<!DOCTYPE html>
<html>

  <head>

    <!-- JQUERY -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>

    <!-- CORE -->
    <script src="/ething/lib/core.js"></script>

    <!-- UI -->
    <link href='//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css' rel='stylesheet' type='text/css' />
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <script src="/ething/lib/ui.js"></script>
    <link href="/ething/lib/ui.css" rel='stylesheet' type='text/css' />

  </head>

  <body>

    <p id="header">
      <button id="open-table" class="btn btn-primary" type="button">Create from table table</button>
      <button id="open-new" class="btn btn-default" type="button">Build a new graph</button>
    </p>

    <!-- your content goes here -->
    <div id="content"></div>

    <!-- APP -->
    <script type="text/javascript">
      var main = function() {

        $('#open-table').click(function() {
          $.OpenDialog({
            filter: function(resource) {
              return resource instanceof EThing.Table;
            },
            limit: 1
          }).done(function(selectedResources) {
            var table = selectedResources[0];

            $('<div>')
              .graphSimpleWizard(table)
              .modal({
                title: 'Graph : "' + table.name() + '"',
                buttons: {
                  '+Draw': function() {
                    var $this = $(this);
                    $this.graphSimpleWizard('validate', function(options) {
                      $('#header').remove();
                      $('#content').graph(options);
                      $this.modal('hide');
                    });
                    return false;
                  },
                  'Cancel': null
                }
              });

          })
        });

        $('#open-new').click(function() {

          $('<div>')
            .graphWizard()
            .modal({
              title: 'Graph',
              buttons: {
                '+Draw': function() {
                  var $this = $(this);
                  $this.graphWizard('validate', function(options) {
                    $('#header').remove();
                    $('#content').graph(options);
                    $this.modal('hide');
                  });
                  return false;
                },
                'Cancel': null
              }
            });

        });


      };

      EThing.auth.authorize(main || null);
    </script>

  </body>

</html>