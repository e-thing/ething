(function(m){function a(t,e,c){if(Array.isArray(e))for(var d in e){var p=e[d];/\[\]$/.test(t)?c(t,p):a(t+"["+("object"===typeof p?d:"")+"]",p,c)}else if("object"===typeof e)for(p in e)a(t+"["+p+"]",e[p],c);else c(t,e)}var h=m.EThing||{utils:{}},e=h.utils;e.isNode="undefined"!==typeof module&&module.exports;e.isId=function(a){return"string"==typeof a&&7===a.length&&/^[0-9a-zA-Z\-_]+$/.test(a)};e.parseUrl=function(a){return(a=/^((([a-z]+):)?\/\/)?(([^:]*)(:([^@]*))?@)?([^:\/?#]+)?(:([0-9]+))?([^?#]+)?(\?[^#]*)?(#.*)?$/i.exec(a))?
{scheme:a[3],user:a[5],password:a[7],hostname:a[8],port:a[10],path:a[11],search:a[12],hash:a[13]}:!1};e.getParam=function(a,e){var c=a.indexOf("?"),d=new RegExp("[\\?&]"+encodeURIComponent(e)+"=([^&#]*)");c=-1!==c?d.exec(a.substr(c)):null;return null===c?"":decodeURIComponent(c[1])};e.getQueryString=function(a,e){var c=a.indexOf("?"),d=new RegExp("[\\?&]"+encodeURIComponent(e)+"=([^&#]*)");c=-1!==c?d.exec(a.substr(c)):null;return null===c?"":decodeURIComponent(c[1])};e.removeParam=function(a,e){var c=
a.split("?");if(2<=c.length){var d=c[1].indexOf("#"),t="";-1!==d&&(t=c[1].substr(d),c[1]=c[1].substr(0,d));d=encodeURIComponent(e)+"=";for(var n=c[1].split(/[&;]/g),f=n.length;0<f--;)-1!==n[f].lastIndexOf(d,0)&&n.splice(f,1);a=c[0]+(0<n.length?"?"+n.join("&"):"")+t}return a};e.insertParam=function(a,f,c){a=e.removeParam(a,f);var d=a.indexOf("#"),t="";-1!==d&&(t=a.substr(d),a=a.substr(0,d));d=a.indexOf("?");var n="";-1!==d&&(n=a.substr(d),a=a.substr(0,d));n+=n.length?"&":"?";n+=encodeURIComponent(f)+
"="+encodeURIComponent(c);return a+n+t};e.param=function(t){var e,c=[],d=function(a,d){d="function"==typeof d?d():null==d?"":d;c[c.length]=encodeURIComponent(a)+"="+encodeURIComponent(d)};for(e in t)null!==t[e]&&"undefined"!=typeof t[e]&&a(e,t[e],d);return c.join("&").replace(/%20/g,"+")};var k=e.pad=function(a,e,c){a+="";return a.length>=e?a:Array(e-a.length+1).join(c||"0")+a};e.sizeToString=function(a){a=parseInt(a);return isNaN(a)?"-":a=9E8<a?Math.floor(a/1E9*100)/100+" GB":9E5<a?Math.floor(a/
1E6*100)/100+" MB":900<a?Math.floor(a/1E3*100)/100+" KB":a+" B"};e.dateToString=function(a){var e=new Date;"number"==typeof a&&(a=new Date(1E3*a));if(a){if(864E5>e.getTime()-a.getTime())return k(a.getHours(),2)+":"+k(a.getMinutes(),2);var c=a.getFullYear(),d=a.getDate();a=a.getMonth();return c==e.getFullYear()?d+" "+"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")[a]+".":c+"/"+k(a+1,2)+"/"+k(d,2)}return"-"};e.dateDiffToString=function(a){a=parseInt(a);if(isNaN(a))return"-";var e=0,c="";
var d=Math.floor(a/604800);1<=d&&2>e&&(c+=Math.floor(d)+" week"+(1<d?"s":""),a-=604800*d,e++);d=Math.floor(a/86400);1<=d&&2>e&&(e&&(c+=" "),c+=Math.floor(d)+" day"+(1<d?"s":""),a-=86400*d,e++);d=Math.floor(a/3600);1<=d&&2>e&&(e&&(c+=" "),c+=Math.floor(d)+" hour"+(1<d?"s":""),a-=3600*d,e++);d=Math.floor(a/60);1<=d&&2>e&&(e&&(c+=" "),c+=Math.floor(d)+" minute"+(1<d?"s":""),a-=60*d,e++);d=a;1<=d&&2>e&&(e&&(c+=" "),c+=Math.floor(d)+" seconde"+(1<d?"s":""));return c};var l={};e.createCache=function(a){return function(e,
c){if(!l[e]||"function"==typeof l[e].state&&"rejected"===l[e].state())l[e]=a(e);return l[e].done(c)}};var v={},f=v.toString,q=v.hasOwnProperty;"Boolean Number String Function Array Date RegExp Object Error Symbol".split(" ").forEach(function(a){v["[object "+a+"]"]=a.toLowerCase()});e.type=function(a){return null==a?a+"":"object"===typeof a||"function"===typeof a?v[f.call(a)]||"object":typeof a};e.isPlainObject=function(a){var f;if("object"!==e.type(a)||a.nodeType||null!=a&&a===a.window)return!1;try{if(a.constructor&&
!q.call(a,"constructor")&&!q.call(a.constructor.prototype||{},"isPrototypeOf"))return!1}catch(c){return!1}for(f in a);return void 0===f||q.call(a,f)};e.extend=function(){var a,f,c,d=arguments[0]||{},p=1,n=arguments.length,l=!1;"boolean"===typeof d&&(l=d,d=arguments[1]||{},p=2);"object"!==typeof d&&"function"!==typeof d&&(d={});n===p&&(d=this,--p);for(;p<n;p++)if(null!=(a=arguments[p]))for(f in a){var h=d[f];var k=a[f];d!==k&&(l&&k&&(e.isPlainObject(k)||(c=Array.isArray(k)))?(c?(c=!1,h=h&&Array.isArray(h)?
h:[]):h=h&&e.isPlainObject(h)?h:{},d[f]=e.extend(l,h,k)):void 0!==k&&(d[f]=k))}return d};m.EThing=h})(this);
(function(m){if("undefined"!==typeof module&&module.exports){m.btoa=function(a){return(a instanceof Buffer?a:new Buffer(a.toString(),"binary")).toString("base64")};m.atob=function(a){return(new Buffer(a,"base64")).toString("binary")};var a=require("url");m.XMLHttpRequest=function(){var h=this,e=require("http"),k=require("https"),l,v,f,q,t,z,c,d={"User-Agent":"node-XMLHttpRequest",Accept:"*/*"},p={},n={},x=!1,r=!1,m={};this.UNSENT=0;this.OPENED=1;this.HEADERS_RECEIVED=2;this.LOADING=3;this.DONE=4;
this.readyState=this.UNSENT;this.onreadystatechange=null;this.responseText=this.response=this.responseType="";this.statusText=this.status=null;this.withCredentials=!1;this.open=function(a,d,e,p,n){this.abort();r=!1;f=a;q=d.toString();t="boolean"!==typeof e?!0:e;z=p||null;c=n||null;w(this.OPENED)};this.setRequestHeader=function(a,d){if(this.readyState!==this.OPENED)throw Error("INVALID_STATE_ERR: setRequestHeader can only be called when state is OPEN");if(x)throw Error("INVALID_STATE_ERR: send flag is true");
a=n[a.toLowerCase()]||a;n[a.toLowerCase()]=a;p[a]=p[a]?p[a]+", "+d:d};this.getResponseHeader=function(a){return"string"===typeof a&&this.readyState>this.OPENED&&v&&v.headers&&v.headers[a.toLowerCase()]&&!r?v.headers[a.toLowerCase()]:null};this.getAllResponseHeaders=function(){if(this.readyState<this.HEADERS_RECEIVED||r)return"";var a="",d;for(d in v.headers)"set-cookie"!==d&&"set-cookie2"!==d&&(a+=d+": "+v.headers[d]+"\r\n");return a.substr(0,a.length-2)};this.getRequestHeader=function(a){return"string"===
typeof a&&n[a.toLowerCase()]?p[n[a.toLowerCase()]]:""};this.send=function(m){if(this.readyState!==this.OPENED)throw Error("INVALID_STATE_ERR: connection must be opened before send() is called");if(x)throw Error("INVALID_STATE_ERR: send has already been called");var C=!1,y=a.parse(q);switch(y.protocol){case "https:":C=!0;case "http:":var B=y.hostname;break;case void 0:case null:case "":B="localhost";break;default:throw Error("Protocol not supported.");}var D=y.port||(C?443:80),E=y.pathname+(y.search?
y.search:""),F;for(F in d)n[F.toLowerCase()]||(p[F]=d[F]);p.Host=B;C&&443===D||80===D||(p.Host+=":"+y.port);z&&("undefined"===typeof c&&(c=""),y=new Buffer(z+":"+c),p.Authorization="Basic "+y.toString("base64"));"GET"===f||"HEAD"===f?m=null:m?(p["Content-Length"]=Buffer.isBuffer(m)?m.length:Buffer.byteLength(m),p["Content-Type"]||(p["Content-Type"]="text/plain;charset=UTF-8")):"POST"===f&&(p["Content-Length"]=0);D={host:B,port:D,path:E,method:f,headers:p,agent:!1,withCredentials:h.withCredentials};
r=!1;if(t){var b=C?k.request:e.request;x=!0;h.dispatchEvent("readystatechange");var g=function(a){h.handleError(a)};l=b(D,function G(d){var c=[];v=d;301===v.statusCode||302===v.statusCode||303===v.statusCode||307===v.statusCode?(q=v.headers.location,d=a.parse(q),B=d.hostname,l=b({hostname:d.hostname,port:d.port,path:d.path,method:303===v.statusCode?"GET":f,headers:p,withCredentials:h.withCredentials},G).on("error",g),l.end()):(w(h.HEADERS_RECEIVED),h.status=v.statusCode,h.statusText=v.statusMessage,
v.on("data",function(a){a&&c.push(a);x&&w(h.LOADING)}),v.on("end",function(){c=Buffer.concat(c);switch(h.responseType){case "":case "text":h.response=c.toString("utf8");h.responseText=h.response;break;case "json":try{h.response=JSON.parse(c.toString("utf8"))}catch(J){h.handleError(J)}break;case "arraybuffer":for(var a=new ArrayBuffer(c.length),b=new Uint8Array(a),g=0;g<c.length;++g)b[g]=c[g];h.response=a;break;case "buffer":h.response=c;break;default:throw Error(h.responseType+" response type not supported.");
}x&&(w(h.DONE),x=!1)}),v.on("error",function(a){h.handleError(a)}))}).on("error",g);m&&l.write(m);l.end();h.dispatchEvent("loadstart")}else throw Error("Synchronous mode not supported.");};this.handleError=function(a){this.status=0;this.statusText=a;this.responseText=a.stack;r=!0;w(this.DONE);this.dispatchEvent("error")};this.abort=function(){l&&(l.abort(),l=null);p=d;this.status=0;this.responseText="";r=!0;this.readyState===this.UNSENT||this.readyState===this.OPENED&&!x||this.readyState===this.DONE||
(x=!1,w(this.DONE));this.readyState=this.UNSENT;this.dispatchEvent("abort")};this.addEventListener=function(a,d){a in m||(m[a]=[]);m[a].push(d)};this.removeEventListener=function(a,d){a in m&&(m[a]=m[a].filter(function(a){return a!==d}))};this.dispatchEvent=function(a){if("function"===typeof h["on"+a])h["on"+a]();if(a in m)for(var d=0,c=m[a].length;d<c;d++)m[a][d].call(h)};var w=function(a){if(a==h.LOADING||h.readyState!==a)h.readyState=a,(t||h.readyState<h.OPENED||h.readyState===h.DONE)&&h.dispatchEvent("readystatechange"),
h.readyState!==h.DONE||r||(h.dispatchEvent("load"),h.dispatchEvent("loadend"))}}}})(this);
(function(m){function a(){return!0}function h(){return!1}function e(a){var e={};a.on=function(a,h){if("function"==typeof h){a=a.split(" ");for(var f=0;f<a.length;f++){var k=a[f];k.length&&(e[k]||(e[k]=[]),e[k].push(h))}}};a.off=function(a,h){a=a.split(" ");for(var f=0;f<a.length;f++){var k=a[f];if(k.length)if("function"==typeof h)for(var c=0;f<e[k].length;f++)e[k][c]===h&&(e[k].splice(c,1),c--);else e[k]=[]}};a.one=function(e,k){if("function"==typeof k)a.on(e,function(){a.off(e,k);k.apply(this,Array.prototype.slice.call(arguments))})};
a.trigger=function(f,h){"string"===typeof f&&(f=k.Event(f));for(var l=e[f.type]||[],m=0;m<l.length;m++){var c=[f];Array.isArray(h)&&(c=c.concat(h));l[m].apply(a,c);if(f.isImmediatePropagationStopped()||f.isPropagationStopped())break}return f}}var k=m.EThing||{};k.Event=function(a,e){if(!(this instanceof k.Event))return new k.Event(a,e);this.type=a;e&&k.utils.extend(this,e);this.timeStamp=Date.now()};k.Event.prototype={constructor:k.Event,isDefaultPrevented:h,isPropagationStopped:h,isImmediatePropagationStopped:h,
preventDefault:function(){this.isDefaultPrevented=a},stopPropagation:function(){this.isPropagationStopped=a},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=a;this.stopPropagation()}};e(k);k.EventEngine=e})(this);
(function(m){function a(h){var e="pending",k=[],l=[],m=[],f=null,q=[["resolve","done"],["reject","fail"],["notify","progress"]],t={done:function(){for(var a=0;a<arguments.length;a++)if(arguments[a])if(Array.isArray(arguments[a]))for(var c=arguments[a],n=0;n<c.length;n++)"resolved"===e&&c[n].apply(this,f),k.push(c[n]);else"resolved"===e&&arguments[a].apply(this,f),k.push(arguments[a]);return this},fail:function(){for(var a=0;a<arguments.length;a++)if(arguments[a])if(Array.isArray(arguments[a]))for(var c=
arguments[a],n=0;n<c.length;n++)"rejected"===e&&c[n].apply(this,f),l.push(c[n]);else"rejected"===e&&arguments[a].apply(this,f),l.push(arguments[a]);return this},always:function(){return this.done.apply(this,arguments).fail.apply(this,arguments)},progress:function(){for(var a=0;a<arguments.length;a++)if(arguments[a])if(Array.isArray(arguments[a]))for(var c=arguments[a],f=0;f<c.length;f++)"pending"===e&&m.push(c[f]);else"pending"===e&&m.push(arguments[a]);return this},then:function(){var c=arguments;
return a(function(a){q.forEach(function(d,e){var f="function"==typeof c[e]&&c[e];z[d[1]](function(){var c=f&&f.apply(this,arguments);if(c&&"function"==typeof c.promise)c.promise().progress(a.notify).done(a.resolve).fail(a.reject);else a[d[0]+"With"](this===t?a.promise():this,f?[c]:arguments)})});c=null}).promise()},promise:function(a){if(null==a)return t;for(var c in t)a[c]=t[c];return a},state:function(){return e},debug:function(){console.log("[debug]",k,l,e)},isRejected:function(){return"rejected"===
e},isResolved:function(){return"resolved"===e}},z={resolveWith:function(a){if("pending"===e){e="resolved";for(var c=f=1<arguments.length?arguments[1]:[],d=0;d<k.length;d++)k[d].apply(a,c)}return this},rejectWith:function(a){if("pending"===e){e="rejected";for(var c=f=1<arguments.length?arguments[1]:[],d=0;d<l.length;d++)l[d].apply(a,c)}return this},notifyWith:function(a){if("pending"===e)for(var c=f=1<arguments.length?arguments[1]:[],d=0;d<m.length;d++)m[d].apply(a,c);return this},resolve:function(){return this.resolveWith(this,
arguments)},reject:function(){return this.rejectWith(this,arguments)},notify:function(){return this.notifyWith(this,arguments)}},c=t.promise(z);h&&h.apply(c,[c]);return c}a.when=function(){if(2>arguments.length){var h=arguments.length?arguments[0]:void 0;return h&&"function"===typeof h.isResolved&&"function"===typeof h.isRejected?h.promise():a().resolve(h).promise()}return function(e){for(var k=a(),h=e.length,m=0,f=Array(h),q=0;q<e.length;q++)(function(a){var l=null;e[a].done?e[a].done(function(){f[a]=
2>arguments.length?arguments[0]:arguments;++m==h&&k.resolve.apply(k,f)}).fail(function(){k.reject(arguments)}):(l=e[a],e[a]=new Deferred,e[a].done(function(){f[a]=2>arguments.length?arguments[0]:arguments;++m==h&&k.resolve.apply(k,f)}).fail(function(){k.reject(arguments)}).resolve(l))})(q);return k.promise()}(arguments)};m.EThing=m.EThing||{utils:{}};m.EThing.utils.Deferred=a})(this);
(function(m){var a=m.EThing||{},h=m.Blob||function(){},e=m.Buffer||function(){},k=a.utils.extend,l=a.utils.isId,v=a.utils.isPlainObject,f=[],q=[],t=[],z=[],c=null;a.Error=function(a){this.name="EThing.Error";"string"==typeof a&&(a={message:a});k(this,{message:"unknown error"},a)};a.Error.prototype=Error();var d=function(b,g){b=b||"";/^([a-z]+:)?\/\//.test(b)||(!/^\//.test(b)&&b&&(b="/"+b),b=a.config.apiUrl+b);g&&p(b)&&(b=E(b),"function"==typeof c&&(b=c(b)));return b},p=function(b){return(new RegExp("^([a-z]+:)?//"+
a.config.apiUrl.replace(/^([a-z]+:)?\/\//,""))).test(b)};a.toApiUrl=d;a.apiUrl=function(){return d()};var n=function(b){function g(g){var c=u.getResponseHeader("Content-Type")||"",A=null;if("undefined"!=typeof g)A=g;else if(/json/.test(c)||/text\/plain/.test(c))switch(u.responseType){case "":case "text":case "json":A=u.response;break;case "blob":if(b.synchronous){if(!FileReaderSync)throw Error("FileReaderSync not supported.");g=new FileReaderSync;A=String.fromCharCode.apply(null,new Uint8Array(g.readAsArrayBuffer(u.response)))}else{A=
a.utils.Deferred();if(!FileReader)throw Error("FileReaderSync not supported.");g=new FileReader;g.onload=function(){A.resolve(String.fromCharCode.apply(null,new Uint8Array(this.result)))};g.readAsArrayBuffer(u.response)}break;case "arraybuffer":A=String.fromCharCode.apply(null,new Uint8Array(u.response));break;case "buffer":A=u.response.toString("utf8");break;default:throw Error(u.responseType+" response type not supported.");}a.utils.Deferred.when(A).always(function(g){try{g=JSON.parse(g)}catch(L){}var c=
[new a.Error(g||(u.status?u.status+" ["+u.statusText+"]":"unknown error")),u,b];a.trigger("ething.request.error",c);t.forEach(function(a){a.apply(r,c)});a.trigger("ething.request.complete",c);q.forEach(function(a){a.apply(r,c)});G.rejectWith(r,c)})}function A(g){var c=[g,u,b];a.trigger("ething.request.success",c);f.forEach(function(a){a.apply(r,c)});a.trigger("ething.request.complete",c);q.forEach(function(a){a.apply(r,c)});G.resolveWith(r,c)}var G=new a.utils.Deferred,u=new m.XMLHttpRequest;"string"==
typeof b&&(b={url:b});b=k({method:"GET",context:null,url:null,data:null,contentType:null,headers:null,dataType:null,converter:null,synchronous:!1},b);if("string"!=typeof b.url)return null;var n=d(b.url),l=p(n);b.method=b.method.toUpperCase();var r=b.context||a,w=!/^(?:GET|HEAD)$/.test(b.method),x=void 0,y="undefined"!=typeof b.data&&null!==b.data;!w&&y&&(n+=(/\?/.test(n)?"&":"?")+("string"==typeof b.data?b.data:a.utils.param(b.data)));u.open(b.method,n,!b.synchronous);n=null;if(v(b.headers))for(var B in b.headers)b.headers.hasOwnProperty(B)&&
(/^content-type$/i.test(B)&&(n=b.headers[B]),u.setRequestHeader(B,b.headers[B]));!n&&b.contentType&&u.setRequestHeader("Content-Type",n=b.contentType);if(w&&y)if(n){if(x=b.data,v(b.data)||Array.isArray(b.data))/json/i.test(n)?x=JSON.stringify(b.data):/application\/x-www-form-urlencoded/i.test(n)&&(x=a.utils.param(b.data))}else b.data instanceof h?(u.setRequestHeader("Content-Type",n=b.data.type),x=b.data):b.data instanceof ArrayBuffer||b.data instanceof e?(u.setRequestHeader("Content-Type",n="application/octet-stream"),
x=b.data):(u.setRequestHeader("Content-Type",n="application/x-www-form-urlencoded; charset=UTF-8"),x="string"==typeof b.data?b.data:a.utils.param(b.data));l&&(u=E(u),"function"==typeof c&&(u=c(u)));var C=b.dataType;C&&"auto"!=C&&(u.responseType=C);u.onload=function(a){if(200<=u.status&&300>u.status||304===u.status){a=u.response;if("auto"==C){if(/json/.test(u.getResponseHeader("Content-Type")||""))try{a=JSON.parse(a)}catch(K){}}else if("json"==C&&"string"===typeof a)try{a=JSON.parse(a)}catch(K){}"function"==
typeof b.converter&&(a=b.converter.call(r,a,u,b));A(a)}else g()};u.onerror=function(){g()};u.onabort=function(){g()};u.onprogress=function(a){G.notifyWith(r,[a,u,b])};l=a.Event("ething.request.send");a.trigger(l,[u,b]);l.isDefaultPrevented()?g("Aborded"):(z.forEach(function(a){a.call(r,u)}),u.send(x));return G.promise()},x=a.getClass=function(b){b=b.split(/[.\\]/);var g=a;b.forEach(function(a){if("undefined"!=typeof g[a])g=g[a];else return g=void 0,!1});return g};a.instanciate=function(a){var b=x(a.type);
return b?new b(a):!1};var r=function(b,g){if("object"==typeof b&&null!==b){var c=Array.isArray(b);c||(b=[b]);b=b.map(function(b){return a.instanciate(b)}).filter(function(a){return a});b=a.arbo.update(b).resources;c||(b=b.length?b[0]:null)}return b};a.request=function(a,g){var b=n(a);"function"==typeof g&&b.always(function(){g.apply(this,Array.prototype.slice.call(arguments))});if(a.synchronous){var c=null;b.always(function(a){c=a});return c}return b};a.apiRequestPrefilter=function(a){c=a};a.ajaxSend=
function(a){"function"==typeof a&&z.push(a)};a.ajaxComplete=function(a){"function"==typeof a&&q.push(a)};a.ajaxSuccess=function(a){"function"==typeof a&&f.push(a)};a.ajaxError=function(a){"function"==typeof a&&t.push(a)};var B=a.DeferredObject=function(){function b(){for(var a=0;a<c.length;a++){var b=c[a].dfr,g=c[a].fn;if(c[a].pending)c[a].pending=!1,g.call(d,d).done(function(){var a=Array.prototype.slice.call(arguments);b.resolveWith(d,a)}).fail(function(){b.rejectWith(d,Array.prototype.slice.call(arguments))}).progress(function(){b.notifyWith(d,
Array.prototype.slice.call(arguments))});else if(b.isResolved()||b.isRejected()){c.splice(a,1);a--;continue}break}}var g=a.utils.Deferred().resolve(),c=[],d=this;"done fail always progress then state isRejected isResolved".split(" ").forEach(function(a){this[a]=function(){var b=(c.length?c[c.length-1].dfr:g)[a].apply(d,Array.prototype.slice.call(arguments));return"object"==typeof b&&"then"!==a?d:b}},this);this.promise=function(){return d};this.deferred=function(g){var d=new a.utils.Deferred;d.always(function(){b()});
c.push({fn:g,dfr:d,pending:!0});b();return this}};a.config=k({apiUrl:(m.location?window.location.protocol+"//"+window.location.hostname:"http://localhost")+"/ething/api"},a.config);var w=a.utils.inherits=function(a,c){a.prototype=new c;a.prototype.constructor=a};a.Resource=function(b){B.call(this);a.EventEngine(this);this._fromJson(b,!0)};w(a.Resource,B);a.Resource.prototype._fromJson=function(b,c){var g=this._json&&b&&this._json.modifiedDate&&b.modifiedDate&&this._json.modifiedDate!==b.modifiedDate;
this._json=k({name:null,id:null,type:null,createdBy:null,createdDate:0,modifiedDate:0,data:null,description:null},b||{});!c&&g&&(this.trigger("updated"),a.trigger("ething.resource.updated",[this]));return g};a.Resource.prototype.json=function(){return this._json};a.Resource.prototype.name=function(){return this._json.name};a.Resource.prototype.dirname=function(){return a.Resource.dirname(this._json.name)};a.Resource.prototype.basename=function(){return a.Resource.basename(this._json.name)};a.Resource.prototype.extension=
function(){return a.Resource.extension(this._json.name)};a.Resource.prototype.id=function(){return this._json.id};a.Resource.prototype.createdBy=function(){return this._json.createdBy};a.Resource.prototype.type=function(){return this._json.type};a.Resource.prototype.baseType=function(){return this._json.type.split("\\").shift()};a.Resource.prototype.createdDate=function(){return new Date(this._json.createdDate)};a.Resource.prototype.ctime=function(){return this.createdDate()};a.Resource.prototype.modifiedDate=
function(){return new Date(this._json.modifiedDate)};a.Resource.prototype.mtime=function(){return this.modifiedDate()};a.Resource.prototype["public"]=function(){return this._json["public"]||!1};a.Resource.prototype.data=function(a,c){return"undefined"==typeof a?this._json.data:this._json.data.hasOwnProperty(a)?this._json.data[a]:c};a.Resource.prototype.description=function(){return this._json.description||""};a.Resource.prototype.remove=function(b){return this.deferred(function(){return a.Resource.remove(this,
b)})};a.Resource.prototype.update=function(b){return this.deferred(function(){return a.get(this,b)})};a.Resource.prototype.set=function(b,c){var g=[].slice.call(arguments);return this.deferred(function(){g.unshift(this);return a.Resource.set.apply(a,g)})};a.Resource.prototype.setData=function(a,c,d){if("string"===typeof a&&"function"!=typeof c){var b=a,g=c;c=d;a={};a[b]=g}return this.set({data:a},c)};a.File=function(b){a.Resource.call(this,b)};w(a.File,a.Resource);a.File.prototype.size=function(){return this._json.size};
a.File.prototype.expireAfter=function(){return this._json.expireAfter||null};a.File.prototype.mime=function(){return this._json.mime};a.File.prototype.thumbnailLink=function(a){return this._json.hasThumbnail?d("files/"+this.id()+"/thumbnail",a):null};a.File.prototype.getContentUrl=function(a){return d("files/"+this.id(),a)};a.File.prototype.isText=function(){return this._json.isText};a.File.prototype.isScript=function(){return this._json.isText&&"application/javascript"===this._json.mime};a.File.prototype.execute=
function(b,c){b=[].slice.call(arguments);return this.deferred(function(){b.unshift(this);return a.File.execute.apply(a,b)})};a.File.prototype.read=function(b,c){var g=[].slice.call(arguments);return this.deferred(function(){g.unshift(this);return a.File.read.apply(a,g)})};a.File.prototype.write=function(b,c){var g=[].slice.call(arguments);return this.deferred(function(){g.unshift(this);return a.File.write.apply(a,g)})};a.Table=function(b){a.Resource.call(this,b)};w(a.Table,a.Resource);a.Table.prototype.length=
function(){return this._json.length};a.Table.prototype.maxLength=function(){return this._json.maxLength};a.Table.prototype.expireAfter=function(){return this._json.expireAfter};a.Table.prototype.keys=function(){var a=[],c;for(c in this._json.keys)this._json.keys.hasOwnProperty(c)&&a.push(c);return a};a.Table.prototype.select=function(b,c){var g=[].slice.call(arguments);return this.deferred(function(){g.unshift(this);return a.Table.select.apply(a,g)})};a.Table.prototype.computeStatistics=function(b,
c,d){var g=[].slice.call(arguments);return this.deferred(function(){g.unshift(this);return a.Table.computeStatistics.apply(a,g)})};a.Table.prototype.removeRow=function(b,c){var g=[].slice.call(arguments);return this.deferred(function(){g.unshift(this);return a.Table.removeRow.apply(a,g)})};a.Table.prototype.replaceRow=function(b,c){var g=[].slice.call(arguments);return this.deferred(function(){g.unshift(this);return a.Table.replaceRow.apply(a,g)})};a.Table.prototype.findOneAndReplace=function(b,c,
d,e){var g=[].slice.call(arguments);return this.deferred(function(){g.unshift(this);return a.Table.findOneAndReplace.apply(a,g)})};a.Table.prototype.insert=function(b,c){var g=[].slice.call(arguments);return this.deferred(function(){g.unshift(this);return a.Table.insert.apply(this,g)})};a.Table.prototype["import"]=function(b,c){var g=[].slice.call(arguments);return this.deferred(function(){g.unshift(this);return a.Table["import"].apply(this,g)})};a.Table.prototype.getContentUrl=function(a){return d("tables/"+
this.id(),a)};a.App=function(b){a.Resource.call(this,b)};w(a.App,a.Resource);a.App.prototype.size=function(){return this._json.size||0};a.App.prototype.iconLink=function(a){return this._json.hasIcon?d("apps/"+this.id()+"/icon",a):null};a.App.prototype.getContentUrl=function(a){return d("apps/"+this.id(),a)};a.App.prototype.scope=function(){return"string"==typeof this._json.scope?this._json.scope:""};a.App.prototype.version=function(){return this._json.version||null};a.App.prototype.read=function(b){var c=
[].slice.call(arguments);return this.deferred(function(){c.unshift(this);return a.App.read.apply(a,c)})};a.App.prototype.write=function(b,c){var g=[].slice.call(arguments);return this.deferred(function(){g.unshift(this);return a.App.write.apply(a,g)})};a.Device=function(b){a.Resource.call(this,b);(this._json.operations||[]).forEach(function(b){if("undefined"==typeof this[b]){var c=this;this[b]=function(c,g,d){var e=[].slice.call(arguments);return this.deferred(function(){e.unshift(b);e.unshift(this);
return a.Device.execute.apply(a,e)})};this[b].getApi=function(g){return a.Device.getApi(c,b,g)};this[b].executeUrl=function(a){return c.executeUrl(b,a)}}},this)};w(a.Device,a.Resource);a.Device.prototype.location=function(){return this._json.location||null};a.Device.prototype.lastSeenDate=function(){return"string"==typeof this._json.lastSeenDate?new Date(this._json.lastSeenDate):null};a.Device.prototype.hasBattery=function(){return"number"==typeof this._json.battery&&0<=this._json.battery};a.Device.prototype.battery=
function(){return this.hasBattery()?this._json.battery:null};a.Device.prototype.operations=function(){return this._json.operations?this._json.operations:[]};a.Device.prototype.execute=function(){var b=[].slice.call(arguments);return this.deferred(function(){b.unshift(this);return a.Device.execute.apply(a,b)})};a.Device.prototype.executeUrl=function(b,c){var g="devices/"+this.id()+"/call/"+b;if(v(c)&&0!==Object.keys(c).length){var d=JSON.stringify(c);g+="?paramData="+encodeURIComponent(d)}return a.toApiUrl(g,
!0)};a.Device.prototype.getApi=function(b,c){var g=[].slice.call(arguments);return this.deferred(function(){g.unshift(this);return a.Device.getApi.apply(a,g)})};a.Device.Http=function(b){a.Device.call(this,b)};w(a.Device.Http,a.Device);a.Device.Http.prototype.url=function(){return this._json.url};a.Device.Http.prototype.auth=function(){return this._json.auth};a.Device.Http.prototype.scope=function(){return"string"==typeof this._json.scope?this._json.scope:""};a.Device.Http.prototype.request=function(b){var c=
[].slice.call(arguments);return this.deferred(function(){c.unshift(this);return a.Device.Http.request.apply(a,c)})};a.Device.Http.prototype.ajax=a.Device.Http.prototype.request;a.Device.Http.prototype.getResourceUrl=function(b,c){return a.Device.Http.getResourceUrl(this,b,c)};a.Device.Http.prototype.setSpecification=function(a,c){"string"==typeof a&&(a=JSON.parse(a));return this.set({specification:a},c)};a.Device.Http.prototype.getSpecification=function(b){return a.Device.Http.getSpecification(this,
b)};a.Device.MySensorsGateway=function(b){a.Device.call(this,b)};w(a.Device.MySensorsGateway,a.Device);a.Device.MySensorsGateway.prototype.isMetric=function(){return this._json.isMetric};a.Device.MySensorsGateway.prototype.libVersion=function(){return this._json.libVersion};a.Device.MySensorsEthernetGateway=function(b){a.Device.call(this,b)};w(a.Device.MySensorsEthernetGateway,a.Device.MySensorsGateway);a.Device.MySensorsEthernetGateway.prototype.address=function(){return this._json.address};a.Device.MySensorsSerialGateway=
function(b){a.Device.call(this,b)};w(a.Device.MySensorsSerialGateway,a.Device.MySensorsGateway);a.Device.MySensorsSerialGateway.prototype.port=function(){return this._json.port};a.Device.MySensorsSerialGateway.prototype.baudrate=function(){return this._json.baudrate};a.Device.RFLinkGateway=function(b){a.Device.call(this,b)};w(a.Device.RFLinkGateway,a.Device);a.Device.RFLinkGateway.prototype.inclusion=function(){return!!this._json.inclusion};a.Device.RFLinkGateway.prototype.version=function(){return this._json.version};
a.Device.RFLinkGateway.prototype.revision=function(){return this._json.revision};a.Device.RFLinkGateway.prototype.build=function(){return this._json.build};a.Device.RFLinkSerialGateway=function(b){a.Device.call(this,b)};w(a.Device.RFLinkSerialGateway,a.Device.RFLinkGateway);a.Device.RFLinkSerialGateway.prototype.port=function(){return this._json.port};a.Device.RFLinkSerialGateway.prototype.baudrate=function(){return this._json.baudrate};a.Device.RFLinkSwitch=function(b){a.Device.call(this,b)};w(a.Device.RFLinkSwitch,
a.Device);a.Device.RFLinkSwitch.prototype.protocol=function(){return!!this._json.protocol};a.Device.RFLinkSwitch.prototype.nodeId=function(){return!!this._json.nodeId};a.Device.RFLinkSwitch.prototype.switchId=function(){return!!this._json.switchId};a.Device.MySensorsNode=function(b){a.Device.call(this,b)};w(a.Device.MySensorsNode,a.Device);a.Device.MySensorsNode.prototype.nodeId=function(){return this._json.nodeId};a.Device.MySensorsNode.prototype.sketchName=function(){return this._json.sketchName};
a.Device.MySensorsNode.prototype.sketchVersion=function(){return this._json.sketchVersion};a.Device.MySensorsNode.prototype.smartSleep=function(){return this._json.smartSleep};a.Device.MySensorsSensor=function(b){a.Device.call(this,b)};w(a.Device.MySensorsSensor,a.Device);a.Device.MySensorsSensor.prototype.sensorId=function(){return this._json.sensorId};a.Device.MySensorsSensor.prototype.sensorType=function(){return this._json.sensorType};a.Device.MySensorsSensor.prototype.val=function(a){return this._json.data.hasOwnProperty(a)?
this._json.data[a]:null};a.Device.MySensorsSensor.prototype.setValue=function(a,c,d){var b={};b[a]=c;return this.setData(b,d)};a.Device.RTSP=function(b){a.Device.call(this,b)};w(a.Device.RTSP,a.Device);a.Device.RTSP.prototype.url=function(){return this._json.url};a.Device.RTSP.prototype.transport=function(){return this._json.transport};a.Device.Denon=function(b){a.Device.call(this,b)};w(a.Device.Denon,a.Device);a.Device.Denon.prototype.host=function(){return this._json.host};a.Device.MQTT=function(b){a.Device.call(this,
b)};w(a.Device.MQTT,a.Device);a.Device.MQTT.prototype.host=function(){return this._json.host};a.Device.MQTT.prototype.port=function(){return this._json.port};a.Device.MQTT.prototype.topic=function(){return this._json.topic};a.Device.MQTT.prototype.auth=function(){return this._json.auth||null};a.list=a.find=function(b,c){var g=null,d=null;1==arguments.length?"function"==typeof arguments[0]?d=arguments[0]:g=arguments[0]:2<=arguments.length&&(g=arguments[0],d=arguments[1]);return a.request({url:"/resources?"+
a.utils.param({q:g}),method:"GET",dataType:"json",converter:r},d)};a.Resource.usage=function(b){return a.request({url:"/usage",dataType:"json",method:"GET"},b)};a.Resource.remove=function(b,c){if(b instanceof a.Resource){var g=b;b=b.id()}else if(!l(b))throw"First argument must be a Resource object or a Resource id : "+b;return a.request({url:"/resources/"+b,method:"DELETE",context:g},c).done(function(){a.trigger("ething.resource.removed",[b])})};a.get=function(b,c){if(b instanceof a.Resource){var g=
b;b=b.id()}else if(!l(b))throw"First argument must be a Resource object or a Resource id : "+b;return a.request({url:"/resources/"+b,dataType:"json",method:"GET",context:g,converter:r},c)};a.Resource.set=function(b,c,d){if(!v(c)||!c)throw"Second argument must be a unempty object !";if(b instanceof a.Resource){var g=b;b=b.id()}else if(!l(b))throw"First argument must be a Resource object or a Resource id : "+b;return a.request({url:"/resources/"+b,dataType:"json",method:"POST",contentType:"application/json; charset=utf-8",
data:c,context:g,headers:{"X-HTTP-Method-Override":"PATCH"},converter:r},d)};a.Resource.dirname=function(a){var b=a.replace(/\/[^\/]*\/?$/,"");return b===a?"":b};a.Resource.basename=function(a){return a.replace(/.*\//,"")};a.Resource.extension=function(a){return 0<=a.indexOf(".")?a.split(".").pop():""};a.Resource.fnmatch=function(a,c){for(var b=a.split(" "),g,d=0;d<b.length;d++)if(""!=b[d]&&(g="^"+b[d].replace(/\//g,"\\/").replace(/\*\*/g,"(\\/[^\\/]+)*").replace(/\*/g,"[^\\/]+").replace(/((?!\\))\?/g,
"$1.")+"$",g="^"+g+"$",g=new RegExp(g),null!=c.match(g)))return!0;return!1};a.File.create=function(b,c){"string"==typeof b&&(b={name:b});return a.request({url:"/files",dataType:"json",method:"POST",contentType:"application/json; charset=utf-8",data:b,converter:r},c).done(function(b){a.trigger("ething.file.created",[b])})};a.File.read=function(b,c,d){if(b instanceof a.File){var g=b;b=b.id()}else if(!l(b))throw"First argument must be a File object or a file id !";"undefined"==typeof d&&"function"==
typeof c&&(d=c,c=!1);return a.request({url:"/files/"+b,method:"GET",dataType:c?a.utils.isNode?"buffer":"blob":"text",context:g},d)};a.File.execute=function(b,c,d){if(b instanceof a.File){var g=b;b=b.id()}else if(!l(b))throw"First argument must be a File object or a file id !";"undefined"===typeof d&&"function"===typeof c&&(d=c,c=null);return a.request({url:"/files/"+b+"/execute?"+a.utils.param({args:c}),method:"GET",dataType:"json",context:g},d)};a.File.write=function(b,c,d){if(b instanceof a.File){var g=
b;b=b.id()}else if(!l(b))throw"First argument must be a File object or a file id !";return a.request({url:"/files/"+b,dataType:"json",method:"PUT",contentType:"string"==typeof c?"text/plain":"application/octet-stream",data:c,context:g,converter:r},d)};a.Table.create=function(b,c){"string"==typeof b&&(b={name:b});return a.request({url:"/tables",dataType:"json",method:"POST",contentType:"application/json; charset=utf-8",data:b,converter:r},c).done(function(b){a.trigger("ething.table.created",[b])})};
a.Table.select=function(b,c,d){if(b instanceof a.Table){var g=b;b=b.id()}else if(!l(b))throw"First argument must be a Table object or a table id !";"undefined"==typeof d&&"function"==typeof c&&(d=c,c=null);c=c||{};Array.isArray(c.fields)&&(c.fields=c.fields.join(","));return a.request({url:"/tables/"+b+"?"+a.utils.param({start:c.start,length:c.length,sort:c.sort,q:c.query,fields:c.fields,datefmt:c.datefmt}),method:"GET",dataType:"json",context:g},d)};a.Table.computeStatistics=function(b,c,d,e){if(b instanceof
a.Table){var g=b;b=b.id()}else if(!l(b))throw"First argument must be a Table object or a table id !";"undefined"==typeof e&&"function"==typeof d&&(e=d,d=null);return a.request({url:"/tables/"+b+"/statistics?"+a.utils.param({key:c,q:d}),method:"GET",dataType:"json",context:g},e)};a.Table.removeRow=function(b,c,d){if(b instanceof a.Table){var g=b;b=b.id()}else if(!l(b))throw"First argument must be a Table object or a table id !";c=Array.isArray(c)?c:[c];return a.request({url:"/tables/"+b+"/remove",
dataType:"json",method:"POST",contentType:"application/json; charset=utf-8",data:c,context:g,converter:r},d)};a.Table.replaceRow=function(b,c,d){if(b instanceof a.Table){var g=b;b=b.id()}else if(!l(b))throw"First argument must be a Table object or a table id !";if("object"===typeof c&&!l(c.id))throw"Second argument must be an object containing at least a document id";return a.request({url:"/tables/"+b+"/id/"+c.id,dataType:"json",method:"POST",contentType:"application/json; charset=utf-8",data:c,context:g,
headers:{"X-HTTP-Method-Override":"PATCH"}},d)};a.Table.findOneAndReplace=function(b,c,d,e,f){var g=f,A=!1;if(b instanceof a.Table){var h=b;b=b.id()}else if(!l(b))throw"First argument must be a Table object or a table id !";if("string"!==typeof c)throw"Second argument must be a query string";if("object"!==typeof d)throw"Third argument must be an object";"undefined"===typeof f&&"function"===typeof e&&(g=e,A=!1);"boolean"===typeof e&&(A=e);return a.request({url:"/tables/"+b+"/replace?"+a.utils.param({q:c,
upsert:A}),dataType:"json",method:"POST",contentType:"application/json; charset=utf-8",data:d,context:h,converter:r},g)};a.Table.insert=function(b,c,d,e){if(b instanceof a.Table){var g=b;b=b.id()}else if(!l(b))throw"First argument must be a Table object or a table id !";if("string"==typeof d){var f=d;d=e}return a.request({url:"/tables/"+b+"?"+a.utils.param({invalid_field:f}),dataType:"json",method:"POST",contentType:"application/json; charset=utf-8",data:c,context:g,converter:r},d)};a.Table["import"]=
function(b,c){if(b instanceof a.Table){var d=b;b=b.id()}else if(!l(b))throw"First argument must be a Table object or a table id !";if(!Array.isArray(c))throw"The data must be an array of objects";for(var g=2;g<arguments.length;g++)switch(typeof arguments[g]){case "function":var e=arguments[g];break;case "boolean":var f=arguments[g];break;case "string":var h=arguments[g]}return a.request({url:"/tables/"+b+"?"+a.utils.param({skip_error:f,invalid_field:h}),dataType:"json",method:"PUT",contentType:"application/json; charset=utf-8",
data:c,context:d,converter:r},e)};a.Device.execute=function(b,c,d,e,f){if(b instanceof a.Device){var g=b;b=b.id()}else if(!l(b))throw"First argument must be a Device object or a Device id !";4==arguments.length?"boolean"==typeof d?(f=e,e=d,d=void 0):"function"==typeof e&&(f=e,e=void 0):3==arguments.length&&("boolean"==typeof d?(e=d,d=void 0):"function"==typeof d&&(f=d,d=void 0));return a.request({url:"/devices/"+b+"/call/"+c,method:"POST",contentType:"application/json; charset=utf-8",data:d,dataType:e?
a.utils.isNode?"buffer":"blob":"auto",context:g},f)};a.Device.getApi=function(b,c,d){"function"==typeof c&&"undefined"==typeof d&&(d=c,c=void 0);if(b instanceof a.Device){var e=b;b=b.id()}else if(!l(b))throw"First argument must be a Device object or a Device id !";return a.request({url:"/devices/"+b+"/api"+(c?"/"+c:""),method:"GET",context:e,dataType:"json"},d)};a.Device.Http.create=function(b,c){b.type="Http";return a.request({url:"/devices",dataType:"json",method:"POST",contentType:"application/json; charset=utf-8",
data:b,converter:r},c).done(function(b){a.trigger("ething.device.created",[b])})};a.Device.Http.getResourceUrl=function(b,c,e){b instanceof a.Device.Http&&(b=b.id());b="devices/"+b+"/request";"string"==typeof c&&(/^\//.test(c)||(c="/"+c),b+=c);return d(b,e)};a.Device.Http.ajax=a.Device.Http.request=function(b,c){if(b instanceof a.Device.Http){var d=b;var e=b.id()}else if(l(b))e=b;else throw"First argument must be a Device object or a Device id !";d={url:null,context:d};"string"==typeof c?d.url=c:
k(d,c);d.url=a.Device.Http.getResourceUrl(e,d.url);return a.request(d)};a.Device.Http.getSpecification=function(b,c){if(b instanceof a.Device.Http){var d=b;b=b.id()}else if(!a.utils.isId(b))throw"First argument must be a Device object or a Device id !";return a.request({url:"/devices/"+b+"/specification",dataType:"json",context:d,converter:function(b){d instanceof a.Device.Http&&(d.swaggerSpecification=b);return b}},c)};a.Device.MySensorsEthernetGateway.create=function(b,c){b.type="MySensorsEthernetGateway";
return a.request({url:"/devices",dataType:"json",method:"POST",contentType:"application/json; charset=utf-8",data:b,converter:r},c).done(function(b){a.trigger("ething.device.created",[b])})};a.Device.MySensorsSerialGateway.create=function(b,c){b.type="MySensorsSerialGateway";return a.request({url:"/devices",dataType:"json",method:"POST",contentType:"application/json; charset=utf-8",data:b,converter:r},c).done(function(b){a.trigger("ething.device.created",[b])})};a.Device.MySensorsNode.create=function(b,
c){b.type="MySensorsNode";return a.request({url:"/devices",dataType:"json",method:"POST",contentType:"application/json; charset=utf-8",data:b,converter:r},c).done(function(b){a.trigger("ething.device.created",[b])})};a.Device.MySensorsSensor.create=function(b,c){b.type="MySensorsSensor";return a.request({url:"/devices",dataType:"json",method:"POST",contentType:"application/json; charset=utf-8",data:b,converter:r},c).done(function(b){a.trigger("ething.device.created",[b])})};a.Device.RFLinkSerialGateway.create=
function(b,c){b.type="RFLinkSerialGateway";return a.request({url:"/devices",dataType:"json",method:"POST",contentType:"application/json; charset=utf-8",data:b,converter:r},c).done(function(b){a.trigger("ething.device.created",[b])})};a.Device.RTSP.create=function(b,c){b.type="RTSP";return a.request({url:"/devices",dataType:"json",method:"POST",contentType:"application/json; charset=utf-8",data:b,converter:r},c).done(function(b){a.trigger("ething.device.created",[b])})};a.Device.Denon.create=function(b,
c){b.type="Denon";return a.request({url:"/devices",dataType:"json",method:"POST",contentType:"application/json; charset=utf-8",data:b,converter:r},c).done(function(b){a.trigger("ething.device.created",[b])})};a.Device.MQTT.create=function(b,c){b.type="MQTT";return a.request({url:"/devices",dataType:"json",method:"POST",contentType:"application/json; charset=utf-8",data:b,converter:r},c).done(function(b){a.trigger("ething.device.created",[b])})};a.App.create=function(b,c){b.content&&(b.content=m.btoa(b.content));
if(b.icon){if(b.icon instanceof h){if(!FileReader)throw"no FileReader instance found";var d=new FileReader,e=a.utils.Deferred();d.onloadend=function(){b.icon=d.result.substr(d.result.indexOf(";base64,")+8);a.request({url:"/apps",dataType:"json",method:"POST",contentType:"application/json; charset=utf-8",data:b,converter:r}).done(function(){e.resolveWith(this,Array.prototype.slice.call(arguments))}).fail(function(){e.rejectWith(this,Array.prototype.slice.call(arguments))})};d.readAsDataURL(b.icon);
return e.done(c).done(function(){a.trigger("ething.app.created",[this])}).promise()}if(b.icon instanceof ArrayBuffer){for(var g="",f=new Uint8Array(b.icon),p=0;p<f.byteLength;p++)g+=String.fromCharCode(f[p]);b.icon=m.btoa(g)}else if("string"!=b.icon)throw"invalid type for the icon attribute";}return a.request({url:"/apps",dataType:"json",method:"POST",contentType:"application/json; charset=utf-8",data:b,converter:r},c).done(function(b){a.trigger("ething.app.created",[b])})};a.App.read=function(b,
c){if(b instanceof a.App){var d=b;var e=b.id()}else if(l(b))e=b;else throw"First argument must be a File object or a file id !";return a.request({url:"/apps/"+e,method:"GET",dataType:"text",context:d},c)};a.App.write=function(b,c,d){if(b instanceof a.App){var e=b;b=b.id()}else if(!l(b))throw"First argument must be a File object or a file id !";if("string"!=typeof c)throw"Second argument must be a string !";return a.request({url:"/apps/"+b,dataType:"json",method:"PUT",contentType:"string"==typeof c?
"text/plain":"application/octet-stream",data:c,context:e,converter:r},d)};a.App.getIcon=function(b,c){if(b instanceof a.App){var d=b;var e=b.id()}else if(l(b))e=b;else throw"First argument must be a File object or a file id !";return a.request({url:"/apps/"+e+"/icon",method:"GET",dataType:a.utils.isNode?"buffer":"blob",context:d},c)};a.settings=a.settings||{};a.settings.get=function(b){return a.request({url:"/settings",dataType:"json",method:"GET"},b)};a.settings.set=function(b,c){if(!v(b))throw"First argument must be an object !";
return a.request({url:"/settings",dataType:"json",method:"POST",contentType:"application/json; charset=utf-8",data:b,headers:{"X-HTTP-Method-Override":"PATCH"}},c)};a.notify=function(b,c,d){var e={};if(3==arguments.length)e.body=c,e.subject=b;else if(2==arguments.length)"string"==typeof c?(e.subject=b,e.body=c):(e.body=b,d=c);else if(1==arguments.length)e.body=b;else throw"Bad arguments!";return a.request({url:"/notification",method:"POST",contentType:"application/json; charset=utf-8",data:e},d)};
var C=function(a){return a},H=null,y=null,I=null,D=null,E=C;a.auth={};a.auth.isAuthenticated=function(){return!!D};a.auth.getApp=function(){return H};a.auth.getDevice=function(){return y};a.auth.getScope=function(){return I};a.auth.reset=function(){I=D=y=H=null;E=C};a.auth.setApiKey=function(b){a.auth.reset();E=function(c){"string"==typeof c?c=a.utils.insertParam(c,"api_key",b):c.setRequestHeader("X-API-KEY",b);return c}};a.auth.setBasicAuth=function(b,c){a.auth.reset();E=function(a){"string"==typeof a?
a=a.replace(/\/\/([^:]+:[^@]+@)?/,"//"+b+":"+c+"@"):a.setRequestHeader("Authorization","Basic "+m.btoa(b+":"+c));return a}};a.initialize=function(b,c,d){a.auth.reset();b=k({apiUrl:null,apiKey:null,login:null,password:null},b||{});b.apiUrl&&(a.config.apiUrl=b.apiUrl);b.apiKey?a.auth.setApiKey(b.apiKey):b.login&&b.password&&a.auth.setBasicAuth(b.login,b.password);return a.request({url:"/auth",dataType:"json",context:a,converter:function(b){D=b.type;b.app&&(H=new a.App(b.app));b.device&&(y=new a.Device.Http(b.device));
b.scope&&(I=b.scope)}}).done(function(){F.forEach(function(b){b.call(a)});a.trigger("ething.authenticated")}).done(c).fail(d)};var F=[];a.authenticated=function(b){"function"==typeof b&&(F.push(b),a.auth.isAuthenticated()&&b.call(a))};m.EThing=a})(this);
(function(m){function a(a){return f.request({url:"/resources",method:"GET",dataType:"json"}).then(function(a){a=a.map(function(a){return f.instanciate(a)}).filter(function(a){return a});h(a,!0);return q}).done(a)}function h(a,d,h){Array.isArray(a)||(a=[a]);var c=[],k=[],p=[];d&&(q.forEach(function(d,e){if(!(d instanceof f.Folder)){for(var h in a)if(a[h].id()===d.id())return;c.push(e)}}),c.map(function(a){var c=q[a];q.splice(a,1);return c}));a.forEach(function(c,d){var f=!1,h;for(h in q)if(q[h].id()===
c.id()){f=h;break}!1===f?(k.push(c),e(c)):(f=q[f],f._fromJson(c.json())&&p.push(f),a[d]=f)});if(d)for(d=0;d<q.length;d++){var l=q[d];l instanceof f.Folder&&0==l.find(function(a){return!(a instanceof f.Folder)}).length&&(c.push(l),q.splice(d,1),d--)}d=0<c.length||0<k.length||0<p.length;!h&&d&&f.trigger("ething.arbo.changed",[k,c,p]);return{resources:a,removed:c,added:k,updated:p,hasChanged:d}}function e(a){q.push(a);for(var c=a.dirname(),h=!1,k=0;k<q.length;k++)if(q[k]instanceof f.Folder&&q[k].name()===
c){h=!0;break}h||e(new f.Folder({name:c}));return a}function k(a,d,e){if(Array.isArray(a))a.forEach(function(a){k(a,d)});else{if("string"===typeof a&&(a=l(a),!a))return;if(!0!==a.isRoot){var c=[];a instanceof f.Folder&&a.children().forEach(function(a){k(a,!0)});for(var h=0;h<q.length;h++){var p=q[h];if(p.id()==a.id()){c.push(p);q.splice(h,1);d||(a=p.parent())&&0==a.children().length&&k(a);break}}!e&&c.length&&f.trigger("ething.arbo.changed",[[],c,[]])}}}function l(a){for(var c=0;c<q.length;c++)if(q[c].id()===
a)return q[c]}function v(a,d){return q.filter(function(c){if(!d||c.type()===d){var e=c.name();return"function"==typeof a?!!a.call(c,c):"string"==typeof a?e===a:Array.isArray(a)?0<=a.indexOf(e):a instanceof RegExp?a.test(e):!0}})}var f=m.EThing||{},q=[],t=null,z=null;f.Folder=function(a){a.id||(a.id="/"+a.name);""===a.name&&(this.isRoot=!0);f.Resource.call(this,f.utils.extend({type:"Folder"},a))};f.Folder.prototype=Object.create(f.Resource.prototype);f.Folder.prototype.createdDate=function(){for(var a=
this.find(),d=null,e=0;e<a.length;e++)if(null===d||d<a[e].createdDate())d=a[e].createdDate();return d};f.Folder.prototype.modifiedDate=function(){for(var a=this.find(),d=null,e=0;e<a.length;e++)if(null===d||d>a[e].modifiedDate())d=a[e].modifiedDate();return d};f.Folder.prototype.remove=function(a){var c=this;return this.deferred(function(){var d=[];this.children().forEach(function(a){d.push(a.remove())});return f.utils.Deferred.when.apply(f.utils.Deferred,d).done(function(){"function"==typeof a&&
a.call(c)})})};f.Folder.prototype.set=null;f.Folder.prototype.setData=null;f.Folder.prototype.extension=function(){return""};f.Folder.prototype.children=function(a,d){var c=this._json.name.length?this._json.name+"/":"",e=v(new RegExp("^"+c+"[^/]+$"));"undefined"!=typeof a&&a&&(e=e.filter(function(e){if(!d||e.type()===d){var f=e.name().substr(c.length);if("function"==typeof a)return!!a.call(e,e,f);if("string"==typeof a)return f===a;if(Array.isArray(a))return 0<=a.indexOf(f);if(a instanceof RegExp)return a.test(f)}}));
return e};f.Folder.prototype.ls=f.Folder.prototype.children;f.Folder.prototype.find=function(a,d){var c=this._json.name.length?this._json.name+"/":"",e=v(c.length?new RegExp("^"+c):/^.+/);"undefined"!=typeof a&&a&&(e=e.filter(function(e){if(!d||e.type()===d){var f=e.name().substr(c.length);if("function"==typeof a)return!!a.call(e,e,f);if("string"==typeof a)return f===a;if(Array.isArray(a))return 0<=a.indexOf(f);if(a instanceof RegExp)return a.test(f)}}));return e};f.Folder.prototype.findOne=function(a,
d){var c=this.find(a,d);return c.length?c[0]:null};f.Folder.prototype.length=function(){return this.children().length};f.Resource.prototype.parent=function(){if(!this.isRoot)return l("/"+this.dirname())};f.on("ething.resource.removed",function(a,d){var c=l(d);c&&k(c)});m.EThing=m.EThing||{};m.EThing.arbo={load:function(a,d){if(t&&!d)var c=!0===t?(new f.utils.Deferred).resolve().promise():t;else{var h=new f.utils.Deferred;q=[];z=t=null;f.request({url:"/resources",method:"GET",dataType:"json"}).done(function(a){t=
!0;q=[];z=new f.Folder({name:""});q.push(z);a.forEach(function(a){(a=f.instanciate(a))&&e(a)});h.resolve()});t=c=h.promise()}return c.done(function(){"function"==typeof a&&a(q);f.trigger("ething.arbo.loaded")})},lastRefreshTs:0,refresh:function(){this.lastRefreshTs=Date.now();return a.apply(this,Array.prototype.slice.call(arguments))},remove:k,update:h,findOneById:l,list:function(){return q},find:v,findOne:function(a,d){var c=v(a,d);return c.length?c[0]:null},isLoaded:function(){return!0===t||t&&
"resolved"==t.state()},root:function(){return z}};m.EThing=f})(this);
(function(m){var a=m.EThing||{};a.Rule=function(e){this._json=e;a.DeferredObject.call(this)};a.utils.inherits(a.Rule,a.DeferredObject);a.Rule.prototype.id=function(){return this._json.id};a.Rule.prototype.events=function(){return this._json.events};a.Rule.prototype.conditions=function(){return this._json.conditions};a.Rule.prototype.actions=function(){return this._json.actions};a.Rule.prototype.enabled=function(){return!!this._json.enabled};a.Rule.prototype.isInvalid=function(){var a=!1;this.conditions().forEach(function(e){if(!0===
e.isInvalid)return a=!0,!1});return a};a.Rule.prototype.name=function(){return this._json.name};a.Rule.prototype.priority=function(){return this._json.priority};a.Rule.prototype.repeat=function(){return this._json.repeat};a.Rule.prototype.createdDate=function(){return new Date(this._json.createdDate)};a.Rule.prototype.executedDate=function(){return this._json.executedDate?new Date(this._json.executedDate):null};a.Rule.prototype.executedCount=function(){return this._json.executedCount};a.Rule.prototype.remove=
function(e){return this.deferred(function(){return a.Rule.remove(this,e)})};a.Rule.prototype.set=function(e,h){return this.deferred(function(){return a.Rule.set(this,e,h)})};var h=function(e,h){"object"==typeof e&&null!==e&&(Array.isArray(e)?e=e.map(function(e){return new a.Rule(e)}):this instanceof a.Rule&&this.id()===e.id?(this._json=e,e=this):e=new a.Rule(e));return e};a.listRules=function(e){return a.request({url:"/rules",method:"GET",dataType:"json",converter:h},e)};a.getRule=function(e,k){if(e instanceof
a.Rule){var l=e;e=e.id()}else if(!a.utils.isId(e))throw"First argument must be a Rule object or a Rule id !";return a.request({url:"/rules/"+e,dataType:"json",method:"GET",context:l,converter:h},k)};a.Rule.create=function(e,k){return a.request({url:"/rules",dataType:"json",method:"POST",contentType:"application/json; charset=utf-8",data:e,converter:h},k)};a.Rule.remove=function(e,h){if(e instanceof a.Rule){var k=e;e=e.id()}else if(!a.utils.isId(e))throw"First argument must be a Rule object or a Rule id !";
return a.request({url:"/rules/"+e,method:"DELETE",context:k},h)};a.Rule.set=function(e,k,l){if(!a.utils.isPlainObject(k)||!k)throw"Second argument must be a unempty object !";if(e instanceof a.Rule){var m=e;e=e.id()}else if(!a.utils.isId(e))throw"First argument must be a Rule object or a Rule id !";return a.request({url:"/rules/"+e,dataType:"json",method:"POST",contentType:"application/json; charset=utf-8",data:k,context:m,headers:{"X-HTTP-Method-Override":"PATCH"},converter:h},l)};a.Rule.trigger=
function(e,h){return a.request({url:"/rules/trigger/"+encodeURIComponent(e),method:"POST"},h)}})(this);
