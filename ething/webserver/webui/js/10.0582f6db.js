(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{"1qxN":function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e._t("default"),r("blockquote",{staticClass:"q-mt-xl"},[e.meta.description?r("vue-markdown",[e._v(e._s(e.meta.description.trim()))]):e._e()],1),r("form-schema",{staticClass:"q-mb-xl",attrs:{schema:e.schema},on:{error:function(t){e.inputError=t}},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}}),e.error?r("q-alert",{staticClass:"q-mb-xl",attrs:{type:"negative"}},[e._v("\n    "+e._s(String(e.error))+"\n  ")]):e._e(),r("div",[r("q-btn",{attrs:{loading:e.loading,disable:e.inputError,color:"primary",icon:"done",label:e.create?"create":"edit"},on:{click:e.handler}}),r("q-btn",{attrs:{color:"negative",icon:"clear",label:"cancel",flat:""},on:{click:function(t){e.$emit("canceled")}}})],1),r("q-inner-loading",{staticClass:"text-center",attrs:{visible:!e.ready}},[r("div",{staticClass:"q-pa-lg text-primary"},[e._v("loading...")]),r("q-spinner-oval",{attrs:{color:"primary",size:"50px"}})],1)],2)},i=[];n._withStripped=!0;var o=r("cDf5"),s=r.n(o),a=(r("f3/d"),r("VRzm"),r("rGqo"),r("yt8O"),r("RW0V"),r("91GP"),r("QmqO")),c=r.n(a),u=r("nOak"),l=r.n(u),d=r("ffiS"),f={name:"ResourceEditor",components:{VueMarkdown:l.a},props:["resource"],data:function(){var e=this,t=this.getSchemaModel(function(){e.$nextTick(function(){e.ready=!0})});return{inputError:!1,create:!(this.resource instanceof c.a.Resource),type:this.resource instanceof c.a.Resource?this.resource.type():this.resource,schema:t.schema,model:t.model,meta:t.meta,loading:!1,error:null,ready:!1}},methods:{handler:function(){var e=this;this.loading=!0;var t={},r=null;r=this.create?"undefined"!==typeof c.a[this.type]?c.a[this.type].create(Object.assign(t,this.model)):c.a.Device.create(this.type,Object.assign(t,this.model)):this.resource.set(Object.assign(t,this.model)),r.then(function(t){e.$emit("done",t)}).catch(function(t){e.error=t}).finally(function(){e.loading=!1})},getSchemaModel:function(e){var t=this,r=this.resource instanceof c.a.Resource?this.resource.type():this.resource,n=this.resource instanceof c.a.Resource?this.resource:null,i=n?this.$meta.get(n):this.$meta.get(r);i=this.customize(i,n,r);var o=i.required||[],s={},a={},u=0,l=function(){u--,u<=0&&"function"===typeof e&&e()},d=function(e){var r=i.properties[e].required||-1!==o.indexOf(e);if((!i.properties[e].readOnly||r)&&(s[e]=i.properties[e],i.properties[e].required&&-1===o.indexOf(e)&&o.push(e),n)){var c=i.properties[e].get(n);c instanceof Promise?(u++,c.then(function(r){t.$set(t.model,e,r)}).finally(l)):a[e]=c}};for(var f in i.properties)d(f);var p=Object.keys(s);return o=o.filter(function(e){return-1!==p.indexOf(e)}),u||l(),{model:a,schema:{type:"object",required:o,properties:s,order:["name"]},meta:i}},customize:function(e,t,r){return t||("resources/File"===r?(e.properties.content={id:"resource.content",type:"binary"},e.properties.name.dependencies={"resource.content":function(e,t,r){r.files.length>0&&t.setValue(r.files[0].name)}}):"resources/Table"===r&&(e.properties.content={id:"resource.content",type:"binary",format:"text",accept:".json,.csv",_converter:function(e,t,r,n){var i=function(e){if(!Array.isArray(e))return n("invalid file content");for(var t in e){if("object"!==s()(e[t])||null===e[t])return n("invalid file content");if(!e[t].date)return n("no date field for the item "+t);var i=!1;for(var o in e[t])if("date"!=o&&"id"!=o){i=!0;break}if(!i)return n("no data for the item "+t)}r(e)};/\.json$/i.test(e.name)?i(JSON.parse(t)):/\.csv$/i.test(e.name)?d().fromString(t).then(function(e){i(e)}):n("invalid file type")}},e.properties.name.dependencies={"resource.content":function(e,t,r){r.files.length>0&&t.setValue(r.files[0].name)}})),e}}},p=f,m=(r("NIl1"),r("KHd+")),h=Object(m["a"])(p,n,i,!1,null,"4b023153",null);t["a"]=h.exports},49:function(e,t){},NIl1:function(e,t,r){"use strict";var n=r("ozk9"),i=r.n(n);i.a},SDMV:function(e,t,r){},hVxs:function(e,t,r){"use strict";var n=r("SDMV"),i=r.n(n);i.a},ozk9:function(e,t,r){},"uLZ+":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-page",{attrs:{padding:""}},[r("div",{staticClass:"q-my-md q-display-1 q-display-1-opacity"},[r("q-icon",{attrs:{name:e.$meta.get(e.resource).icon}}),e._v("\n    "+e._s(e.resource.basename())+"\n  ")],1),r("div",{staticClass:"q-my-md q-subheading text-faded"},[r("q-icon",{attrs:{name:"settings"}}),e._v("\n    Settings\n  ")],1),r("resource-editor",{attrs:{resource:e.resource},on:{done:e.onDone,canceled:e.onCancel}})],1)},i=[];n._withStripped=!0;r("pIFo");var o=r("1qxN"),s={name:"PageResource",components:{ResourceEditor:o["a"]},computed:{resource:function(){var e=this.$route.params.id,t=this.$store.getters["ething/get"](e);return e&&e.length&&(t||this.$router.replace("/404")),t}},methods:{onDone:function(e){this.$router.go(-1)},onCancel:function(){this.$router.go(-1)}}},a=s,c=(r("hVxs"),r("KHd+")),u=Object(c["a"])(a,n,i,!1,null,null,null);t["default"]=u.exports}}]);