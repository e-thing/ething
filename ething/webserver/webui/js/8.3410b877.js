(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{"23Kr":function(t,e,r){},"2iqt":function(t,e,r){},"7FKt":function(t,e,r){},"GA/o":function(t,e,r){"use strict";r.r(e);var s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("q-page",{attrs:{padding:""}},[r("div",{staticClass:"q-my-md q-display-1 q-display-1-opacity"},[r("q-icon",{staticClass:"vertical-middle",attrs:{name:t.$meta.get(t.resource).icon}}),r("span",{staticClass:"vertical-middle"},[t._v("\n      "+t._s(t.resource.basename())+"\n    ")]),t.resource.lastSeenDate()?r("q-chip",{attrs:{small:"",detail:"",icon:"access time"}},[t._v("\n      "+t._s(t.$ui.dateToString(t.resource.lastSeenDate()))+"\n    ")]):t._e(),r("resource-battery-chip",{staticClass:"vertical-middle",attrs:{resource:t.resource}}),t.resource.location()?r("q-chip",{attrs:{small:"",detail:"",icon:"location_on"}},[t._v("\n      "+t._s(t.resource.location())+"\n    ")]):t._e(),r("q-btn",{staticClass:"float-right",attrs:{flat:"",rounded:"",label:"settings",icon:"settings"},on:{click:function(e){t.$router.push("/resource/"+t.resource.id())}}})],1),t.createdBys.length?r("q-breadcrumbs",{staticClass:"q-py-md"},[t._l(t.createdBys,function(e,s){return r("q-breadcrumbs-el",{key:s,attrs:{label:e.basename(),to:t.$ui.route(e)}})}),r("q-breadcrumbs-el",{attrs:{label:""}})],2):t._e(),t.attributes.length>0?r("q-card",{staticClass:"q-my-md attributes",class:{detailled:t.showDetailledAttributes}},[r("q-card-title",{staticClass:"bg-primary text-white"},[r("q-icon",{staticClass:"vertical-middle",attrs:{name:"mdi-format-list-bulleted"}}),r("span",{staticClass:"vertical-middle"},[t._v("\n        Attributes\n      ")]),r("q-btn",{staticClass:"float-right",staticStyle:{"line-height":"initial"},attrs:{flat:"",rounded:"",size:"small",label:t.showDetailledAttributes?"less":"more",icon:t.showDetailledAttributes?"expand_less":"expand_more"},on:{click:function(e){t.showDetailledAttributes=!t.showDetailledAttributes}}})],1),r("q-card-separator"),r("q-card-main",[r("div",{staticClass:"row"},[t._l(t.attributes,function(e){return[r("div",{staticClass:"col-xs-12 col-sm-2 key text-secondary",class:{detailled:e.detailled}},[t._v(t._s(e.name))]),r("div",{staticClass:"col-xs-12 col-sm-10 value",class:{detailled:e.detailled}},[t._v(t._s(e.value))])]})],2)])],1):t._e(),t.data?r("q-card",{staticClass:"q-my-md"},[r("q-card-title",{staticClass:"bg-primary text-white"},[r("q-icon",{staticClass:"vertical-middle",attrs:{name:"mdi-format-list-bulleted"}}),r("span",{staticClass:"vertical-middle"},[t._v("\n        Data\n      ")])],1),r("q-card-separator"),r("q-card-main",[r("div",{staticClass:"row"},[t._l(t.data,function(e,s){return[r("div",{staticClass:"col-xs-12 col-sm-2 key text-secondary"},[t._v(t._s(s))]),r("div",{staticClass:"col-xs-12 col-sm-10 value"},[t._v(t._s(e))])]})],2)])],1):t._e(),t.children.length?r("q-card",{staticClass:"q-my-md"},[r("q-card-title",{staticClass:"bg-primary text-white"},[r("q-icon",{staticClass:"vertical-middle",attrs:{name:"mdi-database"}}),r("span",{staticClass:"vertical-middle"},[t._v("\n        Resources\n      ")])],1),r("q-card-separator"),r("q-card-main",[r("q-list",{attrs:{"no-border":""}},t._l(t.children,function(t){return r("resource-q-item",{key:t.id(),attrs:{resource:t}})}))],1)],1):t._e(),Object.keys(t.$meta.get(t.resource).methods).length?r("q-card",{staticClass:"q-my-md"},[r("q-card-title",{staticClass:"bg-primary text-white"},[r("q-icon",{staticClass:"vertical-middle",attrs:{name:"mdi-database"}}),r("span",{staticClass:"vertical-middle"},[t._v("\n        API\n      ")])],1),r("q-card-separator"),r("q-card-main",[r("device-api",{attrs:{device:t.resource}})],1)],1):t._e()],1)},i=[];s._withStripped=!0;r("f3/d"),r("rGqo"),r("yt8O"),r("RW0V"),r("pIFo");var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("q-list",{attrs:{"no-border":""}},t._l(t.operations,function(e){return r("q-collapsible",{key:e.name,attrs:{icon:"keyboard_arrow_right",label:e.name,sublabel:e.return}},[r("div",{staticClass:"content"},[e.description?r("blockquote",{staticClass:"q-my-md"},[r("vue-markdown",[t._v(t._s(e.description))])],1):t._e(),t.hasParameters(e)?r("form-schema",{staticClass:"q-my-md",attrs:{schema:e.schema},on:{error:function(t){e.inputError=t}},model:{value:e.model,callback:function(r){t.$set(e,"model",r)},expression:"operation.model"}}):t._e(),r("div",{staticClass:"q-my-md"},[r("q-btn",{attrs:{loading:e.loading,disable:e.inputError,color:"primary",icon:"done",label:"execute"},on:{click:function(r){t.execute(e)}}})],1),e.error?r("q-alert",{staticClass:"q-my-md",attrs:{type:"negative"}},[t._v("\n          "+t._s(String(e.error))+"\n        ")]):t._e(),e.result?r("div",{staticClass:"result q-my-md"},["image"===e.resultType?r("img",{attrs:{src:e.result},on:{load:function(t){e.loading=!1}}}):"audio"===e.resultType?r("audio",{attrs:{controls:"",src:e.result,type:e.resultContentType}}):"video"===e.resultType?r("video",{attrs:{controls:"",autoplay:"",src:e.result,type:e.resultContentType}}):"videoflash"===e.resultType?r("object",{staticClass:"videoplayer",attrs:{width:"425",height:"300",data:"http://releases.flowplayer.org/swf/flowplayer-3.2.18.swf",type:"application/x-shockwave-flash"}},[r("param",{attrs:{name:"movie",value:"http://releases.flowplayer.org/swf/flowplayer-3.2.18.swf"}}),r("param",{attrs:{name:"allowfullscreen",value:"true"}}),r("param",{attrs:{name:"allowscriptaccess",value:"always"}}),t._v('":{\\"url\\":\\"\' + operation.result + \'\\"},\\"playlist\\":[{\\"url\\":\\"\' + operation.result + \'\\"}]}\'" />\n          ')]):"json"===e.resultType?r("pre",{directives:[{name:"highlightjs",rawName:"v-highlightjs"}]},[r("code",{staticClass:"json"},[t._v(t._s(e.result))])]):"html"===e.resultType?r("pre",{directives:[{name:"highlightjs",rawName:"v-highlightjs"}]},[r("code",{staticClass:"html"},[t._v(t._s(e.result))])]):"xml"===e.resultType?r("pre",{directives:[{name:"highlightjs",rawName:"v-highlightjs"}]},[r("code",{staticClass:"xml"},[t._v(t._s(e.result))])]):"text"===e.resultType?r("pre",[r("code",{staticClass:"plain"},[t._v(t._s(e.result))])]):t._e()]):t._e()],1)])}))],1)},a=[];n._withStripped=!0;r("QmqO");var o=r("nOak"),l=r.n(o),c=(r("Kw5r"),function(t){var e=document.createElement("audio");return!(!e.canPlayType||!e.canPlayType(t).replace(/no/,""))}),u=function(t){var e=document.createElement("video");return!(!e.canPlayType||!e.canPlayType(t).replace(/no/,""))},d=function(t,e){if(t instanceof Blob){var r=new window.FileReader;r.readAsText(t),r.onloadend=function(){e(r.result)}}else e(t)},h={name:"DeviceApi",components:{VueMarkdown:l.a},props:["device"],data:function(){return{operations:this.buildApi()}},computed:{},methods:{buildApi:function(){var t=this.$meta.get(this.device).methods,e=[];for(var r in t){var s=t[r];e.push({name:r,description:s.description,return:s.return,inputError:!1,error:!1,loading:!1,result:null,resultType:null,resultContentType:null,schema:{additionalProperties:!1,properties:s.arguments,required:s.required,type:"object"},model:{}})}return e},hasParameters:function(t){return Object.keys(t.schema.properties||{}).length},execute:function(t){var e=t.return;t.error=!1,t.loading=!0,t.result=null,t.resultType=null,t.resultContentType=null,/^image\//.test(e)||/^multipart\/x-mixed-replace/.test(e)||"video/x-motion-jpeg"==e||"video/x-jpeg"==e?(t.result=this.toUrl(t),t.resultType="image"):/^audio\//.test(e)&&c(e)?(t.resultContentType=e,t.result=this.toUrl(t),t.resultType="audio",t.loading=!1):/^video\//.test(e)?(u(e)?(t.resultContentType=e,t.result=this.toUrl(t),t.resultType="video"):(t.result=this.toUrl(t),t.resultType="videoflash"),t.loading=!1):this.device.execute(t.name,t.model,"blob").then(function(e){t.loading=!1;var r=e.type;e&&0!=e.size?/json/.test(r)?d(e,function(e){try{t.result=JSON.stringify(JSON.parse(e),null,"  "),t.resultType="json"}catch(r){t.error="can't parse JSON.  Raw result:\n\n"+e}}):"text/html"===r?d(e,function(e){t.result=e,t.resultType="html"}):/xml/.test(r)?d(e,function(e){t.result=e,t.resultType="xml"}):/text/.test(r)?d(e,function(e){t.result=e,t.resultType="text"}):t.error="Unable to render the response":(t.result=null,t.resultType="empty")}).catch(function(e){t.error=e}).finally(function(){t.loading=!1})},toUrl:function(t){var e="devices/"+this.device.id()+"/call/"+t.name;return t.model&&(e+="?"+this.$ething.utils.param(t.model)),this.$ething.toApiUrl(e,!0)}}},m=h,p=(r("Vyck"),r("KHd+")),f=Object(p["a"])(m,n,a,!1,null,"ab03cc36",null),y=f.exports,v=r("ZlnI"),g=r("aRp8"),b=function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.widgets.length>0?r("widget",t._b({attrs:{type:t.wtype,options:t.woptions}},"widget",t.$attrs,!1)):t._e()},w=[];b._withStripped=!0;r("91GP"),r("dRSK");var _=r("kCP0"),q={name:"ResourceWidget",components:{Widget:_["a"]},props:{resource:{},type:String},data:function(){return{}},computed:{widgets:function(){return this.$meta.get(this.resource).widgets||[]},widget:function(){var t,e=this;return this.type&&(t=this.widgets.find(function(t){return t.type===e.type}),t)?t:this.widgets[0]},wtype:function(){return this.widget.type},woptions:function(){return Object.assign({resource:"string"===typeof this.resource?this.resource:this.resource.id()},this.widget.options)}}},C=q,x=(r("OvqJ"),Object(p["a"])(C,b,w,!1,null,"47c78d4d",null)),$=x.exports,T={name:"PageDevice",components:{DeviceApi:y,ResourceQItem:v["a"],ResourceBatteryChip:g["a"],ResourceWidget:$},data:function(){return{showDetailledAttributes:!1}},computed:{resource:function(){var t=this.$route.params.id,e=this.$store.getters["ething/get"](t);return t&&t.length&&(e&&e.isTypeof("resources/Device")||this.$router.replace("/404")),e},children:function(){var t=this;return this.$store.getters["ething/filter"](function(e){return e.createdBy()===t.resource.id()})},tables:function(){return this.children.filter(function(t){return t.isTypeof("resources/Table")})},files:function(){return this.children.filter(function(t){return t.isTypeof("resources/File")})},devices:function(){return this.children.filter(function(t){return t.isTypeof("resources/Device")})},data:function(){var t=this.resource.data();return t&&Object.keys(t).length>0?t:void 0},attributes:function(){var t=this.$meta.get(this.resource).properties,e=[],r=["name","data","description"],s=["id","modifiedDate","createdBy","type","extends","public","createdDate","methods","battery","location","interfaces","connected","lastSeenDate"];for(var i in t)if(-1===r.indexOf(i)){var n=t[i],a=n.getFormatted(this.resource);e.push({name:i,value:a,detailled:-1!==s.indexOf(i)})}return e},createdBys:function(){var t=[],e=this.resource.createdBy();while(e){var r=this.$ething.arbo.get(e);if(!r)break;t.push(r),e=r.createdBy()}return t.reverse()}}},k=T,j=(r("Q6IQ"),Object(p["a"])(k,s,i,!1,null,null,null));e["default"]=j.exports},OvqJ:function(t,e,r){"use strict";var s=r("lWw0"),i=r.n(s);i.a},Q6IQ:function(t,e,r){"use strict";var s=r("7FKt"),i=r.n(s);i.a},Vyck:function(t,e,r){"use strict";var s=r("jqUK"),i=r.n(s);i.a},ZlnI:function(t,e,r){"use strict";var s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("q-item",{staticClass:"item",attrs:{link:!t.readonly},nativeOn:{click:function(e){t.open(t.resource)}}},[t._l(t.level,function(e){return r("div",{class:t.gen(e)})}),r("q-item-side",{attrs:{icon:t.$meta.get(t.resource).icon,inverted:"",color:t.$meta.get(t.resource).color}}),r("q-item-main",[r("q-item-tile",{attrs:{label:""}},[r("span",{staticClass:"vertical-middle text-black"},[t._v(t._s(t.resource.basename()))]),t.showParent?r("small",{staticClass:"parent text-faded vertical-bottom on-right",class:t.readonly?"":"cursor-pointer",on:{click:function(e){e.stopPropagation(),t.open(t.createdBy)}}},[t._v(t._s(t.createdBy.basename()))]):t._e(),t.showConnected&&!t.resource.connected()?r("q-icon",{staticClass:"vertical-middle on-right",attrs:{name:"mdi-lan-disconnect",color:"warning"}}):t._e(),t.resource.public()?r("q-icon",{staticClass:"vertical-middle on-right",attrs:{name:"share",color:"warning"}}):t._e()],1),r("q-item-tile",{attrs:{sublabel:""}},[t._v(t._s(t.$ui.dateToString(t.date)))]),t.showType?r("q-item-tile",{attrs:{sublabel:""}},[t._v(t._s(t.resource.type().replace("resources/","")))]):t._e(),t.showBattery?r("q-item-tile",{staticClass:"lt-sm",attrs:{sublabel:""}},[t._v("battery: "+t._s(t.resource.battery())+"%")]):t._e(),t.showLocation?r("q-item-tile",{staticClass:"lt-sm",attrs:{sublabel:""}},[t._v("location: "+t._s(t.resource.location()))]):t._e(),t.showSize?r("q-item-tile",{attrs:{sublabel:""}},[t._v(t._s(t.$ui.sizeToString(t.resource.size())))]):t._e(),t.showLength?r("q-item-tile",{attrs:{sublabel:""}},[t._v(t._s(t.resource.length())+" rows")]):t._e()],1),t.showLocation?r("q-item-side",{staticClass:"gt-xs",attrs:{right:""}},[r("q-chip",{attrs:{small:"",detail:"",icon:"location_on"}},[t._v("\n      "+t._s(t.resource.location())+"\n    ")])],1):t._e(),t.showBattery?r("q-item-side",{staticClass:"gt-xs",attrs:{right:""}},[r("resource-battery-chip",{attrs:{resource:t.resource}})],1):t._e(),t.readonly?t._e():[t.showChart?r("q-item-side",{staticClass:"gt-xs",attrs:{right:""}},[r("q-btn",{attrs:{icon:"mdi-chart-line",round:"",flat:"",dense:"",color:"secondary"},on:{click:function(e){return e.stopPropagation(),t.chart(e)}}})],1):t._e(),t.showDownload?r("q-item-side",{staticClass:"gt-xs",attrs:{right:""}},[r("q-btn",{attrs:{icon:"cloud_download",round:"",flat:"",dense:"",color:"secondary"},on:{click:function(e){return e.stopPropagation(),t.download(e)}}})],1):t._e(),r("q-item-side",{staticClass:"gt-xs",attrs:{right:""}},[r("q-btn",{attrs:{icon:"delete",round:"",flat:"",dense:"",color:"negative"},on:{click:function(e){return e.stopPropagation(),t.remove(e)}}})],1),r("q-item-side",{staticClass:"gt-xs",attrs:{right:""}},[r("q-btn",{attrs:{icon:"settings",round:"",flat:"",dense:""},on:{click:function(e){return e.stopPropagation(),t.settings(e)}}})],1),r("q-item-side",{staticClass:"lt-sm",attrs:{right:""}},[r("q-btn",{attrs:{icon:"more_vert",round:"",flat:"",dense:""},on:{click:function(e){return e.stopPropagation(),t.more(e)}}})],1)]],2)},i=[];s._withStripped=!0;r("f3/d"),r("xfY5");var n=r("aRp8"),a=r("JEAp"),o=r.n(a),l={name:"ResourceQItem",components:{ResourceBatteryChip:n["a"]},props:{resource:{},level:{type:Number,default:0},noParent:Boolean,readonly:Boolean},data:function(){return{}},computed:{date:function(){var t=this.resource.modifiedDate();if(this.resource instanceof this.$ething.Device){var e=this.resource.lastSeenDate();if(e&&e>t)return e}return t},createdBy:function(){return this.resource.createdBy()?this.$ething.arbo.get(this.resource.createdBy()):null},showParent:function(){return!this.noParent&&!!this.createdBy},showType:function(){return this.resource instanceof this.$ething.Device},showConnected:function(){return this.resource instanceof this.$ething.Device},showBattery:function(){return this.resource instanceof this.$ething.Device&&this.resource.hasBattery()},showLocation:function(){return this.resource instanceof this.$ething.Device&&this.resource.location()},showSize:function(){return this.resource instanceof this.$ething.File},showLength:function(){return this.resource instanceof this.$ething.Table},showChart:function(){return this.resource instanceof this.$ething.Table&&this.resource.length()},showDownload:function(){return this.resource instanceof this.$ething.File||this.resource instanceof this.$ething.Table}},methods:{gen:function(t){return["pad","pad-"+t]},batteryIcon:function(t){return t>95?"mdi-battery":t>85?"mdi-battery-90":t>75?"mdi-battery-80":t>65?"mdi-battery-70":t>55?"mdi-battery-60":t>45?"mdi-battery-50":t>35?"mdi-battery-40":t>25?"mdi-battery-30":t>15?"mdi-battery-20":t>=0?"mdi-battery-alert":"battery unknown"},batteryColor:function(t){return t<=15?"negative":t<=40?"warning":void 0},settings:function(){this.$router.push("/resource/"+this.resource.id())},more:function(){var t=this,e=[];this.showChart&&e.push({label:"Plot chart",color:"secondary",icon:"mdi-chart-line",handler:function(){return t.chart()}}),e.push({label:"Delete",color:"negative",icon:"delete",handler:function(){return t.remove()}}),e.push({label:"Settings",icon:"settings",handler:function(){t.settings()}}),this.$q.actionSheet({title:this.resource.basename(),actions:e}).catch(function(){})},remove:function(){var t=this,e=this.resource.name(),r=this.$ething.arbo.list().filter(function(e){return e.createdBy()===t.resource.id()}),s=[];return r.length&&s.push({label:"Remove also the children resources",value:"removeChildren",color:"secondary"}),this.$q.dialog({title:"Remove",message:"Do you really want to remove definitely the "+this.resource.type()+' "'+this.resource.name()+'" ?',options:{type:"checkbox",model:[],items:s},ok:"Remove",cancel:"Cancel"}).then(function(r){t.resource.remove(-1!==r.indexOf("removeChildren")).then(function(){t.$q.notify(e+" removed !")})})},chart:function(){this.$router.push("/chart/"+this.resource.id())},download:function(){var t=this;this.resource instanceof this.$ething.File?this.$ething.request({url:this.resource.getContentUrl(),dataType:"blob"}).then(function(e){console.log(e),o.a.saveAs(e,t.resource.basename())}):this.resource instanceof this.$ething.Table&&this.$q.dialog({title:'Download "'+this.resource.name()+'"',message:"Format: ",options:{type:"radio",model:"csv",items:[{label:"CSV",value:"csv"},{label:"JSON",value:"json_pretty"}]},cancel:!0,preventClose:!0,color:"secondary"}).then(function(e){t.$ething.request({url:t.resource.getContentUrl()+"?fmt="+e,dataType:"blob"}).then(function(r){o.a.saveAs(r,t.resource.basename()+"."+("json_pretty"==e?"json":e))})})},open:function(t){this.readonly||this.$ui.open(t)}}},c=l,u=(r("p1QS"),r("KHd+")),d=Object(u["a"])(c,s,i,!1,null,"91edf06a",null);e["a"]=d.exports},aRp8:function(t,e,r){"use strict";var s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return"number"===typeof t.battery?r("q-chip",{attrs:{small:"",detail:"",icon:t.batteryIcon(t.battery),color:t.batteryColor(t.battery)}},[t._v("\n  "+t._s(t.battery)+"%\n")]):t._e()},i=[];s._withStripped=!0;var n={name:"ResourceBatteryChip",props:{resource:{}},data:function(){return{}},computed:{battery:function(){return this.resource.battery()}},methods:{batteryIcon:function(t){return t>95?"mdi-battery":t>85?"mdi-battery-90":t>75?"mdi-battery-80":t>65?"mdi-battery-70":t>55?"mdi-battery-60":t>45?"mdi-battery-50":t>35?"mdi-battery-40":t>25?"mdi-battery-30":t>15?"mdi-battery-20":t>=0?"mdi-battery-alert":"battery unknown"},batteryColor:function(t){return t<=15?"negative":t<=40?"warning":void 0}}},a=n,o=r("KHd+"),l=Object(o["a"])(a,s,i,!1,null,null,null);e["a"]=l.exports},jqUK:function(t,e,r){},kCP0:function(t,e,r){"use strict";var s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"widget",class:{"widget-err":!!t.error}},[r(t.type,t._b({ref:"widget",tag:"componant",class:t.inline?"":"fit",style:t.style,on:{error:function(e){t.error=e}}},"componant",t.attr,!1))],1)},i=[];s._withStripped=!0;r("dRSK"),r("91GP");var n=r("t/Xm"),a={name:"Widget",components:n["a"],props:{type:String,options:{},inline:Boolean},data:function(){return{error:!1}},computed:{attr:function(){return Object.assign({},this.options,this.$attrs)},widgetClass:function(){return this.$widget.find(this.type)},widgetClassMeta:function(){return this.widgetClass?this.widgetClass.meta:{}},style:function(){var t={};return this.widgetClassMeta.minWidth&&(t.minWidth=this.widgetClassMeta.minWidth+"px",this.inline&&(t.width=t.minWidth)),this.widgetClassMeta.minHeight&&(t.minHeight=this.widgetClassMeta.minHeight+"px",t.height=this.inline?t.minHeight:"1px"),t}},methods:{hasContentOverflow:function(){var t=this.$refs.widget.$el;return t.scrollWidth>t.clientWidth}}},o=a,l=(r("yHkA"),r("KHd+")),c=Object(l["a"])(o,s,i,!1,null,"b3f19e0c",null);e["a"]=c.exports},lWw0:function(t,e,r){},p1QS:function(t,e,r){"use strict";var s=r("2iqt"),i=r.n(s);i.a},yHkA:function(t,e,r){"use strict";var s=r("23Kr"),i=r.n(s);i.a}}]);