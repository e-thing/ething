(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[19],{"+kVK":function(e,t,n){"use strict";var i=n("AHSe"),r=n.n(i);r.a},"/71H":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-select",{attrs:{value:e.formattedValue,options:e.options,multiple:e.multiple},on:{input:function(t){e.$emit("input",t)}}})},r=[];i._withStripped=!0;n("f3/d"),n("KKXr"),n("QmqO");var a={name:"ResourceSelect",props:{type:String,notType:String,filter:{},value:{},useId:Boolean,multiple:Boolean},data:function(){return{}},computed:{formattedValue:function(){return this.multiple?Array.isArray(this.value)?this.value:this.value?[this.value]:[]:this.value},resources:function(){var e=this,t=null,n=null;return this.notType&&(t=this.notType.split(/[ ;,]+/)),this.type&&(n=this.type.split(/[ ;,]+/)),this.$store.getters["ething/filter"](function(i){if(t)for(var r in t)if(i.isTypeof(t[r]))return!1;if(n)for(var r in n)if(!i.isTypeof(n[r]))return!1;return!e.filter||!!e.filter(i)})},options:function(){var e=this;return this.resources.map(function(t){for(var n=[],i=t,r=0;r<2;r++){var a=i.createdBy()?e.$ething.arbo.get(i.createdBy()):null;if(!a)break;n.push(a),i=a}return{label:t.name(),value:e.useId?t.id():t,icon:e.$meta.get(t).icon,leftColor:e.$meta.get(t).color,inset:!0,stamp:t.type(),sublabel:n.length?n.reverse().map(function(e){return e.basename()}).join(" -> "):void 0}})}}},o=a,s=n("KHd+"),l=Object(s["a"])(o,i,r,!1,null,null,null);t["a"]=l.exports},"/egE":function(e,t,n){},"1O/z":function(e,t,n){"use strict";var i=n("9bRH"),r=n.n(i);r.a},"2sd5":function(e,t,n){},35:function(e,t){},36:function(e,t){},"3CEo":function(e,t,n){},"3Qcm":function(e,t,n){},47:function(e,t,n){e.exports=n("JJXq")},"4FYl":function(e,t,n){"use strict";var i=n("TnQi"),r=n.n(i);r.a},"5wDA":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"card-carousel",class:{hasThumbnails:e.thumbnails,noTitle:!e.noTitle}},[n("div",{staticClass:"card-img"},[n("div",{staticClass:"img-wrapper"},[e.currentImage?n("div",[n("img",{key:e.imgKey,attrs:{src:e.addTimestampToUrl(e.currentImage.getSrc()),alt:""},on:{load:e.onload,error:e.onerror}}),e.loading?n("div",{staticClass:"loader text-center"},[e._v("loading...")]):e._e(),e.error?n("div",{staticClass:"error text-center text-negative"},[e._v("Error")]):e._e(),e.noTitle?e._e():n("div",{staticClass:"title text-center text-faded"},[e._v(e._s(e.currentImage.name()))])]):e._e()]),e.controls&&e.images.length>1?n("div",{staticClass:"actions"},[n("q-btn",{staticClass:"prev",attrs:{round:"",flat:"",size:"lg",icon:"chevron left"},on:{click:e.prevImage}}),n("q-btn",{staticClass:"next",attrs:{round:"",flat:"",size:"lg",icon:"chevron right"},on:{click:e.nextImage}})],1):e._e()]),e.thumbnails&&e.images.length>1?n("div",{staticClass:"thumbnails"},e._l(e.images,function(t,i){return n("div",{key:i,class:["thumbnail-image",e.activeImage==i?"active":""],on:{click:function(t){e.activateImage(i)}}},[n("img",{attrs:{src:t.getThumbSrc(t)}})])})):e._e()])},r=[];i._withStripped=!0;n("f3/d"),n("INYr");var a={name:"ImageViewer",props:{source:{},value:{},thumbnails:Boolean,controls:Boolean,noTitle:Boolean},data:function(){return{activeImage:0,images:[],imgKey:0,loading:!1}},computed:{currentImage:function(){return this.images[this.activeImage]}},watch:{source:function(e){this.setSource(e)},value:function(e){this.activateImage(e)},activeImage:{handler:function(){this.loading=!0,this.error=!1},immediate:!0}},mounted:function(){this.setSource(this.source),this.value&&this.activateImage(this.value)},methods:{setSource:function(e){var t=this;if(Array.isArray(e))this.images=e.map(function(e){return t.parseSource(e)}).filter(function(e){return!!e});else{var n=this.parseSource(e);this.images=[],n&&this.images.push(n)}},nextImage:function(){var e=this.activeImage+1;e>=this.images.length&&(e=0),this.activateImage(e)},prevImage:function(){var e=this.activeImage-1;e<0&&(e=this.images.length-1),this.activateImage(e)},activateImage:function(e){if("number"==typeof e)this.activeImage=e,this.$emit("input",this.images[this.activeImage].source);else{var t=this.images.findIndex(function(t){return t.source===e});-1!==t&&(this.activeImage=t)}},refresh:function(){console.log("refresh"),this.loading=!0,this.error=!1,this.imgKey+=1},parseSource:function(e){var t={};return/^https?:\/\//.test(e)?t={type:"url",getSrc:function(){return e},name:function(){return e}}:e instanceof this.$ething.File&&(t={type:"resource.File",getSrc:function(){return e.getContentUrl(!1)},getThumbSrc:function(){return e.thumbnailLink(!1)},name:function(){return e.name()}}),t.source=e,t},addTimestampToUrl:function(e){return e+(-1===e.indexOf("?")?"?":"&")+Date.now()},onload:function(){this.loading=!1,this.error=!1},onerror:function(e){this.loading=!1,this.error=!0}}},o=a,s=(n("ieQ9"),n("KHd+")),l=Object(s["a"])(o,i,r,!1,null,"cfe844c6",null);t["a"]=l.exports},"6NBf":function(e,t,n){},"6X7v":function(e,t,n){},"7Ujp":function(e,t,n){"use strict";var i=n("eUja"),r=n.n(i);r.a},"8/vs":function(e,t,n){},"8olZ":function(e,t,n){"use strict";var i=n("8/vs"),r=n.n(i);r.a},"9E6g":function(e,t,n){"use strict";n.r(t),n.d(t,"makeForm",function(){return g}),n.d(t,"FormComponent",function(){return y}),n.d(t,"registerForm",function(){return h}),n.d(t,"unregisterForm",function(){return f}),n.d(t,"definitions",function(){return d}),n.d(t,"resolve",function(){return b});n("dRSK"),n("f3/d"),n("xfY5");var i=n("cDf5"),r=n.n(i),a=n("MVZn"),o=n.n(a),s=(n("rGqo"),n("pIFo"),n("91GP"),n("ta7f")),l=n("3C1I"),c=n.n(l),u=n("4IOb"),d={},m=[],h=function(e){"function"===typeof e&&m.push(e)},f=function(e){var t=m.indexOf(e);-1!==t&&m.splice(t,1)},p=function(e){if("string"===typeof e["$ref"]){var t=Object.assign({},e);delete t["$ref"],e=b(Object(u["extend"])(!0,t,c.a.get(d,e["$ref"].replace(/^#/,""))))}return e},v=function(e){if(Array.isArray(e.allOf)){var t=Object.assign({},e);delete t.allOf,e.allOf.forEach(function(e){t=Object(u["extend"])(!0,t,b(e))}),e=t}return e},b=function(e){return v(p(e))},g=function(e,t,n,i,a,s,l){t=b(t);var c={props:o()({schema:t,model:n,level:i},l),on:{input:a,error:s}};if(Array.isArray(t.anyOf)){var u=t.anyOf.filter(function(e){return"null"===e.type});if(u.length>0&&u.length<t.anyOf.length)return e("form-schema-optional",c)}for(var d in m){var h=m[d](t);if(h)return e(h,c)}if(Array.isArray(t.enum))return e("form-schema-enum",c);var f=t.type;switch(f){case"object":case"class":return e("form-schema-object",c);case"array":if("object"===r()(t.items)&&null!==t.items||"undefined"===typeof t.items)return e("form-schema-array",c);Array.isArray(t.items);break;case"string":var p=t.format;return e("date-time"===p||"date"===p||"time"===p?"form-schema-date":"color"===p?"form-schema-color":"json"===p?"form-schema-json":"form-schema-string",c);case"number":case"integer":case"int":case"long":case"double":case"float":return"number"===typeof t.minimum&&"number"===typeof t.maximum&&"number"===typeof t.multipleOf?e("form-schema-number-slider",c):e("form-schema-number",c);case"boolean":case"bool":return e("form-schema-boolean",c);case"json":return e("form-schema-json",c);case"binary":return e("form-schema-file",c)}if("undefined"===typeof f)return e("form-schema-multi-type",c);console.error("unable to render the schema",t)},y={model:{prop:"model",event:"input"},props:{schema:{type:Object,required:!0},model:{},level:{type:Number,default:0},required:Boolean,definitions:{type:Object,default:function(){return{}}}},validations:function(){return{value:this.required?{required:s["required"]}:{}}},data:function(){return{value:"undefined"!=typeof this.model?this.cast(this.model):this.model,error:!1,mutableSchema:Object(u["extend"])(!0,{},this.schema)}},computed:{castedModel:function(){return"undefined"!=typeof this.model?this.cast(this.model):this.model},errorMessage:function(){return"undefined"==typeof this.$v.value.required||this.$v.value.required?"undefined"==typeof this.$v.value.minLength||this.$v.value.minLength?"undefined"==typeof this.$v.value.maxLength||this.$v.value.maxLength?"undefined"==typeof this.$v.value.minValue||this.$v.value.minValue?"undefined"==typeof this.$v.value.maxValue||this.$v.value.maxValue?"undefined"==typeof this.$v.value.between||this.$v.value.between?"undefined"==typeof this.$v.value.alpha||this.$v.value.alpha?"undefined"==typeof this.$v.value.alphaNum||this.$v.value.alphaNum?"undefined"==typeof this.$v.value.numeric||this.$v.value.numeric?"undefined"==typeof this.$v.value.email||this.$v.value.email?"undefined"==typeof this.$v.value.ipAddress||this.$v.value.ipAddress?"undefined"==typeof this.$v.value.macAddress||this.$v.value.macAddress?"undefined"==typeof this.$v.value.url||this.$v.value.url?"undefined"==typeof this.$v.value.regex||this.$v.value.regex?"Invalid value":"Does not match the pattern `"+this.$v.value.$params.regex.pattern+"`":"Accepts only URLs":"Accepts only valid MAC addresses like 00:ff:11:22:33:44:55":"Accepts only valid IPv4 addresses in dotted decimal notation like 127.0.0.1":"Accepts only valid email addresses":"Accepts only numerics":"Accepts only alphanumerics":"Accepts only alphabet characters":"must be between "+this.$v.value.$params.between.min+" and "+this.$v.value.$params.between.max:"must be lower than or equal to "+this.$v.value.$params.maxValue.max:"must be greater than or equal to "+this.$v.value.$params.minValue.min:"must have maximum "+this.$v.value.$params.maxLength.max+" characters":"must have minimum "+this.$v.value.$params.minLength.min+" characters":"Field is required"}},watch:{"$v.$error":{handler:function(e,t){e!==t&&this.setError(e)},immediate:!0}},methods:{setValue:function(e){this.value=e,this.$v.value.$touch(),"undefined"!=typeof this.value&&this.$emit("input",e)},setError:function(e){this.error=e,this.$emit("error",e)},cast:function(e){return e},parent:function(){var e=this.$parent;while(e&&(!e._isWrapper||e._isWrapper()))e=e.$parent;return e},root:function(){var e,t=this;while(t)e=t,t=t.parent();return e},children:function(){return this._children(this)},_children:function(e){var t=[];e.$children;for(var n in e.$children){var i=e.$children[n];i._isWrapper&&!i._isWrapper()?t.push(i):t=t.concat(this._children(i))}return t},find:function(e){var t=this._find_down(this,e);return t||this._find_up(this,e)},_find_up:function(e,t){var n=e.parent();if(n){if(n._is(t))return n;var i=n.children();for(var r in i){var a=i[r];if(a!==e){var o=this._find_down(a,t);if(o)return o}}return this._find_up(n,t)}},_find_down:function(e,t){if(e._is(t))return e;var n=e.children();for(var i in n){var r=this._find_down(n[i],t);if(r)return r}},_isWrapper:function(){return"FormSchema"===this.$options.name},_is:function(e){return this.schema.id===e&&!this._isWrapper()}},mounted:function(){var e=this;if(this.schema.dependencies&&!this._isWrapper()){var t=function(t){var n=e.schema.dependencies[t],i=e.find(t);i&&n?(i.$on("input",function(t){n(t,e,i)}),n(i.value,e,i)):i||console.warn('[form-schema] node with id ""'+t+'" not found for '+e.$options.name)};for(var n in this.schema.dependencies)t(n)}"undefined"===typeof this.model&&"undefined"!==typeof this.schema.default?this.setValue(this.cast(this.schema.default)):this.value!==this.model?this.setValue(this.value):this.$v.value.$touch()}}},"9bRH":function(e,t,n){},AHSe:function(e,t,n){},AXcE:function(e,t,n){"use strict";var i=n("3CEo"),r=n.n(i);r.a},ApIF:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("q-resize-observable",{on:{resize:e.onResize}}),e.options?n("highstock",{ref:"highcharts",staticClass:"chart",class:{expended:e.expended},attrs:{options:e.options}}):n("div",{staticClass:"absolute-center text-center"},[n("q-btn",{attrs:{label:"new plot",icon:"timeline",flat:"",color:"primary"},on:{click:function(t){e.optionsModal=!0}}})],1),n("q-inner-loading",{staticClass:"text-center",attrs:{visible:e.loading}},[n("div",{staticClass:"q-pa-lg text-primary"},[e._v("loading...")]),n("q-spinner-oval",{attrs:{color:"primary",size:"50px"}})],1),n("modal",{attrs:{title:"Chart save",icon:"save",size:"xs","valid-btn-label":"Save"},on:{valid:e.onSave,show:e.$v.filename.$touch},model:{value:e.saveModal,callback:function(t){e.saveModal=t},expression:"saveModal"}},[n("q-field",{staticClass:"q-my-md",attrs:{label:"Filename",orientation:"vertical",error:e.$v.filename.$error,"error-label":"Required"}},[n("q-input",{on:{input:e.$v.filename.$touch},model:{value:e.filename,callback:function(t){e.filename=t},expression:"filename"}})],1)],1),n("modal",{attrs:{size:"lg","no-esc-dismiss":!e.options,"no-backdrop-dismiss":!e.options,title:"Chart options",icon:"edit","valid-btn-disable":e.$v.optionsData.$error},on:{valid:e.onOptionsValidate},model:{value:e.optionsModal,callback:function(t){e.optionsModal=t},expression:"optionsModal"}},[n("q-field",{staticClass:"q-my-md",attrs:{label:"Title",orientation:"vertical"}},[n("q-input",{model:{value:e.optionsData.title,callback:function(t){e.$set(e.optionsData,"title",t)},expression:"optionsData.title"}})],1),n("q-field",{staticClass:"q-my-md",attrs:{label:"Subtitle",orientation:"vertical"}},[n("q-input",{model:{value:e.optionsData.subtitle,callback:function(t){e.$set(e.optionsData,"subtitle",t)},expression:"optionsData.subtitle"}})],1),n("div",{staticClass:"q-my-md"},[n("div",{staticClass:"q-subheading q-mb-md"},[e._v("\n        Panes\n        "),n("q-btn",{attrs:{flat:"",size:"md",color:"blue-5",label:"Add pane",icon:"add"},on:{click:function(t){e.optionsData.panes.push({}),e.$v.optionsData.$touch()}}})],1),n("div",{staticClass:"q-ml-md q-mb-md"},e._l(e.optionsData.panes,function(t,i){return n("div",{key:i,staticClass:"pane"},[n("q-field",{staticClass:"q-my-md",attrs:{label:"name/unit",orientation:"vertical",error:e.$v.optionsData.panes.$each[i].name.$error,"error-label":"Required"}},[n("q-input",{attrs:{error:e.$v.optionsData.panes.$each[i].name.$error},on:{blur:e.$v.optionsData.panes.$each[i].name.$touch},model:{value:t.name,callback:function(n){e.$set(t,"name",n)},expression:"pane.name"}})],1),n("div",{staticClass:"q-my-md"},[n("div",{staticClass:"q-subheading q-mb-md"},[e._v("\n              Curves\n              "),n("q-btn",{attrs:{flat:"",size:"md",color:"cyan-5",label:"Add",icon:"add"},on:{click:function(n){t.curves.push({type:"line",data:{}}),e.$v.optionsData.$touch()}}})],1),n("div",{staticClass:"q-ml-md q-mb-md"},e._l(t.curves,function(r,a){return n("div",{key:a,staticClass:"curve"},[n("q-field",{staticClass:"q-my-md",attrs:{label:"name",orientation:"vertical",error:e.$v.optionsData.panes.$each[i].curves.$each[a].name.$error,"error-label":"Required"}},[n("q-input",{attrs:{error:e.$v.optionsData.panes.$each[i].curves.$each[a].name.$error},on:{blur:e.$v.optionsData.panes.$each[i].curves.$each[a].name.$touch},model:{value:r.name,callback:function(t){e.$set(r,"name",t)},expression:"curve.name"}})],1),n("q-field",{staticClass:"q-my-md",attrs:{label:"type",orientation:"vertical",error:e.$v.optionsData.panes.$each[i].curves.$each[a].type.$error,"error-label":"Required"}},[n("q-select",{attrs:{options:e.serieTypeOptions,error:e.$v.optionsData.panes.$each[i].curves.$each[a].type.$error},on:{blur:e.$v.optionsData.panes.$each[i].curves.$each[a].type.$touch},model:{value:r.type,callback:function(t){e.$set(r,"type",t)},expression:"curve.type"}})],1),n("q-field",{staticClass:"q-my-md",attrs:{label:"table",orientation:"vertical",error:e.$v.optionsData.panes.$each[i].curves.$each[a].data.resource.$error,"error-label":"Required"}},[n("resource-select",{attrs:{type:"resources/Table","use-id":"",error:e.$v.optionsData.panes.$each[i].curves.$each[a].data.resource.$error},on:{input:e.$v.optionsData.panes.$each[i].curves.$each[a].data.resource.$touch},model:{value:r.data.resource,callback:function(t){e.$set(r.data,"resource",t)},expression:"curve.data.resource"}})],1),r.data.resource?n("q-field",{staticClass:"q-my-md",attrs:{label:"key",orientation:"vertical",error:e.$v.optionsData.panes.$each[i].curves.$each[a].data.key.$error,"error-label":"Required"}},[n("q-select",{attrs:{options:e.optionsBuildKeyOptions(r,e.$v.optionsData.panes.$each[i].curves.$each[a].data.key),error:e.$v.optionsData.panes.$each[i].curves.$each[a].data.key.$error},on:{input:e.$v.optionsData.panes.$each[i].curves.$each[a].data.key.$touch},model:{value:r.data.key,callback:function(t){e.$set(r.data,"key",t)},expression:"curve.data.key"}})],1):e._e(),n("q-btn",{attrs:{flat:"",size:"md",color:"negative",label:"remove",icon:"delete"},on:{click:function(e){t.curves.splice(a,1)}}})],1)}))]),n("q-btn",{attrs:{flat:"",size:"md",color:"negative",label:"remove",icon:"delete"},on:{click:function(t){e.optionsData.panes.splice(i,1)}}})],1)}))])],1)],1)},r=[];i._withStripped=!0;n("f3/d"),n("rGqo"),n("yt8O");var a=n("QmqO"),o=n.n(a),s=n("Kw5r"),l=n("WKJ1"),c=n("6n/F"),u=n.n(c),d=n("N9ju"),m=n.n(d),h=n("AxlJ"),f=n.n(h),p=n("4IOb"),v=n("/71H"),b=n("ta7f");function g(){this.sources=[],this.history="all"}m()(u.a),f()(u.a),s["a"].use(l["a"],{Highcharts:u.a}),g.prototype.clear=function(){this.sources=[],this.history="all"},g.prototype.setHistory=function(e){this.history=e},g.prototype.add=function(e,t){var n=this,i=o.a.arbo.get(e.resource);if(i instanceof o.a.Table){var r=null,a=e.key;for(var s in this.sources)if(this.sources[s].resource===i.id()){r=this.sources[s];break}r||(r={resource:i.id(),keys:[],done:[],fetch:function(e){var t=this,i=o.a.arbo.get(this.resource),r=null;if("number"===typeof n.history){var a=new Date(Date.now()-1e3*parseInt(n.history));r="date > '"+a.toISOString()+"'"}i.select({fields:["date"].concat(this.keys),query:r}).then(function(e){t.done.forEach(function(t){t(e)})}).finally(function(){e()})}},this.sources.push(r)),r.keys.push(a),r.done.push(function(e){var n=e.filter(function(e){return e.hasOwnProperty(a)}).map(function(e){var t=new Date(e.date),n=e[a];return"number"!=typeof n&&("string"===typeof n?n=parseFloat(e[a]):"boolean"===typeof n&&(n=n?1:0)),[t.getTime(),n]});t(n)})}},g.prototype.load=function(e){var t=this.sources.length;function n(){t--,0===t&&"function"===typeof e&&e()}this.sources.forEach(function(e){e.fetch.call(e,n)})};var y={name:"Chart",props:{preferences:{},expended:Boolean,dense:Boolean,readonly:Boolean,history:{}},components:{ResourceSelect:v["a"]},data:function(){var e="",t=!1;if("string"===typeof this.preferences){var n=this.$ething.arbo.get(this.preferences);n instanceof this.$ething.File&&(t=n)}else this.preferences instanceof this.$ething.File&&(t=this.preferences);return t&&(e=t.name()),{loading:!1,dataSource:new g,options:!1,optionsModal:!this.preferences,optionsData:{panes:[{curves:[{type:"line",data:{}}]}]},serieTypeOptions:[{label:"line",value:"line"},{label:"column",value:"column"},{label:"scatter",value:"scatter"},{label:"area",value:"area"},{label:"spline",value:"spline"}],saveModal:!1,filename:e,file:t,table:null}},validations:function(){return{filename:{required:b["required"]},optionsData:{required:b["required"],panes:{required:b["required"],minLength:Object(b["minLength"])(1),$each:{name:{required:b["required"]},curves:{required:b["required"],minLength:Object(b["minLength"])(1),$each:{name:{required:b["required"]},type:{required:b["required"]},data:{required:b["required"],resource:{required:b["required"]},key:{required:b["required"]}}}}}}}}},methods:{load:function(e){var t=this;this.loading=!0,this.currentPreferences=Object(p["extend"])(!0,{},e),this.dataSource.clear(),this.dataSource.setHistory(this.history||e.history||"all");var n=e.title;this.dense&&e.subtitle&&(n?n+=" - "+e.subtitle:n=e.subtitle),this.options={chart:{plotBorderWidth:1,zoomType:"x"},exporting:{menuItemDefinitions:{refresh:{onclick:function(){t.refresh()},text:"refresh"},options:{onclick:function(){t.optionsModal=!0},text:"options"},save:{onclick:function(){t.currentPreferences&&(t.saveModal=!0)},text:"save"}},buttons:{contextButton:{menuItems:this.readonly?["refresh","separator","downloadPNG","downloadJPEG","downloadPDF"]:["refresh","options","save","separator","downloadPNG","downloadJPEG","downloadPDF"]}}},rangeSelector:{buttons:[{type:"hour",count:12,text:"12h"},{type:"day",count:1,text:"1d"},{type:"week",count:1,text:"1w"},{type:"month",count:1,text:"1m"},{type:"all",text:"All"}],selected:1,enabled:!this.dense},tooltip:{xDateFormat:"%Y-%m-%d %H:%M",valueDecimals:3},navigator:{enabled:!this.dense},xAxis:{type:"datetime",ordinal:!1,tickLength:5},credits:{enabled:!1},plotOptions:{column:{dataGrouping:{approximation:"average"}},series:{animation:!1}},series:[],yAxis:[],title:{text:n},subtitle:{text:this.dense?null:e.subtitle},time:{useUTC:!1}};var i=5,r=(100-(e.panes.length-1)*i)/e.panes.length;e.panes.forEach(function(e,n){var a="axis-"+n,o={title:{text:e.name||""},resize:{enabled:!0},height:r+"%",top:n*(r+i)+"%",offset:0,labels:{align:"right",x:-3,y:4},lineWidth:1,opposite:!1,showLastLabel:!0,gridLineWidth:1,id:a};t.options.yAxis.push(o),e.curves.forEach(function(e,n){var i={showInNavigator:!0,type:e.type||"line",name:e.name||"data "+n,data:[],yAxis:a};t.dataSource.add(e.data,function(e){e.length&&(i.data=e,-1===t.options.series.indexOf(i)&&t.options.series.push(i))})})}),this.dataSource.load(function(){t.loading=!1})},refresh:function(){var e=this;this.loading=!0,this.dataSource.load(function(){e.loading=!1})},onOptionsValidate:function(){this.load(this.optionsData),this.optionsModal=!1},optionsBuildKeyOptions:function(e){var t=this.$ething.arbo.get(e.data.resource);if(t){var n=t.keys();return n.length&&this.$set(e.data,"key",n[0]),n.map(function(e){return{label:e,value:e}})}},onSave:function(){var e=this,t=JSON.stringify(this.currentPreferences,null,4);/\.plot$/.test(this.filename)||(this.filename=this.filename+".plot"),this.file&&this.file.name()===this.filename?this.file.write(t):this.filename.length&&this.$ething.File.create({name:this.filename,content:t}).then(function(t){e.file=t}),this.saveModal=!1},chart:function(){return this.$refs.highcharts?this.$refs.highcharts.chart:void 0},onResize:function(e){this.resize()},resize:Object(p["debounce"])(function(){var e=this.chart();e&&e.reflow()},1e3),onTableUpdate:function(e,t){-1!==t.indexOf("contentModifiedDate")&&this.refresh()}},mounted:function(){var e=this;if(this.$v.optionsData.$touch(),this.file)this.file.read().then(function(t){try{var n="string"===typeof t?JSON.parse(t):t;e.optionsData=n,e.load(n)}catch(e){console.error(e)}});else{var t={},n=null;if("string"===typeof this.preferences&&(n=this.$store.getters["ething/get"](this.preferences)),this.preferences instanceof this.$ething.Table&&(n=this.$store.getters["ething/get"](this.preferences.id())),n){this.table=n,n.on("updated",this.onTableUpdate);var i=this.$ething.arbo.get(n.createdBy());i&&(t.subtitle='<a href="#'+this.$ui.route(i)+'">'+i.basename()+"</a>"),t.title='<a href="#'+this.$ui.route(n)+'">'+n.basename()+"</a>",t.panes=[],n.keys().forEach(function(e){var i={name:e,curves:[{name:e,type:"line",data:{resource:n.id(),key:e}}]};t.panes.push(i)})}else t=this.preferences;t&&(this.optionsData=t,this.load(t))}},beforeDestroy:function(){this.table&&this.table.off("updated",this.onTableUpdate)}},_=y,x=(n("LvdV"),n("KHd+")),$=Object(x["a"])(_,i,r,!1,null,"427c5f6d",null);t["a"]=$.exports},BLau:function(e,t,n){"use strict";var i=n("GI7+"),r=n.n(i);r.a},"BM+I":function(e,t,n){"use strict";var i=n("ak/P"),r=n.n(i);r.a},BMdk:function(e,t,n){"use strict";var i=n("hZXq"),r=n.n(i);r.a},Bass:function(e,t,n){"use strict";var i=n("/egE"),r=n.n(i);r.a},Cd0x:function(e,t,n){"use strict";var i=n("q4Oz"),r=n.n(i);r.a},E1lG:function(e,t,n){},ESr1:function(e,t,n){"use strict";var i=n("ld4t"),r=n.n(i);r.a},"GI7+":function(e,t,n){},GnLr:function(e,t,n){},Goa7:function(e,t,n){"use strict";var i=n("3Qcm"),r=n.n(i);r.a},Gwbd:function(e,t,n){},Hl11:function(e,t,n){},I0l5:function(e,t,n){"use strict";var i=n("QBV9"),r=n.n(i);r.a},JJXq:function(e,t,n){"use strict";n.r(t);var i={};n.d(i,"filter",function(){return $}),n.d(i,"get",function(){return w}),n.d(i,"glob",function(){return S});var r={};n.d(r,"update",function(){return k});var a=n("MVZn"),o=n.n(a),s=(n("SpHO"),n("Kw5r")),l=n("4IOb");s["a"].use(l["default"],{cfg:{},components:{QLayout:l["QLayout"],QLayoutHeader:l["QLayoutHeader"],QLayoutDrawer:l["QLayoutDrawer"],QPageContainer:l["QPageContainer"],QPage:l["QPage"],QToolbar:l["QToolbar"],QToolbarTitle:l["QToolbarTitle"],QBtn:l["QBtn"],QBtnGroup:l["QBtnGroup"],QBtnDropdown:l["QBtnDropdown"],QWindowResizeObservable:l["QWindowResizeObservable"],QResizeObservable:l["QResizeObservable"],QTabs:l["QTabs"],QTab:l["QTab"],QTabPane:l["QTabPane"],QRouteTab:l["QRouteTab"],QIcon:l["QIcon"],QList:l["QList"],QListHeader:l["QListHeader"],QItem:l["QItem"],QItemSeparator:l["QItemSeparator"],QItemTile:l["QItemTile"],QItemMain:l["QItemMain"],QItemSide:l["QItemSide"],QBreadcrumbs:l["QBreadcrumbs"],QBreadcrumbsEl:l["QBreadcrumbsEl"],QTable:l["QTable"],QTableColumns:l["QTableColumns"],QInnerLoading:l["QInnerLoading"],QSpinnerOval:l["QSpinnerOval"],QSpinnerPie:l["QSpinnerPie"],QField:l["QField"],QInput:l["QInput"],QSelect:l["QSelect"],QRadio:l["QRadio"],QCheckbox:l["QCheckbox"],QColor:l["QColor"],QDatetime:l["QDatetime"],QChipsInput:l["QChipsInput"],QAutocomplete:l["QAutocomplete"],QSlider:l["QSlider"],QToggle:l["QToggle"],QKnob:l["QKnob"],QCollapsible:l["QCollapsible"],QModal:l["QModal"],QModalLayout:l["QModalLayout"],QAlert:l["QAlert"],QChip:l["QChip"],QPageSticky:l["QPageSticky"],QFab:l["QFab"],QFabAction:l["QFabAction"],QPopover:l["QPopover"],QOptionGroup:l["QOptionGroup"],QCard:l["QCard"],QCardTitle:l["QCardTitle"],QCardMain:l["QCardMain"],QCardSeparator:l["QCardSeparator"],QScrollArea:l["QScrollArea"],QSearch:l["QSearch"]},directives:{CloseOverlay:l["CloseOverlay"]},plugins:{Notify:l["Notify"],Dialog:l["Dialog"],LocalStorage:l["LocalStorage"],ActionSheet:l["ActionSheet"]}});n("QBu7"),n("flf9"),n("s/Tp"),n("OKqc"),n("Hl11"),n("fm0S");var c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"q-app"}},[n("router-view")],1)},u=[];c._withStripped=!0;var d={name:"App"},m=d,h=(n("ZL7j"),n("KHd+")),f=Object(h["a"])(m,c,u,!1,null,null,null),p=f.exports,v=n("jE9Z"),b=[{path:"/",component:function(){return n.e(17).then(n.bind(null,"ez0Y"))},children:[{path:"",redirect:"dashboard"},{path:"data/:path*",name:"data",component:function(){return Promise.all([n.e(0),n.e(16)]).then(n.bind(null,"xjVW"))}},{path:"devices",name:"devices",component:function(){return Promise.all([n.e(0),n.e(15)]).then(n.bind(null,"GeLR"))}},{path:"table/:id",component:function(){return n.e(14).then(n.bind(null,"oqN7"))},meta:{back:!0}},{path:"chart/:id",component:function(){return n.e(1).then(n.bind(null,"rxuX"))},meta:{back:!0}},{path:"chart",component:function(){return n.e(1).then(n.bind(null,"rxuX"))}},{path:"text/:id",component:function(){return Promise.all([n.e(0),n.e(13)]).then(n.bind(null,"xItC"))},meta:{back:!0}},{path:"script/:id",component:function(){return Promise.all([n.e(0),n.e(12)]).then(n.bind(null,"ADSn"))},meta:{back:!0}},{path:"image/:id",component:function(){return n.e(11).then(n.bind(null,"KDo1"))},meta:{back:!0}},{path:"resource/:id",component:function(){return Promise.all([n.e(0),n.e(10)]).then(n.bind(null,"uLZ+"))},meta:{back:!0}},{path:"create/:type",component:function(){return Promise.all([n.e(0),n.e(9)]).then(n.bind(null,"Vh8b"))},meta:{back:!0}},{path:"device/:id",component:function(){return Promise.all([n.e(0),n.e(8)]).then(n.bind(null,"GA/o"))},meta:{back:!0}},{path:"dashboard",name:"dashboard",component:function(){return Promise.all([n.e(0),n.e(7)]).then(n.bind(null,"7JVJ"))}},{path:"settings",component:function(){return n.e(6).then(n.bind(null,"tB8M"))}},{path:"rules",name:"rules",component:function(){return n.e(5).then(n.bind(null,"DRFT"))}},{path:"test",component:function(){return n.e(4).then(n.bind(null,"yWG4"))}}]},{path:"/login",name:"login",component:function(){return n.e(3).then(n.bind(null,"AT+L"))}},{path:"*",component:function(){return n.e(2).then(n.bind(null,"7l0S"))}}];s["a"].use(v["a"]);var g=new v["a"]({mode:"hash",base:"/",scrollBehavior:function(){return{y:0}},routes:b}),y=g,_=n("L2JU"),x={resources:[],loaded:!1},$=(n("f3/d"),n("Oyvg"),n("dRSK"),function(e){return function(t){return e.resources.filter(t)}}),w=function(e){return function(t){return e.resources.find(function(e){return e.id()===t})}},S=function(e){return function(t){var n=new RegExp("^"+(t?t+"/":"")+"[^/]+$");return e.resources.filter(function(e){return n.test(e.name())})}},C=n("QmqO"),q=n.n(C),k=function(e){console.log("store resource update"),e.loaded=!0,e.resources=q.a.arbo.list()},O=n("MS+v"),j={namespaced:!0,state:x,getters:i,mutations:r,actions:O};s["a"].use(_["a"]);var D=new _["a"].Store({modules:{ething:j}}),E=D,F=n("qSUR"),M={failed:"Action failed",success:"Action was successful"},I={en:M},T=function(e){var t=e.app,n=e.Vue;n.use(F["a"]),t.i18n=new F["a"]({locale:"en",fallbackLocale:"en",messages:I})},Q=n("vDqi"),V=n.n(Q),W=function(e){var t=e.Vue;t.prototype.$axios=V.a,window.axios=V.a},L=function(e){e.app,e.router;var t=e.Vue;e.store;t.prototype.$ething=q.a,window.EThing=q.a},A=(n("VRzm"),n("rGqo"),n("yt8O"),n("RW0V"),n("cDf5")),B=n.n(A);n("91GP"),n("KKXr"),n("pIFo");EventSource||(console.log("load EventSource polyfill"),EventSource=n("JLUw"));var R={source:null,connected:!1,showReconnect:!1,onconnect:null,ondisconnect:null,start:function(){var e=this,t=this,n=this.source=new EventSource(q.a.config.serverUrl+"/api/events",{withCredentials:!0,https:{rejectUnauthorized:!1}});n.onopen=function(){console.log("SSE connected"),t.connected=!0,t.notification&&t.notification(),t.showReconnect&&(t.notification=l["Notify"].create({type:"positive",color:"positive",message:"Reconnected to server !",icon:"thumb_up",position:"top-right",onDismiss:function(){delete t.notification}})),t.onconnect&&t.onconnect.call(t)},n.onerror=function(){!0===t.connected&&(console.warn("SSE disconnected"),t.connected=!1,t.showReconnect=!0,t.notification&&t.notification(),t.notification=l["Notify"].create({type:"negative",color:"negative",message:"Lost connection to server !",icon:"report_problem",position:"top-right",onDismiss:function(){delete t.notification}}),t.ondisconnect&&t.ondisconnect.call(t))},n.onmessage=function(t){var n=JSON.parse(t.data);e.dispatch(n)}},stop:function(){this.source&&this.source.close()},dispatch:function(e){var t,n=e.name,i=!!e.data.resource,r=q.a.Event(n,{data:e.data,originalEvent:e});if(i){var a=e.data.resource.id;e.data.resource&&("ResourceDeleted"===n?q.a.arbo.remove(a):q.a.arbo.update(q.a.instanciate(e.data.resource))),t=q.a.arbo.get(a),t&&t.trigger(r)}else q.a.trigger(r)},cacheDelay:500,cache:{},fetch:function(e){var t=this;this.cache[e]&&clearTimeout(this.cache[e]),this.cache[e]=setTimeout(function(){delete t.cache[e],q.a.get(e)},this.cacheDelay)}},H=function(e){e.app,e.router;var t=e.Vue;t.prototype.$sse=R,window.sse=R},z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-schema-ething-resource"},[e.schema.description?n("small",{staticClass:"form-schema-description"},[e._v(e._s(e.schema.description))]):e._e(),n("resource-select",{attrs:{value:e.castedModel,filter:e.filter,type:e.types,multiple:e.multiple,"use-id":""},on:{input:e.setValue}}),e.$v.value.$error?n("small",{staticClass:"form-schema-error"},[e._v(e._s(e.errorMessage))]):e._e()],1)},P=[];z._withStripped=!0;var U=n("/71H"),N=n("9E6g");Object(N["registerForm"])(function(e){if("ething.resource"===e.format)return"form-schema-ething-resource"});var Y={name:"FormSchemaEthingResource",mixins:[N["FormComponent"]],components:{ResourceSelect:U["a"]},computed:{types:function(){if(this.schema.onlyTypes)return this.schema.onlyTypes.join(" ")},multiple:function(){return"array"===this.schema.type},filter:function(){var e=this.schema;if(e.filter)return function(t){return e.filter.call(e,t)}}}},K=Y,J=(n("Goa7"),Object(h["a"])(K,z,P,!1,null,"2e98a43c",null)),G=J.exports,X={icon:"attachment",color:"grey",widgets:{},inheritances:[],required:[],properties:{createdBy:{format:"ething.resource",readOnly:!0},data:{readOnly:!0},modifiedDate:{getFormatted:function(e){return l["date"].formatDate(this.get(e).getTime(),"YYYY-MM-DD HH:mm")}},createdDate:{getFormatted:function(e){return l["date"].formatDate(this.get(e).getTime(),"YYYY-MM-DD HH:mm")}},extends:{getFormatted:function(e){return(this.get(e)||[]).join(", ")}}}},Z={icon:"mdi-file",color:"green",properties:{size:{getFormatted:function(e){return l["format"].humanStorageSize(this.get(e))}},contentModifiedDate:{getFormatted:function(e){return l["date"].formatDate(this.get(e).getTime(),"YYYY-MM-DD HH:mm")}}},dynamic:function(e){var t,n=[];"plot"===e.extension()?(t="mdi-file-chart",n.push("WChart")):/^text/.test(e.mime())?t="mdi-file-document":/^image/.test(e.mime())?(t="mdi-file-image",n.push("WImage")):/^video/.test(e.mime())?t="mdi-file-video":/^application/.test(e.mime())&&(t="mdi-file-xml"),"application/javascript"===e.mime()&&n.push("WScript");var i={};return t&&(i.icon=t),n&&(i.widgets=n),i}},ee={icon:"mdi-table",color:"blue",properties:{length:{getFormatted:function(e){return this.get(e)+" rows"}},contentModifiedDate:{getFormatted:function(e){return l["date"].formatDate(this.get(e).getTime(),"YYYY-MM-DD HH:mm")}}},widgets:{chart:{description:"print a chart",type:"WChart"}}},te={icon:"mdi-sitemap",color:"purple",virtual:!0,disableCreation:!1,properties:{battery:{readOnly:!0},connected:{readOnly:!0},lastSeenDate:{getFormatted:function(e){var t=this.get(e);return t?l["date"].formatDate(t.getTime(),"YYYY-MM-DD HH:mm"):"never"}},methods:{getFormatted:function(e){return(this.get(e)||[]).join(", ")}},interfaces:{getFormatted:function(e){return(this.get(e)||[]).join(", ")}}},methods:{}},ne={icon:"event note",color:"teal",properties:{events:{items:{format:"ething.event"},_label:function(e,t){var n=Object.assign({},t);return delete n.type,t.type+" ("+this.$ui.describe(n)+")"}},conditions:{items:{format:"ething.condition"},_label:function(e,t){var n=Object.assign({},t);return delete n.type,t.type+" ("+this.$ui.describe(n)+")"}},actions:{items:{format:"ething.action"},_label:function(e,t){var n=Object.assign({},t);return delete n.type,t.type+" ("+this.$ui.describe(n)+")"}}}},ie={Resource:X,File:Z,Table:ee,Device:te,Rule:ne},re={icon:"mdi-thermometer",widgets:{"temperature.knob":{label:"temperature (knob)",description:"show the temperature",type:"WDeviceKnob",options:{attr:"temperature",unit:"°C",min:-20,max:40}},"temperature.label":{label:"temperature (label)",description:"show the temperature",type:"WDeviceLabel",options:{attr:"temperature",unit:"°C",min:-20,max:40}}}},ae={icon:"mdi-toggle-switch",widgets:{switch:{description:"toggle the device",type:"WSwitch",options:{attr:"state",fn_setter:"setState"}}}},oe={icon:"lightbulb outline",widgets:{switch:{description:"toggle the light"}}},se={icon:"mdi-contrast-circle",widgets:{dimmer:{description:"adjust the level",type:"WDimmable",options:{attr:"level",fn_setter:"getLevel"}}}},le={icon:"photo_camera",widgets:{camera:{description:"show the last image",type:"WCamera"}}},ce={Thermometer:re,Switch:ae,Light:oe,Dimmable:se,Camera:le},ue={properties:{resource:{id:"ResourceEvent.resource",format:"ething.resource"}}},de={properties:{key:{id:"TableDataThresholdEvent.key",enum:[],dependencies:{"ResourceEvent.resource":function(e,t,n){var i=[];(e||[]).forEach(function(e){var n=t.$ething.arbo.get(e);n&&(i=i.concat(n.keys()))}),i=i.filter(function(e,t,n){return n.indexOf(e)===t}),t.$set(t.mutableSchema,"enum",i)}}},threshold_mode:{enumLabels:["greater than","greater than or equal to","less than","less than or equal to"],default:"gt"},threshold_value:{default:0}}},me=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-schema-cron"},[e.schema.description?n("small",{staticClass:"form-schema-description"},[e._v(e._s(e.schema.description))]):e._e(),n("q-btn",{attrs:{flat:"",color:"primary",icon:"edit",label:e.castedModel?"change":"set"},on:{click:function(t){e.editing=!0}}}),n("div",[e._v(e._s(e.readableExp))]),e.$v.value.$error?n("small",{staticClass:"form-schema-error"},[e._v(e._s(e.errorMessage))]):e._e(),n("modal",{attrs:{title:"Cron editor",icon:"event"},on:{valid:e.apply},model:{value:e.editing,callback:function(t){e.editing=t},expression:"editing"}},[n("cron",{staticClass:"q-ma-md",attrs:{value:e.castedModel},on:{input:function(t){e.editedExp=t}}})],1)],1)},he=[];me._withStripped=!0;n("a1Th");var fe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"row cell"},[n("div",{staticClass:"col-xs-12 col-sm-3 title text-bold"},[e._v("\n      Schedule\n    ")]),n("div",{staticClass:"col-xs-12 col-sm-9 cell-content"},[n("div",{staticClass:"text-faded"},[e._v("\n        Select the schedule that the trigger should run on.\n      ")]),n("q-list",{attrs:{"no-border":""}},[n("q-item",{attrs:{tag:"label"}},[n("q-item-side",[n("q-radio",{attrs:{val:"daily"},model:{value:e.model.schedule,callback:function(t){e.$set(e.model,"schedule",t)},expression:"model.schedule"}})],1),n("q-item-main",[n("q-item-tile",{attrs:{label:""}},[e._v("Daily")]),n("q-item-tile",{attrs:{sublabel:""}},[e._v("Allows you to configure a trigger that will run once, hourly or minutely daily")])],1)],1),n("q-item",{attrs:{tag:"label"}},[n("q-item-side",[n("q-radio",{attrs:{val:"weekly"},model:{value:e.model.schedule,callback:function(t){e.$set(e.model,"schedule",t)},expression:"model.schedule"}})],1),n("q-item-main",[n("q-item-tile",{attrs:{label:""}},[e._v("Days per week")]),n("q-item-tile",{attrs:{sublabel:""}},[e._v("Allows you to configure a trigger that will run once, hourly or minutely on certain days of the week")])],1)],1),n("q-item",{attrs:{tag:"label"}},[n("q-item-side",[n("q-radio",{attrs:{val:"monthly"},model:{value:e.model.schedule,callback:function(t){e.$set(e.model,"schedule",t)},expression:"model.schedule"}})],1),n("q-item-main",[n("q-item-tile",{attrs:{label:""}},[e._v("Days per month")]),n("q-item-tile",{attrs:{sublabel:""}},[e._v("Allows you to configure a trigger that will run on a specific date of the month or specific day of the week")])],1)],1),n("q-item",{attrs:{tag:"label"}},[n("q-item-side",[n("q-radio",{attrs:{val:"cron"},model:{value:e.model.schedule,callback:function(t){e.$set(e.model,"schedule",t)},expression:"model.schedule"}})],1),n("q-item-main",[n("q-item-tile",{attrs:{label:""}},[e._v("Cron expression")]),n("q-item-tile",{attrs:{sublabel:""}},[e._v("Allows you to configure a trigger that will run according to the specific CRON expression")])],1)],1)],1)],1)]),"weekly"==e.model.schedule?n("div",{staticClass:"row cell"},[n("div",{staticClass:"col-xs-12 col-sm-3 title text-bold"},[e._v("\n      Run Days\n    ")]),n("div",{staticClass:"col-xs-12 col-sm-9 cell-content"},[n("div",{staticClass:"text-faded"},[e._v("\n        Select what days of the week the scheduler should execute.\n      ")]),n("div",{staticClass:"q-my-md"},e._l(e.weekdays,function(t){return n("q-checkbox",{key:t,staticClass:"q-mr-md q-my-sm",attrs:{val:t,label:t},model:{value:e.model.days,callback:function(t){e.$set(e.model,"days",t)},expression:"model.days"}})}))])]):e._e(),"monthly"==e.model.schedule?n("div",{staticClass:"row cell"},[n("div",{staticClass:"col-xs-12 col-sm-3 title text-bold"},[e._v("\n      On\n    ")]),n("div",{staticClass:"col-xs-12 col-sm-9 cell-content"},[n("div",{staticClass:"text-faded"},[e._v("\n        Select when in the month the trigger should execute\n      ")]),n("q-list",{attrs:{"no-border":""}},[n("q-item",{attrs:{tag:"label"}},[n("q-item-side",[n("q-radio",{attrs:{val:"day"},model:{value:e.model.on,callback:function(t){e.$set(e.model,"on",t)},expression:"model.on"}})],1),n("q-item-main",[n("q-item-tile",{attrs:{label:""}},[e._v("Specific date of every month")])],1)],1),n("q-item",{attrs:{tag:"label"}},[n("q-item-side",[n("q-radio",{attrs:{val:"weekday"},model:{value:e.model.on,callback:function(t){e.$set(e.model,"on",t)},expression:"model.on"}})],1),n("q-item-main",[n("q-item-tile",{attrs:{label:""}},[e._v("Specific day of week of every month")])],1)],1)],1),"day"==e.model.on?n("div",[e._v("\n        The\n        "),n("q-select",{staticClass:"inline",attrs:{options:e.onMonthlyDaysOptions,"hide-underline":""},model:{value:e.model.onDay,callback:function(t){e.$set(e.model,"onDay",t)},expression:"model.onDay"}}),e._v("\n        of every month\n      ")],1):e._e(),"weekday"==e.model.on?n("div",[e._v("\n        The\n        "),n("q-select",{staticClass:"inline",attrs:{options:[{label:"First",value:1},{label:"Second",value:2},{label:"Third",value:3},{label:"Fourth",value:4}],"hide-underline":""},model:{value:e.model.onWeekdayOrdinal,callback:function(t){e.$set(e.model,"onWeekdayOrdinal",t)},expression:"model.onWeekdayOrdinal"}}),n("q-select",{staticClass:"inline",attrs:{options:e.onMonthlyWeekdaysOptions,"hide-underline":""},model:{value:e.model.onWeekday,callback:function(t){e.$set(e.model,"onWeekday",t)},expression:"model.onWeekday"}}),e._v("\n        of every month\n      ")],1):e._e()],1)]):e._e(),"daily"==e.model.schedule||"weekly"==e.model.schedule?n("div",{staticClass:"row cell"},[n("div",{staticClass:"col-xs-12 col-sm-3 title text-bold"},[e._v("\n      Interval\n    ")]),n("div",{staticClass:"col-xs-12 col-sm-9 cell-content"},[n("q-select",{staticClass:"inline",attrs:{options:[{label:"Runs once",value:"once"},{label:"Every x hours",value:"repeatHours"},{label:"Every x minutes",value:"repeatMinutes"}],"hide-underline":""},model:{value:e.model.interval,callback:function(t){e.$set(e.model,"interval",t)},expression:"model.interval"}})],1)]):e._e(),"monthly"==e.model.schedule||("daily"==e.model.schedule||"weekly"==e.model.schedule)&&"once"==e.model.interval?n("div",{staticClass:"row cell"},[n("div",{staticClass:"col-xs-12 col-sm-3 title text-bold"},[e._v("\n      Start Time\n    ")]),n("div",{staticClass:"col-xs-12 col-sm-9 cell-content"},[e._v("\n\n      Starting at\n      "),n("q-datetime",{staticClass:"inline",attrs:{type:"time",format24h:"","hide-underline":""},model:{value:e.model.startTime,callback:function(t){e.$set(e.model,"startTime",t)},expression:"model.startTime"}})],1)]):e._e(),"daily"!=e.model.schedule&&"weekly"!=e.model.schedule||"repeatHours"!=e.model.interval&&"repeatMinutes"!=e.model.interval?e._e():n("div",{staticClass:"row cell"},[n("div",{staticClass:"col-xs-12 col-sm-3 title text-bold"},[e._v("\n      Repeat\n    ")]),n("div",{staticClass:"col-xs-12 col-sm-9 cell-content"},[e._v("\n      Every\n      "),n("q-select",{staticClass:"inline",attrs:{options:"repeatHours"==e.model.interval?e.everyHoursOptions:e.everyMinutesOptions,"hide-underline":""},model:{value:e.model.every,callback:function(t){e.$set(e.model,"every",t)},expression:"model.every"}}),"repeatHours"==e.model.interval?n("span",[e._v("\n        hours\n      ")]):n("span",[e._v("\n        minutes\n      ")])],1)]),"cron"==e.model.schedule?n("div",{staticClass:"row cell"},[n("div",{staticClass:"col-xs-12 col-sm-3 title text-bold"},[e._v("\n      Cron Expression\n    ")]),n("div",{staticClass:"col-xs-12 col-sm-9 cell-content"},[n("div",{staticClass:"text-faded"},[e._v("\n        Enter the cron expression to configure when the trigger shoud execute\n      ")]),n("q-input",{staticClass:"q-my-md",attrs:{placeholder:"min hour day month weekday","hide-underline":"","float-label":"Cron expression"},model:{value:e.model.cron,callback:function(t){e.$set(e.model,"cron",t)},expression:"model.cron"}})],1)]):e._e()])},pe=[];fe._withStripped=!0;var ve={name:"Cron",props:["value"],data:function(){for(var e=[],t=1;t<=12;t++)e.push({label:String(t),value:t});var n=[];for(t=1;t<=59;t++)n.push({label:String(t),value:t});var i=[];for(t=1;t<=31;t++)i.push({label:String(t),value:t});var r=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"];return{model:Object.assign({schedule:"daily",interval:"once",startTime:l["date"].buildDate({hours:15,minutes:0}),every:1,days:[],on:"day",onDay:1,onWeekdayOrdinal:1,onWeekday:"monday",cron:this.value||"* 1 * * *"},this.value?this.unserialize(this.value):null),weekdays:r,everyHoursOptions:e,everyMinutesOptions:n,onMonthlyWeekdaysOptions:r.map(function(e){return{label:e,value:e}}),onMonthlyDaysOptions:i,cron:""}},watch:{model:{handler:function(){this.cron=this.serialize()},deep:!0,immediate:!0},cron:{handler:function(e){this.$emit("input",e)},immediate:!0}},methods:{weekdayToIndex:function(e){var t=this.weekdays.indexOf(e)+1;return 7==t&&(t=0),t},indexToWeekday:function(e){return e=parseInt(e),0==e&&(e=7),this.weekdays[e-1]},serialize:function(){var e=this,t=this.model;if("cron"==t.schedule)return t.cron;if("daily"==t.schedule||"weekly"==t.schedule){var n="*";if("weekly"==t.schedule&&(n=t.days.map(function(t){return e.weekdayToIndex(t)}).join(","),n||(n="*")),"once"==t.interval){var i=t.startTime.getHours(),r=t.startTime.getMinutes();return r+" "+i+" * * "+n}if("repeatHours"==t.interval){var a=t.every||1;return 1==a?"0 * * * "+n:"0 */"+a+" * * "+n}if("repeatMinutes"==t.interval){a=t.every||1;return 1==a?"* * * * "+n:"*/"+a+" * * * "+n}}if("monthly"==t.schedule){i=t.startTime.getHours(),r=t.startTime.getMinutes();if("day"==t.on){var o=t.onDay||1;return r+" "+i+" "+o+" * *"}if("weekday"==t.on){n=["1-7","8-14","15-21","22-28"];return r+" "+i+" "+n[t.onWeekdayOrdinal-1]+" * "+this.weekdayToIndex(t.onWeekday)}}},unserialize:function(e){var t=this;console.log("unserialize: "+e);var n={},i=e.split(" "),r=/^[0-9]+$/,a=/^\*\/[0-9]+$/;if(5===i.length)if(r.test(i[0])&&r.test(i[1])&&(n.startTime=l["date"].buildDate({hours:parseInt(i[1]),minutes:parseInt(i[0])})),"*"==i[2]&&"*"==i[3]){var o="daily";if("*"!=i[4]&&(o=null,/^[0-6](,[0-6])*$/.test(i[4])&&(o="weekly",n.days=i[4].split(",").map(function(e){return t.indexToWeekday(e)}))),o){if(r.test(i[0])&&r.test(i[1]))return n.schedule=o,n.interval="once",n;if("0"==i[0]&&a.test(i[1]))return n.schedule=o,n.interval="repeatHours",n.every=parseInt(i[1].substr(2)),n;if("0"==i[0]&&"*"==i[1])return n.schedule=o,n.interval="repeatHours",n.every=1,n;if("*"==i[1]&&a.test(i[0]))return n.schedule=o,n.interval="repeatMinutes",n.every=parseInt(i[0].substr(2)),n;if("*"==i[1]&&"*"==i[0])return n.schedule=o,n.interval="repeatMinutes",n.every=1,n}}else if("*"!=i[2]&&"*"==i[3]){if(r.test(i[2])&&"*"==i[4])return n.schedule="monthly",n.on="day",n.onDay=parseInt(i[2]),n;var s=["1-7","8-14","15-21","22-28"];if(/^[0-6]$/.test(i[4])&&-1!==s.indexOf(i[2]))return n.schedule="monthly",n.on="weekday",n.onWeekdayOrdinal=s.indexOf(i[2])+1,n.onWeekday=this.indexToWeekday(i[4]),n}return n.schedule="cron",n.cron=e,n}}},be=ve,ge=(n("BLau"),Object(h["a"])(be,fe,pe,!1,null,"9aad93be",null)),ye=ge.exports,_e=n("J3Jp"),xe=n.n(_e);Object(N["registerForm"])(function(e){if("cron"===e.format)return"form-schema-cron"});var $e={name:"FormSchemaCron",mixins:[N["FormComponent"]],components:{Cron:ye},data:function(){return{editedExp:null,editing:!1}},computed:{readableExp:function(){return this.castedModel?xe.a.toString(this.castedModel):""}},methods:{apply:function(){this.editing=!1,this.setValue(this.editedExp)}}},we=$e,Se=Object(h["a"])(we,me,he,!1,null,null,null),Ce=Se.exports,qe={properties:{cron_expression:{title:"when",format:"cron"}}},ke={ResourceEvent:ue,TableDataThresholdEvent:de,Timer:qe},Oe={properties:{items:{format:"scheduler"}}},je={Scheduler:Oe},De={properties:{device:{id:"ExecuteDevice.device",format:"ething.resource",filter:function(e){return e instanceof EThing.Device}},method:{id:"ExecuteDevice.method",enum:[],dependencies:{"ExecuteDevice.device":function(e,t,n){var i=t.$ething.arbo.get(e),r=[];i&&(r=i.methods()),t.$set(t.mutableSchema,"enum",r)}}},args:{dependencies:{"ExecuteDevice.method":function(e,t,n){var i=t.$ething.arbo.get(t.find("ExecuteDevice.device").value);i&&e?i.getApi(e).then(function(e){t.mutableSchema=Object.assign(t.mutableSchema,e.schema),Object.keys(t.mutableSchema.properties).length?t.$set(t.parent().mutableSchema.properties,"args",t.mutableSchema):t.$delete(t.parent().mutableSchema.properties,"args")}):t.$delete(t.parent().mutableSchema.properties,"args")}}}}},Ee={properties:{message:{format:"text"}}},Fe={properties:{script:{format:"ething.resource",filter:function(e){return e instanceof EThing.File&&"application/javascript"==e.mime()}}}},Me={ExecuteDevice:De,Notify:Ee,RunScript:Fe},Ie={},Te={resources:ie,interfaces:ce,events:ke,conditions:je,actions:Me,signals:Ie};function Qe(e,t){var n=t.split("/"),i=e;for(var r in n){var a=n[r];if("object"!==B()(i)||null===i)return;i=i[a]}return i}function Ve(e,t,n,i){"undefined"===typeof n&&"function"===typeof t&&(i=n,n=t,t=null),i=i||[],t=t||{};var r=!1,a=function(){r=!0};if(e=n(e,t,a,i.join("/")),!r&&"object"===B()(e)&&null!==e)for(var o in e){var s=e[o];if("object"===B()(s)&&null!==s){var l=i.slice(0);l.push(o),e[o]=Ve(s,t[o],n,l)}}return e}function We(e,t){if("string"===typeof e["$ref"]){var n=e["$ref"];return/^#\//.test(n)?(n=n.substr(2),We(Qe(t,n),t)):(console.warn("invalid JSON reference: "+n),{})}if("undefined"!==typeof e["allOf"]){var i=e["allOf"],r={};for(var a in i){var o=i[a],s=null;if("string"===typeof o["$ref"]&&(s=o["$ref"].substr(2)),o=We(o,t),"class"!==o["type"])return e;var c=[];c=c.concat(r.inheritances||[]),null!==s&&c.push(s),c=c.concat(o.inheritances||[]),Le(r,o),r.inheritances=c,r.virtual=!1}e=Object(l["extend"])(!0,{},e);return delete e.allOf,e.type="class",Le(r,e),r}return e}function Le(e,t){if(!t)return e;if(0===Object.keys(t).length&&t.constructor===Object)return e;var n=Object.keys(e.properties||{}),i=Object.keys(t.properties||{}),r=i;n.forEach(function(e){-1===r.indexOf(e)&&r.push(e)});var a=[].concat(e.required||[]);(t.required||[]).forEach(function(e){-1===a.indexOf(e)&&a.push(e)});var o=[].concat(e.signals||[]);(t.signals||[]).forEach(function(e){-1===o.indexOf(e)&&o.push(e)});var s=Object(l["extend"])(!0,e,t),c={};return r.forEach(function(e){c[e]=s.properties[e]}),s.properties=c,s.required=a,s.signals=o,s}function Ae(e){if("class"===e["type"]){e=Object(l["extend"])(!0,{color:"grey",icon:"mdi-help",description:"",required:[],properties:{},methods:{},signals:[],virtual:!1,widgets:{},inheritances:[],disableCreation:!1,dynamic:null},e);var t=function(t){var n=e.properties[t];n.get||(n.get=function(e){return e[t]?e[t]():e.attr(t)}),n.getFormatted||(n.getFormatted=n.get)};for(var n in e.properties)t(n);for(var n in e.widgets)e.widgets[n]=Object(l["extend"])({label:n,description:"",type:null,options:{}},e.widgets[n])}return e}function Be(e,t){var n=document.createElement("script"),i=document.getElementsByTagName("script")[0];n.async=1,n.onload=n.onreadystatechange=function(e,i){(i||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,n=void 0,i||t&&t())},n.src=e,i.parentNode.insertBefore(n,i)}function Re(e,t){var n=e.plugins||{},i=[],r=function(e){var t=n[e];t.js_index&&i.push(new Promise(function(t,n){Be(q.a.config.serverUrl+"/api/plugin/"+e+"/index.js",function(){console.log("plugin "+e+" index.js loaded"),t()})}))};for(var a in n)r(a);Pe.scopes=e.scopes||{},Pe.info=e.info||{},Pe.plugins=n,Pe.config=e.config||{},Promise.all(i).then(function(){var n=e.definitions;Ve(n,Pe.definitions,function(e,t,n,i){return"undefined"===typeof e["type"]&&"undefined"===typeof e["allOf"]||(e=Le(e,t),n()),e}),Ve(n,function(e,t,i,r){return"undefined"===typeof e["type"]&&"undefined"===typeof e["allOf"]||(e=We(e,n),i()),e}),console.log(n),Object(l["extend"])(N["definitions"],n),Pe.definitions=n,t&&t(Pe)})}var He={};function ze(e,t){var n=null;if(e instanceof q.a.Resource&&(n=e,e=e.type()),!t)if(n){var i=n.id();if(i in He)return He[i]}else if(e in He)return He[e];var r=Qe(Pe.definitions,e)||{};if(t||(r=Ae(r)),!t)if(n){i=n.id();if(r.dynamic){var a=r.dynamic.call(r,n);a&&Le(r,a)}He[i]=r}else He[e]=r;return r}var Pe={info:{},mergeClass:Le,get:ze,definitions:Te,plugins:{},scopes:{},loadDefinitions:function(){return new Promise(function(e,t){q.a.request({url:"utils/definitions",dataType:"json"}).then(function(t){console.log("ething meta loaded !"),Re(t,e)})})}},Ue=function(e){e.app,e.router;var t=e.Vue;t.prototype.$meta=Pe,window.meta=Pe},Ne=n("Cb1D"),Ye=n.n(Ne),Ke=n("Qyje"),Je=n.n(Ke),Ge=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-modal",e._b({ref:"modal",staticClass:"column",attrs:{value:e.value,"content-css":e.contentCss},on:{input:function(t){e.$emit("input",t)},show:function(t){e.$emit("show",t)}}},"q-modal",e.$attrs,!1),[n("q-modal-layout",{attrs:{"header-class":"no-shadow","footer-class":"no-shadow"}},[e.title?n("q-toolbar",{attrs:{slot:"header"},slot:"header"},[e.icon?n("q-icon",{staticClass:"q-ml-sm",attrs:{name:e.icon}}):e._e(),n("q-toolbar-title",[e._v("\n        "+e._s(e.title)+"\n      ")]),e.$attrs["no-esc-dismiss"]?e._e():n("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"close"},on:{click:e.hide}})],1):e._e(),n("div",{staticClass:"q-py-md q-px-lg"},[e._t("default")],2),e.noButtons?e._e():n("q-toolbar",{attrs:{slot:"footer",inverted:""},slot:"footer"},[n("q-toolbar-title",[e.validBtnHide?e._e():n("q-btn",{attrs:{color:e.validBtnColor,label:e.validBtnLabel,disable:e.validBtnDisable,loading:e.validBtnLoading},on:{click:function(t){e.onValidBtnClick()}}}),e.cancelBtnHide?e._e():n("q-btn",{attrs:{color:e.cancelBtnColor,label:e.cancelBtnLabel,disable:e.cancelBtnDisable,flat:""},on:{click:function(t){e.onCancelBtnClick()}}}),e._l(e.buttons,function(t,i){return n("q-btn",{key:i,attrs:{color:t.color,label:t.label,flat:t.flat,disable:t.disable},on:{click:function(n){e.onBtnClick(t)}}})}),e._t("buttons")],2)],1)],1)],1)},Xe=[];Ge._withStripped=!0;var Ze={name:"Modal",props:{title:String,icon:String,value:{},size:{type:String,default:"md"},noButtons:Boolean,validBtnHide:Boolean,validBtnDisable:Boolean,validBtnLoading:Boolean,validBtnLabel:{type:String,default:"Valid"},validBtnColor:{type:String,default:"primary"},cancelBtnHide:Boolean,cancelBtnDisable:Boolean,cancelBtnLabel:{type:String,default:"Cancel"},cancelBtnColor:{type:String,default:"negative"},buttons:Array},data:function(){return{}},computed:{contentCss:function(){var e={};return"xs"==this.size?e={minWidth:"30vw",minHeight:"40vh"}:"sm"==this.size?e={minWidth:"40vw",minHeight:"50vh"}:"md"==this.size?e={minWidth:"50vw",minHeight:"70vh"}:"lg"==this.size?e={minWidth:"70vw",minHeight:"80vh"}:"xl"==this.size&&(e={minWidth:"90vw",minHeight:"90vh"}),e}},methods:{onValidBtnClick:function(){this.$emit("valid")},onCancelBtnClick:function(){this.$emit("cancel"),this.hide()},onBtnClick:function(e){e.onclick.call(this)},hide:function(){this.$refs.modal.hide()},show:function(){this.$refs.modal.show()},toggle:function(){this.$refs.modal.toggle()}}},et=Ze,tt=(n("ZPX1"),Object(h["a"])(et,Ge,Xe,!1,null,"6588c67c",null)),nt=tt.exports,it=l["format"].humanStorageSize;Ye.a.shim();var rt=36e5,at={VERSION:"1.0.0"};function ot(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),i=n.exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}at.kioskMode="1"===ot("kiosk");var st=function(e){var t=e.app,n=e.router,i=e.Vue,r=e.store;window.Vue=i,window.quasar=l,i.component("Modal",nt),q.a.on("Notified",function(e){console.log(e),l["Notify"].create({type:"info",message:e.data.message,detail:e.data.subject,position:"bottom-right",timeout:15e3,actions:[{label:"Close",handler:function(){}}]})});var a=null,o=!1,s=window.location.href,c=s.split("/");a=c[0]+"//"+c[2],a&&(q.a.config.serverUrl=a),o||(at.autoLogin=/\/\/localhost/.test(q.a.config.serverUrl)),i.prototype.$ui=window.UI=at,Object.assign(at,{dynamicServerUrl:o,getServerUrl:function(){return q.a.config.serverUrl},setServerUrl:function(e){l["LocalStorage"].set("ething.server.url",e),q.a.config.serverUrl=e},needAuth:function(){return o&&!l["LocalStorage"].get.item("ething.server.url")},route:function(e,t){return e instanceof q.a.File?/\.plot$/.test(e.basename())?"/chart/"+e.id():/image/.test(e.mime())?"/image/"+e.id():"application/javascript"==e.mime()?"/script/"+e.id():"/text/"+e.id():e instanceof q.a.Table?"chart"===t?"/chart/"+e.id():"/table/"+e.id():e instanceof q.a.Device?"/device/"+e.id():e instanceof q.a.Rule?"/rule":void 0},open:function(e,t){var i=this.route(e,t);i&&n.app.$router.push(i)},dateToString:function(e){if(!e)return"-";var t=e.getTime();return l["date"].formatDate(t,"YYYY-MM-DD HH:mm")},sizeToString:function(e){return it(e)},describe:function(e){var t=[],n=function e(t){if(q.a.utils.isId(t)){var n=q.a.arbo.get(t);if(n)return n.name()}return Array.isArray(t)?t.map(function(t){return e(t)}).join(" "):"object"===B()(t)&&null!==t?0===Object.keys(t).length?"":"{...}":null===t?"":String(t)};for(var i in e){var r=e[i],a=n(r);a&&"undefined"!==typeof r&&t.push(i+": "+a)}return t.join(", ")}}),t.data=t.data||{},t.data.state="begin",t.data.error=!1,Object.assign(at,{reset:function(){t.data.state="begin",R.stop(),l["LocalStorage"].remove("ething.auth.iat"),this.authRefreshTimer&&clearInterval(this.authRefreshTimer)},disconnect:function(){this.reset(),n.app.$router.push({name:"login",query:{redirect_uri:n.app.$router.currentRoute.path}})},logout:function(){var e=this;return q.a.axios.request({method:"get",url:q.a.config.serverUrl+"/auth/logout"}).finally(function(){e.disconnect()})},login:function(e,t,i){var r=this;return q.a.axios.request({method:"post",url:e+"/auth/password",headers:{"content-type":"application/x-www-form-urlencoded"},data:Je.a.stringify({login:t,password:i})}).then(function(t){r.reset(),r.setServerUrl(e),l["LocalStorage"].set("ething.auth.iat",Date.now());var i=n.app.$route.query.redirect_uri||"/";"/login"===i&&(i="/"),n.app.$router.replace(i)})},authRefreshTimer:null,authRefresh:function(){return q.a.axios.request({method:"post",url:q.a.config.serverUrl+"/auth/refresh"}).then(function(){l["LocalStorage"].set("ething.auth.iat",Date.now())})}}),console.log("ething configuring ..."),q.a.axios.defaults.withCredentials=!0,q.a.axios.interceptors.response.use(function(e){return e},function(e){if(e.response){var t=e.response.status;401!=t&&403!=t||at.disconnect()}return Promise.reject(e)}),n.beforeEach(function(e,n,i){if("begin"===t.data.state&&"login"!==e.name){if(console.log("begin..."),at.needAuth())return console.warn("no serverUrl found ! need to create a new session"),void i({name:"login",replace:!0,query:{redirect_uri:e.path}});t.data.state="initializing",console.log("initializing...");var a=Pe.loadDefinitions(),o=q.a.arbo.load(null,!0).then(function(){console.log("ething arbo loaded !"),r.commit("ething/update")});Promise.all([o,a]).then(function(){t.data.state="ok",console.log("ething loaded !");var e=!1;R.onconnect=function(){e&&q.a.arbo.load(null,!0).then(function(){console.log("ething arbo reloaded !"),r.commit("ething/update")})},R.ondisconnect=function(){e=!0},R.start();var n=l["LocalStorage"].get.item("ething.auth.iat");n&&Date.now()-n>rt&&at.authRefresh(),at.authRefreshTimer=setInterval(function(){at.authRefresh()},rt)}).catch(function(e){console.error(e),t.data.state="error",t.data.error=e})}i()})},lt=n("t/Xm");function ct(e){return e.meta=e.meta||{},e}for(var ut in lt["a"])lt["a"][ut]=ct(lt["a"][ut]);var dt,mt,ht={widgets:lt["a"],find:function(e){if(lt["a"].hasOwnProperty(e))return lt["a"][e]},register:function(e){if(!e.name)throw new Error("No name set in the widget definition");lt["a"][e.name]=ct(e)}},ft=function(e){e.app,e.router;var t=e.Vue;t.prototype.$widget=ht,window.widget=ht},pt={name:"FormSchema",mixins:[N["FormComponent"]],render:function(e){var t=this;return Object(N["makeForm"])(e,this.schema,this.model,this.level,function(e){t.setValue(e)},function(e){t.setError(e)},{required:this.required})}},vt=pt,bt=(n("4FYl"),Object(h["a"])(vt,dt,mt,!1,null,null,null)),gt=bt.exports,yt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-schema-object",class:{indent:e.level}},[e.schema.description?n("small",{staticClass:"form-schema-description"},[e._v(e._s(e.schema.description))]):e._e(),e._l(e.items,function(t){return n("q-field",{key:t.key,staticClass:"formField",class:{formFieldRequired:t.required,formFieldError:!!e.errors[t.key]},attrs:{label:t.schema.title||t.schema.label||t.key,orientation:"vertical"}},[n("form-schema",{attrs:{required:t.required,schema:t.schema,model:t.model,level:e.level+1},on:{input:function(n){e.onChildValueChange(t,n)},error:function(n){e.onChildErrorChange(t,n)}}})],1)}),e.$v.value.$error&&e.$v.value.required?n("small",{staticClass:"form-schema-error"},[e._v(e._s(e.errorMessage))]):e._e()],2)},_t=[];yt._withStripped=!0;n("hhXQ");var xt={name:"FormSchemaObject",mixins:[N["FormComponent"]],data:function(){return{errors:{}}},computed:{items:function(){var e=this,t=this.mutableSchema,n=t.required||[],i=[],r=[];for(var a in t.properties)t.properties[a].readOnly?i.push(a):t.properties[a].required&&-1===n.indexOf(a)&&n.push(a),t.properties[a]._disabled&&r.push(a);var o=n.concat(Object.keys(t.properties||{}).filter(function(e){return-1===n.indexOf(e)&&-1===i.indexOf(e)})).filter(function(e){return-1===r.indexOf(e)&&!!t.properties[e]});if(t.order)for(var s=t.order.length;s>0;s--){var l=t.order[s-1],c=o.indexOf(l);-1!==c&&(o.splice(c,1),o.unshift(l))}var u=!1;return Object.keys(this.errors).forEach(function(t){-1===o.indexOf(t)&&(delete e.errors[t],u=!0)}),u&&this.setError(Object.values(this.errors).some(function(e){return e})),o.map(function(i){return{key:i,schema:t.properties[i],required:-1!==n.indexOf(i),model:(e.model||{})[i]}})}},methods:{onChildValueChange:function(e,t){var n=Object.assign({},this.value);n[e.key]=t,this.setValue(n)},onChildErrorChange:function(e,t){this.$set(this.errors,e.key,t),this.setError(Object.values(this.errors).some(function(e){return e}))}}},$t=xt,wt=(n("ezf8"),Object(h["a"])($t,yt,_t,!1,null,null,null)),St=wt.exports,Ct=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-schema-array",class:{indent:e.level}},[e.schema.description?n("small",{staticClass:"form-schema-description"},[e._v(e._s(e.schema.description))]):e._e(),n("div",[n("q-btn",{attrs:{flat:"",size:"md",label:"Add item",icon:"add"},on:{click:e.addItem}})],1),e._l(e.items,function(t,i){return n("div",{key:i,staticClass:"formField"},[n("div",{staticClass:"row items-center"},[n("div",{staticClass:"label col text-faded"},[n("q-icon",{attrs:{name:"keyboard_arrow_right",color:"primary"}}),e._v("\n        "+e._s(e.getLabel(i))+"\n      ")],1),i>0?n("q-btn",{staticClass:"col-auto",attrs:{flat:"",size:"sm",color:"secondary",icon:"arrow_drop_up",flat:""},on:{click:function(t){e.moveItem(i,"up")}}}):e._e(),i<e.items.length-1?n("q-btn",{staticClass:"col-auto",attrs:{flat:"",size:"sm",color:"secondary",icon:"arrow_drop_down",flat:""},on:{click:function(t){e.moveItem(i,"down")}}}):e._e(),n("q-btn",{staticClass:"col-auto",attrs:{flat:"",size:"sm",color:"secondary",label:"edit",icon:"edit"},on:{click:function(t){e.editItem(i)}}}),n("q-btn",{staticClass:"col-auto",attrs:{flat:"",size:"sm",color:"negative",label:"remove",icon:"delete"},on:{click:function(t){e.removeItem(i)}}})],1)])}),e.$v.value.$error?n("small",{staticClass:"form-schema-error"},[e._v(e._s(e.errorMessage))]):e._e(),n("modal",{attrs:{title:"Add item",icon:"add","valid-btn-disable":e.edit.error,"valid-btn-label":"Add"},on:{valid:e.onEditDone},model:{value:e.edit.show,callback:function(t){e.$set(e.edit,"show",t)},expression:"edit.show"}},[n("form-schema",{attrs:{schema:e.schema.items||{}},on:{error:function(t){e.edit.error=t}},model:{value:e.edit.model,callback:function(t){e.$set(e.edit,"model",t)},expression:"edit.model"}})],1)],2)},qt=[];Ct._withStripped=!0;var kt=n("ta7f"),Ot={name:"FormSchemaArray",mixins:[N["FormComponent"]],data:function(){return{items:[],edit:{show:!1,model:void 0,error:!1}}},watch:{model:function(){this.refreshFromModel()}},validations:function(){var e={};return"number"===typeof this.schema.minItems&&(e.minLength=Object(kt["minLength"])(this.schema.minItems)),"number"===typeof this.schema.maxItems&&(e.maxLength=Object(kt["maxLength"])(this.schema.maxItems)),{value:e}},methods:{refreshFromModel:function(){var e=this;this.items=(this.model||[]).map(function(t){return{schema:e.schema.items||{}}})},getLabel:function(e){var t=this.schema._label;return"string"===typeof t?t:"function"===typeof t?t.call(this,e,this.value[e]):-1!==["string","boolean","integer","int","long","number","float","double"].indexOf(this.schema.items.type)?String(this.value[e]):"item #"+e},getModel:function(e){return Array.isArray(this.model)&&e<this.model.length?this.model[e]:void 0},addItem:function(){this.edit.key=-1,this.edit.model=void 0,this.edit.show=!0},onEditDone:function(){var e=(this.value||[]).slice();-1===this.edit.key?e.push(this.edit.model):e[this.edit.key]=this.edit.model,this.setValue(e),this.edit.show=!1},removeItem:function(e){this.items.splice(e,1);var t=(this.value||[]).slice();t.splice(e,1),this.setValue(t)},moveItem:function(e,t){var n=(this.value||[]).slice(),i=n.splice(e,1);n.splice(e+("up"===t?-1:1),0,i[0]),this.setValue(n)},editItem:function(e){this.edit.key=e,this.edit.model=this.model[e],this.edit.show=!0},onChildValueChange:function(e,t){var n=(this.value||[]).slice();n[e]=t,this.setValue(n)},onChildErrorChange:function(e,t){this.items[e].error=t,this.setError(Object.values(this.items).some(function(e){return e.error}))}},mounted:function(){this.refreshFromModel()}},jt=Ot,Dt=(n("ESr1"),Object(h["a"])(jt,Ct,qt,!1,null,"53fe6a3b",null)),Et=Dt.exports,Ft=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-schema-string"},[e.schema.description?n("small",{staticClass:"form-schema-description"},[e._v(e._s(e.schema.description))]):e._e(),n("q-input",{attrs:{type:"text"===e.schema.format?"textarea":"text",value:e.castedModel,error:e.$v.value.$error},on:{input:e.setValue}}),e.$v.value.$error?n("small",{staticClass:"form-schema-error"},[e._v(e._s(e.errorMessage))]):e._e()],1)},Mt=[];Ft._withStripped=!0;var It=n("eO9T"),Tt=function(e){return Object(It["withParams"])({type:"regex",pattern:e},function(t){return!Object(It["req"])(t)||new RegExp(e).test(t)})},Qt={name:"FormSchemaString",mixins:[N["FormComponent"]],validations:function(){var e={};return"number"===typeof this.schema.minLength&&(e.minLength=Object(kt["minLength"])(this.schema.minLength)),"number"===typeof this.schema.maxLength&&(e.maxLength=Object(kt["maxLength"])(this.schema.maxLength)),"string"===typeof this.schema.pattern&&(e.regex=Tt(this.schema.pattern)),{value:e}},methods:{cast:function(e){return null===e?"":String(e)}}},Vt=Qt,Wt=(n("Mrzf"),Object(h["a"])(Vt,Ft,Mt,!1,null,"3f595154",null)),Lt=Wt.exports,At=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-schema-number"},[e.schema.description?n("small",{staticClass:"form-schema-description"},[e._v(e._s(e.schema.description))]):e._e(),n("q-input",{attrs:{type:"number",value:e.castedModel,error:e.$v.value.$error},on:{input:e.setValue}}),e.$v.value.$error?n("small",{staticClass:"form-schema-error"},[e._v(e._s(e.errorMessage))]):e._e()],1)},Bt=[];At._withStripped=!0;n("xfY5");var Rt={name:"FormSchemaNumber",mixins:[N["FormComponent"]],validations:function(){var e={};return"number"===typeof this.schema.minimum&&(e.minValue=Object(kt["minValue"])(this.schema.minimum)),"number"===typeof this.schema.maximum&&(e.maxValue=Object(kt["maxValue"])(this.schema.maximum)),{value:e}},methods:{cast:function(e){return Number(e)}}},Ht=Rt,zt=(n("Bass"),Object(h["a"])(Ht,At,Bt,!1,null,"3a7fea5c",null)),Pt=zt.exports,Ut=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-schema-boolean"},[e.schema.description?n("small",{staticClass:"form-schema-description"},[e._v(e._s(e.schema.description))]):e._e(),n("q-toggle",{attrs:{value:e.model,error:e.$v.value.$error},on:{input:e.setValue}}),e.$v.value.$error?n("small",{staticClass:"form-schema-error"},[e._v(e._s(e.errorMessage))]):e._e()],1)},Nt=[];Ut._withStripped=!0;var Yt={name:"FormSchemaBoolean",mixins:[N["FormComponent"]],props:{model:Boolean}},Kt=Yt,Jt=(n("NJyr"),Object(h["a"])(Kt,Ut,Nt,!1,null,"5f588be5",null)),Gt=Jt.exports,Xt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-schema-enum"},[e.schema.description?n("small",{staticClass:"form-schema-description"},[e._v(e._s(e.schema.description))]):e._e(),n("q-select",{attrs:{value:e.model,options:e.selectOptions,error:e.$v.value.$error},on:{input:e.setValue}}),e.$v.value.$error?n("small",{staticClass:"form-schema-error"},[e._v(e._s(e.errorMessage))]):e._e()],1)},Zt=[];Xt._withStripped=!0;var en={name:"FormSchemaEnum",mixins:[N["FormComponent"]],computed:{selectOptions:function(){var e=this.mutableSchema.enumLabels||[];return(this.mutableSchema.enum||[]).map(function(t,n){return{label:n<e.length?e[n]:String(t),value:t}})}}},tn=en,nn=(n("RakF"),Object(h["a"])(tn,Xt,Zt,!1,null,"c056b024",null)),rn=nn.exports,an=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-schema-date"},[e.schema.description?n("small",{staticClass:"form-schema-description"},[e._v(e._s(e.schema.description))]):e._e(),n("q-datetime",{attrs:{type:e.datetype,value:e.model,error:e.$v.value.$error,format24h:""},on:{input:e.setValue}}),e.$v.value.$error?n("small",{staticClass:"form-schema-error"},[e._v(e._s(e.errorMessage))]):e._e()],1)},on=[];an._withStripped=!0;var sn={name:"FormSchemaDate",mixins:[N["FormComponent"]],computed:{datetype:function(){return"date"===this.schema.format?"date":"time"===this.schema.format?"time":"datetime"}}},ln=sn,cn=(n("vYdL"),Object(h["a"])(ln,an,on,!1,null,"b353fb9c",null)),un=cn.exports,dn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-schema-color"},[e.schema.description?n("small",{staticClass:"form-schema-description"},[e._v(e._s(e.schema.description))]):e._e(),n("q-color",{attrs:{value:e.model,error:e.$v.value.$error},on:{input:e.setValue}}),e.$v.value.$error?n("small",{staticClass:"form-schema-error"},[e._v(e._s(e.errorMessage))]):e._e()],1)},mn=[];dn._withStripped=!0;var hn={name:"FormSchemaDate",mixins:[N["FormComponent"]],props:{model:String}},fn=hn,pn=(n("VwY0"),Object(h["a"])(fn,dn,mn,!1,null,"38df3f81",null)),vn=pn.exports,bn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-schema-json"},[n("small",{staticClass:"form-schema-description text-faded"},[e._v(e._s(e.schema.description))]),n("codemirror",{ref:"cm",attrs:{value:e.formattedModel,options:e.cmOption},on:{input:e.parseJson}})],1)},gn=[];bn._withStripped=!0;var yn=n("lSNA"),_n=n.n(yn),xn=n("j5TT"),$n=(n("p77/"),n("+dQi"),n("jDMi"),n("ELLl"),n("SJVZ"),n("y8iW"),n("aX69"),n("rt3J"),n("iCJ0"),n("DdDu"),n("Trwj")),wn=n.n($n);xn["CodeMirror"].registerHelper("lint","json",function(e){var t=[],n=wn.a.parser;n.parseError=function(e,n){var i=n.loc;t.push({from:xn["CodeMirror"].Pos(i.first_line-1,i.first_column),to:xn["CodeMirror"].Pos(i.last_line-1,i.last_column),message:e})};try{n.parse(e)}catch(e){}return t});var Sn={name:"FormSchemaJson",mixins:[N["FormComponent"]],components:{codemirror:xn["codemirror"]},computed:{formattedModel:function(){return"string"===this.schema.type?this.castedModel:JSON.stringify(this.castedModel,null,4)}},data:function(){var e;return{cmOption:(e={mode:"application/json",tabSize:4,styleActiveLine:!0,lineNumbers:!0,lineWrapping:!1,foldGutter:!0,styleSelectedText:!0,lint:!0,gutters:["CodeMirror-lint-markers","CodeMirror-linenumbers","CodeMirror-foldgutter"],matchBrackets:!0,autoCloseBrackets:!0},_n()(e,"foldGutter",!0),_n()(e,"showCursorWhenSelecting",!0),_n()(e,"extraKeys",{Ctrl:"autocomplete"}),_n()(e,"hintOptions",{completeSingle:!1}),_n()(e,"viewportMargin",1/0),e)}},methods:{parseJson:function(e){if("string"!==this.schema.type)try{e=JSON.parse(e)}catch(t){e=null}this.setValue(e)}}},Cn=Sn,qn=(n("vgDZ"),Object(h["a"])(Cn,bn,gn,!1,null,"5690a663",null)),kn=qn.exports,On=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-schema-optional",class:{indent:e.level}},[e.schema.description?n("small",{staticClass:"form-schema-description"},[e._v(e._s(e.schema.description))]):e._e(),n("div",[n("q-toggle",{attrs:{label:"enable"},model:{value:e.enabled,callback:function(t){e.enabled=t},expression:"enabled"}})],1),e.enabled?n("form-schema",{ref:"sub",attrs:{required:"",schema:e.filteredSchema,model:e.cachedValue,level:e.level},on:{input:e.onChildValueChange,error:e.setError}}):e._e()],1)},jn=[];On._withStripped=!0;n("Zz4T");var Dn={name:"FormSchemaOptional",mixins:[N["FormComponent"]],computed:{filteredSchema:function(){var e=Object.assign({},this.schema);delete e.anyOf,delete e.description;var t=this.schema.anyOf.filter(function(e){return"null"!==e.type});return 1==t.length?e=Object(l["extend"])(!0,e,t[0]):e.anyOf=t,e}},data:function(){return{enabled:!1,cachedValue:void 0}},watch:{model:function(){this.refreshFromModel()},enabled:function(e){var t=this;this.$nextTick(function(){e?(t.setValue(t.$refs["sub"].value),t.setError(t.$refs["sub"].error)):(t.setValue(null),t.setError(!1))})}},methods:{refreshFromModel:function(){this.enabled=null!==this.model&&"undefined"!==typeof this.model,this.enabled&&(this.cachedValue=this.model)},onChildValueChange:function(e){this.cachedValue=e,this.setValue(e)}},mounted:function(){this.refreshFromModel()}},En=Dn,Fn=(n("BMdk"),Object(h["a"])(En,On,jn,!1,null,"1daa800d",null)),Mn=Fn.exports,In=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-schema-multi-type"},[e.schema.description?n("small",{staticClass:"form-schema-description"},[e._v(e._s(e.schema.description))]):e._e(),n("q-select",{attrs:{"stack-label":"type",value:e.type,options:e.selectOptions},on:{input:e.setType}}),e.isValid?n("form-schema",{ref:"child",attrs:{required:e.required,schema:e.computedSchema,model:e.cachedValue,level:e.level},on:{input:e.onChildValueChange,error:e.setError}}):e._e()],1)},Tn=[];In._withStripped=!0;var Qn=["string","number","boolean","object","array"],Vn={name:"FormSchemaMultiType",mixins:[N["FormComponent"]],props:{types:{type:Array,default:function(){return Qn}}},computed:{isValid:function(){return"object"===B()(this.computedSchema)},computedSchema:function(){return"undefined"!==typeof this.type?{type:this.type}:void 0},selectOptions:function(){return this.types.map(function(e){return{label:e,value:e}})}},data:function(){return{type:void 0,cachedValue:void 0}},watch:{model:function(){this.refreshFromModel()}},methods:{setType:function(e){var t=this;this.type=e,this.$nextTick(function(){t.$refs["child"]&&(t.setValue(t.$refs["child"].value),t.setError(t.$refs["child"].error))})},refreshFromModel:function(){var e=B()(this.model);"object"===e&&Array.isArray(this.model)&&(e="array"),-1!==this.types.indexOf(e)?(this.type=e,this.cachedValue=this.model):this.type=this.types[0]},onChildValueChange:function(e){this.cachedValue=e,this.setValue(e)}},mounted:function(){this.refreshFromModel()}},Wn=Vn,Ln=(n("buvv"),Object(h["a"])(Wn,In,Tn,!1,null,"1c40f248",null)),An=Ln.exports,Bn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-schema-number-slider"},[e.schema.description?n("small",{staticClass:"form-schema-description"},[e._v(e._s(e.schema.description))]):e._e(),n("q-slider",{attrs:{value:e.castedModel,error:e.$v.value.$error,min:e.schema.minimum,max:e.schema.maximum,step:e.schema.multipleOf,"label-always":""},on:{input:e.setValue}}),e.$v.value.$error?n("small",{staticClass:"form-schema-error"},[e._v(e._s(e.errorMessage))]):e._e()],1)},Rn=[];Bn._withStripped=!0;var Hn={name:"FormSchemaNumberSlider",mixins:[Pt]},zn=Hn,Pn=(n("Z/Wj"),Object(h["a"])(zn,Bn,Rn,!1,null,"2f1573fe",null)),Un=Pn.exports,Nn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-schema-file"},[e.schema.description?n("small",{staticClass:"form-schema-description"},[e._v(e._s(e.schema.description))]):e._e(),n("div",[n("span",{staticClass:"q-mr-md relative-position overflow-hidden"},[n("q-icon",{attrs:{name:"add",color:"primary"}}),e._v(" add file\n      "),n("input",{ref:"file",staticClass:"file-input absolute-full cursor-pointer",attrs:{type:"file",accept:e.schema.accept},on:{change:e.__add}})],1),e._l(e.files,function(t,i){return n("small",{key:i,staticClass:"text-faded"},[e._v("\n      "+e._s(t.name)+" ("+e._s(t.__size)+")\n    ")])})],2),e.$v.value.$error?n("small",{staticClass:"form-schema-error"},[e._v(e._s(e.errorMessage))]):e._e(),"string"===typeof e.error?n("small",{staticClass:"form-schema-error"},[e._v(e._s(e.error))]):e._e()])},Yn=[];Nn._withStripped=!0;var Kn=l["format"].humanStorageSize,Jn={name:"FormSchemaFile",mixins:[N["FormComponent"]],data:function(){return{files:[]}},methods:{__add:function(e,t){var n=this;t=Array.prototype.slice.call(t||e.target.files),this.$refs.file.value="";t=t.map(function(e){return e.__size=Kn(e.size),e.__timestamp=(new Date).getTime(),e.__converting=!0,n.convert(e,function(t){n.$nextTick(function(){e.__converting=!1,n.setValue(t)})},function(e){n.files=[],n.setError(String(e)),n.setValue(void 0)}),e}),this.files=t},convert:function(e,t,n){var i=this,r=function(r){var a=i.schema._converter;if("function"===typeof a)try{a.call(i,e,r,t,n)}catch(e){n(e)}else t(r)};if("base64"===this.schema.format){var a=new FileReader;a.onloadend=function(e){var t=a.result,n=t.split(",",2);r(n[1])},a.readAsDataURL(e)}else if("text"===this.schema.format){var o=new FileReader;o.onloadend=function(e){var t=o.result;r(t)},o.readAsText(e)}else r(e)}}},Gn=Jn,Xn=(n("pBng"),Object(h["a"])(Gn,Nn,Yn,!1,null,"546ee83a",null)),Zn=Xn.exports,ei=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-schema-bluetooth-interface"},[e.schema.description?n("small",{staticClass:"form-schema-description"},[e._v(e._s(e.schema.description))]):e._e(),n("div",{staticClass:"row"},[n("q-input",{staticClass:"col",attrs:{type:"number",value:e.castedModel,error:e.$v.value.$error},on:{input:e.setValue}}),n("q-btn",{staticClass:"col-auto",attrs:{flat:"",color:"faded",icon:"search"}},[n("q-popover",{attrs:{anchor:"bottom right",self:"top right",fit:""},on:{show:e.show}},[n("div",{staticStyle:{width:"260px"}},[e.loading?n("div",{staticClass:"q-ma-md text-center text-faded"},[n("div",{staticClass:"q-ma-md"},[e._v("loading...")]),n("q-spinner-oval",{attrs:{color:"primary",size:"50px"}})],1):0===e.interfaces.length?n("div",{staticClass:"q-ma-md text-faded"},[e._v("no bluetooth interface detected")]):n("q-list",{attrs:{separator:"",link:""}},[n("q-btn",{attrs:{flat:"",color:"faded",icon:"refresh",label:"refresh"},on:{click:function(t){e.refresh()}}}),e._l(e.interfaces,function(t,i){return n("q-item",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}],key:i,nativeOn:{click:function(n){e.setValue(e.parseIntFromHci(t.hci))}}},[n("q-item-main",[n("q-item-tile",{attrs:{label:""}},[e._v(e._s(t.hci))]),t.address?n("q-item-tile",{attrs:{sublabel:""}},[e._v("mac: "+e._s(t.address))]):e._e(),t.name?n("q-item-tile",{attrs:{sublabel:""}},[e._v("name: "+e._s(t.name))]):e._e(),t.status?n("q-item-tile",{attrs:{sublabel:""}},[e._v("status: "+e._s(t.status))]):e._e(),t.manufacturer?n("q-item-tile",{attrs:{sublabel:""}},[e._v("manufacturer: "+e._s(t.manufacturer))]):e._e()],1)],1)})],2)],1)])],1)],1),e.$v.value.$error?n("small",{staticClass:"form-schema-error"},[e._v(e._s(e.errorMessage))]):e._e()])},ti=[];ei._withStripped=!0;n("SRfc");Object(N["registerForm"])(function(e){if("bluetooth-interface"===e.format)return"form-schema-bluetooth-interface"});var ni={name:"FormSchemaBluetoothInterface",mixins:[N["FormComponent"]],data:function(){return{interfaces:[],loading:!0,loaded:!1}},methods:{show:function(){this.loaded||(this.loaded=!0),this.refresh()},refresh:function(){var e=this;this.loading=!0,q.a.request({url:"utils/bluetooth_list",dataType:"json"}).then(function(t){e.interfaces=t}).finally(function(){e.loading=!1})},parseIntFromHci:function(e){return parseInt(e.match(/^hci([0-9]+)$/)[1])}}},ii=ni,ri=Object(h["a"])(ii,ei,ti,!1,null,null,null),ai=ri.exports,oi=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-schema-ething-action",class:{indent:e.level}},[e.schema.description?n("small",{staticClass:"form-schema-description"},[e._v(e._s(e.schema.description))]):e._e(),n("q-field",{staticClass:"formFieldRequired",attrs:{label:"Action",helper:"Select the action to be executed",orientation:"vertical"}},[n("q-select",{attrs:{value:e.action,options:e.actionOptions},on:{input:e.setType}})],1),e.action?n("form-schema",{key:e.formId,attrs:{schema:e.actionSchema,model:e.model},on:{input:e.setOptions,error:e.setError}}):e._e(),e.$v.value.$error?n("small",{staticClass:"form-schema-error"},[e._v(e._s(e.errorMessage))]):e._e()],1)},si=[];oi._withStripped=!0,Object(N["registerForm"])(function(e){if("ething.action"===e.format)return"form-schema-ething-action"});var li={name:"FormSchemaEthingAction",mixins:[N["FormComponent"]],components:{ResourceSelect:U["a"]},props:{model:Object,default:function(){return{type:void 0}}},data:function(){var e=[];for(var t in this.$meta.definitions.actions){var n=this.$meta.definitions.actions[t];if(!n.virtual){var i=n.description;i||(n.allOf||[]).forEach(function(e){e.description&&(i=e.description)}),e.push({label:t,value:"actions/"+t,sublabel:i})}}return{actionOptions:e,formId:0}},computed:{action:function(){return this.model?this.model.type:void 0},actionSchema:function(){var e={type:"object",required:[],properties:{}};if(this.action){var t=this.$meta.get(this.action);e=t}return e}},watch:{actionSchema:function(e,t){e!==t&&this.formId++}},methods:{setType:function(e){this.setValue({type:e})},setOptions:function(e){this.setValue(Object.assign({type:this.action},e))}}},ci=li,ui=Object(h["a"])(ci,oi,si,!1,null,null,null),di=ui.exports,mi=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-schema-ething-condition",class:{indent:e.level}},[e.schema.description?n("small",{staticClass:"form-schema-description"},[e._v(e._s(e.schema.description))]):e._e(),n("q-field",{staticClass:"formFieldRequired",attrs:{label:"Condition",helper:"Select a condition",orientation:"vertical"}},[n("q-select",{attrs:{value:e.condition,options:e.conditionOptions},on:{input:e.setType}})],1),e.condition?n("form-schema",{key:e.formId,attrs:{schema:e.conditionSchema,model:e.model},on:{input:e.setOptions,error:e.setError}}):e._e(),e.$v.value.$error?n("small",{staticClass:"form-schema-error"},[e._v(e._s(e.errorMessage))]):e._e()],1)},hi=[];mi._withStripped=!0,Object(N["registerForm"])(function(e){if("ething.condition"===e.format)return"form-schema-ething-condition"});var fi={name:"FormSchemaEthingCondition",mixins:[N["FormComponent"]],components:{ResourceSelect:U["a"]},props:{model:Object,default:function(){return{type:void 0}}},data:function(){var e=[];for(var t in this.$meta.definitions.conditions){var n=this.$meta.definitions.conditions[t];if(!n.virtual){var i=n.description;i||(n.allOf||[]).forEach(function(e){e.description&&(i=e.description)}),e.push({label:t,value:"conditions/"+t,sublabel:i})}}return{conditionOptions:e,formId:0}},computed:{condition:function(){return this.model?this.model.type:void 0},conditionSchema:function(){var e={type:"object",required:[],properties:{}};if(this.condition){var t=this.$meta.get(this.condition);e=t}return e}},watch:{conditionSchema:function(e,t){e!==t&&this.formId++}},methods:{setType:function(e){this.setValue({type:e})},setOptions:function(e){this.setValue(Object.assign({type:this.condition},e))}}},pi=fi,vi=Object(h["a"])(pi,mi,hi,!1,null,null,null),bi=vi.exports,gi=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-schema-ething-event",class:{indent:e.level}},[e.schema.description?n("small",{staticClass:"form-schema-description"},[e._v(e._s(e.schema.description))]):e._e(),n("q-field",{staticClass:"formFieldRequired",attrs:{label:"Event",helper:"Select the event on which this rule will be executed",orientation:"vertical"}},[n("q-select",{attrs:{value:e.event,options:e.eventOptions},on:{input:e.setType}})],1),e.event?n("form-schema",{key:e.formId,attrs:{schema:e.eventSchema,model:e.model},on:{input:e.setOptions,error:e.setError}}):e._e(),e.$v.value.$error?n("small",{staticClass:"form-schema-error"},[e._v(e._s(e.errorMessage))]):e._e()],1)},yi=[];gi._withStripped=!0,Object(N["registerForm"])(function(e){if("ething.event"===e.format)return"form-schema-ething-event"});var _i={name:"FormSchemaEthingEvent",mixins:[N["FormComponent"]],components:{ResourceSelect:U["a"]},props:{model:Object,default:function(){return{type:void 0}}},data:function(){var e=[];for(var t in this.$meta.definitions.events){var n=this.$meta.definitions.events[t];if(!n.virtual){var i=n.description;i||(n.allOf||[]).forEach(function(e){e.description&&(i=e.description)}),e.push({label:t,value:"events/"+t,sublabel:i})}}return{eventOptions:e,formId:0}},computed:{event:function(){return this.model?this.model.type:void 0},eventSchema:function(){var e={type:"object",required:[],properties:{}};if(this.event){var t=this.$meta.get(this.event);if(e=t,-1!==t.inheritances.indexOf("events/ResourceEvent")&&t.signal){var n=t.signal;t=this.$meta;e=Object(l["extend"])(!0,{properties:{resource:{filter:function(e){var i=t.get(e).signals;return-1!==i.indexOf(n)}}}},e)}}return e}},watch:{eventSchema:function(e,t){e!==t&&this.formId++}},methods:{setType:function(e){this.setValue({type:e})},setOptions:function(e){this.setValue(Object.assign({type:this.event},e))}}},xi=_i,$i=(n("Cd0x"),Object(h["a"])(xi,gi,yi,!1,null,"791d8d85",null)),wi=$i.exports,Si=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-schema-host"},[e.schema.description?n("small",{staticClass:"form-schema-description"},[e._v(e._s(e.schema.description))]):e._e(),n("div",{staticClass:"row"},[n("q-input",{staticClass:"col",attrs:{value:e.castedModel,error:e.$v.value.$error},on:{input:e.setValue}}),n("q-btn",{staticClass:"col-auto",attrs:{flat:"",color:"faded",icon:"search"}},[n("q-popover",{attrs:{anchor:"bottom right",self:"top right",fit:""},on:{show:e.showHosts}},[n("div",{staticStyle:{width:"260px"}},[e.loading?n("div",{staticClass:"q-ma-md text-center text-faded"},[n("div",{staticClass:"q-ma-md"},[e._v("scanning...")]),n("q-spinner-oval",{attrs:{color:"primary",size:"50px"}})],1):0===e.hosts.length?n("div",{staticClass:"q-ma-md text-faded"},[e._v("no host detected")]):n("q-list",{attrs:{separator:"",link:""}},[n("q-btn",{attrs:{flat:"",color:"faded",icon:"refresh",label:"refresh"},on:{click:function(t){e.refresh(!0)}}}),e._l(e.hosts,function(t,i){return n("q-item",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}],key:i,nativeOn:{click:function(n){e.setValue(t.hostname||t.ip)}}},[n("q-item-main",[n("q-item-tile",{attrs:{label:""}},[e._v(e._s(t.hostname||t.ip))]),t.mac?n("q-item-tile",{attrs:{sublabel:""}},[e._v("mac: "+e._s(t.mac))]):e._e(),t.vendor?n("q-item-tile",{attrs:{sublabel:""}},[e._v("vendor: "+e._s(t.vendor))]):e._e()],1)],1)})],2)],1)])],1)],1),e.$v.value.$error?n("small",{staticClass:"form-schema-error"},[e._v(e._s(e.errorMessage))]):e._e()])},Ci=[];Si._withStripped=!0,Object(N["registerForm"])(function(e){if("host"===e.format)return"form-schema-host"});var qi=[],ki=!1,Oi=null,ji=3e5;function Di(e,t){"function"===typeof e&&(t=e,e=!1),!1===ki&&(e=!0),(e||Date.now()-ki>ji)&&(ki=Date.now(),Oi=q.a.request({url:"utils/net_list",dataType:"json"}).then(function(e){qi=e})),Oi.finally(function(){"function"===typeof t&&t(qi)})}var Ei={name:"FormSchemaHost",mixins:[N["FormComponent"]],data:function(){return{hosts:[],loading:!0}},methods:{showHosts:function(){this.refresh()},refresh:function(e){var t=this;this.loading=!0,Di(e,function(e){t.hosts=e,t.loading=!1})}},mounted:function(){}},Fi=Ei,Mi=(n("tMwa"),Object(h["a"])(Fi,Si,Ci,!1,null,"5e716427",null)),Ii=Mi.exports,Ti=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-schema-scope"},[e.schema.description?n("small",{staticClass:"form-schema-description"},[e._v(e._s(e.schema.description))]):e._e(),n("q-select",{attrs:{multiple:"","display-value":e.formattedModel.length?e.formattedModel.join(" "):"none",value:e.formattedModel,options:e.selectOptions,error:e.$v.value.$error},on:{input:e.formatValue}}),e.$v.value.$error?n("small",{staticClass:"form-schema-error"},[e._v(e._s(e.errorMessage))]):e._e()],1)},Qi=[];Ti._withStripped=!0,Object(N["registerForm"])(function(e){if("scope"===e.format)return"form-schema-scope"});var Vi={name:"FormSchemaScope",mixins:[N["FormComponent"]],data:function(){var e=[];for(var t in this.$meta.scopes){var n=this.$meta.scopes[t];e.push({label:t,value:t,sublabel:n.description})}return{selectOptions:e}},computed:{formattedModel:function(){return(this.model||"").split(" ").filter(function(e){return e.length})}},methods:{formatValue:function(e){e=e.join(" "),this.setValue(e)}}},Wi=Vi,Li=(n("1O/z"),Object(h["a"])(Wi,Ti,Qi,!1,null,"07e1bc78",null)),Ai=Li.exports,Bi=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-schema-serial-port"},[e.schema.description?n("small",{staticClass:"form-schema-description"},[e._v(e._s(e.schema.description))]):e._e(),n("div",{staticClass:"row"},[n("q-input",{staticClass:"col",attrs:{value:e.castedModel,error:e.$v.value.$error},on:{input:e.setValue}}),n("q-btn",{staticClass:"col-auto",attrs:{flat:"",color:"faded",icon:"search"}},[n("q-popover",{attrs:{anchor:"bottom right",self:"top right",fit:""},on:{show:e.show}},[n("div",{staticStyle:{width:"260px"}},[e.loading?n("div",{staticClass:"q-ma-md text-center text-faded"},[n("div",{staticClass:"q-ma-md"},[e._v("loading...")]),n("q-spinner-oval",{attrs:{color:"primary",size:"50px"}})],1):0===e.ports.length?n("div",{staticClass:"q-ma-md text-faded"},[e._v("no serial port found")]):n("q-list",{attrs:{separator:"",link:""}},[n("q-btn",{attrs:{flat:"",color:"faded",icon:"refresh",label:"refresh"},on:{click:function(t){e.refresh()}}}),e._l(e.ports,function(t,i){return n("q-item",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}],key:i,nativeOn:{click:function(n){e.setValue(t.device)}}},[n("q-item-main",[n("q-item-tile",{attrs:{label:""}},[e._v(e._s(t.device))]),t.product?n("q-item-tile",{attrs:{sublabel:""}},[e._v("product: "+e._s(t.product))]):e._e(),t.manufacturer?n("q-item-tile",{attrs:{sublabel:""}},[e._v("manufacturer: "+e._s(t.manufacturer))]):e._e(),t.description?n("q-item-tile",{attrs:{sublabel:""}},[e._v("description: "+e._s(t.description))]):e._e()],1)],1)})],2)],1)])],1)],1),e.$v.value.$error?n("small",{staticClass:"form-schema-error"},[e._v(e._s(e.errorMessage))]):e._e()])},Ri=[];Bi._withStripped=!0,Object(N["registerForm"])(function(e){if("serial"===e.format)return"form-schema-serial-port"});var Hi={name:"FormSchemaSerialPort",mixins:[N["FormComponent"]],data:function(){return{ports:[],loading:!0,loaded:!1}},methods:{show:function(){this.loaded||(this.loaded=!0),this.refresh()},refresh:function(){var e=this;this.loading=!0,q.a.request({url:"utils/serial_ports_list",dataType:"json"}).then(function(t){e.ports=t}).finally(function(){e.loading=!1})}}},zi=Hi,Pi=Object(h["a"])(zi,Bi,Ri,!1,null,null,null),Ui=Pi.exports,Ni=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-schema-week-calendar"},[e.schema.description?n("small",{staticClass:"form-schema-description"},[e._v(e._s(e.schema.description))]):e._e(),e.value&&e.value.length?n("div",e._l(e.value,function(t,i){return n("q-item",{key:i,attrs:{dense:""}},[n("q-item-side",{attrs:{icon:"schedule"}}),n("q-item-main",[n("q-item-tile",{attrs:{label:""}},[e._v(e._s(e.toString(t)))])],1)],1)})):n("div",{staticClass:"q-ma-md text-faded"},[e._v("\n    no scheduling\n  ")]),n("q-btn",{attrs:{color:"blue-5",label:"Select",icon:"add",flat:""},on:{click:function(t){e.modal=!0}}}),n("modal",{attrs:{title:"Scheduler",icon:"schedule","valid-btn-hide":"","cancel-btn-label":"Close","cancel-btn-color":"faded"},model:{value:e.modal,callback:function(t){e.modal=t},expression:"modal"}},[n("div",{staticClass:"overflow-hidden"},[n("div",{staticClass:"row gutter-xs non-selectable"},e._l(e.days,function(t){return n("div",{staticClass:"col day"},[n("div",{staticClass:"column"},[n("div",{staticClass:"col-auto header q-py-md text-center"},[n("span",{staticClass:"gt-xs"},[e._v(e._s(t.name))]),n("span",{staticClass:"xs"},[e._v(e._s(e.printSmall(t.name)))])]),e._l(t.hours,function(t){return n("div",{staticClass:"col-auto hour q-pa-xs",class:{selected:t.selected},on:{mousedown:function(n){e.select(t)},mouseover:function(n){e.mouseOver(n,t)},mouseup:e.updateValue}},[e._v("\n              "+e._s(t.index)+"\n            ")])})],2)])}))])])],1)},Yi=[];Ni._withStripped=!0;n("bHtr");Object(N["registerForm"])(function(e){if("week-calendar"===e.format)return"form-schema-week-calendar"});var Ki=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Ji={name:"FormSchemaWeekCalendar",mixins:[N["FormComponent"]],data:function(){return{days:this.fromValue(this.model),selectMode:!0,modal:!1}},methods:{select:function(e){e.selected=!e.selected,this.selectMode=e.selected},mouseOver:function(e,t){1===e.buttons&&(t.selected=this.selectMode)},updateValue:function(){var e=[];this.days.forEach(function(t,n){var i=n,r=!1,a=null;t.hours.forEach(function(t){t.selected!=r&&(t.selected?a={start:{weekDay:i,hour:t.index}}:(a.end={weekDay:i,hour:t.index},e.push(a),a=null)),r=t.selected}),a&&(a.end={weekDay:i,hour:24},e.push(a),a=null)}),this.setValue(e)},inSelection:function(e,t,n){var i=function(e,t){return 100*e+t};for(var r in e){var a=i(e[r].start.weekDay,e[r].start.hour),o=i(e[r].end.weekDay,e[r].end.hour),s=i(t,n);if(s>=a&&s<o)return!0}return!1},fromValue:function(e){var t=this,n=Ki.map(function(n,i){return{name:n,hours:Array(24).fill(0).map(function(n,r){return{index:r,selected:!!e&&t.inSelection(e,i,r)}})}});return n},toString:function(e){return e.start.weekDay===e.end.weekDay?Ki[e.start.weekDay]+" "+e.start.hour+"h - "+e.end.hour+"h":Ki[e.start.weekDay]+" "+e.start.hour+"h - "+Ki[e.end.weekDay]+" "+e.end.hour+"h"},printSmall:function(e){return e.substring(0,3)}},mounted:function(){this.updateValue()}},Gi=Ji,Xi=(n("P9YX"),Object(h["a"])(Gi,Ni,Yi,!1,null,"2ebe30c6",null)),Zi=Xi.exports,er=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-schema-scheduler"},[e.schema.description?n("small",{staticClass:"form-schema-description"},[e._v(e._s(e.schema.description))]):e._e(),e.value&&e.value.length?n("div",e._l(e.value,function(t,i){return n("q-item",{key:i,attrs:{dense:""}},[n("q-item-side",{attrs:{icon:"schedule"}}),n("q-item-main",[n("q-item-tile",{attrs:{label:""}},[e._v(e._s(e.toString(t)))])],1),n("q-item-side",{attrs:{right:""}},[n("q-btn",{attrs:{icon:"delete",round:"",flat:"",dense:"",color:"negative"},on:{click:function(t){e.value.splice(i,1)}}})],1)],1)})):n("div",{staticClass:"q-ma-md text-faded"},[e._v("\n    no scheduling\n  ")]),n("q-btn",{attrs:{color:"blue-5",label:"Add",icon:"add",flat:""},on:{click:function(t){e.modal=!0}}}),n("modal",{attrs:{title:"Scheduler",icon:"schedule","valid-btn-label":"add","cancel-btn-label":"Close","valid-btn-disable":e.itemError},on:{valid:e.add},model:{value:e.modal,callback:function(t){e.modal=t},expression:"modal"}},[n("form-schema",{attrs:{schema:e.itemSchema},on:{error:function(t){e.itemError=t}},model:{value:e.itemModel,callback:function(t){e.itemModel=t},expression:"itemModel"}})],1)],1)},tr=[];er._withStripped=!0,Object(N["registerForm"])(function(e){if("scheduler"===e.format)return"form-schema-scheduler"});var nr=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],ir={name:"FormSchemaScheduler",mixins:[N["FormComponent"]],data:function(){for(var e=[],t=1;t<=31;t++)e.push(t);return{modal:!1,itemSchema:{type:"object",additionalProperties:!1,required:["mode","start","end"],properties:{mode:{id:"FormSchemaScheduler.mode",enum:["daily","weekly","monthly"],default:"daily"},start:{type:"object",additionalProperties:!1,required:["weekday","monthday","time"],properties:{monthday:{label:"day of month",enum:e,dependencies:{"FormSchemaScheduler.mode":function(e,t,n){t.$set(t.parent().mutableSchema.properties.monthday,"_disabled","monthly"!==e)}}},weekday:{label:"week day",enum:[1,2,3,4,5,6,7],enumLabels:nr,dependencies:{"FormSchemaScheduler.mode":function(e,t,n){t.$set(t.parent().mutableSchema.properties.weekday,"_disabled","weekly"!==e)}}},time:{type:"string",format:"time"}}},end:{type:"object",additionalProperties:!1,required:["weekday","monthday","time"],properties:{monthday:{label:"day of month",enum:e,dependencies:{"FormSchemaScheduler.mode":function(e,t,n){t.$set(t.parent().mutableSchema.properties.monthday,"_disabled","monthly"!==e)}}},weekday:{label:"week day",enum:[1,2,3,4,5,6,7],enumLabels:nr,dependencies:{"FormSchemaScheduler.mode":function(e,t,n){t.$set(t.parent().mutableSchema.properties.weekday,"_disabled","weekly"!==e)}}},time:{type:"string",format:"time"}}}}},itemModel:{},itemError:!1}},methods:{toString:function(e){var t=e.mode,n=e.start,i=e.end;switch(t){case"daily":return"every day between "+n.hour+":"+n.minute+" and "+i.hour+":"+i.minute;case"weekly":return"between "+nr[n.weekday-1]+" "+n.hour+":"+n.minute+" and "+nr[i.weekday-1]+" "+i.hour+":"+i.minute;case"monthly":return"between "+n.monthday+this.dateSuffix(n.monthday)+" "+n.hour+":"+n.minute+" and "+i.monthday+this.dateSuffix(i.monthday)+" "+i.hour+":"+i.minute}return e.start.weekDay===e.end.weekDay?nr[e.start.weekDay]+" "+e.start.hour+"h - "+e.end.hour+"h":nr[e.start.weekDay]+" "+e.start.hour+"h - "+nr[e.end.weekDay]+" "+e.end.hour+"h"},dateSuffix:function(e){if(e<10||e>=20){if(e%=10,1==e)return"st";if(2==e)return"nd";if(3==e)return"rd"}return"th"},add:function(){var e=this.value?this.value.slice(0):[],t=Object(l["extend"])(!0,{},this.itemModel),n=new Date(t.start.time);delete t.start["time"],t.start["hour"]=n.getHours(),t.start["minute"]=n.getMinutes();var i=new Date(t.end.time);delete t.end["time"],t.end["hour"]=i.getHours(),t.end["minute"]=n.getMinutes(),e.push(t),this.setValue(e),this.modal=!1}}},rr=ir,ar=Object(h["a"])(rr,er,tr,!1,null,null,null),or=ar.exports,sr=function(e){e.app,e.router;var t=e.Vue;window.formSchema=N,t.component("FormSchema",gt),t.component("FormSchemaObject",St),t.component("FormSchemaArray",Et),t.component("FormSchemaString",Lt),t.component("FormSchemaNumber",Pt),t.component("FormSchemaBoolean",Gt),t.component("FormSchemaEnum",rn),t.component("FormSchemaDate",un),t.component("FormSchemaColor",vn),t.component("FormSchemaJson",kn),t.component("FormSchemaOptional",Mn),t.component("FormSchemaMultiType",An),t.component("FormSchemaNumberSlider",Un),t.component("FormSchemaFile",Zn),t.component("FormSchemaBluetoothInterface",ai),t.component("FormSchemaCron",Ce),t.component("FormSchemaEthingAction",di),t.component("FormSchemaEthingCondition",bi),t.component("FormSchemaEthingEvent",wi),t.component("FormSchemaEthingResource",G),t.component("FormSchemaHost",Ii),t.component("FormSchemaScope",Ai),t.component("FormSchemaSerialPort",Ui),t.component("FormSchemaWeekCalendar",Zi),t.component("FormSchemaScheduler",or),t.config.optionMergeStrategies.validations=t.config.optionMergeStrategies.data},lr=n("Hc5T"),cr=n.n(lr),ur=function(e){var t=e.Vue;t.use(cr.a)},dr=(n("a1vE"),n("pw5m")),mr=n.n(dr),hr=n("WtIr"),fr=n.n(hr),pr=n("jctj"),vr=n.n(pr);mr.a.registerLanguage("json",fr.a),mr.a.registerLanguage("xml",vr.a);var br={install:function(e){e.directive("highlightjs",{deep:!0,bind:function(e,t){var n,i,r=e.querySelectorAll("code");for(i=0;i<r.length;i+=1)n=r[i],"string"===typeof t.value&&(n.textContent=t.value),mr.a.highlightBlock(n)},componentUpdated:function(e,t){var n,i,r=e.querySelectorAll("code");for(i=0;i<r.length;i+=1)n=r[i],"string"===typeof t.value&&(n.textContent=t.value),mr.a.highlightBlock(n)}})}},gr=function(e){var t=e.Vue;t.use(br)};s["a"].config.productionTip=!0;var yr=o()({el:"#q-app",router:y,store:E},p),_r=[];_r.push(T),_r.push(W),_r.push(L),_r.push(st),_r.push(H),_r.push(Ue),_r.push(ft),_r.push(sr),_r.push(ur),_r.push(gr),_r.forEach(function(e){return e({app:yr,router:y,store:E,Vue:s["a"]})}),new s["a"](yr)},KL5P:function(e,t,n){"use strict";var i=n("qw4C"),r=n.n(i);r.a},LvdV:function(e,t,n){"use strict";var i=n("WUie"),r=n.n(i);r.a},"MS+v":function(e,t){},Mrzf:function(e,t,n){"use strict";var i=n("oDlV"),r=n.n(i);r.a},NJyr:function(e,t,n){"use strict";var i=n("SPze"),r=n.n(i);r.a},P9YX:function(e,t,n){"use strict";var i=n("mu6F"),r=n.n(i);r.a},PtDB:function(e,t,n){"use strict";var i=n("ax0v"),r=n.n(i);r.a},QAcJ:function(e,t,n){},QBV9:function(e,t,n){},RakF:function(e,t,n){"use strict";var i=n("iRK8"),r=n.n(i);r.a},SPze:function(e,t,n){},TnQi:function(e,t,n){},VwY0:function(e,t,n){"use strict";var i=n("Gwbd"),r=n.n(i);r.a},WUie:function(e,t,n){},"Z/Wj":function(e,t,n){"use strict";var i=n("mYX9"),r=n.n(i);r.a},ZL7j:function(e,t,n){"use strict";var i=n("usnz"),r=n.n(i);r.a},ZPX1:function(e,t,n){"use strict";var i=n("x5ly"),r=n.n(i);r.a},a1vE:function(e,t,n){},"ak/P":function(e,t,n){},ax0v:function(e,t,n){},bCyU:function(e,t,n){},bS65:function(e,t,n){},buvv:function(e,t,n){"use strict";var i=n("bCyU"),r=n.n(i);r.a},dFVy:function(e,t,n){"use strict";var i=n("QAcJ"),r=n.n(i);r.a},ddaK:function(e,t,n){},eUja:function(e,t,n){},ezf8:function(e,t,n){"use strict";var i=n("ddaK"),r=n.n(i);r.a},fm0S:function(e,t,n){},hZXq:function(e,t,n){},iRK8:function(e,t,n){},ieQ9:function(e,t,n){"use strict";var i=n("bS65"),r=n.n(i);r.a},jfJU:function(e,t,n){},ld4t:function(e,t,n){},m6lM:function(e,t,n){"use strict";var i=n("E1lG"),r=n.n(i);r.a},mYX9:function(e,t,n){},mu6F:function(e,t,n){},oDlV:function(e,t,n){},pBng:function(e,t,n){"use strict";var i=n("6NBf"),r=n.n(i);r.a},q4Oz:function(e,t,n){},qw4C:function(e,t,n){},"t/Xm":function(e,t,n){"use strict";var i,r,a={name:"WWidget",data:function(){return{error:!1}},watch:{error:function(e){console.log("err",e),this.$emit("error",e)}},methods:{setError:function(e){this.error=e}}},o=a,s=n("KHd+"),l=Object(s["a"])(o,i,r,!1,null,null,null),c=l.exports,u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"column"},[e.noHeader?e._e():n("div",{staticClass:"col-auto text-center text-faded"},[e._v("\n    "+e._s(e.title)+"\n    "),e._t("header")],2),n("div",{staticClass:"col relative-position"},[e._t("default")],2),e.noFooter?e._e():n("div",{staticClass:"col-auto text-center text-faded"},[e._t("footer")],2)])},d=[];u._withStripped=!0;var m,h,f={name:"WLayout",props:{title:String,noHeader:Boolean,noFooter:Boolean}},p=f,v=(n("zRAR"),Object(s["a"])(p,u,d,!1,null,"35fa24eb",null)),b=v.exports,g=n("QmqO"),y=n.n(g),_={name:"WResource",mixins:[c],props:["resource"],data:function(){return{}},computed:{r:function(){if(this.resource instanceof y.a.Resource)return this.resource;var e=this.$store.getters["ething/get"](this.resource);return e||this.setError("the resource does not exist anymore !"),e}}},x=_,$=Object(s["a"])(x,m,h,!1,null,null,null),w=$.exports,S=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("chart",{attrs:{preferences:e.r,history:e.history,expended:"",dense:"",readonly:""}})},C=[];S._withStripped=!0;var q=n("ApIF"),k={name:"WChart",components:{Chart:q["a"]},mixins:[w],props:{history:{default:86400}},meta:{name:"chart",minWidth:250,minHeight:150,options:{properties:{history:{description:"the past data to plot",type:"number",enum:[3600,21600,43200,86400,172800,604800,"all"],enumLabels:["1 hour","6 hours","12 hours","1 day","2 days","1 week","all"],default:86400}}}}},O=k,j=(n("BM+I"),Object(s["a"])(O,S,C,!1,null,"ff4039b6",null)),D=j.exports,E=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("image-viewer",{attrs:{source:e.r,"no-title":""}})},F=[];E._withStripped=!0;var M=n("5wDA"),I={name:"WCamera",components:{ImageViewer:M["a"]},mixins:[w],meta:{name:"image",minWidth:320,minHeight:280}},T=I,Q=(n("KL5P"),Object(s["a"])(T,E,F,!1,null,"9d630416",null)),V=Q.exports,W=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("w-device-layout",e._b({attrs:{resource:e.resource}},"w-device-layout",e.$attrs,!1),[n("div",{staticClass:"absolute-center"},[n("q-toggle",{attrs:{value:!!e.value,disable:e.reading||e.writing},on:{input:e.toggle}})],1)])},L=[];W._withStripped=!0;n("VRzm");function A(e,t){return new Promise(function(n,i){e.attr?n(t.attr(e.attr)):e.fn?t.execute(e.fn).then(function(e){n(e)}).catch(function(e){i(e)}):e.dataProp?n(t.data(e.dataProp)):i(new Error("invalid widget configuration"))})}var B,R,H={name:"WDeviceRead",mixins:[w],props:{fn:{},attr:{},dataProp:{}},data:function(){return{value:null,lastUpdate:null,reading:!1}},watch:{r:function(){(!this.lastUpdate||this.r.modifiedDate()>this.lastUpdate)&&this.update()}},methods:{read:function(){var e=this;this.reading=!0;var t=A(this,this.r);return t.finally(function(){e.reading=!1}),t},update:function(){var e=this;this.lastUpdate=this.r.modifiedDate(),this.read().then(function(t){e.value=t})}},mounted:function(){this.update()},read:A},z=H,P=Object(s["a"])(z,B,R,!1,null,null,null),U=P.exports;function N(e,t,n){var i=e.attr_setter,r=e.fn_setter,a=e.dataProp_setter;return i||r||a||(e.attr?i=e.attr:e.fn?r=e.fn:e.dataProp&&(a=e.dataProp)),new Promise(function(e,o){i?t.set({attr_setter:n}).then(function(){e()}).catch(function(e){o(e)}):r?t.execute(r,n).then(function(){e()}).catch(function(e){o(e)}):a?t.setData(a,n).then(function(){e()}).catch(function(e){o(e)}):o(new Error("invalid widget configuration"))})}var Y,K,J={name:"WDeviceReadWrite",mixins:[U],props:{fn_setter:{},attr_setter:{},dataProp_setter:{}},data:function(){return{writing:!1}},methods:{write:function(e){var t=this;this.writing=!0;var n=N(this,this.r,e);return n.finally(function(){t.writing=!1,t.update()}),n}},write:N},G=J,X=Object(s["a"])(G,Y,K,!1,null,null,null),Z=X.exports,ee=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("w-layout",e._b({},"w-layout",e.$attrs,!1),[n("div",{staticClass:"cursor-pointer",attrs:{slot:"header"},on:{click:function(t){e.$ui.open(e.r)}},slot:"header"},[e._v("\n    "+e._s(e.r.basename())+"\n  ")]),e._t("default"),n("small",{attrs:{slot:"footer"},slot:"footer"},[e._v("\n    "+e._s(e.date)+"\n  ")])],2)},te=[];ee._withStripped=!0;var ne={name:"WDeviceLayout",mixins:[w],components:{WLayout:b},computed:{date:function(){var e=this.r.lastSeenDate(),t=this.r.modifiedDate();return e&&e>t&&(t=e),this.$ui.dateToString(t)}}},ie=ne,re=(n("dFVy"),Object(s["a"])(ie,ee,te,!1,null,"b03681b4",null)),ae=re.exports,oe={name:"WSwitch",mixins:[Z],components:{WDeviceLayout:ae},methods:{toggle:function(e){var t=this;this.write(e).then(function(){t.setError(!1)}).catch(function(e){t.setError(e)})}},meta:{name:"switch",minWidth:60,minHeight:60}},se=oe,le=(n("I0l5"),Object(s["a"])(se,W,L,!1,null,"6218ba12",null)),ce=le.exports,ue=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("w-device-layout",e._b({attrs:{resource:e.resource}},"w-device-layout",e.$attrs,!1),[n("div",{staticClass:"absolute-center"},[n("span",{staticClass:"value"},[e._v("\n        "+e._s(null===e.value?"?":e.value)+"\n    ")]),e.unit?n("span",{staticClass:"unit"},[e._v("\n        "+e._s(e.unit)+"\n    ")]):e._e()])])},de=[];ue._withStripped=!0;var me={name:"WDeviceLabel",mixins:[U],components:{WDeviceLayout:ae},props:{unit:String},meta:{name:"label",minWidth:50,minHeight:50}},he=me,fe=(n("8olZ"),Object(s["a"])(he,ue,de,!1,null,"c65d6730",null)),pe=fe.exports,ve=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("w-device-layout",e._b({attrs:{resource:e.resource}},"w-device-layout",e.$attrs,!1),[n("div",{staticClass:"fit column items-center justify-center"},e._l(e.computedItems,function(t,i){return n("div",{key:i,staticClass:"col-auto"},[t.key?n("span",{staticClass:"key"},[e._v("\n          "+e._s(t.key)+" :\n      ")]):e._e(),n("span",{staticClass:"value"},[e._v("\n          "+e._s(t.value)+"\n      ")]),t.unit?n("span",{staticClass:"unit"},[e._v("\n          "+e._s(t.unit)+"\n      ")]):e._e()])}))])},be=[];ve._withStripped=!0;var ge={name:"WDeviceMultiLabel",mixins:[w],components:{WDeviceLayout:ae},props:{items:Array},data:function(){return{computedItems:[],lastUpdate:null}},watch:{r:function(){(!this.lastUpdate||this.r.modifiedDate()>this.lastUpdate)&&this.update()}},methods:{update:function(){var e=this;this.lastUpdate=this.r.modifiedDate(),this.computedItems=this.items.map(function(t){var n={key:t.key,unit:t.unit,value:"?"};return n.value="...",U.read(t,e.r).then(function(e){n.value=e}),n})}},mounted:function(){this.update()},meta:{name:"multilabel",minWidth:50,minHeight:50}},ye=ge,_e=(n("m6lM"),Object(s["a"])(ye,ve,be,!1,null,"2afa4a3a",null)),xe=_e.exports,$e=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("w-device-layout",e._b({attrs:{resource:e.resource}},"w-device-layout",e.$attrs,!1),[n("div",{staticClass:"absolute-center"},[n("q-knob",{attrs:{value:null===e.value?0:e.value,min:e.min,max:e.max,readonly:"",color:"primary"}},[e._v("\n      "+e._s(e.value)+" "),n("span",{staticClass:"unit"},[e._v(e._s(e.unit))])])],1)])},we=[];$e._withStripped=!0;n("xfY5");var Se={name:"WDeviceKnob",mixins:[U],components:{WDeviceLayout:ae},props:{unit:String,min:{type:Number,default:0},max:{type:Number,default:100}},meta:{name:"knob",minWidth:160,minHeight:160}},Ce=Se,qe=Object(s["a"])(Ce,$e,we,!1,null,null,null),ke=qe.exports,Oe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("image-viewer",{ref:"view",attrs:{source:e.source,"no-title":""}})},je=[];Oe._withStripped=!0;var De={name:"WImage",components:{ImageViewer:M["a"]},props:{refreshInterval:{default:30}},data:function(){return{timerId:null}},computed:{source:function(){return this.r.executeUrl("snapshot")}},mounted:function(){var e=this;this.timerId=setInterval(function(){e.$refs.view.refresh()},1e3*this.refreshInterval)},beforeDestroy:function(){null!==this.timerId&&clearInterval(this.timerId)},mixins:[w],meta:{name:"camera",minWidth:320,minHeight:280,options:{properties:{refreshInterval:{description:"set the refresh interval in seconds",type:"number",default:30}}}}},Ee=De,Fe=(n("AXcE"),Object(s["a"])(Ee,Oe,je,!1,null,"6b0c89ab",null)),Me=Fe.exports,Ie=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("w-device-layout",e._b({attrs:{resource:e.resource}},"w-device-layout",e.$attrs,!1),[n("div",{staticClass:"absolute-center"},[n("q-knob",{attrs:{value:e.value,min:e.min,max:e.max,disable:e.writing,color:"primary"},on:{change:e.setLevel}},[e._v("\n      "+e._s(e.value)+" "),n("span",{staticClass:"unit"},[e._v(e._s(e.unit))])])],1)])},Te=[];Ie._withStripped=!0;var Qe={name:"WDimmable",mixins:[Z],components:{WDeviceLayout:ae},props:{unit:String,min:{type:Number,default:0},max:{type:Number,default:100}},methods:{setLevel:function(e){var t=this;this.write(e).then(function(){t.setError(!1)}).catch(function(e){t.setError(e)})}},meta:{name:"qnob",minWidth:160,minHeight:160}},Ve=Qe,We=(n("+kVK"),Object(s["a"])(Ve,Ie,Te,!1,null,"16a0ab57",null)),Le=We.exports,Ae=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"column"},[e._l(e.inputs,function(t,i){return n("div",{key:i,staticClass:"col-auto q-ma-xs text-center"},[n("div",{staticClass:"text-faded"},[e._v(e._s(t.name))]),n(t.type,e._b({tag:"componant",model:{value:e.args[t.name],callback:function(n){e.$set(e.args,t.name,n)},expression:"args[input.name]"}},"componant",e.extractOptions(t),!1))],1)}),n("q-btn",{staticClass:"col",attrs:{flat:"",icon:e.icon,label:e.label,loading:e.loading,color:"primary"},on:{click:e.run}})],2)},Be=[];Ae._withStripped=!0;n("f3/d"),n("91GP");var Re=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.schema.description?n("small",{staticClass:"form-schema-description"},[e._v(e._s(e.schema.description))]):e._e(),n("form-schema",{attrs:{schema:e.rootSchema},on:{error:function(t){e.rootError=t}},model:{value:e.rootModel,callback:function(t){e.rootModel=t},expression:"rootModel"}}),null!==e.optionsSchema?n("div",{staticClass:"q-my-md"},[n("form-schema",{attrs:{schema:e.optionsSchema},on:{error:function(t){e.optionsError=t}},model:{value:e.optionsModel,callback:function(t){e.optionsModel=t},expression:"optionsModel"}})],1):e._e()],1)},He=[];Re._withStripped=!0;n("rGqo"),n("yt8O"),n("RW0V");var ze=n("9E6g"),Pe=n("Kw5r"),Ue=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-input",e._b({attrs:{type:"number",value:e.value},on:{input:function(t){e.$emit("input",t)}}},"q-input",e.$attrs,!1))},Ne=[];Ue._withStripped=!0;var Ye={name:"NumberInput",props:["value"],meta:{options:{properties:{min:{type:"number"},max:{type:"number"}}}}},Ke=Ye,Je=Object(s["a"])(Ke,Ue,Ne,!1,null,null,null),Ge=Je.exports,Xe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-input",e._b({attrs:{type:"text",value:e.value},on:{input:function(t){e.$emit("input",t)}}},"q-input",e.$attrs,!1))},Ze=[];Xe._withStripped=!0;var et={name:"StringInput",props:["value"]},tt=et,nt=Object(s["a"])(tt,Xe,Ze,!1,null,null,null),it=nt.exports,rt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-color",e._b({attrs:{value:e.value},on:{input:function(t){e.$emit("input",t)}}},"q-color",e.$attrs,!1))},at=[];rt._withStripped=!0;var ot={name:"ColorInput",props:["value"]},st=ot,lt=Object(s["a"])(st,rt,at,!1,null,null,null),ct=lt.exports,ut=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-slider",e._b({attrs:{value:e.value,label:""},on:{input:function(t){e.$emit("input",t)}}},"q-slider",e.$attrs,!1))},dt=[];ut._withStripped=!0;var mt={name:"SliderInput",props:{value:{default:0}},meta:{options:{properties:{min:{type:"number",required:!0},max:{type:"number",required:!0}}}}},ht=mt,ft=Object(s["a"])(ht,ut,dt,!1,null,null,null),pt=ft.exports,vt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-knob",e._b({attrs:{value:e.value,label:"",color:"primary"},on:{input:function(t){e.$emit("input",t)}}},"q-knob",e.$attrs,!1))},bt=[];vt._withStripped=!0;var gt={name:"KnobInput",props:{value:{default:0}},meta:{options:{properties:{min:{type:"number",required:!0},max:{type:"number",required:!0}}}}},yt=gt,_t=Object(s["a"])(yt,vt,bt,!1,null,null,null),xt=_t.exports,$t={number:Ge,string:it,color:ct,slider:pt,knob:xt};Object(ze["registerForm"])(function(e){if("script-input-item"===e.type)return"form-schema-script-input-item"});var wt={name:"FormSchemaScriptInputItem",mixins:[ze["FormComponent"]],data:function(){var e=Object.assign({},this.model),t=e.name,n=e.type;return delete e.name,delete e.type,{rootSchema:{type:"object",required:["name","type"],properties:{name:{type:"string",minLength:1,pattern:"^[-_0-9a-zA-Z]+$"},type:{enum:Object.keys($t)}}},rootModel:{name:t,type:n},rootError:!1,optionsSchema:null,optionsModel:{},optionsError:!1}},computed:{globalError:function(){return this.rootError||this.optionsError},globalModel:function(){return Object.assign({},this.rootModel,this.optionsModel)}},watch:{globalError:"setError",globalModel:"setValue","rootModel.type":{immediate:!0,handler:function(e){var t=e?$t[e]:null,n=null;t&&t.meta&&t.meta.options&&(n=t.meta.options),n=n&&0!==Object.keys(n).length?Object.assign({type:"object"},n):null,this.optionsModel={},this.optionsError=!1,this.optionsSchema=n}}}};Pe["a"].component("FormSchemaScriptInputItem",wt);var St,Ct,qt=wt,kt=qt,Ot=(n("7Ujp"),Object(s["a"])(kt,Re,He,!1,null,"2b968968",null)),jt=(Ot.exports,"run"),Dt={name:"WScript",mixins:[w],components:$t,props:{icon:String,label:{type:String,default:jt},arguments:String,inputs:{type:Array,default:function(){return[]}}},data:function(){return{loading:!1,args:{}}},methods:{run:function(){var e=this,t=this.arguments||"";if(this.args)for(var n in this.args){var i=this.args[n];"undefined"!==typeof i&&null!==i&&""!==i&&(t+=" --"+n+'="'+i+'"')}this.loading=!0,this.r.execute(t).then(function(t){t.ok?e.setError(!1):e.setError("error: "+t.stderr)}).catch(function(t){e.setError(t)}).finally(function(){e.loading=!1})},extractOptions:function(e){var t=Object.assign({},e);return delete t.name,delete t.type,t}},meta:{name:"button",minWidth:50,minHeight:50,options:{properties:{label:{type:"string",default:jt},arguments:{description:"the arguments to pass to the script",type:"string"},inputs:{description:"For dynamic arguments add some inputs",type:"array",items:{description:"This input will be transmitted to the script (through --<name>=<value>).",type:"script-input-item",required:["name","type"],properties:{name:{type:"string",minLength:1},type:{enum:["number","string"]}}},_label:function(e,t){return t.name+" ["+t.type+"]"}}}}}},Et=Dt,Ft=(n("PtDB"),Object(s["a"])(Et,Ae,Be,!1,null,"f4a84e58",null)),Mt=Ft.exports,It={name:"WGenericSensor",mixins:[xe],methods:{update:function(){this.lastUpdate=this.r.modifiedDate();var e=this.r.data(),t=[];for(var n in e)t.append({key:n,unit:null,value:e[n]});this.computedItems=t}},meta:{name:"WGenericSensor",minWidth:50,minHeight:50}},Tt=It,Qt=Object(s["a"])(Tt,St,Ct,!1,null,null,null),Vt=Qt.exports;t["a"]={WWidget:c,WLayout:b,WResource:w,WChart:D,WImage:V,WSwitch:ce,WDeviceLayout:ae,WDeviceRead:U,WDeviceReadWrite:Z,WDeviceLabel:pe,WDeviceMultiLabel:xe,WDeviceKnob:ke,WCamera:Me,WDimmable:Le,WScript:Mt,WGenericSensor:Vt}},tMwa:function(e,t,n){"use strict";var i=n("GnLr"),r=n.n(i);r.a},usnz:function(e,t,n){},vYdL:function(e,t,n){"use strict";var i=n("2sd5"),r=n.n(i);r.a},vgDZ:function(e,t,n){"use strict";var i=n("6X7v"),r=n.n(i);r.a},x5ly:function(e,t,n){},zRAR:function(e,t,n){"use strict";var i=n("jfJU"),r=n.n(i);r.a}},[[47,18,0]]]);