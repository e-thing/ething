(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{"0++J":function(t,e,a){},itLy:function(t,e,a){"use strict";var i=a("0++J"),s=a.n(i);s.a},oqN7:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",[a("q-table",{staticClass:"absolute fit scroll",attrs:{data:t.serverData,columns:t.columns,"row-key":"id","visible-columns":t.visibleColumns,loading:t.loading,pagination:t.serverPagination,selection:t.edit?"multiple":"none",selected:t.selected,color:"secondary"},on:{"update:pagination":function(e){t.serverPagination=e},request:t.request,"update:selected":function(e){t.selected=e}},scopedSlots:t._u([{key:"top-left",fn:function(e){return[a("div",{staticClass:"q-title q-title-opacity"},[t._v(t._s(t.resource.basename())+" "),t.createdBy?a("small",{staticClass:"cursor-pointer text-faded",on:{click:function(e){t.$ethingUI.open(t.createdBy)}}},[t._v(" - "+t._s(t.createdBy.basename()))]):t._e()])]}},{key:"top-right",fn:function(e){return[a("q-table-columns",{staticClass:"q-mr-sm",attrs:{color:"secondary",columns:t.columns},model:{value:t.visibleColumns,callback:function(e){t.visibleColumns=e},expression:"visibleColumns"}}),a("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"mdi-chart-line",color:"faded",disable:t.isEmpty},on:{click:function(e){t.$ethingUI.open(t.resource,"chart")}}}),a("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"mdi-information-outline",color:"faded",disable:t.isEmpty},on:{click:t.showStats}}),a("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"add",color:"faded"},on:{click:t.showAddRow}}),a("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"check_box",color:t.edit?"secondary":"faded",disable:t.isEmpty},on:{click:function(e){t.edit=!t.edit}}}),t.selected.length?a("q-btn",{attrs:{flat:"",round:"",dense:"",color:"negative",icon:"delete"},on:{click:t.removeSelection}}):t._e(),a("q-btn",{attrs:{flat:"",round:"",dense:"",color:e.inFullscreen?"secondary":"faded",icon:e.inFullscreen?"fullscreen_exit":"fullscreen"},on:{click:e.toggleFullscreen}})]}}])}),a("modal",{attrs:{title:"Statistics",icon:"mdi-information-outline","valid-btn-hide":"","cancel-btn-label":"Close","cancel-btn-color":"faded"},model:{value:t.modalStatistics,callback:function(e){t.modalStatistics=e},expression:"modalStatistics"}},[a("span",{attrs:{slot:"buttons"},slot:"buttons"},[a("q-btn",{attrs:{color:"faded",disable:t.loadingStatistics,label:"Reload",flat:""},on:{click:t.computeStats}})],1),t.loadingStatistics?a("div",{staticClass:"text-center q-mb-md"},[a("div",{staticClass:"q-pa-lg text-primary"},[t._v("loading...")]),a("q-spinner-oval",{attrs:{color:"primary",size:"50px"}})],1):null!==t.statistics?a("div",t._l(t.resource.keys(),function(e){return a("div",[a("div",{staticClass:"q-mb-md q-mt-lg q-title q-title-opacity"},[a("q-icon",{attrs:{name:"mdi-menu-right"}}),t._v(" column: "+t._s(e))],1),a("div",{staticClass:"row q-mb-md q-ml-lg"},[t.statistics[e]?a("div",[t._l(t.statistics[e],function(e,i){return[a("div",{staticClass:"col-xs-12 col-sm-4 key text-secondary"},[t._v(t._s(i))]),a("div",{staticClass:"col-xs-12 col-sm-8 value"},[t._v(t._s(t.format(i,e)))])]})],2):a("div",{staticClass:"text-faded"},[t._v("No data")])])])})):t._e()]),a("modal",{attrs:{title:"Insert data",icon:"add","valid-btn-label":"Add","valid-btn-disable":t.add.error,"valid-btn-loading":t.add.loading},on:{valid:t.addRow},model:{value:t.add.modal,callback:function(e){t.$set(t.add,"modal",e)},expression:"add.modal"}},[a("span",{attrs:{slot:"buttons"},slot:"buttons"},[a("q-btn",{staticClass:"float-right",attrs:{color:"primary",icon:"add",label:"add another column",flat:"",size:"md"},on:{click:t.addRowTmpl}})],1),a("div",t._l(t.add.data,function(e,i){return a("div",{key:i,staticClass:"q-my-lg add-row-item"},[a("q-field",{staticClass:"q-my-md",attrs:{error:t.$v.add.data.$each[i].key.$error,"error-label":"required"}},[a("q-input",{attrs:{"stack-label":"Column name"},on:{focus:function(e){t.addRowShowKeySuggestion(i)},blur:t.$v.add.data.$each[i].key.$touch},model:{value:e.key,callback:function(a){t.$set(e,"key","string"===typeof a?a.trim():a)},expression:"item.key"}},[a("q-autocomplete",{ref:"addRowKeyAutocomplete",refInFor:!0,attrs:{"min-characters":0,filter:t.addRowKeyFilter,"static-data":{field:"value",list:t.addRowListKeys()}},on:{selected:t.selected}})],1)],1),a("q-field",{staticClass:"q-my-md",attrs:{icon:"keyboard_arrow_right",label:"Type"}},[a("q-select",{attrs:{options:t.add.typeOptions},model:{value:e.type,callback:function(a){t.$set(e,"type",a)},expression:"item.type"}})],1),a("q-field",{staticClass:"q-my-md",attrs:{icon:"keyboard_arrow_right",label:"Value",error:t.$v.add.data.$each[i].value.$error,"error-label":"required"}},["string"===e.type?a("q-input",{on:{blur:t.$v.add.data.$each[i].value.$touch},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}}):"number"===e.type?a("q-input",{attrs:{type:"number"},on:{blur:t.$v.add.data.$each[i].value.$touch},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}}):"boolean"===e.type?a("q-select",{attrs:{options:[{label:"True",value:!0},{label:"False",value:!1}]},on:{blur:t.$v.add.data.$each[i].value.$touch},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}}):t._e()],1)],1)})),t.add.error?a("q-alert",{staticClass:"q-my-md",attrs:{type:"negative"}},[t._v("\n      "+t._s(String(t.add.error))+"\n    ")]):t._e()],1)],1)},s=[];i._withStripped=!0;a("RW0V"),a("VRzm");var n=a("cDf5"),o=a.n(n),l=(a("91GP"),a("rGqo"),a("yt8O"),a("pIFo"),a("9JDm")),r=a("ta7f"),d={name:"PageTable",data:function(){return{loading:!0,serverPagination:{rowsPerPage:10,page:1,sortBy:"date",descending:!0,rowsNumber:0},serverData:[],filter:"",visibleColumns:["date"],edit:!1,selected:[],loadingStatistics:!1,statistics:null,modalStatistics:!1,add:{modal:!1,error:!1,data:[],typeOptions:["string","number","boolean"].map(function(t){return{label:t,value:t}})}}},validations:function(){return{add:{data:{$each:{key:{required:r["required"]},value:{required:r["required"]}}}}}},computed:{resource:function(){var t=this.$route.params.id,e=this.$store.getters["ething/get"](t);return t&&t.length&&(e||this.$router.replace("/404")),this.serverPagination.rowsNumber=e.length(),this.visibleColumns=["date"].concat(e.keys()),e},columns:function(){var t=this.resource,e=[],a={align:"left"};return t&&(e=t.keys().map(function(t){return Object.assign({},a,{name:t,label:t,field:t})})),e.unshift(Object.assign({},a,{name:"date",label:"date",field:"date",sortable:!0,format:function(t){return l["d"].formatDate(t,"YYYY-MM-DD HH:mm:ss")}})),e.unshift(Object.assign({},a,{name:"id",label:"id",field:"id"})),e},createdBy:function(){return this.$ething.arbo.get(this.resource.createdBy())},isEmpty:function(){return 0===this.serverData.length}},watch:{resource:function(t,e){t&&t.contentModifiedDate()>this.contentModifiedDate&&this.reloadData()},"add.data":{handler:function(t,e){t.forEach(function(t){if(o()(t.value)!=t.type)switch(t.type){case"boolean":t.value=!!t.value;break;case"string":t.value=String(t.value);break;case"number":t.value=0;break}})},deep:!0}},methods:{request:function(t){var e=this,a=t.pagination;t.filter;this.resource&&(this.loading=!0,this.contentModifiedDate=this.resource.contentModifiedDate(),this.resource.select({sort:(a.descending?"-":"+")+a.sortBy,start:(a.page-1)*a.rowsPerPage,length:a.rowsPerPage}).then(function(t){e.serverPagination=a,e.serverData=t,e.loading=!1}).catch(function(t){}).finally(function(){e.loading=!1}))},reloadData:function(){this.request({pagination:this.serverPagination,filter:this.filter})},removeSelection:function(){var t=this;this.selected.length&&(this.loading=!0,this.resource.removeRow(this.selected.map(function(t){return t.id})).finally(function(){t.loading=!1,t.selected=[]}))},showStats:function(){null===this.statistics&&this.computeStats(),this.modalStatistics=!0},computeStats:function(){var t=this;this.loadingStatistics=!0,this.statistics={};var e=this.resource.keys().map(function(e){return t.resource.computeStatistics(e).then(function(a){t.statistics[e]=a})});Promise.all(e).finally(function(){t.loadingStatistics=!1})},showAddRow:function(){0===this.add.data.length&&this.addRowTmpl(),this.add.modal=!0},addRowTmpl:function(){var t=this.resource.keys();this.add.data.push({key:t.length?t[0]:"",type:"number",value:0})},addRowListKeys:function(){return this.resource.keys().map(function(t){return{label:t,value:t}})},addRowKeyFilter:function(t,e){e.field;var a=e.list;return a},addRowShowKeySuggestion:function(t){this.$refs["addRowKeyAutocomplete"][t].trigger()},addRow:function(){var t=this,e={};this.add.data.forEach(function(t){if(t.key){var a=t.value;"number"===t.type&&(a=parseFloat(a)),e[t.key]=a}}),Object.keys(e).length>0&&(this.add.loading=!0,this.resource.insert(e).then(function(){t.add.error=!1,t.add.modal=!1}).catch(function(e){t.add.error=e}).finally(function(){t.add.loading=!1}))},format:function(t,e){if(/date/i.test(t)){var a=new Date(e);e=l["d"].formatDate(a,"YYYY-MM-DD HH:mm:ss")}return e}},mounted:function(){this.reloadData()}},c=d,u=(a("itLy"),a("KHd+")),m=Object(u["a"])(c,i,s,!1,null,"0de844e8",null);m.options.__file="Table.vue";e["default"]=m.exports}}]);