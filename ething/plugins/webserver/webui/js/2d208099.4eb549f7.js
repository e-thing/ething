(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["2d208099"],{a2a3:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",[a("div",{staticClass:"page-fit scroll"},[a("q-table",{staticClass:"page-block",attrs:{data:t.serverData,columns:t.columns,"row-key":"id","visible-columns":t.visibleColumns,loading:t.loading,pagination:t.serverPagination,selection:t.edit?"multiple":"none",selected:t.selected,color:"secondary"},on:{"update:pagination":function(e){t.serverPagination=e},request:t.request,"update:selected":function(e){t.selected=e}},scopedSlots:t._u([{key:"top-left",fn:function(e){return[a("div",{staticClass:"text-h6"},[t._v(t._s(t.resource.basename())+" "),t.createdBy?a("small",{staticClass:"cursor-pointer text-faded",on:{click:function(e){return t.$ethingUI.open(t.createdBy)}}},[t._v(" - "+t._s(t.createdBy.basename()))]):t._e()])]}},{key:"top-right",fn:function(e){return[a("q-select",{attrs:{multiple:"",borderless:"",dense:"","options-dense":"","display-value":"Columns","emit-value":"","map-options":"",options:t.columns,"option-value":"name",color:"faded"},model:{value:t.visibleColumns,callback:function(e){t.visibleColumns=e},expression:"visibleColumns"}}),a("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"mdi-chart-line",color:"faded",disable:t.isEmpty},on:{click:function(e){return t.$ethingUI.open(t.resource,"chart")}}}),a("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"mdi-information-outline",color:"faded",disable:t.isEmpty},on:{click:t.showStats}}),a("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"mdi-filter",color:t.filter?"secondary":"faded"},on:{click:t.showFilter}}),a("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"add",color:"faded"},on:{click:t.showAddRow}}),a("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"check_box",color:t.edit?"secondary":"faded",disable:t.isEmpty},on:{click:function(e){t.edit=!t.edit}}}),t.selected.length?a("q-btn",{attrs:{flat:"",round:"",dense:"",color:"negative",icon:"delete"},on:{click:t.removeSelection}}):t._e(),a("q-btn",{attrs:{flat:"",round:"",dense:"",color:e.inFullscreen?"secondary":"faded",icon:e.inFullscreen?"fullscreen_exit":"fullscreen"},on:{click:e.toggleFullscreen}})]}}])})],1),a("modal",{attrs:{title:"Statistics",icon:"mdi-information-outline","valid-btn-hide":"","cancel-btn-label":"Close","cancel-btn-color":"faded"},model:{value:t.modalStatistics,callback:function(e){t.modalStatistics=e},expression:"modalStatistics"}},[a("span",{attrs:{slot:"buttons"},slot:"buttons"},[a("q-btn",{attrs:{color:"faded",disable:t.loadingStatistics,label:"Reload",flat:""},on:{click:t.computeStats}})],1),t.loadingStatistics?a("div",{staticClass:"text-center q-mb-md"},[a("div",{staticClass:"q-pa-lg text-primary"},[t._v("loading...")]),a("q-spinner-oval",{attrs:{color:"primary",size:"50px"}})],1):null!==t.statistics?a("div",t._l(t.resource.keys(),function(e){return a("div",[a("div",{staticClass:"q-mb-md q-mt-lg text-h6"},[a("q-icon",{attrs:{name:"mdi-menu-right"}}),t._v(" column: "+t._s(e))],1),a("div",{staticClass:"q-mb-md q-ml-lg"},[t.statistics[e]?a("div",{staticClass:"row"},[t._l(t.statistics[e],function(e,i){return null!==e?[a("div",{staticClass:"col-xs-12 col-sm-4 key text-secondary"},[t._v(t._s(i))]),a("div",{staticClass:"col-xs-12 col-sm-8 value"},[t._v(t._s(t.format(i,e)))])]:t._e()})],2):a("div",{staticClass:"text-faded"},[t._v("No data")])])])}),0):t._e()]),a("modal",{attrs:{title:"Insert data",icon:"add","valid-btn-label":"Add","valid-btn-disable":t.add.error,"valid-btn-loading":t.add.loading},on:{valid:t.addRow},model:{value:t.add.modal,callback:function(e){t.$set(t.add,"modal",e)},expression:"add.modal"}},[a("span",{attrs:{slot:"buttons-right"},slot:"buttons-right"},[a("q-btn",{attrs:{color:"primary",icon:"add",label:"add another column",flat:"",size:"md"},on:{click:t.addRowTmpl}})],1),a("q-card",{attrs:{flat:""}},[t._l(t.add.data,function(e,i){return a("q-card-section",{key:i},[a("q-select",{attrs:{"use-input":"","input-debounce":"0",options:t.resource.keys()},on:{"new-value":t.createColumnValue},model:{value:e.key,callback:function(a){t.$set(e,"key","string"===typeof a?a.trim():a)},expression:"item.key"}}),a("q-select",{attrs:{options:t.add.typeOptions,label:"Type","emit-value":""},model:{value:e.type,callback:function(a){t.$set(e,"type",a)},expression:"item.type"}}),"string"===e.type?a("q-input",{attrs:{label:"Value"},on:{blur:t.$v.add.data.$each[i].value.$touch},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}}):"number"===e.type?a("q-input",{attrs:{type:"number",label:"Value"},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}}):"boolean"===e.type?a("q-select",{attrs:{options:[{label:"True",value:!0},{label:"False",value:!1}],label:"Value"},on:{blur:t.$v.add.data.$each[i].value.$touch},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}}):t._e()],1)}),a("q-card-section",[t.add.error?a("q-banner",{staticClass:"bg-negative text-white"},[a("q-icon",{attrs:{left:"",name:"mdi-alert"}}),t._v(" "+t._s(String(t.add.error))+"\n        ")],1):t._e()],1)],2)],1),a("modal",{attrs:{title:"Filter",icon:"mdi-filter","valid-btn-label":"Filter"},on:{valid:t.validFilter},model:{value:t.filterModal,callback:function(e){t.filterModal=e},expression:"filterModal"}},[a("q-card",[a("q-card-section",[t._v("\n        Enter an ObjectPath expression to filter the data.\n        See "),a("a",{attrs:{href:"http://objectpath.org",target:"_blank"}},[t._v("ObjectPath website")]),t._v(" for more details.\n      ")]),a("q-card-section",[a("q-input",{attrs:{placeholder:"$.temperature > 20 ..."},model:{value:t.filterModel,callback:function(e){t.filterModel=e},expression:"filterModel"}})],1),a("q-card-section",[a("h6",[t._v("Examples")]),a("p",{staticClass:"caption"},[t._v("Comparison operators")]),a("pre",[t._v("$.temperature is 20")]),a("pre",[t._v("$.temperature is not 20")]),a("pre",[t._v("$.temperature > 20")]),a("p",{staticClass:"caption"},[t._v("Boolean logic operators")]),a("pre",[t._v("$.temperature > 10 and $.temperature < 20")]),a("pre",[t._v("$.state is 'foo' or $.state is 'bar'")]),a("p",{staticClass:"caption"},[t._v("Membership")]),a("pre",[t._v("$.state in ['foo', 'bar']")]),a("pre",[t._v("$.state not in ['foo', 'bar']")])])],1)],1)],1)},n=[],s=(a("456d"),a("5df3"),a("551c"),a("097d"),a("6762"),a("2fdb"),a("8993")),o=a.n(s),l=(a("f751"),a("ac6a"),a("cadf"),a("06db"),a("a481"),a("bd4c")),r={name:"PageTable",data:function(){return{loading:!0,serverPagination:{rowsPerPage:10,page:1,sortBy:"date",descending:!0,rowsNumber:0},serverData:[],visibleColumns:["date"],edit:!1,selected:[],loadingStatistics:!1,statistics:null,modalStatistics:!1,add:{modal:!1,error:!1,data:[],typeOptions:["string","number","boolean"].map(function(t){return{label:t,value:t}})},filter:"",filterModal:!1,filterModel:""}},computed:{resource:function(){var t=this.$route.params.id,e=this.$ething.arbo.get(t);return t&&t.length&&(e||this.$router.replace("/404")),this.filter||(this.serverPagination.rowsNumber=e.length()),this.visibleColumns=["date"].concat(e.keys()),e},columns:function(){var t=this.resource,e=[],a={align:"left"};return t&&(e=t.keys().map(function(t){return Object.assign({},a,{name:t,label:t,field:t})})),e.unshift(Object.assign({},a,{name:"date",label:"date",field:"date",sortable:!0,format:function(t){return l["b"].formatDate(t,"YYYY-MM-DD HH:mm:ss")}})),e.unshift(Object.assign({},a,{name:"id",label:"id",field:"id"})),e},createdBy:function(){return this.$ething.arbo.get(this.resource.createdBy())},isEmpty:function(){return 0===this.serverData.length}},watch:{resource:function(t,e){t&&t.contentModifiedDate()>this.contentModifiedDate&&this.reloadData()},filter:function(t,e){this.serverPagination.rowsNumber=this.resource.length()},"add.data":{handler:function(t,e){t.forEach(function(t){if(o()(t.value)!=t.type)switch(t.type){case"boolean":t.value=!!t.value;break;case"string":t.value=String(t.value);break;case"number":t.value=0;break}})},deep:!0}},methods:{createColumnValue:function(t,e){t.length>0&&(this.resource.keys().includes(t)||e(t,"add-unique"))},request:function(t,e,a){var i=this,n=t.pagination,s=t.filter;if(this.resource){this.loading=!0,this.contentModifiedDate=this.resource.contentModifiedDate();var o=n.rowsPerPage,l=n.page;this.resource.select({sort:(n.descending?"-":"+")+n.sortBy,start:(n.page-1)*n.rowsPerPage,length:n.rowsPerPage,query:s||this.filter}).then(function(t){if(t.length<o){var a=(l-1)*o+t.length;n.rowsNumber=a}i.serverPagination=n,i.serverData=t,e&&e()}).catch(function(t){i.$q.dialog({title:"Error",message:"an error occurs: "+String(t),color:"negative"}),a&&a(t)}).finally(function(){i.loading=!1})}},reloadData:function(t,e){this.request({pagination:this.serverPagination},t,e)},removeSelection:function(){var t=this;this.selected.length&&(this.loading=!0,this.resource.removeRow(this.selected.map(function(t){return t.id})).finally(function(){t.loading=!1,t.selected=[]}))},showStats:function(){null===this.statistics&&this.computeStats(),this.modalStatistics=!0},showFilter:function(){this.filterModal=!0},validFilter:function(){var t=this;this.filter=this.filterModel.trim(),this.filterModal=!1,this.reloadData(null,function(e){t.filter=""})},computeStats:function(){var t=this;this.loadingStatistics=!0,this.statistics={};var e=this.resource.keys().map(function(e){return t.resource.computeStatistics(e).then(function(a){t.statistics[e]=a})});Promise.all(e).finally(function(){t.loadingStatistics=!1})},showAddRow:function(){0===this.add.data.length&&this.addRowTmpl(),this.add.modal=!0},addRowTmpl:function(){var t=this.resource.keys();this.add.data.push({key:t.length?t[0]:"",type:"number",value:0})},addRow:function(){var t=this,e={};this.add.data.forEach(function(t){if(t.key){var a=t.value;"number"===t.type&&(a=parseFloat(a)),e[t.key]=a}}),Object.keys(e).length>0&&(this.add.loading=!0,this.resource.insert(e).then(function(){t.add.error=!1,t.add.modal=!1}).catch(function(e){t.add.error=e}).finally(function(){t.add.loading=!1}))},format:function(t,e){if(/date/i.test(t)){var a=new Date(e);e=l["b"].formatDate(a,"YYYY-MM-DD HH:mm:ss")}return e}},mounted:function(){this.reloadData()}},c=r,d=a("2877"),u=Object(d["a"])(c,i,n,!1,null,"10814af0",null);e["default"]=u.exports}}]);