(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["21d982da"],{1902:function(t,e,s){"use strict";var n=s("9595"),i=s.n(n);i.a},"68cf":function(t,e,s){"use strict";var n=s("f8c8"),i=s.n(n);i.a},"8fac":function(t,e,s){"use strict";s.r(e);var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-page",{staticClass:"page"},[s("q-tabs",{staticClass:"text-secondary",model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[s("q-tab",{attrs:{label:"settings",name:"settings",icon:"settings"}}),s("q-tab",{attrs:{label:"api key",name:"apikey",icon:"mdi-key"}}),s("q-tab",{attrs:{label:"plugins",name:"plugins",icon:"mdi-puzzle"}}),s("q-tab",{attrs:{label:"clients",name:"clients",icon:"mdi-lan-connect"}}),s("q-tab",{attrs:{label:"about",name:"about",icon:"info"}})],1),s("q-tab-panels",{staticClass:"bg-transparent",model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[s("q-tab-panel",{staticClass:"pane",attrs:{name:"settings"}},[s("settings-view")],1),s("q-tab-panel",{staticClass:"pane",attrs:{name:"apikey"}},[s("apikey-view")],1),s("q-tab-panel",{staticClass:"pane",attrs:{name:"plugins"}},[s("plugins-view")],1),s("q-tab-panel",{staticClass:"pane",attrs:{name:"clients"}},[s("clients-view")],1),s("q-tab-panel",{staticClass:"pane",attrs:{name:"about"}},[s("about-view")],1)],1)],1)},i=[],a=(s("7f7f"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"center-width-md q-gutter-y-md q-py-md q-px-sm"},[s("div",{staticClass:"bg-white q-pa-md"},[s("div",{staticClass:"text-h6 text-secondary"},[t._v("General")]),s("form-schema",{staticClass:"q-my-md",attrs:{schema:t.$ethingUI.get("Config")},on:{error:function(e){t.error=e}},model:{value:t.settings,callback:function(e){t.settings=e},expression:"settings"}})],1),t._l(t.plugins,(function(e){return e.show?s("div",{key:e.type,staticClass:"bg-white q-pa-md"},[s("div",{staticClass:"text-h6 text-secondary"},[t._v(t._s(e.name))]),e.meta.description?s("div",{staticClass:"text-faded q-mt-md"},[s("q-markdown",[t._v(t._s(e.meta.description.trim()))])],1):t._e(),e.components?t._l(e.components,(function(t,e){return s("dynamic-component",{key:e,staticClass:"q-mt-md",attrs:{component:t}})})):t._e(),e.hasAttr?s("div",{staticClass:"text-faded q-mt-md"},t._l(e.attr,(function(e,n){return s("div",{key:n},[t._v("\n        "+t._s(n)+" : "+t._s(e)+"\n      ")])})),0):t._e(),e.hasSettings?[s("form-schema",{staticClass:"q-my-md",attrs:{schema:e.schema},on:{error:function(t){e.error=t}},model:{value:e.settings,callback:function(s){t.$set(e,"settings",s)},expression:"plugin.settings"}})]:t._e(),e.hasMethods?[s("entity-api",{staticClass:"q-mt-md",attrs:{entity:e.instance}})]:t._e()],2):t._e()})),t.saveError?s("q-banner",{staticClass:"bg-negative text-white"},[s("q-icon",{attrs:{left:"",name:"mdi-alert"}}),t._v(" "+t._s(String(t.saveError))+"\n  ")],1):t._e(),s("div",[s("q-btn",{class:t.$q.screen.xs?"q-ml-md":"",attrs:{disable:t.globalError,loading:t.saving,color:"secondary",icon:"done",label:"save changes"},on:{click:t.onSave}})],1)],2)}),r=[],o=(s("5df3"),s("551c"),s("097d"),s("f751"),s("456d"),s("ac6a"),s("cadf"),s("06db"),s("8615"),s("11ec")),c={name:"SettingsView",data:function(){var t=this,e=this.$ethingUI.plugins.map((function(e){var s=t.$ethingUI.get(e),n=Object.values(s.components),i={name:e.name(),type:e.type(),instance:e,meta:s,show:!1};if(s&&Object.keys(s.properties).length){var a=Object.assign({},s.schema);delete a.description;var r,o={},c={};for(r in s.properties)s.properties[r]["$readOnly"]?c[r]=e.attr(r):o[r]=e.attr(r);Object.assign(i,{error:!1,show:!0,schema:a,settings:o,hasSettings:Object.keys(o).length>0,attr:c,hasAttr:Object.keys(c).length>0})}return n.length&&Object.assign(i,{components:n,show:!0}),i.hasMethods=Object.keys(s.methods).length>0,i}));return{saving:!1,error:!1,saveError:!1,settings:{},plugins:e}},computed:{globalError:function(){var t=this.error;if(!t)for(var e in this.plugins){this.plugins[e].error&&(t=!0);break}return t}},methods:{load:function(){this.settings=Object(o["a"])(!0,{},this.$ethingUI.settings)},onSave:function(){var t=this;this.saving=!0,this.saveError=!1;var e=[];e.push(this.$ething.settings.set(this.settings)),this.plugins.forEach((function(t){t.settings&&e.push(t.instance.set(t.settings))})),Promise.all(e).then((function(){t.$q.notify({icon:"done",color:"positive",message:"Changes applied",timeout:1500})})).catch((function(e){t.saveError=e})).finally((function(){t.saving=!1}))}},mounted:function(){this.load()}},l=c,d=(s("1902"),s("2877")),u=Object(d["a"])(l,a,r,!1,null,"b4382e44",null),m=u.exports,v=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"center-width-md q-gutter-y-md q-py-md q-px-sm"},[!1===t.loading?[t._m(0),s("div",[s("q-btn",{attrs:{icon:"add",label:"API key",color:"secondary"},on:{click:function(e){return t.create()}}})],1),t.apikeys.length>0?s("div",{staticClass:"bg-white q-pa-md"},[t._m(1),t._l(t.apikeys,(function(e){return s("div",{key:e.id,staticClass:"item row items-center q-gutter-x-sm q-mt-md"},[s("div",{staticClass:"date col-xs-2 col-sm-2 col-md-2 text-faded ellipsis"},[t._v("\n          "+t._s(e.name)+"\n        ")]),s("div",{staticClass:"date col-xs-0 col-sm-0 col-md-2 text-faded ellipsis"},[t._v("\n          "+t._s(t.$ethingUI.utils.dateToString(e.modifiedDate))+"\n        ")]),s("div",{staticClass:"key col col-sm-5 col-md-5 col-lg-5"},[t._v("\n          "+t._s(e.value)+"\n        ")]),s("div",{staticClass:"scope col gt-xs text-faded ellipsis"},t._l(t.splitScopes(e.scope),(function(e){return s("div",[t._v("\n            "+t._s(e)+"\n          ")])})),0),s("div",{staticClass:"controls col-auto"},[s("q-btn",{attrs:{icon:"settings",round:"",flat:"",dense:"",color:"faded"},on:{click:function(s){return t.edit(e)}}}),s("q-btn",{attrs:{icon:"delete",round:"",flat:"",dense:"",color:"negative"},on:{click:function(s){return t.remove(e)}}})],1)])}))],2):t._e()]:s("div",[t._v("loading ...")]),s("modal",{attrs:{title:t.editing?"Edit API key":"Create a new API key",icon:"mdi-key","valid-btn-label":t.editing?"Edit":"Create","cancel-btn-label":"Cancel","valid-btn-disable":t.error||t.addLoading},on:{valid:t.add},model:{value:t.modal,callback:function(e){t.modal=e},expression:"modal"}},[s("form-schema",{key:t.formKey,attrs:{schema:t.schema},on:{error:function(e){t.error=e}},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}}),t.serverError?s("q-banner",{staticClass:"bg-negative text-white q-mb-xl"},[s("q-icon",{attrs:{left:"",name:"mdi-alert"}}),t._v(" "+t._s(String(t.serverError))+"\n    ")],1):t._e()],1)],2)},p=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"bg-white q-pa-md"},[t._v("\n      Control your EThing instance via the "),s("a",{attrs:{href:"https://ething.readthedocs.io/en/latest/http_api.html",target:"_blank"}},[t._v("HTTP API")]),t._v(".\n    ")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"item row items-center q-gutter-x-sm"},[s("div",{staticClass:"name col-xs-2 col-sm-2 col-md-2 text-secondary ellipsis"},[t._v("\n          name\n        ")]),s("div",{staticClass:"date col-xs-0 col-sm-0 col-md-2 text-secondary ellipsis"},[t._v("\n          date\n        ")]),s("div",{staticClass:"key col col-sm-5 col-md-5 col-lg-5 text-secondary"},[t._v("\n          value\n        ")]),s("div",{staticClass:"scope col gt-xs text-secondary"},[t._v("\n          scope\n        ")])])}],g=(s("28a5"),s("20d6"),{name:"ApikeyView",data:function(){return{loading:!0,apikeys:[],formKey:0,schema:{type:"object",additionalProperties:!1,required:["name"],properties:{name:{type:"string",minLength:1},scope:{type:"string",$component:"scope",default:""}}},model:{},error:!1,modal:!1,addLoading:!1,serverError:!1,editing:!1}},methods:{load:function(){var t=this;this.loading=!0,EThing.request({url:"apikey",dataType:"json"}).then((function(e){t.apikeys=e,t.loading=!1})).catch((function(t){console.error(t)}))},reset:function(){this.serverError=!1,this.error=!1,this.model={},this.editing=!1,this.formKey++},add:function(){var t=this,e=Object.assign({},this.model);this.addLoading=!0,this.serverError=!1,EThing.request({method:this.editing?"PATCH":"POST",url:this.editing?"apikey/"+this.editing.id:"apikey",dataType:"json",data:e}).then((function(e){var s=t.apikeys||[],n=!1;for(var i in s)if(s[i].id==e.id){s[i]=e,n=!0;break}n||s.push(e),t.apikeys=s,t.modal=!1})).catch((function(e){t.serverError=e})).finally((function(){t.addLoading=!1}))},create:function(){this.reset(),this.modal=!0},edit:function(t){this.reset(),this.model=Object.assign({},t),this.editing=t,this.modal=!0},remove:function(t){var e=this;EThing.request({method:"DELETE",url:"apikey/"+t.id}).then((function(){var s=e.apikeys.findIndex((function(e){return e.id===t.id}));-1!==s&&e.apikeys.splice(s,1)})).catch((function(t){console.error(t)}))},splitScopes:function(t){return t.split(" ")}},mounted:function(){this.load()}}),h=g,f=Object(d["a"])(h,v,p,!1,null,null,null),_=f.exports,b=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"center-width-sm q-gutter-y-md q-py-md q-px-sm"},[s("div",{staticClass:"bg-white q-pa-md"},[s("div",{staticClass:"text-h6 q-mb-md"},[t._v("Installed")]),t.installedPlugins.length>0?s("div",t._l(t.installedPlugins,(function(e){return s("q-card",{key:e.name,staticClass:"q-my-sm bg-secondary text-white"},[s("q-card-section",[s("div",{staticClass:"row items-center no-wrap"},[s("div",{staticClass:"col"},[s("div",{staticClass:"text-h6"},[t._v("\n                "+t._s(e.name)+"\n              ")])]),s("div",{staticClass:"col-auto"},[e.package.version?s("q-badge",{attrs:{color:"white","text-color":"secondary"}},[t._v("version: "+t._s(e.package.version))]):t._e()],1)])]),s("q-card-section",[t._v("\n          "+t._s(e.package.summary||"no description")+"\n        ")])],1)})),1):s("div",{staticClass:"text-faded"},[t._v("\n      No plugin installed !\n    ")])]),t.localPlugins.length>0?s("div",{staticClass:"bg-white q-pa-md"},[s("div",{staticClass:"text-h6 q-mb-md"},[t._v("Local")]),t._l(t.localPlugins,(function(e){return s("q-card",{key:e.name,staticClass:"q-my-sm bg-secondary text-white"},[s("q-card-section",[s("div",{staticClass:"row items-center no-wrap"},[s("div",{staticClass:"col"},[s("div",{staticClass:"text-h6"},[t._v("\n              "+t._s(e.name)+" "),e.version?s("span",{attrs:{slot:"subtitle"},slot:"subtitle"},[t._v("version: "+t._s(e.version))]):t._e()])]),s("div",{staticClass:"col-auto"},[s("q-icon",{attrs:{slot:"right",name:"mdi-puzzle"},slot:"right"})],1)])]),s("q-card-section",[t._v("\n        location: "+t._s(e.package.location)+"\n      ")]),e.description?s("q-card-section",[t._v("\n        "+t._s(e.description)+"\n      ")]):t._e()],1)}))],2):t._e(),t.builtinPlugins.length>0?s("div",{staticClass:"bg-white q-pa-md"},[s("div",{staticClass:"text-h6 q-mb-md"},[t._v("Builtin")]),t._l(t.builtinPlugins,(function(e){return s("q-card",{key:e.name,staticClass:"q-my-sm bg-secondary text-white"},[s("q-card-section",[s("div",{staticClass:"row items-center no-wrap"},[s("div",{staticClass:"col"},[s("div",{staticClass:"text-h6"},[t._v("\n              "+t._s(e.name)+" "),e.version?s("span",{attrs:{slot:"subtitle"},slot:"subtitle"},[t._v("version: "+t._s(e.version))]):t._e()])]),s("div",{staticClass:"col-auto"},[s("q-icon",{attrs:{slot:"right",name:"mdi-puzzle"},slot:"right"})],1)])]),e.description?s("q-card-section",[t._v("\n        "+t._s(e.description)+"\n      ")]):t._e()],1)}))],2):t._e()])},y=[],q={name:"PluginsView",data:function(){return{}},computed:{plugins:function(){var t=Object.values(this.$ethingUI.plugins);return t.filter((function(t){return t.package}))},installedPlugins:function(){return this.plugins.filter((function(t){return t.package.project_name}))},localPlugins:function(){return this.plugins.filter((function(t){return!t.package.project_name&&!t.package.builtin}))},builtinPlugins:function(){return this.plugins.filter((function(t){return!t.package.project_name&&t.package.builtin}))}},methods:{},mounted:function(){}},C=q,k=Object(d["a"])(C,b,y,!1,null,null,null),x=k.exports,w=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"center-width-sm q-gutter-y-md q-py-md q-px-sm"},[!1===t.loading?[t.clients.length>0?t._l(t.clients,(function(e){return s("q-card",{key:e.id,staticClass:"bg-white",attrs:{flat:""}},[s("q-card-section",[s("div",{staticClass:"row items-center no-wrap"},[s("div",{staticClass:"col"},[s("div",{staticClass:"text-h6"},[t._v("\n                "+t._s(e.ip)+" "),t.isCurrent(e)?s("small",{staticClass:"text-faded"},[t._v("(current)")]):t._e()])]),s("div",{staticClass:"col-auto"},[s("q-icon",{attrs:{name:"mdi-checkbox-blank-circle",color:e.online?"green":"red"}})],1)])]),s("q-card-section",{staticClass:"text-faded"},[s("div",[t._v("online: "+t._s(e.online))]),s("div",[t._v("platform: "+t._s(e.platform))]),s("div",[t._v("browser: "+t._s(e.browser))])]),s("q-separator"),s("q-card-actions",[s("q-btn",{attrs:{flat:"",color:"primary",label:"Identify"},on:{click:function(s){return t.notify(e,"hello !")}}}),s("q-btn",{attrs:{flat:"",color:"faded",label:"Remove"},on:{click:function(s){return t.remove(e)}}})],1)],1)})):s("div",{staticClass:"absolute-center text-faded"},[t._v("No API keys")])]:s("div",[t._v("loading ...")])],2)},E=[],$=s("18d6"),j={name:"ApikeyView",data:function(){return{loading:!0,clients:[]}},methods:{isCurrent:function(t){return t.id===$["a"].getItem("ething.cid")},load:function(){var t=this;this.loading=!0,EThing.request({url:"clients",dataType:"json"}).then((function(e){t.clients=e,t.loading=!1})).catch((function(t){console.error(t)}))},remove:function(t){var e=this;EThing.request({method:"DELETE",url:"clients/"+t.id}).then((function(){var s=e.clients.findIndex((function(e){return e.id===t.id}));-1!==s&&e.clients.splice(s,1)})).catch((function(t){console.error(t)}))},notify:function(t,e){EThing.request({method:"POST",url:"clients/"+t.id+"/notify",contentType:"application/json; charset=utf-8",data:{msg:e}})}},mounted:function(){this.load()}},I=j,O=Object(d["a"])(I,w,E,!1,null,null,null),P=O.exports,S=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"center-width-sm q-gutter-y-md q-py-md q-px-sm"},[s("q-card",{staticClass:"bg-white",attrs:{flat:""}},[s("q-card-section",[s("div",{staticClass:"text-subtitle2"},[t._v("UI")]),s("div",[t._v("version: "+t._s(t.$ethingUI.VERSION))])]),s("q-card-section",[s("div",{staticClass:"text-subtitle2"},[t._v("JS api")]),s("div",[t._v("version: "+t._s(t.$ething.VERSION))])]),s("q-separator"),s("q-card-section",[s("div",{staticClass:"text-subtitle2"},[t._v("Server")]),s("div",[t._v("version: "+t._s(t.$ethingUI.info.VERSION))])]),s("q-card-section",[s("div",{staticClass:"text-subtitle2"},[t._v("Python")]),s("div",[t._v("version: "+t._s(t.$ethingUI.info.python.version)+" type: "+t._s(t.$ethingUI.info.python.type))])]),s("q-card-section",[s("div",{staticClass:"text-subtitle2"},[t._v("Platform")]),s("div",[t._v(t._s(t.$ethingUI.info.platform.name))])]),s("q-separator"),s("q-card-section",[s("div",{staticClass:"text-subtitle2"},[t._v("Plugins")]),t._l(t.$ethingUI.plugins,(function(e){return s("div",{key:e.type()},[t._v("\n        "+t._s(e.name())+" "+t._s(t.$ethingUI.get(e).package.version||"")+"\n      ")])}))],2),s("q-separator"),s("q-card-actions",{attrs:{vertical:""}},[s("q-btn",{attrs:{flat:""},on:{click:t.downloadLogFile}},[t._v("Download LOG file")])],1)],1)],1)},T=[],U=s("b06b"),A={name:"AboutView",methods:{downloadLogFile:function(){Object(U["a"])(EThing.config.serverUrl+"/log.txt")}}},V=A,L=Object(d["a"])(V,S,T,!1,null,null,null),z=L.exports,N={name:"PageSystem",components:{SettingsView:m,ApikeyView:_,PluginsView:x,ClientsView:P,AboutView:z},props:{panel:{type:String,default:"settings"}},computed:{tab:{get:function(){return this.panel},set:function(t){this.$router.push({name:this.$router.currentRoute.name,params:{panel:t}})}}}},R=N,D=(s("68cf"),Object(d["a"])(R,n,i,!1,null,"b421117c",null));e["default"]=D.exports},9595:function(t,e,s){},f8c8:function(t,e,s){}}]);