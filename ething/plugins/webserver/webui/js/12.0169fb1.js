(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[12],{"/5vt":function(t,e,i){"use strict";var s=i("mS+i"),n=i.n(s);n.a},HXg4:function(t,e,i){},MhSa:function(t,e,i){"use strict";var s=i("Uv13"),n=i.n(s);n.a},QVVK:function(t,e,i){},Uv13:function(t,e,i){},"a1/M":function(t,e,i){"use strict";var s=i("HXg4"),n=i.n(s);n.a},hxHi:function(t,e,i){"use strict";var s=i("QVVK"),n=i.n(s);n.a},"mS+i":function(t,e,i){},qZq7:function(t,e,i){"use strict";var s=i("z6bj"),n=i.n(s);n.a},tB8M:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-page",[i("q-tabs",{attrs:{"two-lines":"","no-pane-border":"",color:"secondary"}},[i("q-tab",{attrs:{slot:"title",default:"",label:"settings",name:"settings",icon:"settings"},slot:"title"}),i("q-tab",{attrs:{slot:"title",label:"log",name:"log",icon:"message"},slot:"title"}),i("q-tab",{attrs:{slot:"title",label:"api key",name:"apikey",icon:"mdi-key"},slot:"title"}),i("q-tab",{attrs:{slot:"title",label:"plugins",name:"plugins",icon:"mdi-puzzle"},slot:"title"}),i("q-tab",{attrs:{slot:"title",label:"processes",name:"processes",icon:"mdi-cogs"},slot:"title"}),i("q-tab",{attrs:{slot:"title",label:"about",name:"about",icon:"info"},slot:"title"}),i("q-tab-pane",{attrs:{name:"settings"}},[i("settings-view")],1),i("q-tab-pane",{attrs:{name:"log"}},[i("log-view")],1),i("q-tab-pane",{attrs:{name:"apikey"}},[i("apikey-view")],1),i("q-tab-pane",{attrs:{name:"plugins"}},[i("plugins-view")],1),i("q-tab-pane",{attrs:{name:"processes"}},[i("processes-view")],1),i("q-tab-pane",{attrs:{name:"about"}},[i("about-view")],1)],1)],1)},n=[];s._withStripped=!0;var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"layout"},[!1===t.loading?i("div",[i("div",{staticClass:"q-mt-xl"},[i("div",{staticClass:"q-title q-title-opacity"},[t._v("General")]),i("form-schema",{staticClass:"q-my-md",attrs:{schema:t.$ethingUI.config},on:{error:function(e){t.error=e}},model:{value:t.settings,callback:function(e){t.settings=e},expression:"settings"}})],1),t._l(t.plugins,function(e,s){return"object"===typeof e.schema?i("div",{key:s,staticClass:"q-mt-xl"},[i("div",{staticClass:"q-title q-title-opacity"},[t._v(t._s(s))]),i("form-schema",{staticClass:"q-my-md",attrs:{schema:e.schema},on:{error:function(t){e.error=t}},model:{value:t.settings[s],callback:function(e){t.$set(t.settings,s,e)},expression:"settings[name]"}})],1):t._e()}),t.saveError?i("q-alert",{staticClass:"q-mt-xl",attrs:{type:"negative"}},[t._v("\n      "+t._s(String(t.saveError))+"\n    ")]):t._e(),i("div",{staticClass:"q-mt-xl"},[i("q-btn",{attrs:{disable:t.globalError,loading:t.saving,color:"secondary",icon:"done",label:"save changes"},on:{click:t.onSave}})],1)],2):i("div",{staticClass:"absolute-center text-faded"},[t._v("loading ...")])])},r=[];a._withStripped=!0;i("f3/d");var o={name:"SettingsView",data:function(){var t={};for(var e in this.$ethingUI.plugins){var i=this.$ethingUI.plugins[e];i.schema&&(t[e]={error:!1,schema:i.schema})}return{loading:!0,saving:!1,error:!1,saveError:!1,settings:{},plugins:t,logLevels:[{label:"debug",value:"debug"},{label:"info",value:"info"},{label:"warning",value:"warning"},{label:"error",value:"error"},{label:"fatal",value:"fatal"}]}},computed:{globalError:function(){var t=this.error;if(!t)for(var e in this.plugins){this.plugins[e].error&&(t=!0);break}return t}},methods:{load:function(){var t=this;this.loading=!0,this.$ething.settings.get().then(function(e){for(var i in t.plugins)"undefined"==typeof e[i]&&(e[i]={});t.settings=e,t.loading=!1})},onSave:function(){var t=this,e=this.settings;this.saving=!0,this.saveError=!1,this.$ething.settings.set(e).catch(function(e){t.saveError=e}).finally(function(){t.saving=!1})}},mounted:function(){this.load()}},l=o,c=(i("/5vt"),i("KHd+")),u=Object(c["a"])(l,a,r,!1,null,"24b091b9",null);u.options.__file="SettingsView.vue";var d=u.exports,v=function(){var t=this,e=t.$createElement,i=t._self._c||e;return!1===t.loading?i("div",[i("q-input",{staticClass:"inline",attrs:{placeholder:"filter","hide-underline":"",color:"secondary"},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}}),i("q-select",{staticClass:"inline",attrs:{options:t.lengthOptions,suffix:"results",color:"secondary","hide-underline":""},model:{value:t.length,callback:function(e){t.length=e},expression:"length"}}),i("q-btn",{attrs:{color:"secondary",flat:"",icon:"refresh",label:"refresh"},on:{click:t.load}}),i("div",{staticClass:"column gutter-y-xs q-mt-sm"},t._l(t.logs,function(e,s){return i("div",{staticClass:"log row gutter-x-xs",class:e.cls,attrs:{keys:s}},[i("div",{staticClass:"date col-md-auto col-sm-4"},[t._v("\n        "+t._s(e.date)+"\n      ")]),i("div",{staticClass:"level col-md-1 col-sm-4"},[t._v("\n        "+t._s(e.level)+"\n      ")]),i("div",{staticClass:"level col-md-2 col-sm-4"},[t._v("\n        "+t._s(e.name)+"\n      ")]),i("div",{staticClass:"message col-md col-sm-12"},[t._v("\n        "+t._s(e.message)+"\n      ")])])}))],1):i("div",[t._v("loading ...")])},m=[];v._withStripped=!0;i("KKXr"),i("rGqo");var g={name:"LogView",data:function(){return{loading:!0,logs:[],filter:"",length:100,lengthOptions:[100,200,500,1e3].map(function(t){return{label:String(t),value:t}})}},methods:{load:function(){var t=this;this.loading=!0,this.$ething.request({url:"utils/read_log?line="+this.length+"&filter="+encodeURIComponent(this.filter),dataType:"json"}).then(function(e){t.logs=[],e.forEach(function(e){var i=e.split("::",4);if(4==i.length){var s=i[0].trim(),n=i[1].trim(),a=i[2].trim().toUpperCase(),r=i[3].trim();t.logs.push({date:s,name:n,level:a,cls:a.toLowerCase(),message:r})}else t.logs.length&&(t.logs[t.logs.length-1].message+="\n"+e)}),t.logs.reverse()}).finally(function(){t.loading=!1})}},mounted:function(){this.load()}},h=g,f=(i("hxHi"),Object(c["a"])(h,v,m,!1,null,"1923c293",null));f.options.__file="LogView.vue";var p=f.exports,_=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[!1===t.loading?i("div",[i("div",{staticClass:"q-my-md"},[i("q-btn",{attrs:{icon:"add",label:"new API key",rounded:"",color:"secondary"},on:{click:function(e){t.create()}}})],1),t.apikeys.length>0?i("div",[t._m(0),t._l(t.apikeys,function(e){return i("div",{key:e.id,staticClass:"item row items-center gutter-x-sm q-mt-md"},[i("div",{staticClass:"date col-xs-2 col-sm-2 col-md-2 text-faded ellipsis"},[t._v("\n          "+t._s(e.name)+"\n        ")]),i("div",{staticClass:"date col-xs-0 col-sm-0 col-md-2 text-faded ellipsis"},[t._v("\n          "+t._s(t.$ethingUI.utils.dateToString(e.modifiedDate))+"\n        ")]),i("div",{staticClass:"key col col-sm-5 col-md-5 col-lg-5"},[t._v("\n          "+t._s(e.value)+"\n        ")]),i("div",{staticClass:"scope col gt-xs text-faded ellipsis"},t._l(t.splitScopes(e.scope),function(e){return i("div",[t._v("\n            "+t._s(e)+"\n          ")])})),i("div",{staticClass:"controls col-auto"},[i("q-btn",{attrs:{icon:"settings",round:"",flat:"",dense:"",color:"faded"},on:{click:function(i){t.edit(e)}}}),i("q-btn",{attrs:{icon:"delete",round:"",flat:"",dense:"",color:"negative"},on:{click:function(i){t.remove(e)}}})],1)])})],2):i("div",{staticClass:"absolute-center text-faded"},[t._v("No API keys")])]):i("div",[t._v("loading ...")]),i("modal",{attrs:{title:t.editing?"Edit API key":"Create a new API key",icon:"mdi-key","valid-btn-label":t.editing?"Edit":"Create","cancel-btn-label":"Cancel","valid-btn-disable":t.error||t.addLoading},on:{valid:t.add},model:{value:t.modal,callback:function(e){t.modal=e},expression:"modal"}},[i("form-schema",{key:t.formKey,attrs:{schema:t.schema},on:{error:function(e){t.error=e}},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}}),t.serverError?i("q-alert",{staticClass:"q-mb-xl",attrs:{type:"negative"}},[t._v("\n      "+t._s(String(t.serverError))+"\n    ")]):t._e()],1)],1)},b=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"item row items-center gutter-x-sm"},[i("div",{staticClass:"name col-xs-2 col-sm-2 col-md-2 text-secondary ellipsis"},[t._v("\n          name\n        ")]),i("div",{staticClass:"date col-xs-0 col-sm-0 col-md-2 text-secondary ellipsis"},[t._v("\n          date\n        ")]),i("div",{staticClass:"key col col-sm-5 col-md-5 col-lg-5 text-secondary"},[t._v("\n          value\n        ")]),i("div",{staticClass:"scope col gt-xs text-secondary"},[t._v("\n          scope\n        ")])])}];_._withStripped=!0;i("INYr"),i("91GP");var y={name:"ApikeyView",data:function(){return{loading:!0,apikeys:[],formKey:0,schema:{type:"object",additionalProperties:!1,required:["name"],properties:{name:{type:"string",minLength:1},scope:{type:"string",format:"scope",default:""}}},model:{},error:!1,modal:!1,addLoading:!1,serverError:!1,editing:!1}},methods:{load:function(){var t=this;this.loading=!0,EThing.request({url:"apikey",dataType:"json"}).then(function(e){t.apikeys=e,t.loading=!1}).catch(function(t){console.error(t)})},reset:function(){this.serverError=!1,this.error=!1,this.model={},this.editing=!1,this.formKey++},add:function(){var t=this,e=Object.assign({},this.model);this.addLoading=!0,this.serverError=!1,EThing.request({method:this.editing?"PATCH":"POST",url:this.editing?"apikey/"+this.editing.id:"apikey",dataType:"json",data:e}).then(function(e){var i=t.apikeys||[],s=!1;for(var n in i)if(i[n].id==e.id){i[n]=e,s=!0;break}s||i.push(e),t.apikeys=i,t.modal=!1}).catch(function(e){t.serverError=e}).finally(function(){t.addLoading=!1})},create:function(){this.reset(),this.modal=!0},edit:function(t){this.reset(),this.model=Object.assign({},t),this.editing=t,this.modal=!0},remove:function(t){var e=this;EThing.request({method:"DELETE",url:"apikey/"+t.id}).then(function(){var i=e.apikeys.findIndex(function(e){return e.id===t.id});-1!==i&&e.apikeys.splice(i,1)}).catch(function(t){console.error(t)})},splitScopes:function(t){return t.split(" ")}},mounted:function(){this.load()}},q=y,k=Object(c["a"])(q,_,b,!1,null,null,null);k.options.__file="ApikeyView.vue";var w=k.exports,C=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"layout"},[i("h4",[t._v("Installed")]),t.installedPlugins.length>0?i("div",t._l(t.installedPlugins,function(e){return i("q-card",{key:e.name,staticClass:"q-ma-sm",attrs:{color:"secondary"}},[i("q-card-title",[t._v("\n        "+t._s(e.name)+"\n        "),e.package.version?i("span",{attrs:{slot:"subtitle"},slot:"subtitle"},[t._v("version: "+t._s(e.package.version))]):t._e(),i("q-icon",{attrs:{slot:"right",name:"mdi-puzzle"},slot:"right"})],1),i("q-card-main",[t._v("\n        "+t._s(e.package.summary||"no description")+"\n      ")]),i("q-card-separator")],1)})):i("div",{staticClass:"text-faded"},[t._v("\n    No plugin installed !\n  ")]),t.localPlugins.length>0?i("div",[i("h4",[t._v("Local")]),t._l(t.localPlugins,function(e){return i("q-card",{key:e.name,staticClass:"q-ma-sm",attrs:{color:"secondary"}},[i("q-card-title",[t._v("\n        "+t._s(e.name)+"\n        "),e.version?i("span",{attrs:{slot:"subtitle"},slot:"subtitle"},[t._v("version: "+t._s(e.version))]):t._e(),i("q-icon",{attrs:{slot:"right",name:"mdi-puzzle"},slot:"right"})],1),i("q-card-main",[t._v("\n        location: "+t._s(e.package.location)+"\n      ")]),i("q-card-separator")],1)})],2):t._e(),t.builtinPlugins.length>0?i("div",[i("h4",[t._v("builtin")]),t._l(t.builtinPlugins,function(e){return i("q-card",{key:e.name,staticClass:"q-ma-sm",attrs:{color:"secondary"}},[i("q-card-title",[t._v("\n        "+t._s(e.name)+"\n        "),e.version?i("span",{attrs:{slot:"subtitle"},slot:"subtitle"},[t._v("version: "+t._s(e.version))]):t._e(),i("q-icon",{attrs:{slot:"right",name:"mdi-puzzle"},slot:"right"})],1),i("q-card-separator")],1)})],2):t._e()])},x=[];C._withStripped=!0;var E={name:"PluginsView",data:function(){return{}},computed:{plugins:function(){var t=[];for(var e in this.$ethingUI.plugins)t.push(Object.assign({name:e},this.$ethingUI.plugins[e]));return t.filter(function(t){return t.package})},installedPlugins:function(){return this.plugins.filter(function(t){return t.package.project_name})},localPlugins:function(){return this.plugins.filter(function(t){return!t.package.project_name&&!t.package.builtin})},builtinPlugins:function(){return this.plugins.filter(function(t){return!t.package.project_name&&t.package.builtin})}},methods:{},mounted:function(){}},P=E,S=(i("qZq7"),Object(c["a"])(P,C,x,!1,null,"35b531a2",null));S.options.__file="PluginsView.vue";var $=S.exports,I=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"layout"},[i("q-list",{attrs:{highlight:""}},[i("q-list-header",[t._v("Processes")]),t._l(t.processes,function(e,s){return i("q-item",{key:s},[i("q-item-main",{attrs:{label:e.name}}),i("q-item-side",[t._v("\n        "+t._s(e.active?"running":"stopped")+"\n      ")]),i("q-item-side",{attrs:{right:""}},[t._v("\n        "+t._s(t.duration_to_string(e._duration))+"\n      ")])],1)})],2)],1)},V=[];I._withStripped=!0;i("Vd3H");function j(t,e){return t.start_ts<e.start_ts?-1:t.start_ts>e.start_ts?1:0}var U={name:"ProcessesView",data:function(){return{processes:[],timer:null}},methods:{updateProcesses:function(){var t=this;this.$ething.request("/process").then(function(e){e.sort(j),e.reverse(),t.processes=e,t.updateDuration()})},updateDuration:function(){this.processes.forEach(function(t){t._duration=t.active?Date.now()-1e3*t.start_ts:0})},duration_to_string:function(t){var e=Math.floor(t/1e3),i=Math.floor(e/3600),s=Math.floor((e-3600*i)/60),n=e-3600*i-60*s;return i<10&&(i="0"+i),s<10&&(s="0"+s),n<10&&(n="0"+n),i+":"+s+":"+n}},mounted:function(){this.updateProcesses(),this.timer=setInterval(this.updateProcesses,2e3)},beforeDestroy:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}},O=U,L=(i("MhSa"),Object(c["a"])(O,I,V,!1,null,"47822cdc",null));L.options.__file="ProcessesView.vue";var T=L.exports,z=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"layout"},[i("h4",[t._v("Information")]),i("dl",[i("dt",[t._v("UI")]),i("dd",[t._v("version: "+t._s(t.$ui.VERSION))]),i("dt",[t._v("Server")]),i("dd",[t._v("version: "+t._s(t.$ethingUI.info.VERSION))]),i("dt",[t._v("JS api")]),i("dd",[t._v("version: "+t._s(t.$ething.VERSION))]),i("dt",[t._v("Python")]),i("dd",[t._v("version: "+t._s(t.$ethingUI.info.python.version)+" type: "+t._s(t.$ethingUI.info.python.type))]),i("dt",[t._v("Platform")]),i("dd",[t._v(t._s(t.$ethingUI.info.platform.name))])]),i("div",[i("q-btn",{attrs:{label:"restart",color:"primary"},on:{click:t.restart}})],1)])},A=[];z._withStripped=!0;var K={name:"AboutView",data:function(){return{restarting:!1,timeout:null}},watch:{restarting:function(t,e){var i=this;this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.$ethingUI.off("ui.server.connected",this.reload),t?(this.$q.loading.show({message:"Restarting...<br><small>Please wait until the application has finished to restart.</small><br><small>It could take some time.</small>",messageColor:"white",spinnerSize:250,spinnerColor:"white",customClass:"bg-primary"}),this.timeout=setTimeout(function(){i.timeout=null,i.reload()},12e4),this.$ethingUI.once("ui.server.connected",function(){i.restarting=!1,i.reload()})):this.$q.loading.hide()}},methods:{reload:function(){this.$router.go()},restart:function(){this.restarting=!0,this.$ething.request({url:"utils/restart"})}}},M=K,H=(i("a1/M"),Object(c["a"])(M,z,A,!1,null,"a5523e1c",null));H.options.__file="AboutView.vue";var D=H.exports,N={name:"PageSettings",components:{SettingsView:d,LogView:p,ApikeyView:w,PluginsView:$,ProcessesView:T,AboutView:D}},R=N,G=Object(c["a"])(R,s,n,!1,null,null,null);G.options.__file="Settings.vue";e["default"]=G.exports},z6bj:function(t,e,i){}}]);