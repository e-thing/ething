(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["app"],{0:function(e,t,n){e.exports=n("2f39")},"0292":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:{expended:e.expended}},[n("q-resize-observer",{on:{resize:e.onResize}}),e.options?n("highstock",{ref:"highcharts",staticClass:"chart",class:{expended:e.expended},attrs:{options:e.options}}):n("div",{staticClass:"absolute-center text-center"},[n("q-btn",{attrs:{label:"new plot",icon:"timeline",flat:"",color:"primary"},on:{click:function(t){e.optionsModal=!0}}})],1),n("q-inner-loading",{staticClass:"text-center",attrs:{showing:e.loading}},[n("q-spinner-oval",{attrs:{color:"primary",size:"50px"}})],1),n("modal",{attrs:{title:"Chart save",icon:"save",size:"xs","valid-btn-label":"Save"},on:{valid:e.onSave,show:e.$v.filename.$touch},model:{value:e.saveModal,callback:function(t){e.saveModal=t},expression:"saveModal"}},[n("q-input",{attrs:{error:e.$v.filename.$error,"error-message":"Required",label:"Filename"},on:{input:e.$v.filename.$touch},model:{value:e.filename,callback:function(t){e.filename=t},expression:"filename"}})],1),n("modal",{attrs:{size:"lg","no-esc-dismiss":!e.options,"no-backdrop-dismiss":!e.options,title:"Chart options",icon:"edit","valid-btn-disable":e.$v.optionsData.$error},on:{valid:e.onOptionsValidate},model:{value:e.optionsModal,callback:function(t){e.optionsModal=t},expression:"optionsModal"}},[n("q-input",{attrs:{label:"Title"},model:{value:e.optionsData.title,callback:function(t){e.$set(e.optionsData,"title",t)},expression:"optionsData.title"}}),n("q-input",{attrs:{label:"Subtitle"},model:{value:e.optionsData.subtitle,callback:function(t){e.$set(e.optionsData,"subtitle",t)},expression:"optionsData.subtitle"}}),n("div",{staticClass:"q-my-md"},[n("div",{staticClass:"q-subheading q-mb-md"},[e._v("\n        Panes\n        "),n("q-btn",{attrs:{flat:"",size:"sm",color:"blue-5",label:"Add pane",icon:"add"},on:{click:function(t){e.optionsData.panes.push(e.default_pane(e.optionsData.panes.length+1)),e.$v.optionsData.$touch()}}})],1),n("div",{staticClass:"q-ml-md q-mb-md"},e._l(e.optionsData.panes,(function(t,i){return n("div",{key:i,staticClass:"pane"},[n("q-input",{attrs:{label:"name/unit",error:e.$v.optionsData.panes.$each[i].name.$error,"error-message":"Required"},on:{blur:e.$v.optionsData.panes.$each[i].name.$touch},model:{value:t.name,callback:function(n){e.$set(t,"name",n)},expression:"pane.name"}}),n("div",{staticClass:"fit row"},[n("q-select",{staticClass:"col-grow",attrs:{label:"Y axis mode",options:["auto","fixed"]},model:{value:t.yAxisMode,callback:function(n){e.$set(t,"yAxisMode",n)},expression:"pane.yAxisMode"}}),n("div",{staticClass:"row no-wrap"},["fixed"==t.yAxisMode?n("q-input",{attrs:{type:"number",label:"Min","error-message":"Required"},model:{value:t.yAxisMin,callback:function(n){e.$set(t,"yAxisMin",e._n(n))},expression:"pane.yAxisMin"}}):e._e(),"fixed"==t.yAxisMode?n("q-input",{attrs:{type:"number",label:"Max","error-message":"Required"},model:{value:t.yAxisMax,callback:function(n){e.$set(t,"yAxisMax",e._n(n))},expression:"pane.yAxisMax"}}):e._e()],1)],1),n("div",{staticClass:"q-my-md"},[n("div",{staticClass:"q-subheading q-mb-md"},[e._v("\n              Curves\n              "),n("q-btn",{attrs:{flat:"",size:"sm",color:"cyan-5",label:"Add",icon:"add"},on:{click:function(n){t.curves.push(e.default_curve(t.curves.length+1)),e.$v.optionsData.$touch()}}})],1),n("div",{staticClass:"q-ml-md q-mb-md"},e._l(t.curves,(function(r,o){return n("div",{key:o,staticClass:"curve"},[n("q-input",{attrs:{label:"name",error:e.$v.optionsData.panes.$each[i].curves.$each[o].name.$error,"error-message":"Required"},on:{blur:e.$v.optionsData.panes.$each[i].curves.$each[o].name.$touch},model:{value:r.name,callback:function(t){e.$set(r,"name",t)},expression:"curve.name"}}),n("q-select",{attrs:{label:"type",options:e.serieTypeOptions,error:e.$v.optionsData.panes.$each[i].curves.$each[o].type.$error,"error-message":"Required"},on:{blur:e.$v.optionsData.panes.$each[i].curves.$each[o].type.$touch},model:{value:r.type,callback:function(t){e.$set(r,"type",t)},expression:"curve.type"}}),n("resource-select",{attrs:{resources:"resources/Table",label:"table","use-id":"",error:e.$v.optionsData.panes.$each[i].curves.$each[o].data.resource.$error,"error-message":"Required"},on:{input:e.$v.optionsData.panes.$each[i].curves.$each[o].data.resource.$touch},model:{value:r.data.resource,callback:function(t){e.$set(r.data,"resource",t)},expression:"curve.data.resource"}}),r.data.resource?n("q-select",{attrs:{label:"key",options:e.optionsBuildKeyOptions(r,e.$v.optionsData.panes.$each[i].curves.$each[o].data.key),error:e.$v.optionsData.panes.$each[i].curves.$each[o].data.key.$error,"error-message":"Required"},on:{input:e.$v.optionsData.panes.$each[i].curves.$each[o].data.key.$touch},model:{value:r.data.key,callback:function(t){e.$set(r.data,"key",t)},expression:"curve.data.key"}}):e._e(),n("q-btn",{attrs:{flat:"",size:"sm",color:"negative",label:"remove",icon:"delete"},on:{click:function(e){return t.curves.splice(o,1)}}})],1)})),0)]),n("q-btn",{attrs:{flat:"",size:"sm",color:"negative",label:"remove",icon:"delete"},on:{click:function(t){return e.optionsData.panes.splice(i,1)}}})],1)})),0)])],1)],1)},r=[],o=(n("7514"),n("7f7f"),n("ac6a"),n("cadf"),n("551c"),n("06db"),n("097d"),n("426a")),a=n.n(o),s=n("2b0e"),c=n("58a2"),l=n("ea7f"),u=n.n(l),d=n("37d8"),f=n.n(d),h=n("0319"),m=n.n(h),p=n("11ec"),v=n("ffbd"),b=n("1c16"),_=n("b5ae");function g(){this.sources=[],this.history="all"}function y(e,t){e=new Date(e);if("number"!=typeof t)if("string"===typeof t){if(t=parseFloat(t),isNaN(t))return}else"boolean"===typeof t&&(t=t?1:0);return[e.getTime(),t]}f()(u.a),m()(u.a),s["default"].use(c["a"],{Highcharts:u.a}),g.prototype.clear=function(){this.sources=[],this.history="all"},g.prototype.setHistory=function(e){this.history=e},g.prototype.add=function(e,t){var n=this,i=a.a.arbo.get(e.resource);if(i instanceof a.a.Table){var r=null,o=e.key;for(var s in this.sources)if(this.sources[s].resource===i.id()){r=this.sources[s];break}r||(r={resource:i.id(),keys:[],done:[],fetch:function(e){var t=this,i=a.a.arbo.get(this.resource),r=null;if("number"===typeof n.history){var o=new Date(Date.now()-1e3*parseInt(n.history));r="$.date > dateTime('"+o.toISOString()+"')"}i.select({fields:["date"].concat(this.keys),query:r}).then((function(e){t.done.forEach((function(t){t(e)}))})).finally((function(){e()}))}},this.sources.push(r)),r.keys.push(o),r.done.push((function(e){var n=e.filter((function(e){return e.hasOwnProperty(o)})).map((function(e){return y(e.date,e[o])}));t(n)}))}},g.prototype.load=function(e){var t=this.sources.length;function n(){t--,0===t&&"function"===typeof e&&e()}this.sources.forEach((function(e){e.fetch.call(e,n)}))};var x={name:"Chart",props:{preferences:{},expended:Boolean,dense:Boolean,minimal:Boolean,readonly:Boolean,noZoom:Boolean,history:{},chartOptions:{type:Object,default:function(){return{}}}},components:{ResourceSelect:v["a"]},data:function(){var e="",t=!1;if("string"===typeof this.preferences){var n=this.$ething.arbo.get(this.preferences);n instanceof this.$ething.File&&(t=n)}else this.preferences instanceof this.$ething.File&&(t=this.preferences);return t&&(e=t.name()),{loading:!1,dataSource:new g,options:!1,optionsModal:!this.preferences,optionsData:{panes:[this.default_pane()]},serieTypeOptions:[{label:"line",value:"line"},{label:"column",value:"column"},{label:"scatter",value:"scatter"},{label:"area",value:"area"},{label:"spline",value:"spline"}],saveModal:!1,filename:e,file:t,table:null,refreshIntervalId:null}},validations:function(){return{filename:{required:_["required"]},optionsData:{required:_["required"],panes:{required:_["required"],minLength:Object(_["minLength"])(1),$each:{name:{required:_["required"]},curves:{required:_["required"],minLength:Object(_["minLength"])(1),$each:{name:{required:_["required"]},type:{required:_["required"]},data:{required:_["required"],resource:{required:_["required"]},key:{required:_["required"]}}}}}}}}},methods:{load:function(e){var t=this;this.loading=!0,this.currentPreferences=Object(p["a"])(!0,{},e),this.dataSource.clear(),this.dataSource.setHistory(this.history||e.history||"all");var n=e.title;if(this.dense&&e.subtitle&&(n?n+=" - "+e.subtitle:n=e.subtitle),this.options=Object(p["a"])(!0,{chart:{plotBorderWidth:0,zoomType:this.noZoom?"":"x",spacingBottom:10},exporting:{menuItemDefinitions:{refresh:{onclick:function(){t.refresh()},text:"refresh"},options:{onclick:function(){t.optionsModal=!0},text:"options"},save:{onclick:function(){t.currentPreferences&&(t.saveModal=!0)},text:"save"}},buttons:{contextButton:{menuItems:this.readonly?["refresh","separator","downloadPNG","downloadJPEG","downloadPDF"]:["refresh","options","save","separator","downloadPNG","downloadJPEG","downloadPDF"]}},enabled:!this.minimal},rangeSelector:{buttons:[{type:"hour",count:12,text:"12h"},{type:"day",count:1,text:"1d"},{type:"week",count:1,text:"1w"},{type:"month",count:1,text:"1m"},{type:"all",text:"All"}],selected:this.noZoom?4:1,enabled:!(this.dense||this.minimal||this.noZoom)},tooltip:{xDateFormat:"%Y-%m-%d %H:%M",valueDecimals:3},navigator:{enabled:!(this.dense||this.minimal||this.noZoom)},scrollbar:{enabled:!this.noZoom},xAxis:{type:"datetime",ordinal:!1,tickLength:5},credits:{enabled:!1},plotOptions:{column:{dataGrouping:{approximation:"average"}},series:{animation:!1}},series:[],yAxis:[],title:{text:this.minimal?null:n},subtitle:{text:this.dense||this.minimal?null:e.subtitle},time:{useUTC:!1}},this.chartOptions),!e.panes)return this.loading=!1,void setTimeout((function(){t.chart().showLoading("no data")}),1e3);var i=5,r=(100-(e.panes.length-1)*i)/e.panes.length;e.panes.forEach((function(e,n){var o="axis-"+n,a={title:{text:e.name||""},resize:{enabled:!0},height:r+"%",top:n*(r+i)+"%",offset:0,labels:{align:"right",x:-3,y:4},lineWidth:0,opposite:!1,showLastLabel:!0,gridLineWidth:1,id:o};"fixed"===e.yAxisMode&&("number"===typeof e.yAxisMin&&(a.min=e.yAxisMin),"number"===typeof e.yAxisMax&&(a.max=e.yAxisMax)),t.options.yAxis.push(a),e.curves.forEach((function(e,n){var i=null;e.data.resource&&e.data.key&&(i="s-"+e.data.resource+"-"+e.data.key);var r={showInNavigator:!0,type:e.type||"line",name:e.name||"data "+n,data:[],yAxis:o,id:i};t.dataSource.add(e.data,(function(e){if(e.length&&(r.data=e,-1===t.options.series.indexOf(r))){var n=!0;for(var i in e){var o=e[i];if(o){var a=o[1];if(0!=a&&1!=a){n=!1;break}}}n&&(r.step="left"),t.options.series.push(r)}}))}))})),this.dataSource.load((function(){t.loading=!1,0==t.options.series.length&&t.chart().showLoading("no data")}))},refresh:function(){var e=this;this.loading=!0,this.dataSource.load((function(){e.loading=!1}))},default_curve:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return{name:"curve "+e,type:"line",data:{}}},default_pane:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return{name:"pane "+e,yAxisMode:"auto",yAxisMin:0,yAxisMax:100,curves:[this.default_curve()]}},onOptionsValidate:function(){this.load(this.optionsData),this.optionsModal=!1},optionsBuildKeyOptions:function(e){var t=this.$ething.arbo.get(e.data.resource);if(t){var n=t.keys();return!n.length||e.data.key&&-1!==n.indexOf(e.data.key)||this.$set(e.data,"key",n[0]),n}},onSave:function(){var e=this,t=JSON.stringify(this.currentPreferences,null,4);/\.plot$/.test(this.filename)||(this.filename=this.filename+".plot"),this.file&&this.file.name()===this.filename?this.file.write(t):this.filename.length&&this.$ething.File.create({name:this.filename,content:t}).then((function(t){e.file=t})),this.saveModal=!1},chart:function(){return this.$refs.highcharts?this.$refs.highcharts.chart:void 0},onResize:function(e){this.resize()},resize:Object(b["a"])((function(e){var t=this.chart();t&&t.reflow()}),1e3),onTableUpdate:function(e,t){-1!==t.indexOf("contentModifiedDate")&&this.refresh()},onTableDataAdded:function(e){var t=e.data,n=this.chart();if(n)for(var i in t)if("id"!==i&&"date"!==i){var r="s-"+this.table.id()+"-"+i,o=n.get(r);if(o){if("number"===typeof this.dataSource.history){var a=Date.now()-1e3*parseInt(this.dataSource.history),s=0;for(var c in o.xData){var l=o.xData[c];if(!(l<a))break;s++}for(c=0;c<s;c++)o.removePoint(0,!1)}var u=y(t.date,t[i]);u&&o.addPoint(u)}}}},mounted:function(){var e=this;if(this.$v.optionsData.$touch(),this.file)this.file.read().then((function(t){try{var n="string"===typeof t?JSON.parse(t):t;e.optionsData=n,e.load(n)}catch(i){console.error("[chart] unable to load chart file",i)}}));else{var t={},n=null;if("string"===typeof this.preferences&&(n=this.$ething.arbo.get(this.preferences)),this.preferences instanceof this.$ething.Resource&&(n=this.$ething.arbo.get(this.preferences.id())),n instanceof this.$ething.Table){this.table=n,n.on("signals/TableDataAdded",this.onTableDataAdded);var i=this.$ething.arbo.get(n.createdBy());i&&(t.subtitle=i.basename()),t.title=n.basename(),t.panes=[],n.keys().forEach((function(e){var i={name:e,curves:[{name:e,type:"line",data:{resource:n.id(),key:e}}]};t.panes.push(i)}))}else if(n instanceof this.$ething.Device){t.title=n.basename(),t.panes=[];var r=this.$ething.arbo.find((function(e){return e.createdBy()==n.id()}));r.forEach((function(e){e.keys().forEach((function(n){var i={name:n,curves:[{name:n,type:"line",data:{resource:e.id(),key:n}}]};t.panes.push(i)}))}))}else t=this.preferences;t&&(this.optionsData=t,this.load(t),this.table||null!==this.refreshIntervalId||(this.refreshIntervalId=setInterval((function(){e.refresh()}),3e4)))}},beforeDestroy:function(){this.table&&this.table.off("TableDataAdded",this.onTableDataAdded),null!==this.refreshIntervalId&&(clearInterval(this.refreshIntervalId),this.refreshIntervalId=null)}},w=x,C=(n("9e10"),n("2877")),$=Object(C["a"])(w,i,r,!1,null,"0ee6ba7d",null);t["a"]=$.exports},"0add":function(e,t,n){"use strict";var i=n("4494"),r=n.n(i);r.a},"0c6b":function(e,t,n){},1:function(e,t){},"15b6":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-select",e._b({attrs:{options:e.options,"items-aligned":"","options-selected-class":"text-deep-orange","virtual-scroll-slice-size":200,placeholder:"Select a plugin"},scopedSlots:e._u([{key:"no-option",fn:function(){return[n("q-item",[n("q-item-section",{staticClass:"text-grey"},[e._v("\n        No plugin available\n      ")])],1)]},proxy:!0}]),model:{value:e.model,callback:function(t){e.model=t},expression:"model"}},"q-select",e.$attrs,!1))},r=[],o=(n("7f7f"),{name:"PluginSelect",props:{value:{},useType:Boolean},data:function(){var e=this,t=this.$ethingUI.plugins.map((function(t){var n=e.$ethingUI.get(t);return{label:t.name(),value:t.type(),icon:n.icon,color:n.color,title:n.title,plugin:t}}));return{options:t}},computed:{model:{get:function(){if(this.selectedPlugin)for(var e in this.options)if(this.options[e].value===this.selectedPlugin.type())return this.options[e]},set:function(e){var t;t=e?this.useType?e.value:e.plugin:null,this.$emit("input",t)}},selectedPlugin:function(){if(this.value)return this.useType?this.$ethingUI.findPlugin(this.value):this.value}},methods:{}}),a=o,s=n("2877"),c=Object(s["a"])(a,i,r,!1,null,null,null);t["a"]=c.exports},"1f0e":function(e,t,n){"use strict";var i=n("39da"),r=n.n(i);r.a},2171:function(e,t,n){},"23df":function(e,t,n){},"25d4":function(e,t,n){"use strict";n.d(t,"e",(function(){return l})),n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return m}));n("8e6e"),n("8a81"),n("f751"),n("ac6a"),n("cadf"),n("06db"),n("456d");var i=n("c47a"),r=n.n(i),o=(n("11ec"),n("bc78")),a=n("c658");function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(n,!0).forEach((function(t){r()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l={};function u(e){var t;return t=e?function(t){return c({},t,{resource:e})}:function(e){return e},{component:null,attributes:t,listeners:function(){return{}},zIndex:0,title:"",defaultTitle:"%name%",description:"",icon:"",minWidth:32,minHeight:32,schema:{type:"object"}}}function d(e,t,n){e||(e=u(n.args[0])),t||(t={});var i=Object.keys(e).concat(Object.keys(t)).filter((function(e,t,n){return n.indexOf(e)===t})),r={};return i.forEach((function(i){r[i]="component"===i?Object(a["g"])(e[i],t[i],n):"attributes"===i||"listeners"===i?Object(a["c"])(e[i],t[i],n):Object(a["b"])(e[i],t[i],n)})),r}function f(e,t){return{type:"object",properties:{title:{oneOf:[{const:"$default",title:"default"},{const:"$disabled",title:"disabled"},{title:"custom",type:"string",minLength:1}],type:"string",minLength:0,default:t?"$default":"$disabled",$inline:!0},color:{oneOf:[{const:null,title:"inherit"},{type:"string",$component:"color",default:"#027be3",title:"custom"}],description:"The color of the widget",default:null,$inline:!0,$group:"Appearance"},bgColor:{oneOf:[{const:null,title:"inherit"},{type:"string",$format:"hexa",$component:"color",default:"#ffffffff",title:"custom"}],title:"background color",description:"The color of the widget's background",default:null,$inline:!0,$group:"Appearance"},primaryColor:{oneOf:[{const:null,title:"inherit"},{type:"string",$component:"color",default:o["a"].getBrand("primary"),title:"custom"}],title:"primary color",description:"The primary color of the widget",default:null,$inline:!0,$group:"Appearance"},secondaryColor:{oneOf:[{const:null,title:"inherit"},{type:"string",$component:"color",default:o["a"].getBrand("secondary"),title:"custom"}],title:"secondary color",description:"The secondary color of the widget",default:null,$inline:!0,$group:"Appearance"}}}}function h(e){if(l.hasOwnProperty(e))return l[e]}function m(e,t){if(!t.component)throw new Error("No component attribute set in the widget definition");var n=t.component;return delete t.component,l[e]=d(u(),t),l[e].component=n,l[e]}t["b"]={install:function(e){var t=e.EThingUI;Object.assign(t,{widgets:l,findWidget:h,registerWidget:m})}}},"2a5a":function(e,t,n){"use strict";var i=n("8aff"),r=n.n(i);r.a},"2f39":function(e,t,n){"use strict";n.r(t);var i=n("967e"),r=n.n(i),o=(n("96cf"),n("fa84")),a=n.n(o),s=(n("1867"),n("573e"),n("7d6e"),n("e54f"),n("62f2"),n("7e6d"),n("d5b2"),n("2b0e")),c=n("b05d"),l=n("4d5a"),u=n("c7a0"),d=n("2ea3"),f=n("9898"),h=n("07d0"),m=n("f2cc"),p=n("cb32"),v=n("58a8"),b=n("54e1"),_=n("9c40"),g=n("8c8f"),y=n("156b"),x=n("f09f"),w=n("a370"),C=n("4b7e"),$=n("b047"),k=n("58ea"),q=n("b498"),O=n("24e8"),S=n("54b4"),j=n("8572"),E=n("27f9"),T=n("ddd8"),I=n("3786"),D=n("8f8e"),M=n("9564"),A=n("6f48"),F=n("9f0a"),B=n("c1d0"),P=n("7bbf"),L=n("24a7"),z=n("c859"),R=n("0016"),U=n("068f"),N=n("74f7"),V=n("3845"),H=n("497d"),W=n("6ab5"),Q=n("033f"),Y=n("e208"),G=n("4e73"),J=n("b6d5"),K=n("edca"),Z=n("3b16"),X=n("7cbe"),ee=n("4983"),te=n("eb85"),ne=n("2c91"),ie=n("0d59"),re=n("1b41"),oe=n("163c"),ae=n("8562"),se=n("eaac"),ce=n("357e"),le=n("bd08"),ue=n("db86"),de=n("429b"),fe=n("7460"),he=n("7867"),me=n("adad"),pe=n("823b"),ve=n("05eb"),be=n("74af"),_e=n("65c6"),ge=n("6ac5"),ye=n("05c0"),xe=n("d3ab"),we=n("c294"),Ce=n("72db"),$e=n("7f67"),ke=n("714f"),qe=n("f449"),Oe=n("75c3"),Se=n("12c5"),je=n("696d"),Ee=n("b12a"),Te=n("7518"),Ie=n("436b"),De=n("f508"),Me=n("18d6"),Ae=n("a639"),Fe=n("2a19");s["default"].use(c["a"],{config:{},components:{QLayout:l["a"],QPageContainer:u["a"],QPage:d["a"],QHeader:f["a"],QFooter:h["a"],QDrawer:m["a"],QAvatar:p["a"],QBadge:v["a"],QBanner:b["a"],QBtn:_["a"],QBtnGroup:g["a"],QBtnDropdown:y["a"],QCard:x["a"],QCardSection:w["a"],QCardActions:C["a"],QChip:$["a"],QCircularProgress:k["a"],QColor:q["a"],QDialog:O["a"],QExpansionItem:S["a"],QField:j["a"],QInput:E["a"],QSelect:T["a"],QRadio:I["a"],QCheckbox:D["a"],QToggle:M["a"],QBtnToggle:A["a"],QOptionGroup:F["a"],QSlider:B["a"],QRange:P["a"],QTime:L["a"],QDate:z["a"],QIcon:R["a"],QImg:U["a"],QInnerLoading:N["a"],QKnob:V["a"],QList:H["a"],QItem:W["a"],QItemSection:Q["a"],QItemLabel:Y["a"],QMenu:G["a"],QResizeObserver:J["a"],QScrollObserver:K["a"],QPagination:Z["a"],QPopupProxy:X["a"],QScrollArea:ee["a"],QSeparator:te["a"],QSpace:ne["a"],QSpinner:ie["a"],QSpinnerOval:re["a"],QSpinnerPie:oe["a"],QSplitter:ae["a"],QTable:se["a"],QTh:ce["a"],QTr:le["a"],QTd:ue["a"],QTabs:de["a"],QTab:fe["a"],QRouteTab:he["a"],QTabPanels:me["a"],QTabPanel:pe["a"],QTimeline:ve["a"],QTimelineEntry:be["a"],QToolbar:_e["a"],QToolbarTitle:ge["a"],QTooltip:ye["a"],QPageSticky:xe["a"],QFab:we["a"],QFabAction:Ce["a"]},directives:{ClosePopup:$e["a"],Ripple:ke["a"],TouchHold:qe["a"],TouchPan:Oe["a"],TouchSwipe:Se["a"]},plugins:{AddressbarColor:je["a"],AppFullscreen:Ee["a"],BottomSheet:Te["a"],Dialog:Ie["a"],Loading:De["a"],LocalStorage:Me["a"],SessionStorage:Ae["a"],Notify:Fe["a"]}});var Be=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"q-app"}},[n("router-view")],1)},Pe=[],Le={name:"App"},ze=Le,Re=n("2877"),Ue=Object(Re["a"])(ze,Be,Pe,!1,null,null,null),Ne=Ue.exports,Ve=n("8c4f"),He=n("c86d"),We=n("c7b2"),Qe=[{path:"/",component:function(){return n.e("1ec3cd79").then(n.bind(null,"7b3d"))},children:[{path:"",redirect:"dashboard"},{path:"explore",name:"explore",component:He["a"],props:function(e){var t={tree:!0},n=e.query.resources;if("undefined"!=typeof e.query.deviceMenu){t.defaultSort="location",t.allowPairing=!0;var i=We["a"].menu.devices;if("other"===e.query.deviceMenu){var r=i.map((function(e){return We["a"].resource.typeFilter(e.types)}));n=function(e){if(We["a"].isSubclass(e,"resources/Device")){var t=!0;for(var n in r)if(r[n](e)){t=!1;break}return t}},t.createTypes="resources/Device"}else n="all"===e.query.deviceMenu?"resources/Device":i[e.query.deviceMenu].types}else"undefined"!=typeof e.query.deviceLocation&&(n=function(t){return We["a"].isSubclass(t,"resources/Device")&&t.location()==e.query.deviceLocation});return t.resources=n,t}},{path:"table/:id",component:function(){return n.e("4ec7c3b5").then(n.bind(null,"a2a3"))},meta:{back:!0}},{path:"flow/:id",component:function(){return n.e("19c0639a").then(n.bind(null,"ace6"))},meta:{back:!0}},{path:"chart/:id",name:"chart",component:function(){return n.e("2d213e2c").then(n.bind(null,"af1b"))},meta:{back:!0}},{path:"chart",component:function(){return n.e("2d213e2c").then(n.bind(null,"af1b"))}},{path:"text/:id",component:function(){return n.e("57ff77f3").then(n.bind(null,"c48b"))},meta:{back:!0}},{path:"image/:id",component:function(){return n.e("2d0b344a").then(n.bind(null,"283a"))},meta:{back:!0}},{path:"resourceEdit/:id",name:"resourceEdit",component:function(){return n.e("2d2389e5").then(n.bind(null,"ffc2"))},meta:{back:!0}},{path:"resourceEdit/:type",name:"resourceCreate",component:function(){return n.e("2d2389e5").then(n.bind(null,"ffc2"))},meta:{back:!0}},{path:"resource/:id",name:"resourceMain",component:function(){return n.e("5556d1fc").then(n.bind(null,"4a46"))},meta:{back:!0}},{path:"dashboard",name:"dashboard",component:function(){return n.e("f078d798").then(n.bind(null,"ec95"))}},{path:"system",redirect:{name:"system",params:{panel:"settings"}}},{path:"system/:panel?",name:"system",component:function(){return n.e("21d982da").then(n.bind(null,"8fac"))},props:!0}]},{path:"/login",name:"login",component:function(){return n.e("334f41d4").then(n.bind(null,"013f"))}}];Qe.push({path:"*",component:function(){return n.e("4b4818b8").then(n.bind(null,"ee5d"))}});var Ye=Qe;s["default"].use(Ve["a"]);var Ge=function(){var e=new Ve["a"]({scrollBehavior:function(){return{x:0,y:0}},routes:Ye,mode:"hash",base:"/client/"});return e},Je=function(){var e="function"===typeof Ge?Ge({Vue:s["default"]}):Ge,t={el:"#q-app",router:e,render:function(e){return e(Ne)}};return{app:t,router:e}},Ke=n("a925"),Ze={failed:"Action failed",success:"Action was successful"},Xe={"en-us":Ze};s["default"].use(Ke["a"]);var et=new Ke["a"]({locale:"en-us",fallbackLocale:"en-us",messages:Xe}),tt=function(e){var t=e.app;t.i18n=et},nt=n("0ae4"),it=n.n(nt),rt=(n("df2e"),function(e){We["a"].install(e),e.Vue.use(it.a)}),ot=n("1dce"),at=n.n(ot),st=function(e){var t=e.Vue;t.use(at.a)},ct=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.visible?n("vue-touch-keyboard",{staticClass:"vkeyboard",attrs:{layout:e.layout,cancel:e.hide,accept:e.accept,change:e.change,next:e.next,input:e.input,options:e.options}}):e._e()},lt=[],ut=n("f186"),dt=n.n(ut),ft=(n("a245"),n("f303")),ht=ft["c"].style,mt=null,pt=function(e){if(mt){var t=e.target.nodeName.toLowerCase();if("input"==t||"textarea"==t){var n=e.target,i=null;if("input"==t){var r=n.getAttribute("type");switch(r){case"number":i="numeric";break}}mt.show(n,i)}}},vt=function(e){mt||(mt=e,document.body.addEventListener?document.body.addEventListener("focus",pt,!0):document.body.onfocusin=pt)},bt=function(e){mt&&(mt=null,document.body.addEventListener?document.body.removeEventListener("focus",pt,!0):document.body.onfocusin=null)},_t={name:"VKeyboard",components:{"vue-touch-keyboard":dt.a.component},data:function(){return{visible:!1,layout:"normal",input:null,options:{useKbEvents:!1,preventClickEvent:!0}}},methods:{accept:function(e){this.hide()},show:function(e,t){this.input=e,this.layout=e.dataset.layout||t||"normal",this.visible||(this.visible=!0)},hide:function(){this.visible=!1},change:function(e,t){var n=new InputEvent("input",{data:e,bubbles:!0,cancelable:!0});this.input.dispatchEvent(n)},next:function(){var e=this,t=document.querySelectorAll("input"),n=!1;t=[].filter.call(t,(function(e){return"none"!==ht(e,"display")})),t.forEach((function(i,r){!n&&i==e.input&&r<t.length-1&&(n=!0,e.$nextTick((function(){t[r+1].focus()})))})),n||(this.input.blur(),this.hide())}},mounted:function(){vt(this)},beforeDestroy:function(){bt(this)}},gt=_t,yt=(n("2a5a"),Object(Re["a"])(gt,ct,lt,!1,null,null,null)),xt=yt.exports,wt=function(e){e.app,e.router;var t=e.Vue;e.store;t.component("VKeyboard",xt)},Ct=(n("6b5b"),n("a70e")),$t=n.n(Ct),kt=n("5ad2"),qt=n.n(kt),Ot=n("8dcb"),St=n.n(Ot);$t.a.registerLanguage("json",qt.a),$t.a.registerLanguage("xml",St.a);var jt,Et,Tt={install:function(e){e.directive("highlightjs",{deep:!0,bind:function(e,t){var n,i,r=e.querySelectorAll("code");for(i=0;i<r.length;i+=1)n=r[i],"string"===typeof t.value&&(n.textContent=t.value),$t.a.highlightBlock(n)},componentUpdated:function(e,t){var n,i,r=e.querySelectorAll("code");for(i=0;i<r.length;i+=1)n=r[i],"string"===typeof t.value&&(n.textContent=t.value),$t.a.highlightBlock(n)}})}},It=function(e){var t=e.Vue;t.use(Tt)},Dt=n("426a"),Mt=n.n(Dt),At=function(e){var t=e.Vue;new t({data:{ething:Mt.a}});t.prototype.$ething=Mt.a,window&&(window.EThing=Mt.a)},Ft=n("e35a"),Bt=(n("f751"),{name:"FormSchema",props:{value:{}},inheritAttrs:!1,render:function(e){var t=this;return Object(Ft["makeForm"])(e,Object.assign({value:this.value},this.$attrs),{input:function(e){t.$emit("input",e)},error:function(e){t.$emit("error",e)}})}}),Pt=Bt,Lt=Object(Re["a"])(Pt,jt,Et,!1,null,null,null),zt=Lt.exports,Rt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-select"},[n("q-select",{attrs:{value:e.c_value,options:e.items,error:!!e.error,multiple:e.isMultiple,"hide-bottom-space":"",dense:"","emit-value":""},on:{input:function(t){e.c_value=t}}})],1)},Ut=[],Nt={name:"FormSchemaSelect",mixins:[Ft["FormComponent"]],computed:{enumSchema:function(){return this.isBoolean?Object.assign({enum:[!0,!1],$labels:["True","False"]},this.c_schema):this.isMultiple?this.c_schema.items:this.c_schema},items:function(){var e=this;return(this.enumSchema.enum||[]).map((function(t,n,i){var r=i.length;return{label:String(e.getLabel(e.enumSchema,t,n,r)),value:t,icon:e.getIcon(e.enumSchema,t,n,r)}}))},isMultiple:function(){return"array"===this.c_schema.type&&this.c_schema.items.enum},isBoolean:function(){return"boolean"===this.c_schema.type}},methods:{getLabel:function(e,t,n,i){var r=e["$labels"]||[];if(Array.isArray(r)){if(n<r.length)return r[n]}else if("function"===typeof r)return r.call(this,t,n,i);return t},getIcon:function(e,t,n,i){var r=e["$icons"]||[];if(Array.isArray(r)){if(n<r.length)return r[n]}else if("function"===typeof r)return r.call(this,t,n,i)}},rule:function(e){return"undefined"!=typeof e.enum||"array"===e.type&&e.items.enum||"boolean"===e.type}},Vt=Nt,Ht=Object(Re["a"])(Vt,Rt,Ut,!1,null,null,null),Wt=Ht.exports,Qt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-radio"},e._l(e.items,(function(t,i){return n("q-radio",{key:i,attrs:{val:"item.value",label:"item.label"},model:{value:e.c_value,callback:function(t){e.c_value=t},expression:"c_value"}})})),1)},Yt=[],Gt={name:"FormSchemaRadio",mixins:[Wt],rule:function(e){return"undefined"!=typeof e.enum||"boolean"===e.type}},Jt=Gt,Kt=Object(Re["a"])(Jt,Qt,Yt,!1,null,null,null),Zt=Kt.exports,Xt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-checkbox"},e._l(e.items,(function(t,i){return n("q-checkbox",{key:i,attrs:{val:"item.value",label:"item.label"},model:{value:e.c_value,callback:function(t){e.c_value=t},expression:"c_value"}})})),1)},en=[],tn={name:"FormSchemaCheckbox",mixins:[Wt],rule:function(e){return"array"===e.type&&e.items.enum}},nn=tn,rn=Object(Re["a"])(nn,Xt,en,!1,null,null,null),on=rn.exports,an=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-input"},[n("combobox",e._b({attrs:{type:e.inputType,value:e.c_value,error:!!e.error,placeholder:e.c_schema["$placeholder"],"hide-bottom-space":"",dense:"",items:e.c_schema["$hints"]},on:{input:function(t){e.c_value=e.__cast_input_val(t)}}},"combobox",e.attributes,!1))],1)},sn=[],cn=(n("6762"),n("2fdb"),n("c5f6"),n("b5ae")),ln=(n("3b2b"),n("78ef")),un=function(e){return Object(ln["withParams"])({type:"regex",pattern:e},(function(t){return!Object(ln["req"])(t)||new RegExp(e).test(t)}))},dn=n("b314"),fn=function(e){return void 0!==e&&null!==e},hn={name:"FormSchemaInput",components:{Combobox:dn["a"]},mixins:[Ft["FormComponent"]],validations:function(){var e={};return"string"===this.c_schema.type?("number"===typeof this.c_schema.minLength&&(0===this.c_schema.minLength&&(e.required=fn),e.minLength=Object(cn["minLength"])(this.c_schema.minLength)),"number"===typeof this.c_schema.maxLength&&(e.maxLength=Object(cn["maxLength"])(this.c_schema.maxLength)),"string"===typeof this.c_schema.pattern&&(e.regex=un(this.c_schema.pattern)),"email"===this.c_schema.format&&(e.email=cn["email"])):"number"!==this.c_schema.type&&"integer"!==this.c_schema.type||("number"===typeof this.c_schema.minimum&&(e.minValue=Object(cn["minValue"])(this.c_schema.minimum)),"number"===typeof this.c_schema.maximum&&(e.maxValue=Object(cn["maxValue"])(this.c_schema.maximum))),{c_value:e}},methods:{__cast_input_val:function(e){return"number"===this.inputType&&(e=Number(e)),e},__createValue:function(e,t){e.length>0&&(this.c_schema["$hints"].includes(e)||t(e,"add-unique"))}},computed:{inputType:function(){return"string"===this.c_schema.type?"email"===this.c_schema.format?"email":"url"===this.c_schema.format?"url":"text":"number"===this.c_schema.type||"integer"===this.c_schema.type?"number":"text"},isNumber:function(){return"number"===this.c_schema.type||"integer"===this.c_schema.type},isInteger:function(){return"integer"===this.c_schema.type},attributes:function(){var e={};return this.isInteger&&(e.decimals=0),this.isNumber&&("number"===typeof this.c_schema.minimum&&(e.min=this.c_schema.minimum),"number"===typeof this.c_schema.maximum&&(e.max=this.c_schema.maximum),"number"===typeof this.c_schema.multipleOf&&(e.step=this.c_schema.multipleOf)),"string"===this.c_schema.type&&"number"===typeof this.c_schema.maxLength&&(e.maxlength=this.c_schema.maxLength),e}},rule:function(e){return-1!==["string","number","integer"].indexOf(e.type)}},mn=hn,pn=Object(Re["a"])(mn,an,sn,!1,null,null,null),vn=pn.exports,bn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-file"},[n("div",[n("span",{staticClass:"q-mr-md relative-position overflow-hidden"},[n("q-icon",{attrs:{name:"add",color:"primary"}}),e._v(" add file\n      "),n("input",{ref:"file",staticClass:"file-input absolute-full cursor-pointer",attrs:{type:"file",accept:e.c_schema.accept},on:{change:e.__add}})],1),e._l(e.files,(function(t,i){return n("small",{key:i,staticClass:"text-faded"},[e._v("\n      "+e._s(t.name)+" ("+e._s(t.__size)+")\n    ")])}))],2)])},_n=[],gn=(n("28a5"),n("7937")),yn=gn["c"].humanStorageSize,xn={name:"FormSchemaFile",mixins:[Ft["FormComponent"]],data:function(){return{files:[]}},methods:{__add:function(e,t){var n=this;t=Array.prototype.slice.call(t||e.target.files),this.$refs.file.value="";t=t.map((function(e){return e.__size=yn(e.size),e.__timestamp=(new Date).getTime(),e.__converting=!0,n.convert(e,(function(t){n.$nextTick((function(){e.__converting=!1,n.c_value=t}))}),(function(e){n.files=[],n.$emit("error",String(e)),n.c_value=void 0})),e})),this.files=t},convert:function(e,t,n){var i=this,r=function(r){var o=i.c_schema["$converter"];if("function"===typeof o)try{o.call(i,e,r,t,n)}catch(a){n(a)}else t(r)};if("data-url"===this.c_schema.format){var o=new FileReader;o.onloadend=function(e){r(o.result)},o.readAsDataURL(e)}else if("base64"===this.c_schema.format){var a=new FileReader;a.onloadend=function(e){var t=a.result,n=t.split(",",2);r(n[1])},a.readAsDataURL(e)}else if("text"===this.c_schema.format){var s=new FileReader;s.onloadend=function(e){r(s.result)},s.readAsText(e)}else r(e)}},rule:function(e){return"string"===e.type&&-1!==["data-url","base64"].indexOf(e.format)}},wn=xn,Cn=(n("1f0e"),Object(Re["a"])(wn,bn,_n,!1,null,"94e42a08",null)),$n=Cn.exports,kn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-password"},[n("q-input",{attrs:{type:"password",value:e.c_value,error:!!e.error,"hide-bottom-space":"",dense:"",debounce:"500",placeholder:e.c_schema["$placeholder"]},on:{input:function(t){e.c_value=t}}})],1)},qn=[],On={name:"FormSchemaPassword",mixins:[vn]},Sn=On,jn=Object(Re["a"])(Sn,kn,qn,!1,null,null,null),En=jn.exports,Tn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-textarea"},[n("q-input",{attrs:{type:"textarea",value:e.c_value,error:!!e.error,placeholder:e.c_schema["$placeholder"],rows:e.c_schema["$rows"],"hide-bottom-space":"",dense:"",debounce:"500"},on:{input:function(t){e.c_value=t}}})],1)},In=[],Dn={name:"FormSchemaTextarea",mixins:[vn]},Mn=Dn,An=Object(Re["a"])(Mn,Tn,In,!1,null,null,null),Fn=An.exports,Bn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-color"},[n("q-field",{attrs:{error:!!e.error,"hide-bottom-space":"",dense:""},nativeOn:{click:function(t){e.isDialogOpen=!0}},scopedSlots:e._u([{key:"control",fn:function(){return[e._v("\n      "+e._s(e.c_value)+"\n    ")]},proxy:!0},{key:"append",fn:function(){return[n("div",{staticClass:"cursor-pointer",staticStyle:{width:"24px",height:"24px","border-radius":"50%",border:"1px solid grey"},style:{"background-color":e.c_value}},[e._v("Â ")]),n("q-icon",{staticClass:"cursor-pointer",attrs:{right:"",name:"colorize"}},[n("q-dialog",{attrs:{"transition-show":"scale","transition-hide":"scale",square:""},model:{value:e.isDialogOpen,callback:function(t){e.isDialogOpen=t},expression:"isDialogOpen"}},[n("q-color",{staticClass:"no-border-radius",attrs:{"format-model":e.c_schema.$format||"hex"},model:{value:e.c_value,callback:function(t){e.c_value=t},expression:"c_value"}})],1)],1)]},proxy:!0}])})],1)},Pn=[],Ln={name:"FormSchemaColor",mixins:[vn],data:function(){return{isDialogOpen:!1}},methods:{cast:function(e){return e||"#FF0000"}},rule:function(e){return"string"===e.type&&"color"===e.format}},zn=Ln,Rn=Object(Re["a"])(zn,Bn,Pn,!1,null,null,null),Un=Rn.exports,Nn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-datetime"},[n("q-field",{attrs:{error:!!e.error,"hide-bottom-space":"",dense:""},nativeOn:{click:function(t){e.isDialogOpen=!0}},scopedSlots:e._u([{key:"control",fn:function(){return[e._v("\n      "+e._s(e.c_value)+"\n    ")]},proxy:!0},{key:"append",fn:function(){return[n("q-icon",{staticClass:"cursor-pointer",attrs:{name:e.showDate?"event":"access_time"}},[n("q-dialog",{attrs:{"transition-show":"scale","transition-hide":"scale",square:""},model:{value:e.isDialogOpen,callback:function(t){e.isDialogOpen=t},expression:"isDialogOpen"}},[n("div",{staticClass:"row items-stretch",style:{"max-width":e.__width,width:e.__width}},[e.showDate?n("q-date",{staticClass:"col-xs-12 no-shadow no-border-radius",class:e.__both?"col-sm-6":"",attrs:{mask:e._mask},model:{value:e._date,callback:function(t){e._date=t},expression:"_date"}}):e._e(),e.showTime?n("q-time",{staticClass:"col-xs-12 no-shadow no-border-radius",class:e.__both?"col-sm-6":"",attrs:{mask:e._mask,format24h:""},model:{value:e._date,callback:function(t){e._date=t},expression:"_date"}}):e._e()],1)])],1)]},proxy:!0}])})],1)},Vn=[],Hn={name:"FormSchemaDatetime",mixins:[Ft["FormComponent"]],data:function(){return{isDialogOpen:!1}},computed:{showDate:function(){return"time"!==this.c_schema.format},showTime:function(){return"date"!==this.c_schema.format},_mask:function(){var e=this.c_schema.format;return"time"===e?"HH:mm":"date"===e?"YYYY-MM-DD":"YYYY-MM-DD HH:mm"},_date:{get:function(){return this.c_value},set:function(e){this.c_value=e}},__both:function(){return this.showDate&&this.showTime},__width:function(){return this.__both&&!this.$q.screen.xs?"600px":"300px"}},rule:function(e){return"string"===e.type&&-1!==["date-time","datetime","date","time"].indexOf(e.format)}},Wn=Hn,Qn=Object(Re["a"])(Wn,Nn,Vn,!1,null,null,null),Yn=Qn.exports,Gn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-range"},[n("q-slider",e._b({attrs:{value:"undefined"===typeof e.c_value?0:e.c_value,error:!!e.error,"label-always":""},on:{input:function(t){e.c_value=t}}},"q-slider",e.attributes,!1))],1)},Jn=[],Kn={name:"FormSchemaRange",mixins:[vn],rule:function(e){return("number"===e.type||"integer"===e.type)&&"undefined"!==typeof e.minimum&&"undefined"!==typeof e.maximum}},Zn=Kn,Xn=Object(Re["a"])(Zn,Gn,Jn,!1,null,null,null),ei=Xn.exports,ti=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-object",class:{indent:e.level}},[e.items.length>1?[n("q-tabs",{staticClass:"text-grey",attrs:{dense:"",align:"justify"},model:{value:e.group_,callback:function(t){e.group_=t},expression:"group_"}},e._l(e.items,(function(t){return n("q-tab",{key:t.name,class:{"text-negative":e.hasGroupError(t),"text-primary":t.name===e.group_},attrs:{name:t.name,label:t.name}})})),1),n("q-separator",{staticClass:"q-mb-md"})]:e._e(),n("q-tab-panels",{attrs:{"keep-alive":""},model:{value:e.group_,callback:function(t){e.group_=t},expression:"group_"}},e._l(e.items,(function(t){return n("q-tab-panel",{key:t.name,staticClass:"q-pa-none",attrs:{name:t.name}},[t.items.length>0?e._l(t.items,(function(t){return n("div",{key:t.key,staticClass:"form-schema-object-item",class:{"form-schema-object-item-required":t.required,"form-schema-object-item-error":!!e.errors[t.key]},style:{display:e.inlined?"inline":"block"}},[t.schema.$hideLabel?e._e():n("div",{staticClass:"form-schema-object-item-title text-subtitle2",style:{display:e.inlined?"inline":"block"}},[e._v("\n            "+e._s(t.schema.title||t.key)+"\n            "),t.schema.$optional?n("q-toggle",{staticClass:"q-ml-sm",attrs:{value:t.enable},on:{input:function(n){return e.onEnableChange(t,n)}}}):e._e()],1),t.enable?n("form-schema",{attrs:{required:t.required,inline:e.inlined,"force-description":!e.inlined,schema:t.schema,value:t.model,level:e.level+1},on:{input:function(n){return e.onChildValueChange(t,n)},error:function(n){return e.onChildErrorChange(t,n)}}}):e._e()],1)})):n("div",[n("small",{staticClass:"text-faded"},[e._v("empty")])])],2)})),1)],2)},ni=[],ii=(n("7f7f"),n("8615"),n("ac6a"),n("cadf"),n("06db"),n("456d"),n("8993")),ri=n.n(ii);function oi(e){return"object"===ri()(e)&&null!==e}var ai={name:"FormSchemaObject",mixins:[Ft["FormComponent"]],data:function(){return{errors:{},cache:{},group_:null}},computed:{items:function(){var e=this,t=this.c_schema,n=t.required||[],i=[],r=[];for(var o in t.properties)!t.properties[o]||t.properties[o]["$disabled"]?r.push(o):t.properties[o]["$readOnly"]?i.push(o):t.properties[o]["$required"]&&-1===n.indexOf(o)&&!t.properties[o]["$optional"]&&n.push(o);var a=n.concat(Object.keys(t.properties||{}).filter((function(e){return-1===n.indexOf(e)&&-1===i.indexOf(e)}))).filter((function(e){return-1===r.indexOf(e)&&!!t.properties[e]})),s=[];if(a.forEach((function(e){var n=t.properties[e]["$group"];-1===s.indexOf(n)&&s.push(n)})),t["$order"])for(var c=t["$order"].length;c>0;c--){var l=t["$order"][c-1],u=a.indexOf(l);-1!==u&&(a.splice(u,1),a.unshift(l))}var d=!1;Object.keys(this.errors).forEach((function(t){-1===a.indexOf(t)&&(delete e.errors[t],d=!0)})),d&&this.$emit("error",Object.values(this.errors).some((function(e){return e})));var f=Object.assign({},this.c_value),h=!1;Object.keys(f).forEach((function(e){-1===a.indexOf(e)&&(delete f[e],h=!0)})),h&&(this.c_value=f);var m=a.map((function(i){var r=t.properties[i],o=(e.c_value||{})[i],a=r["$group"],s=!0;return r.$optional&&(s=e.c_value&&i in e.c_value),{key:i,schema:r,required:-1!==n.indexOf(i),model:o,enable:s,group:a}}));return s.map((function(e){var t=e||"general";return{name:t,items:m.filter((function(t){return t.group===e}))}}))}},watch:{items:{handler:function(e){var t=e.map((function(e){return e.name}));null!==this.group_&&-1!==t.indexOf(this.group_)||(this.group_=t[0])},immediate:!0}},methods:{onChildValueChange:function(e,t){if(oi(this.c_value))this.$set(this.c_value,e.key,t);else{var n={};n[e.key]=t,this.c_value=n}},onChildErrorChange:function(e,t){this.$set(this.errors,e.key,t),this.$emit("error",Object.values(this.errors).some((function(e){return e})))},onEnableChange:function(e,t){t?(this.$set(this.c_value,e.key,this.cache[e.key]),delete this.cache[e.key]):(this.cache[e.key]=this.c_value[e.key],this.$delete(this.c_value,e.key))},hasGroupError:function(e){var t=this;return e.items.some((function(e){return t.errors[e.key]}))}},rule:function(e){return"object"===e.type||"object"===ri()(e.properties)}},si=ai,ci=(n("586d"),Object(Re["a"])(si,ti,ni,!1,null,"45c68345",null)),li=ci.exports,ui=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-array",class:{indent:e.level}},[n("div",[n("q-btn",{staticClass:"q-mb-xs",attrs:{outline:"",dense:"",label:"Add item",icon:"add",size:"xs",color:"grey"},on:{click:e.addItem}})],1),n("div",{staticClass:"form-schema-array-content"},[e._l(e.items,(function(t,i){return n("div",{key:i,staticClass:"form-schema-array-item"},[n("div",{staticClass:"form-schema-array-item-header"},[n("q-btn",{staticStyle:{"vertical-align":"middle"},attrs:{size:"xs",color:"negative",label:"remove",icon:"delete"},on:{click:function(t){return e.removeItem(i)}}}),i>0?n("q-btn",{attrs:{flat:"",size:"sm",color:"secondary",label:"up",icon:"arrow_drop_up"},on:{click:function(t){return e.moveItem(i,"up")}}}):e._e(),i<e.items.length-1?n("q-btn",{attrs:{flat:"",size:"sm",color:"secondary",label:"down",icon:"arrow_drop_down"},on:{click:function(t){return e.moveItem(i,"down")}}}):e._e()],1),n("form-schema",{attrs:{inline:"",schema:t.schema,value:e.getModel(i),level:e.level+1},on:{input:function(t){return e.onChildValueChange(i,t)},error:function(t){return e.onChildErrorChange(i,t)}}})],1)})),n("div",{staticClass:"form-schema-array-bottom-padding relative-position",staticStyle:{height:"48px"}},[e.items.length?e._e():n("small",{staticClass:"absolute-center faded"},[e._v("empty")])])],2)])},di=[],fi={name:"FormSchemaArray",mixins:[Ft["FormComponent"]],data:function(){return{items:[]}},watch:{c_value:function(){this.refreshFromModel()}},methods:{refreshFromModel:function(){var e=this;this.items=(this.c_value||[]).map((function(t){return{schema:e.c_schema.items||{}}}))},getModel:function(e){return Array.isArray(this.c_value)&&e<this.c_value.length?this.c_value[e]:void 0},addItem:function(){this.items.push({schema:this.c_schema.items||{}})},removeItem:function(e){this.items.splice(e,1),this.c_value.splice(e,1)},moveItem:function(e,t){var n=this.items.splice(e,1),i=this.c_value.splice(e,1);this.items.splice(e+("up"===t?-1:1),0,n[0]),this.c_value.splice(e+("up"===t?-1:1),0,i[0])},onChildValueChange:function(e,t){this.c_value?this.$set(this.c_value,e,t):this.c_value=[t]},onChildErrorChange:function(e,t){this.$set(this.items[e],"error",t),this.$emit("error",Object.values(this.items).some((function(e){return e.error})))}},mounted:function(){this.refreshFromModel()},rule:function(e){return"array"===e.type}},hi=fi,mi=(n("8805"),Object(Re["a"])(hi,ui,di,!1,null,"0f761fe5",null)),pi=mi.exports,vi=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-input"},[n("pre",[e._v(e._s(e.c_value))])])},bi=[],_i={name:"FormSchemaConst",mixins:[Ft["FormComponent"]],rule:function(e){return"undefined"!==typeof e.const}},gi=_i,yi=Object(Re["a"])(gi,vi,bi,!1,null,null,null),xi=yi.exports,wi=[Wt,Zt,on,$n,Yn,Un,vn,En,Fn,ei,pi,li,xi],Ci=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-bluetooth-interface"},[n("combobox",{attrs:{type:"number",value:e.c_value,error:!!e.error,"hide-bottom-space":"",dense:"",items:e.asyncItems,prefix:"hci","empty-message":"no bluetooth interface detected"},on:{input:function(t){e.c_value=t}},scopedSlots:e._u([{key:"item-content",fn:function(t){var i=t.item;return[n("q-item-section",[n("q-item-label",[e._v(e._s(i.hci))]),i.address?n("q-item-label",{attrs:{caption:""}},[e._v("mac: "+e._s(i.address))]):e._e(),i.name?n("q-item-label",{attrs:{caption:""}},[e._v("name: "+e._s(i.name))]):e._e(),i.status?n("q-item-label",{attrs:{caption:""}},[e._v("status: "+e._s(i.status))]):e._e(),i.manufacturer?n("q-item-label",{attrs:{caption:""}},[e._v("manufacturer: "+e._s(i.manufacturer))]):e._e()],1)]}}])})],1)},$i=[],ki=(n("4917"),{name:"FormSchemaBluetoothInterface",mixins:[Ft["FormComponent"]],methods:{parseIntFromHci:function(e){return parseInt(e.match(/^hci([0-9]+)$/)[1])},asyncItems:function(e){Mt.a.request({url:"utils/bluetooth_list",dataType:"json"}).then((function(t){e(t.map((function(e){return e.value=parseIntFromHci(e.hci),e})))})).catch((function(){e()}))}}}),qi=ki,Oi=Object(Re["a"])(qi,Ci,$i,!1,null,null,null),Si=Oi.exports,ji=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-editor",attrs:{"force-description":""}},[n("codemirror",{ref:"cm",attrs:{value:e.c_value||"",options:e.cmOption},on:{input:function(t){e.c_value=t}}})],1)},Ei=[],Ti=n("8f94"),Ii=(n("a7be"),n("f9d4"),n("ced0"),n("db91"),n("8c33"),n("10b2"),{name:"FormSchemaEditor",mixins:[Ft["FormComponent"]],components:{codemirror:Ti["codemirror"]},data:function(){return{cmOption:{mode:this.schema["$lang"]||"text",tabSize:4,styleActiveLine:!0,lineNumbers:!0,lineWrapping:!1,styleSelectedText:!0,matchBrackets:!0,autoCloseBrackets:!0,showCursorWhenSelecting:!0,extraKeys:{Ctrl:"autocomplete"},hintOptions:{completeSingle:!1},viewportMargin:1/0}}},mounted:function(){var e=this;setTimeout((function(){e.$refs.cm&&e.$refs.cm.refresh()}),400)}}),Di=Ii,Mi=(n("95fd"),Object(Re["a"])(Di,ji,Ei,!1,null,null,null)),Ai=Mi.exports,Fi=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-ething-flow-node"},[n("flow-node-select",{attrs:{value:e.c_value,filter:e.computed_filter,multiple:e.multiple,flow:e.flow,"use-id":""},on:{input:function(t){e.c_value=t}}})],1)},Bi=[],Pi=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-select",e._b({attrs:{value:e.formattedValue,options:e.options,multiple:e.multiple,"emit-value":""},on:{input:function(t){e.$emit("input",e._formatValueOut(t))}}},"q-select",e.$attrs,!1))},Li=[],zi=(n("7514"),{name:"FlowNodeSelect",props:{filter:{},value:{},useId:Boolean,multiple:Boolean,flow:{}},computed:{computedFlow:function(){return"string"===typeof this.flow?this.$ething.arbo.get(this.flow):this.flow},formattedValue:function(){if(this.multiple){var e=[];return Array.isArray(this.value)?e=this.value:this.value&&(e=[this.value]),e.map(this._formatValueIn)}return this._formatValueIn(this.value)},nodes:function(){var e=this,t=[];return this.$ething.arbo.find((function(e){return e instanceof Mt.a.Flow})).forEach((function(n){e.computedFlow&&n.id()!==e.computedFlow.id()||n.attr("nodes").forEach((function(i){e.filter&&!e.filter.call(e,n,i)||t.push({flow:n,node:i})}))})),t},options:function(){var e=this;return this.nodes.map((function(t){var n,i=t.flow,r=t.node;return n=e.flow?r.id:i.id()+":"+r.id,{label:r.name,value:n,icon:e.$ethingUI.get(r.type).icon,leftColor:e.$ethingUI.get(r.type).color,inset:!0,stamp:e.$ethingUI.get(r.type).title,sublabel:e.flow?null:i.basename()}}))}},methods:{_formatValueIn:function(e){return this.flow?this.useId?e:e.id:this.useId?e.flow+":"+e.node:e.flow.id()+":"+e.node.id},_formatValueOut:function(e){if(this.flow){if(this.useId)return e;var t=this.nodes;for(var n in t)if(t[n].node.id===e)return t[n].node}else{var i=e.split(":"),r=i[0],o=i[1];if(this.useId)return{flow:r,node:o};t=this.nodes;for(var n in t)if(t[n].flow.id()===r&&t[n].node.id===o)return t[n]}}}}),Ri=zi,Ui=Object(Re["a"])(Ri,Pi,Li,!1,null,null,null),Ni=Ui.exports,Vi={name:"FormSchemaEthingFlowNode",mixins:[Ft["FormComponent"]],components:{FlowNodeSelect:Ni},computed:{multiple:function(){return"array"===this.c_schema.type},computed_filter:function(){var e=this,t=this.c_schema;return function(n,i){return e.filter(n,i,t)}},flow:function(){var e=this.c_schema["$flow"];return"$context"===e&&(e=this.getContext("flow")),"function"===typeof e&&(e=e.call(this.c_schema)),e}},methods:{filter:function(e,t,n){var i=n["$filter"];if(i)if("string"===typeof i){if(!this.$ethingUI.isSubclass(t.type,i))return!1}else if(!i.call(n,e,t))return!1;return!0}}},Hi=Vi,Wi=Object(Re["a"])(Hi,Fi,Bi,!1,null,null,null),Qi=Wi.exports,Yi=n("dd5d"),Gi=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-ething-plugin"},[n("plugin-select",{attrs:{value:e.c_value,filter:e.computed_filter,"use-type":"",dense:"",error:!!e.error,"hide-bottom-space":""},on:{input:function(t){e.c_value=t}}})],1)},Ji=[],Ki=n("15b6"),Zi={name:"FormSchemaEthingPlugin",mixins:[Ft["FormComponent"]],components:{PluginSelect:Ki["a"]},computed:{computed_filter:function(){var e=this,t=this.c_schema;return function(n){return e.filter(n,t)}}},methods:{filter:function(e,t){var n;if(t["$must_throw"]){n=!1;var i=this.$ethingUI.findPlugin(e).signals;for(var r in i)if(this.$ethingUI.isSubclass(i[r],t["$must_throw"])){n=!0;break}if(!n)return!1}return!(t["$filter"]&&!t["$filter"].call(t,e))}}},Xi=Zi,er=Object(Re["a"])(Xi,Gi,Ji,!1,null,"8b456240",null),tr=er.exports,nr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-cron"},[n("q-btn",{attrs:{flat:"",color:"primary",icon:"edit",label:e.c_value?"change":"set"},on:{click:function(t){e.editing=!0}}}),n("div",[e._v(e._s(e.readableExp))]),n("modal",{attrs:{title:"Cron editor",icon:"event"},on:{valid:e.apply},model:{value:e.editing,callback:function(t){e.editing=t},expression:"editing"}},[n("cron",{staticClass:"q-ma-md",attrs:{value:e.c_value},on:{input:function(t){e.editedExp=t}}})],1)],1)},ir=[],rr=(n("6b54"),n("80c5")),or=n("2772"),ar=n.n(or),sr={name:"FormSchemaCron",mixins:[Ft["FormComponent"]],components:{Cron:rr["a"]},data:function(){return{editedExp:null,editing:!1}},computed:{readableExp:function(){return this.c_value?ar.a.toString(this.c_value):""}},methods:{apply:function(){this.editing=!1,this.c_value=this.editedExp}}},cr=sr,lr=Object(Re["a"])(cr,nr,ir,!1,null,null,null),ur=lr.exports,dr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-host"},[n("combobox",{attrs:{value:e.c_value,error:!!e.error,"hide-bottom-space":"",dense:"",items:e.asyncItems},on:{input:function(t){e.c_value=t}},scopedSlots:e._u([{key:"item-content",fn:function(t){var i=t.item;return[n("q-item-section",[n("q-item-label",[e._v(e._s(i.value)+" "),i.is_localhost?n("span",{staticClass:"text-secondary"},[e._v("(localhost)")]):e._e()]),i.mac?n("q-item-label",{attrs:{caption:""}},[e._v("mac: "+e._s(i.mac))]):e._e(),i.vendor?n("q-item-label",{attrs:{caption:""}},[e._v("vendor: "+e._s(i.vendor))]):e._e()],1)]}}])})],1)},fr=[],hr={name:"FormSchemaHost",mixins:[Ft["FormComponent"]],methods:{asyncItems:function(e){Mt.a.request({url:"utils/net_list",dataType:"json"}).then((function(t){e(t.map((function(e){return e.value=e.hostname||e.ip,e})))})).catch((function(){e()}))}}},mr=hr,pr=Object(Re["a"])(mr,dr,fr,!1,null,null,null),vr=pr.exports,br=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-oneof"},[n("div",{class:e.inlined?"row":""},[n("q-select",{class:e.inlined?e.subschema?"col-auto":"col-12":"",attrs:{options:e.items,"emit-value":"","hide-bottom-space":"",dense:"","display-value":e.currentItem.label||"none"},model:{value:e.typeModel,callback:function(t){e.typeModel=t},expression:"typeModel"}}),e.subschema?n("form-schema",{class:e.inlined?"col":"",attrs:{inline:e.inlined,level:e.level+1,schema:e.subschema,required:""},on:{error:function(t){return e.$emit("error",t)}},model:{value:e.valueModel,callback:function(t){e.valueModel=t},expression:"valueModel"}}):e._e()],1)])},_r=[],gr=function(e){return void 0!==e},yr=function(e){return!0},xr={name:"FormSchemaOneof",mixins:[Ft["FormComponent"]],data:function(){return{}},computed:{items:function(){var e=this,t=this.c_schema.oneOf||[];return t.map((function(t,n,i){var r=i.length,o=null,a=null,s=null,c=null,l=null;return"undefined"!==typeof t.const?(o=function(e){return e===t.const},l=function(){e.c_value=t.const},c=function(e){return null}):t.properties&&t.properties.type&&"undefined"!==typeof t.properties.type.const&&(o=function(e){return"object"===ri()(e)&&null!==e&&e.type===t.properties.type.const},a=function(e){if(e)return e.value},s=function(t){var n=e.currentItem.schema.properties.type.const;e.c_value&&e.c_value.type===n?e.$set(e.c_value,"value",t):e.c_value={type:n,value:t}},c=function(e){return e.properties.value},l=function(){var n={type:t.properties.type.const};t.properties.value&&(n.value=t.properties.value.default),e.c_value=n}),{label:String(e.getLabel(e.c_schema,t,n,r)),value:n,schema:t,icon:e.getIcon(e.c_schema,t,n,r),valueTest:o,valueGetter:a,valueSetter:s,schemaGetter:c,typeModelChange:l}}))},currentItem:function(){return this.items[this.typeModel]||{}},valueModel:{get:function(){var e=this.currentItem;return e.valueGetter?e.valueGetter(this.c_value):this.c_value},set:function(e){var t=this.currentItem;t.valueSetter?t.valueSetter(e):this.c_value=e}},typeModel:{get:function(){var e=this.items,t=this.c_value,n=0;for(var i in e){var r=e[i];if(r.valueTest){if(r.valueTest(t))return i}else n=i}return n},set:function(e){var t=this.items[e]||{};t.typeModelChange?t.typeModelChange():this.c_value=t.schema.default}},selectOptions:function(){return this.items.map((function(e,t){return{label:e.label,value:t,icon:e.icon}}))},subschema:function(){if("undefined"!==typeof this.typeModel){var e=this.items[this.typeModel];return e.schemaGetter?e.schemaGetter(e.schema):e.schema}}},watch:{subschema:function(e,t){e||this.$emit("error",!1)}},validations:function(){return{c_value:this.required?{required:gr}:{required:yr}}},methods:{getLabel:function(e,t,n,i){if("undefined"!==typeof e["$labels"]){var r=e["$labels"];if(Array.isArray(r)){if(n<r.length)return r[n]}else if("function"===typeof r)return r.call(this,t,n,i)}if(t.title)return t.title;if(t.properties&&t.properties.type){if(t.properties.type.title)return t.properties.type.title;if(t.properties.type.const)return t.properties.type.const}return"schema #"+n},getIcon:function(e,t,n,i){if("undefined"!==typeof e["$icons"]){var r=e["$icons"];if(Array.isArray(r)){if(n<r.length)return r[n]}else if("function"===typeof r)return r.call(this,t,n,i)}return"undefined"!==typeof t["$icon"]?t["$icon"]:t.properties&&t.properties.type&&"undefined"!==typeof t.properties.type["$icon"]?t.properties.type["$icon"]:void 0}},rule:function(e){return Array.isArray(e.oneOf)}},wr=xr,Cr=Object(Re["a"])(wr,br,_r,!1,null,null,null),$r=Cr.exports,kr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-optional",class:{indent:e.level}},[n("div",[n("q-toggle",{attrs:{label:"enable"},model:{value:e.enabled,callback:function(t){e.enabled=t},expression:"enabled"}})],1),e.enabled?n("form-schema",{ref:"sub",attrs:{required:"",schema:e.filteredSchema,value:e.cachedValue,level:e.level},on:{input:e.onChildValueChange,error:function(t){return e.$emit("error",t)}}}):e._e()],1)},qr=[],Or=(n("673e"),n("11ec")),Sr={name:"FormSchemaOptional",mixins:[Ft["FormComponent"]],computed:{filteredSchema:function(){var e=Object.assign({},this.c_schema);delete e.anyOf,delete e.description;var t=this.c_schema.anyOf.filter((function(e){return"null"!==e.type}));return 1==t.length?e=Object(Or["a"])(!0,e,t[0]):e.anyOf=t,e}},data:function(){return{enabled:!1,cachedValue:void 0}},watch:{c_value:function(){this.refreshFromModel()},enabled:function(e){var t=this;this.$nextTick((function(){e?(t.c_value=t.$refs["sub"].c_value,t.$emit("error",t.$refs["sub"].error)):(t.c_value=null,t.$emit("error",!1))}))}},methods:{refreshFromModel:function(){this.enabled=null!==this.c_value&&"undefined"!==typeof this.c_value,this.enabled&&(this.cachedValue=this.c_value)},onChildValueChange:function(e){this.cachedValue=e,this.c_value=e}},mounted:function(){this.refreshFromModel()},rule:function(e){if(Array.isArray(e.anyOf)){var t=e.anyOf.filter((function(e){return"null"===e.type}));if(t.length>0&&t.length<e.anyOf.length)return!0}}},jr=Sr,Er=Object(Re["a"])(jr,kr,qr,!1,null,null,null),Tr=Er.exports,Ir=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-scheduler"},[e.c_value&&e.c_value.length?n("div",e._l(e.c_value,(function(t,i){return n("q-item",{key:i,attrs:{dense:""}},[n("q-item-section",{attrs:{avatar:""}},[n("q-icon",{attrs:{name:"schedule"}})],1),n("q-item-section",[e._v("\n        "+e._s(e.toString(t))+"\n      ")]),n("q-item-section",{attrs:{side:""}},[n("q-btn",{attrs:{icon:"delete",round:"",flat:"",dense:"",color:"negative"},on:{click:function(t){return e.c_value.splice(i,1)}}})],1)],1)})),1):n("div",{staticClass:"q-ma-md text-faded"},[e._v("\n    no scheduling\n  ")]),n("q-btn",{attrs:{color:"blue-5",label:"Add",icon:"add",flat:""},on:{click:function(t){e.modal=!0}}}),n("modal",{attrs:{title:"Scheduler",icon:"schedule","valid-btn-label":"add","cancel-btn-label":"Close","valid-btn-disable":e.itemError},on:{valid:e.add},model:{value:e.modal,callback:function(t){e.modal=t},expression:"modal"}},[n("form-schema",{attrs:{schema:e.itemSchema},on:{error:function(t){e.itemError=t}},model:{value:e.itemModel,callback:function(t){e.itemModel=t},expression:"itemModel"}})],1)],1)},Dr=[],Mr=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];function Ar(e,t,n){return n=n||"0",e+="",e.length>=t?e:new Array(t-e.length+1).join(n)+e}function Fr(e){var t=e.mode,n=e.start,i=e.end;switch(t){case"daily":return"every day between "+n.hour+":"+Ar(n.minute,2)+" and "+i.hour+":"+Ar(i.minute,2);case"weekly":return"between "+Mr[n.weekday-1]+" "+n.hour+":"+Ar(n.minute,2)+" and "+Mr[i.weekday-1]+" "+i.hour+":"+Ar(i.minute,2);case"monthly":return"between "+n.monthday+Br(n.monthday)+" "+n.hour+":"+Ar(n.minute,2)+" and "+i.monthday+Br(i.monthday)+" "+i.hour+":"+Ar(i.minute,2)}}function Br(e){if(e<10||e>=20){if(e%=10,1==e)return"st";if(2==e)return"nd";if(3==e)return"rd"}return"th"}var Pr={name:"FormSchemaScheduler",mixins:[Ft["FormComponent"]],data:function(){for(var e=[],t=1;t<=31;t++)e.push(t);return{modal:!1,itemSchema:{type:"object",additionalProperties:!1,required:["mode","start","end"],properties:{mode:{id:"FormSchemaScheduler.mode",enum:["daily","weekly","monthly"],default:"daily"},start:{type:"object",additionalProperties:!1,required:["weekday","monthday","time"],properties:{monthday:{label:"day of month",enum:e,$dependencies:{"FormSchemaScheduler.mode":function(e,t,n){t.$set(t.parent().c_schema.properties.monthday,"$disabled","monthly"!==e)}}},weekday:{label:"week day",enum:[1,2,3,4,5,6,7],$labels:Mr,$dependencies:{"FormSchemaScheduler.mode":function(e,t,n){t.$set(t.parent().c_schema.properties.weekday,"$disabled","weekly"!==e)}}},time:{type:"string",format:"time"}}},end:{type:"object",additionalProperties:!1,required:["weekday","monthday","time"],properties:{monthday:{label:"day of month",enum:e,$dependencies:{"FormSchemaScheduler.mode":function(e,t,n){t.$set(t.parent().c_schema.properties.monthday,"$disabled","monthly"!==e)}}},weekday:{label:"week day",enum:[1,2,3,4,5,6,7],$labels:Mr,$dependencies:{"FormSchemaScheduler.mode":function(e,t,n){t.$set(t.parent().c_schema.properties.weekday,"$disabled","weekly"!==e)}}},time:{type:"string",format:"time"}}}}},itemModel:{},itemError:!1}},methods:{toString:Fr,add:function(){var e=this.c_value?this.c_value.slice(0):[],t=Object(Or["a"])(!0,{},this.itemModel),n=new Date(t.start.time);delete t.start["time"],t.start["hour"]=n.getHours(),t.start["minute"]=n.getMinutes();var i=new Date(t.end.time);delete t.end["time"],t.end["hour"]=i.getHours(),t.end["minute"]=n.getMinutes(),e.push(t),this.c_value=e,this.modal=!1}}},Lr=Pr,zr=Object(Re["a"])(Lr,Ir,Dr,!1,null,null,null),Rr=zr.exports,Ur=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-scope"},[n("q-select",{attrs:{multiple:"","display-value":e.formattedModel.length?e.formattedModel.join(" "):"none",value:e.formattedModel,options:e.selectOptions,error:!!e.error,"emit-value":""},on:{input:function(t){e.formattedModel=t}}})],1)},Nr=[],Vr={name:"FormSchemaScope",mixins:[Ft["FormComponent"]],data:function(){var e=[];for(var t in this.$ethingUI.scopes){var n=this.$ethingUI.scopes[t];e.push({label:t,value:t,sublabel:n.description})}return{selectOptions:e}},computed:{formattedModel:{get:function(){return(this.c_value||"").split(" ").filter((function(e){return e.length}))},set:function(e){e=e.join(" "),this.c_value=e}}}},Hr=Vr,Wr=Object(Re["a"])(Hr,Ur,Nr,!1,null,"25d711f5",null),Qr=Wr.exports,Yr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-serial-port"},[n("combobox",{attrs:{value:e.c_value,error:!!e.error,"hide-bottom-space":"",dense:"",items:e.asyncItems,"empty-message":"no serial port found"},on:{input:function(t){e.c_value=t}},scopedSlots:e._u([{key:"item-content",fn:function(t){var i=t.item;return[n("q-item-section",[n("q-item-label",[e._v(e._s(i.value))]),i.product?n("q-item-label",{attrs:{caption:""}},[e._v("product: "+e._s(i.product))]):e._e(),i.manufacturer?n("q-item-label",{attrs:{caption:""}},[e._v("manufacturer: "+e._s(i.manufacturer))]):e._e(),i.description?n("q-item-label",{attrs:{caption:""}},[e._v("description: "+e._s(i.description))]):e._e()],1)]}}])})],1)},Gr=[],Jr={name:"FormSchemaSerialPort",components:{Combobox:dn["a"]},mixins:[Ft["FormComponent"]],methods:{asyncItems:function(e){Mt.a.request({url:"utils/serial_ports_list",dataType:"json"}).then((function(t){e(t.map((function(e){return e.value=e.device,e})))})).catch((function(){e()}))}}},Kr=Jr,Zr=Object(Re["a"])(Kr,Yr,Gr,!1,null,null,null),Xr=Zr.exports,eo=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-week-calendar"},[e.c_value&&e.c_value.length?n("div",e._l(e.c_value,(function(t,i){return n("q-item",{key:i,attrs:{dense:""}},[n("q-item-section",{attrs:{avatar:""}},[n("q-icon",{attrs:{name:"schedule"}})],1),n("q-item-section",[e._v("\n        "+e._s(e.toString(t))+"\n      ")])],1)})),1):n("div",{staticClass:"q-ma-md text-faded"},[e._v("\n    no scheduling\n  ")]),n("q-btn",{attrs:{color:"blue-5",label:"Select",icon:"add",flat:""},on:{click:function(t){e.modal=!0}}}),n("modal",{attrs:{title:"Scheduler",icon:"schedule","valid-btn-hide":"","cancel-btn-label":"Close","cancel-btn-color":"faded"},model:{value:e.modal,callback:function(t){e.modal=t},expression:"modal"}},[n("div",{staticClass:"overflow-hidden"},[n("div",{staticClass:"row q-gutter-xs non-selectable"},e._l(e.days,(function(t){return n("div",{staticClass:"col day"},[n("div",{staticClass:"column"},[n("div",{staticClass:"col-auto header q-py-md text-center"},[n("span",{staticClass:"gt-xs"},[e._v(e._s(t.name))]),n("span",{staticClass:"xs"},[e._v(e._s(e.printSmall(t.name)))])]),e._l(t.hours,(function(t){return n("div",{staticClass:"col-auto hour q-pa-xs",class:{selected:t.selected},on:{mousedown:function(n){return e.select(t)},mouseover:function(n){return e.mouseOver(n,t)},mouseup:e.updateValue}},[e._v("\n              "+e._s(t.index)+"\n            ")])}))],2)])})),0)])])],1)},to=[],no=(n("6c7b"),["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"]),io={name:"FormSchemaWeekCalendar",mixins:[Ft["FormComponent"]],data:function(){return{days:this.fromValue(this.c_value),selectMode:!0,modal:!1}},methods:{select:function(e){e.selected=!e.selected,this.selectMode=e.selected},mouseOver:function(e,t){1===e.buttons&&(t.selected=this.selectMode)},updateValue:function(){var e=[];this.days.forEach((function(t,n){var i=n,r=!1,o=null;t.hours.forEach((function(t){t.selected!=r&&(t.selected?o={start:{weekDay:i,hour:t.index}}:(o.end={weekDay:i,hour:t.index},e.push(o),o=null)),r=t.selected})),o&&(o.end={weekDay:i,hour:24},e.push(o),o=null)})),this.c_value=e},inSelection:function(e,t,n){var i=function(e,t){return 100*e+t};for(var r in e){var o=i(e[r].start.weekDay,e[r].start.hour),a=i(e[r].end.weekDay,e[r].end.hour),s=i(t,n);if(s>=o&&s<a)return!0}return!1},fromValue:function(e){var t=this,n=no.map((function(n,i){return{name:n,hours:Array(24).fill(0).map((function(n,r){return{index:r,selected:!!e&&t.inSelection(e,i,r)}}))}}));return n},toString:function(e){return e.start.weekDay===e.end.weekDay?no[e.start.weekDay]+" "+e.start.hour+"h - "+e.end.hour+"h":no[e.start.weekDay]+" "+e.start.hour+"h - "+no[e.end.weekDay]+" "+e.end.hour+"h"},printSmall:function(e){return e.substring(0,3)}},mounted:function(){this.updateValue()}},ro=io,oo=(n("f29f"),Object(Re["a"])(ro,eo,to,!1,null,"95ee0b46",null)),ao=oo.exports,so=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-array-modal"},[n("div",[n("q-btn",{attrs:{flat:"",size:"md",label:"Add item",icon:"add"},on:{click:e.addItem}})],1),e._l(e.items,(function(t,i){return n("div",{key:i,staticClass:"formField"},[n("div",{staticClass:"row items-center"},[n("div",{staticClass:"label col text-faded"},[n("q-icon",{attrs:{name:"keyboard_arrow_right",color:"primary"}}),e._v("\n        "+e._s(e.getLabel(i))+"\n      ")],1),i>0?n("q-btn",{staticClass:"col-auto",attrs:{flat:"",size:"sm",color:"secondary",icon:"arrow_drop_up"},on:{click:function(t){return e.moveItem(i,"up")}}}):e._e(),i<e.items.length-1?n("q-btn",{staticClass:"col-auto",attrs:{flat:"",size:"sm",color:"secondary",icon:"arrow_drop_down"},on:{click:function(t){return e.moveItem(i,"down")}}}):e._e(),n("q-btn",{staticClass:"col-auto",attrs:{flat:"",size:"sm",color:"secondary",label:"edit",icon:"edit"},on:{click:function(t){return e.editItem(i)}}}),n("q-btn",{staticClass:"col-auto",attrs:{flat:"",size:"sm",color:"negative",label:"remove",icon:"delete"},on:{click:function(t){return e.removeItem(i)}}})],1)])})),n("modal",{attrs:{title:"Add item",icon:"add","valid-btn-disable":e.edit.error,"valid-btn-label":"Add"},on:{valid:e.onEditDone},model:{value:e.edit.show,callback:function(t){e.$set(e.edit,"show",t)},expression:"edit.show"}},[n("form-schema",{attrs:{schema:e.schema.items||{},value:e.edit.model},on:{input:function(t){e.edit.model=t},error:function(t){e.edit.error=t}}})],1)],2)},co=[],lo={name:"FormSchemaArrayModal",mixins:[Ft["FormComponent"]],data:function(){return{items:[],edit:{show:!1,model:void 0,error:!1}}},watch:{model:function(){this.refreshFromModel()}},validations:function(){var e={};return"number"===typeof this.c_schema.minItems&&(e.minLength=Object(cn["minLength"])(this.c_schema.minItems)),"number"===typeof this.c_schema.maxItems&&(e.maxLength=Object(cn["maxLength"])(this.c_schema.maxItems)),{c_value:e}},methods:{refreshFromModel:function(){var e=this;this.items=(this.c_value||[]).map((function(t){return{schema:e.c_schema.items||{}}}))},getLabel:function(e){var t=this.c_value._label;return"string"===typeof t?t:"function"===typeof t?t.call(this,e,this.c_value[e]):-1!==["string","boolean","integer","int","long","number","float","double"].indexOf(this.c_schema.items.type)?String(this.c_value[e]):"item #"+e},getModel:function(e){return Array.isArray(this.c_value)&&e<this.c_value.length?this.c_value[e]:void 0},addItem:function(){this.edit.key=-1,this.edit.model=void 0,this.edit.show=!0},onEditDone:function(){-1===this.edit.key?this.c_value.push(this.edit.model):this.$set(this.c_value,this.edit.key,this.edit.model),this.edit.show=!1},removeItem:function(e){this.items.splice(e,1),this.c_value.splice(e,1)},moveItem:function(e,t){var n=this.c_value.splice(e,1);this.c_value.splice(e+("up"===t?-1:1),0,n[0])},editItem:function(e){this.edit.key=e,this.edit.model=this.c_value[e],this.edit.show=!0},onChildValueChange:function(e,t){this.$set(this.c_value,e,t)},onChildErrorChange:function(e,t){this.items[e].error=t,this.$emit("error",Object.values(this.items).some((function(e){return e.error})))}},mounted:function(){this.refreshFromModel()}},uo=lo,fo=(n("5c67"),Object(Re["a"])(uo,so,co,!1,null,"39996014",null)),ho=fo.exports,mo={BluetoothInterface:Si,Editor:Ai,EthingFlowNode:Qi,EthingResource:Yi["a"],EthingPlugin:tr,Cron:ur,Host:vr,Oneof:$r,Optional:Tr,Scheduler:Rr,Scope:Qr,SerialPort:Xr,WeekCalendar:ao,ArrayModal:ho};for(var po in wi)Ft["coreComponents"].push(wi[po]);for(var vo in mo)Ft["registerForm"](mo[vo]);var bo=function(e){var t=e.Vue;t.component("FormSchema",zt),t.config.optionMergeStrategies.validations=t.config.optionMergeStrategies.data},_o=n("bc3a"),go=n.n(_o),yo=function(e){var t=e.Vue;t.prototype.$axios=go.a,window&&(window.axios=go.a)},xo=n("2330"),wo=Je(),Co=wo.app,$o=wo.router;function ko(){return qo.apply(this,arguments)}function qo(){return qo=a()(r.a.mark((function e(){var t,n;return r.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=[tt,rt,st,wt,It,At,bo,yo,xo["a"]],n=0;case 2:if(!(n<t.length)){e.next=20;break}if("function"===typeof t[n]){e.next=5;break}return e.abrupt("continue",17);case 5:return e.prev=5,e.next=8,t[n]({app:Co,router:$o,Vue:s["default"],ssrContext:null});case 8:e.next=17;break;case 10:if(e.prev=10,e.t0=e["catch"](5),!e.t0||!e.t0.url){e.next=15;break}return window.location.href=e.t0.url,e.abrupt("return");case 15:return console.error("[Quasar] boot error:",e.t0),e.abrupt("return");case 17:n++,e.next=2;break;case 20:new s["default"](Co);case 21:case"end":return e.stop()}}),e,null,[[5,10]])}))),qo.apply(this,arguments)}ko()},"2f74":function(e,t,n){},"391b":function(e,t,n){"use strict";var i=n("555f"),r=n.n(i);r.a},"396f":function(e,t,n){"use strict";var i=n("ef2b"),r=n.n(i);r.a},"39da":function(e,t,n){},4494:function(e,t,n){},"4b82":function(e,t,n){},"4e1e":function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="4e1e"},"555f":function(e,t,n){},"561e":function(e,t,n){},"57dc":function(e,t,n){"use strict";n("f751"),n("3b2b"),n("55dd"),n("f559"),n("28a5"),n("7514"),n("7f7f");var i=[{name:"name",label:"name",compare:function(e,t){return e.name().localeCompare(t.name())}},{name:"date",label:"date",compare:function(e,t){return t.modifiedDate()-e.modifiedDate()}},{name:"type",label:"type",compare:function(e,t){return e.types().reverse().join(" ").localeCompare(t.types().reverse().join(" "))}},{name:"location",label:"location",groups:function(e){var t=[];if(e.forEach((function(e){var n=e.attr("location");n&&-1===t.indexOf(n)&&t.push(n)})),t.length){var n=t.map((function(e){return{label:e,filter:function(t){return t.attr("location")===e}}}));return n.push({label:"unknown location",filter:function(e){return!e.attr("location")}}),n}}}];t["a"]={props:{resources:{},groups:{},hideOtherGroup:Boolean,createTypes:{},tree:Boolean,showHiddenFiles:Boolean,defaultSort:String},data:function(){return{sort_:this.defaultSort||(this.groups?"custom":"name"),search_:"",filter_:null}},computed:{__sortItems:function(){var e=i.slice();return this.groups&&e.unshift({name:"custom",label:"custom",groups:this.groups}),e},__resources:function(){var e=this,t=[];return"function"===typeof this.resources?t=this.$ething.arbo.find(this.resources):"string"===typeof this.resources?t=this.$ething.arbo.find(this.$ethingUI.resource.typeFilter(this.resources)):Array.isArray(this.resources)?t=this.resources.map((function(t){return"string"===typeof t?e.$ething.arbo.get(t):t})):"undefined"===typeof this.resources&&(t=this.$ething.arbo.find((function(e){return!0}))),t},__createTypes:function(){return"undefined"!==typeof this.createTypes?"string"===typeof this.createTypes?this.createTypes.split(" ").filter((function(e){return!!e})):this.createTypes:"string"===typeof this.resources?this.resources.split(" ").filter((function(e){return!!e})):"undefined"===typeof this.resources?["resources/Resource"]:[]},__filteredResources:function(){var e=this.__resources;this.filter_&&(e=e.filter(this.filter_)),this.showHiddenFiles||(e=e.filter((function(e){return!e.basename().startsWith(".")}))),this.search_&&(e=e.filter(this.__makeSearchFilter(search_)));var t=this.__selectedSortItem;return t&&t.compare&&e.sort(t.compare),e},__groups:function(){var e,t=this.__selectedSortItem;return e=t&&t.groups?"function"===typeof t.groups?t.groups(this.__filteredResources):t.groups:this.groups,e&&Array.isArray(e)?(e=this.__formatGroupList(e),this.hideOtherGroup||e.push({label:"others",icon:null,filter:null,_others:!0}),e.forEach((function(e){e.resources=[]})),this.__filteredResources.forEach((function(t){var n=!1;e.forEach((function(e){e._others?n||e.resources.push(t):e.filter(t)&&(n=!0,e.resources.push(t))}))})),e):[]},__selectedSortItem:function(){if("string"===typeof this.sort_)for(var e in this.__sortItems)if(this.__sortItems[e].name===this.sort_)return this.__sortItems[e]}},methods:{__makeTree:function(e){var t=[],n=function(t){for(var n in e)if(e[n].id()==t)return e[n]},i=function(t){return e.filter((function(e){return e.createdBy()===t.id()}))},r=function(e){var t=e.createdBy();return t&&n(t)},o=0,a=function(e){return{resource:e,level:o}},s=function e(t){var n=[a(t)];return o++,i(t).map((function(t){n=n.concat(e(t))})),o--,n};return e.filter((function(e){return!r(e)})).forEach((function(e){t=t.concat(s(e))})),t},__makeSearchFilter:function(e){if(!e)return function(e){return!0};var t=new RegExp(e,"i");return function(e){return t.test(e.name())||t.test(e.type())||t.test(e.description())||t.test(e.attr("location"))}},__formatGroupList:function(e){var t=this;return e.map((function(e){if("string"===typeof e){var n=t.$ethingUI.get(e),i=n.title,r=n.icon;e={label:i,icon:r,filter:e}}else e=Object.assign({},e);if("string"===typeof e.filter){var o=e.filter;e.label||(e.label=t.$ethingUI.get(o).title),e.label||(e.icon=t.$ethingUI.get(o).icon),e.filter=function(e){return t.$ethingUI.isSubclass(e,o)}}return e}))},__toItems:function(e){return this.tree?this.__makeTree(e):e.map((function(e){return{resource:e,level:0}}))}}}},"586d":function(e,t,n){"use strict";var i=n("2f74"),r=n.n(i);r.a},"5c67":function(e,t,n){"use strict";var i=n("ddda"),r=n.n(i);r.a},"6b5b":function(e,t,n){},"6cbd":function(e,t,n){"use strict";var i=n("cf66"),r=n.n(i);r.a},"6fa4":function(e,t,n){"use strict";var i=n("f4ae"),r=n.n(i);r.a},7367:function(e,t,n){},"7a95":function(e,t,n){"use strict";var i=n("ffaf"),r=n.n(i);r.a},"7cd6":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("modal",{ref:"modal",attrs:{value:e.value,title:e.title,icon:"add","valid-btn-disable":e.formError,"valid-btn-label":"create","valid-btn-loading":e.loading,"no-content-padding":"",size:"lg"},on:{input:function(t){return e.$emit("input",t)},valid:e.handler,cancel:e.onCancel},scopedSlots:e._u([{key:"buttons-right",fn:function(){return[!e.__singleEntry&&e.selectedType?n("q-btn",{attrs:{color:"grey",flat:"",icon:"mdi-arrow-left",label:"back"},on:{click:function(t){e.selectedType=null}}}):e._e()]},proxy:!0}])},[n("q-card",{attrs:{flat:""}},[e.selectedType?[n("q-card-section",[n("resource-editor",{key:e.selectedType,ref:"form",attrs:{resource:e.selectedType},on:{error:function(t){e.formError=t}}})],1),e.error?n("q-card-section",[n("q-banner",{staticClass:"bg-negative text-white"},[n("q-icon",{attrs:{left:"",name:"mdi-alert"}}),e._v(" "+e._s(String(e.error))+"\n        ")],1)],1):e._e()]:n("q-card-section",[0==e.__createSelectOptions.length?n("q-banner",{staticClass:"bg-warning text-white"},[n("q-icon",{attrs:{left:"",name:"mdi-alert"}}),e._v(" Oops. No resource can be created !\n      ")],1):n("q-list",[e._l(e.__createSelectOptions,(function(t){return[e.__createSelectOptions.length>1?n("q-item-label",{attrs:{header:""}},[e._v(e._s(t.name))]):e._e(),e._l(t.items,(function(i,r){return n("q-item",{key:t.name+r,attrs:{clickable:"","inset-level":i.icon?0:1},on:{click:function(e){return i.click()}}},[i.icon?n("q-item-section",{attrs:{avatar:""}},[n("q-icon",{attrs:{name:i.icon,color:i.color}})],1):e._e(),n("q-item-section",[n("q-item-label",[e._v(e._s(i.label))]),i.description?n("q-item-label",{attrs:{caption:"",lines:"2"}},[e._v(e._s(i.description))]):e._e()],1)],1)}))]}))],2)],1)],2)],1)},r=[],o=(n("097d"),n("551c"),n("06db"),n("f751"),n("8993")),a=n.n(o),s=(n("28a5"),{name:"ResourceCreateModal",props:{value:Boolean,types:Array,open:Boolean,title:{type:String,default:"Create"}},data:function(){return{selectedType:void 0,loading:!1,error:!1,formError:!1}},computed:{__createTypes:function(){return"undefined"!==typeof this.types?"string"===typeof this.types?this.types.split(" ").filter((function(e){return!!e})):this.types:["resources/Resource"]},__createSelectOptions:function(){var e=this,t=(this.__createTypes||[]).filter((function(e){return"string"===typeof e&&"!"!==e[0]})),n=(this.__createTypes||[]).filter((function(e){return"string"===typeof e&&"!"===e[0]})),i=(this.__createTypes||[]).filter((function(e){return"object"===a()(e)&&null!==e})),r=this.$ethingUI.getSubclass(t).filter((function(e){return!e.virtual&&!e.disableCreation})).filter((function(t){for(var i in n)if(e.$ethingUI.isSubclass(t,n[i]))return!1;return!0})),o="other",s={};r.forEach((function(t){var n=(t.category||o).split("."),i=t.title||t.split("/").pop(),r=n[0];s[r]||(s[r]={items:[]}),s[r].items.push({label:i,color:t.color,icon:t.icon,description:t.description,click:function(){e.open?e.$router.push({name:"resourceCreate",params:{type:t._type}}):e.selectedType=t._type}})})),i.forEach((function(e){if("object"===a()(e)&&null!==e&&e.label&&e.click){var t=e.category||o;s[t]||(s[t]={items:[]}),s[t].items.push(Object.assign({color:"grey"},e))}}));var c=s[o],l=[];for(var u in delete s[o],s)l.push(Object.assign({name:u},s[u]));return c&&l.push(Object.assign({name:o},c)),l},__singleEntry:function(){return 1===this.__createSelectOptions.length&&1===this.__createSelectOptions[0].items.length?this.__createSelectOptions[0].items[0]:null}},watch:{value:{handler:function(e){if(e){var t=this.__singleEntry;t&&t.click()}},immediate:!0}},methods:{show:function(){return this.$refs.modal.show()},hide:function(){return this.$refs.modal?this.$refs.modal.hide():Promise.resolve()},onDone:function(e){this.hide(),this.$emit("ok")},onCancel:function(){this.hide(),this.$emit("cancel")},handler:function(){var e=this;this.loading=!0,this.$refs.form.submit().then(this.onDone).catch((function(t){e.error=t||"error"})).finally((function(){e.loading=!1}))}}}),c=s,l=n("2877"),u=Object(l["a"])(c,i,r,!1,null,null,null);t["a"]=u.exports},"7dda":function(e,t,n){},"7e6d":function(e,t,n){},"80c5":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"row cell"},[n("div",{staticClass:"col-xs-12 col-sm-3 title text-bold"},[e._v("\n      Schedule\n    ")]),n("div",{staticClass:"col-xs-12 col-sm-9 cell-content"},[n("div",{staticClass:"text-faded"},[e._v("\n        Select the schedule that the trigger should run on.\n      ")]),n("q-list",[n("q-item",{attrs:{tag:"label"}},[n("q-item-section",{attrs:{side:"",top:""}},[n("q-radio",{attrs:{val:"daily"},model:{value:e.model.schedule,callback:function(t){e.$set(e.model,"schedule",t)},expression:"model.schedule"}})],1),n("q-item-section",[n("q-item-label",[e._v("Daily")]),n("q-item-label",{attrs:{caption:""}},[e._v("Allows you to configure a trigger that will run once, hourly or minutely daily")])],1)],1),n("q-item",{attrs:{tag:"label"}},[n("q-item-section",{attrs:{side:"",top:""}},[n("q-radio",{attrs:{val:"weekly"},model:{value:e.model.schedule,callback:function(t){e.$set(e.model,"schedule",t)},expression:"model.schedule"}})],1),n("q-item-section",[n("q-item-label",[e._v("Days per week")]),n("q-item-label",{attrs:{caption:""}},[e._v("Allows you to configure a trigger that will run once, hourly or minutely on certain days of the week")])],1)],1),n("q-item",{attrs:{tag:"label"}},[n("q-item-section",{attrs:{side:"",top:""}},[n("q-radio",{attrs:{val:"monthly"},model:{value:e.model.schedule,callback:function(t){e.$set(e.model,"schedule",t)},expression:"model.schedule"}})],1),n("q-item-section",[n("q-item-label",[e._v("Days per month")]),n("q-item-label",{attrs:{caption:""}},[e._v("Allows you to configure a trigger that will run on a specific date of the month or specific day of the week")])],1)],1),n("q-item",{attrs:{tag:"label"}},[n("q-item-section",{attrs:{side:"",top:""}},[n("q-radio",{attrs:{val:"cron"},model:{value:e.model.schedule,callback:function(t){e.$set(e.model,"schedule",t)},expression:"model.schedule"}})],1),n("q-item-section",[n("q-item-label",[e._v("Cron expression")]),n("q-item-label",{attrs:{caption:""}},[e._v("Allows you to configure a trigger that will run according to the specific CRON expression")])],1)],1)],1)],1)]),"weekly"==e.model.schedule?n("div",{staticClass:"row cell"},[n("div",{staticClass:"col-xs-12 col-sm-3 title text-bold"},[e._v("\n      Run Days\n    ")]),n("div",{staticClass:"col-xs-12 col-sm-9 cell-content"},[n("div",{staticClass:"text-faded"},[e._v("\n        Select what days of the week the scheduler should execute.\n      ")]),n("div",{staticClass:"q-my-md"},e._l(e.weekdays,(function(t){return n("q-checkbox",{key:t,staticClass:"q-mr-md q-my-sm",attrs:{val:t,label:t},model:{value:e.model.days,callback:function(t){e.$set(e.model,"days",t)},expression:"model.days"}})})),1)])]):e._e(),"monthly"==e.model.schedule?n("div",{staticClass:"row cell"},[n("div",{staticClass:"col-xs-12 col-sm-3 title text-bold"},[e._v("\n      On\n    ")]),n("div",{staticClass:"col-xs-12 col-sm-9 cell-content"},[n("div",{staticClass:"text-faded"},[e._v("\n        Select when in the month the trigger should execute\n      ")]),n("q-list",[n("q-item",{attrs:{tag:"label"}},[n("q-item-section",{attrs:{side:"",top:""}},[n("q-radio",{attrs:{val:"day"},model:{value:e.model.on,callback:function(t){e.$set(e.model,"on",t)},expression:"model.on"}})],1),n("q-item-section",[e._v("\n            Specific date of every month\n          ")])],1),n("q-item",{attrs:{tag:"label"}},[n("q-item-section",{attrs:{side:"",top:""}},[n("q-radio",{attrs:{val:"weekday"},model:{value:e.model.on,callback:function(t){e.$set(e.model,"on",t)},expression:"model.on"}})],1),n("q-item-section",[e._v("\n            Specific day of week of every month\n          ")])],1)],1),"day"==e.model.on?n("div",[e._v("\n        The\n        "),n("q-select",{staticClass:"inline",attrs:{options:e.onMonthlyDaysOptions},model:{value:e.model.onDay,callback:function(t){e.$set(e.model,"onDay",t)},expression:"model.onDay"}}),e._v("\n        of every month\n      ")],1):e._e(),"weekday"==e.model.on?n("div",[e._v("\n        The\n        "),n("q-select",{staticClass:"inline",attrs:{options:[{label:"First",value:1},{label:"Second",value:2},{label:"Third",value:3},{label:"Fourth",value:4}]},model:{value:e.model.onWeekdayOrdinal,callback:function(t){e.$set(e.model,"onWeekdayOrdinal",t)},expression:"model.onWeekdayOrdinal"}}),n("q-select",{staticClass:"inline",attrs:{options:e.onMonthlyWeekdaysOptions},model:{value:e.model.onWeekday,callback:function(t){e.$set(e.model,"onWeekday",t)},expression:"model.onWeekday"}}),e._v("\n        of every month\n      ")],1):e._e()],1)]):e._e(),"daily"==e.model.schedule||"weekly"==e.model.schedule?n("div",{staticClass:"row cell"},[n("div",{staticClass:"col-xs-12 col-sm-3 title text-bold"},[e._v("\n      Interval\n    ")]),n("div",{staticClass:"col-xs-12 col-sm-9 cell-content"},[n("q-select",{staticClass:"inline",attrs:{options:[{label:"Runs once",value:"once"},{label:"Every x hours",value:"repeatHours"},{label:"Every x minutes",value:"repeatMinutes"}],"emit-value":""},model:{value:e.model.interval,callback:function(t){e.$set(e.model,"interval",t)},expression:"model.interval"}})],1)]):e._e(),"monthly"==e.model.schedule||("daily"==e.model.schedule||"weekly"==e.model.schedule)&&"once"==e.model.interval?n("div",{staticClass:"row cell"},[n("div",{staticClass:"col-xs-12 col-sm-3 title text-bold"},[e._v("\n      Start Time\n    ")]),n("div",{staticClass:"col-xs-12 col-sm-9 cell-content"},[e._v("\n\n      Starting at\n      "),n("q-input",{staticClass:"inline",attrs:{filled:""},scopedSlots:e._u([{key:"append",fn:function(){return[n("q-icon",{staticClass:"cursor-pointer",attrs:{name:"access_time"}},[n("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[n("q-time",{attrs:{format24h:""},model:{value:e.model.startTime,callback:function(t){e.$set(e.model,"startTime",t)},expression:"model.startTime"}})],1)],1)]},proxy:!0}],null,!1,1903552290),model:{value:e.model.startTime,callback:function(t){e.$set(e.model,"startTime",t)},expression:"model.startTime"}})],1)]):e._e(),"daily"!=e.model.schedule&&"weekly"!=e.model.schedule||"repeatHours"!=e.model.interval&&"repeatMinutes"!=e.model.interval?e._e():n("div",{staticClass:"row cell"},[n("div",{staticClass:"col-xs-12 col-sm-3 title text-bold"},[e._v("\n      Repeat\n    ")]),n("div",{staticClass:"col-xs-12 col-sm-9 cell-content"},[e._v("\n      Every\n      "),n("q-select",{staticClass:"inline",attrs:{options:"repeatHours"==e.model.interval?e.everyHoursOptions:e.everyMinutesOptions},model:{value:e.model.every,callback:function(t){e.$set(e.model,"every",t)},expression:"model.every"}}),"repeatHours"==e.model.interval?n("span",[e._v("\n        hours\n      ")]):n("span",[e._v("\n        minutes\n      ")])],1)]),"cron"==e.model.schedule?n("div",{staticClass:"row cell"},[n("div",{staticClass:"col-xs-12 col-sm-3 title text-bold"},[e._v("\n      Cron Expression\n    ")]),n("div",{staticClass:"col-xs-12 col-sm-9 cell-content"},[n("div",{staticClass:"text-faded"},[e._v("\n        Enter the cron expression to configure when the trigger shoud execute\n      ")]),n("q-input",{staticClass:"q-my-md",attrs:{placeholder:"min hour day month weekday",label:"Cron expression"},model:{value:e.model.cron,callback:function(t){e.$set(e.model,"cron",t)},expression:"model.cron"}})],1)]):e._e()])},r=[],o=(n("28a5"),n("f751"),n("bd4c")),a={name:"Cron",props:["value"],data:function(){for(var e=[],t=1;t<=12;t++)e.push({label:String(t),value:t});var n=[];for(t=1;t<=59;t++)n.push({label:String(t),value:t});var i=[];for(t=1;t<=31;t++)i.push({label:String(t),value:t});var r=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"];return{model:Object.assign({schedule:"daily",interval:"once",startTime:"15:00",every:1,days:[],on:"day",onDay:1,onWeekdayOrdinal:1,onWeekday:"monday",cron:this.value||"* 1 * * *"},this.value?this.unserialize(this.value):null),weekdays:r,everyHoursOptions:e,everyMinutesOptions:n,onMonthlyWeekdaysOptions:r.map((function(e){return{label:e,value:e}})),onMonthlyDaysOptions:i,cron:""}},watch:{model:{handler:function(){this.cron=this.serialize()},deep:!0,immediate:!0},cron:{handler:function(e){this.$emit("input",e)},immediate:!0}},methods:{weekdayToIndex:function(e){var t=this.weekdays.indexOf(e)+1;return 7==t&&(t=0),t},indexToWeekday:function(e){return e=parseInt(e),0==e&&(e=7),this.weekdays[e-1]},serialize:function(){var e=this,t=this.model;if("cron"==t.schedule)return t.cron;if("daily"==t.schedule||"weekly"==t.schedule){var n="*";if("weekly"==t.schedule&&(n=t.days.map((function(t){return e.weekdayToIndex(t)})).join(","),n||(n="*")),"once"==t.interval){var i=t.startTime.split(":"),r=i[0],o=i[1];return o+" "+r+" * * "+n}if("repeatHours"==t.interval){var a=t.every||1;return 1==a?"0 * * * "+n:"0 */"+a+" * * "+n}if("repeatMinutes"==t.interval){a=t.every||1;return 1==a?"* * * * "+n:"*/"+a+" * * * "+n}}if("monthly"==t.schedule){i=t.startTime.split(":"),r=i[0],o=i[1];if("day"==t.on){var s=t.onDay||1;return o+" "+r+" "+s+" * *"}if("weekday"==t.on){n=["1-7","8-14","15-21","22-28"];return o+" "+r+" "+n[t.onWeekdayOrdinal-1]+" * "+this.weekdayToIndex(t.onWeekday)}}},unserialize:function(e){var t=this,n={},i=e.split(" "),r=/^[0-9]+$/,a=/^\*\/[0-9]+$/;if(5===i.length)if(r.test(i[0])&&r.test(i[1])&&(n.startTime=o["b"].buildDate({hours:parseInt(i[1]),minutes:parseInt(i[0])})),"*"==i[2]&&"*"==i[3]){var s="daily";if("*"!=i[4]&&(s=null,/^[0-6](,[0-6])*$/.test(i[4])&&(s="weekly",n.days=i[4].split(",").map((function(e){return t.indexToWeekday(e)})))),s){if(r.test(i[0])&&r.test(i[1]))return n.schedule=s,n.interval="once",n;if("0"==i[0]&&a.test(i[1]))return n.schedule=s,n.interval="repeatHours",n.every=parseInt(i[1].substr(2)),n;if("0"==i[0]&&"*"==i[1])return n.schedule=s,n.interval="repeatHours",n.every=1,n;if("*"==i[1]&&a.test(i[0]))return n.schedule=s,n.interval="repeatMinutes",n.every=parseInt(i[0].substr(2)),n;if("*"==i[1]&&"*"==i[0])return n.schedule=s,n.interval="repeatMinutes",n.every=1,n}}else if("*"!=i[2]&&"*"==i[3]){if(r.test(i[2])&&"*"==i[4])return n.schedule="monthly",n.on="day",n.onDay=parseInt(i[2]),n;var c=["1-7","8-14","15-21","22-28"];if(/^[0-6]$/.test(i[4])&&-1!==c.indexOf(i[2]))return n.schedule="monthly",n.on="weekday",n.onWeekdayOrdinal=c.indexOf(i[2])+1,n.onWeekday=this.indexToWeekday(i[4]),n}return n.schedule="cron",n.cron=e,n}}},s=a,c=(n("391b"),n("2877")),l=Object(c["a"])(s,i,r,!1,null,"7c34d2e4",null);t["a"]=l.exports},"855d":function(e,t,n){"use strict";var i=n("2171"),r=n.n(i);r.a},8805:function(e,t,n){"use strict";var i=n("4b82"),r=n.n(i);r.a},8947:function(e,t,n){},"8a02":function(e,t,n){},"8aff":function(e,t,n){},9023:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"widget column",class:{"widget-err":e.__hasError},style:e.__style},[e.dense||!e.__title&&!e.$slots.title?e._e():n("div",{staticClass:"col-auto title full-width text-subtitle1",class:{"cursor-pointer":e.enableTitleClick},on:{click:e.__titleClick}},[e._t("title",[n("div",{staticClass:"text-center ellipsis"},[e._v(e._s(e.__title))])])],2),n("div",{staticClass:"col relative-position",staticStyle:{overflow:"hidden"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.__hasError,expression:"__hasError"}],staticClass:"absolute full-width widget-err-content",staticStyle:{"z-index":"5"}},[n("div",{staticClass:"text-center text-caption"},[e._t("error-before"),n("div",[e._v(e._s(String(e.error||"error")))]),e._t("error-after")],2)]),n("div",{staticClass:"absolute fit widget-content"},[e._t("default",[n(e.__widget.component,e._g(e._b({tag:"component",on:{error:function(t){e.error=t}}},"component",e.__attrs,!1),e.__widget.listeners()))])],2)]),e.dense||!e.__footer&&!e.$slots.footer?e._e():n("div",{staticClass:"col-auto footer full-width",class:{cursorPointer:e.enableFooterClick},on:{click:e.__footerClick}},[e._t("footer",[n("div",{staticClass:"text-center ellipsis"},[e._v(e._s(e.__footer))])])],2)])},r=[],o=(n("7f7f"),n("25d4")),a=n("11ec"),s=n("bc78"),c={listeners:function(){return{}},attributes:function(e){return e}},l={name:"Widget",components:o["e"],inheritAttrs:!1,props:{widget:{},resource:{},dense:Boolean,height:{type:String,default:"100%"},width:{type:String,default:"100%"},title:String,footer:String,color:{type:String,default:"black"},bgColor:{type:String,default:"white"},primaryColor:String,secondaryColor:String,accentColor:String,enableTitleClick:Boolean,enableFooterClick:Boolean},data:function(){return{error:!1}},watch:{color:function(){this.loadColors()},primaryColor:function(){this.loadColors()},secondaryColor:function(){this.loadColors()},accentColor:function(){this.loadColors()}},computed:{__widget:function(){var e=this.widget;if("string"===typeof e)if(this.resource){var t=e;if(e=this.$ethingUI.get(this.resource).widgets[t],!e){var n='widget "'+t+'" not found for the resource '+this.resource.name();console.error(n),this.setError(n),e=c}}else{var i=e;if(e=this.$ethingUI.findWidget(i),!e){n="unknown widget type: "+i;console.error(n),this.setError(n),e=c}}return this.setError(null),e},__attrs:function(){var e=this.__widget,t=Object(a["a"])(!0,{color:this.__color,bgColor:this.__bgColor,primaryColor:this.__primaryColor,secondaryColor:this.__secondaryColor,accentColor:this.__accentColor},this.$attrs);return e.attributes(t)},__title:function(){var e=this;if(this.title){var t=this.title;if("$disabled"==t)return;return"$default"==t&&(t=this.__widget.defaultTitle,t||(t=this.resource?"%name%":this.__widget.title||this.__widget.schema&&this.__widget.schema.title||""),"function"===typeof t&&(t=t(this.__attrs))),t=this.$ethingUI.utils.parse(t||"",(function(t){if("createdBy"===t)return e.$ething.arbo.get(e.resource.createdBy()).name();var n=e.resource[t];return"function"===typeof n?n.call(e.resource):"undefined"!==typeof n?n:e.resource.attr(t)})),t}},__footer:function(){return this.footer},__style:function(){var e={};return this.__bgColor&&(e["background-color"]=this.__bgColor),this.__color&&(e["color"]=this.__color),this.width&&(e.width=this.width),this.height&&(e.height=this.height),e},__hasError:function(){return!!this.error},__color:function(){return this.color?this.$ethingUI.utils.colorNameToHex(this.color):void 0},__bgColor:function(){return this.bgColor?this.$ethingUI.utils.colorNameToHex(this.bgColor):void 0},__primaryColor:function(){return this.primaryColor||s["a"].getBrand("primary",this.$el)},__secondaryColor:function(){return this.secondaryColor||s["a"].getBrand("secondary",this.$el)},__accentColor:function(){return this.accentColor||s["a"].getBrand("accent",this.$el)}},methods:{setError:function(e){this.error=e},__titleClick:function(e){this.enableTitleClick&&(this.$listeners.titleClick?this.$emit("titleClick",e):this.resource&&this.$ethingUI.open(this.resource))},__footerClick:function(e){this.enableFooterClick&&this.$emit("footerClick",e)},loadColors:function(){if(this.$el){var e=this.__color;e&&s["a"].setBrand("light",s["a"].lighten(e,s["a"].luminosity(e)<.5?40:-30),this.$el);var t=this.primaryColor;t&&s["a"].setBrand("primary",t,this.$el);var n=this.secondaryColor;n&&s["a"].setBrand("secondary",n,this.$el);var i=this.accentColor;i&&s["a"].setBrand("accent",i,this.$el)}}},mounted:function(){this.loadColors()}},u=l,d=(n("396f"),n("2877")),f=Object(d["a"])(u,i,r,!1,null,"5166466a",null);t["a"]=f.exports},"90ee":function(e,t,n){"use strict";var i,r,o,a,s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("strong",[e._v(e._s(e.node.name))])},c=[],l={name:"NodeBase",props:["flow","node"]},u=l,d=n("2877"),f=Object(d["a"])(u,s,c,!1,null,null,null),h=f.exports,m={name:"NodeInput",mixins:[h],methods:{inject:function(e){this.$ething.request({url:"flows/"+this.flow.id()+"/inject/"+this.node.id,method:"POST",contentType:"application/json; charset=utf-8",data:e})}}},p=m,v=Object(d["a"])(p,i,r,!1,null,null,null),b=v.exports,_={name:"NodeOutput",mixins:[h],computed:{data:function(){var e=this.flow.data()[this.node.id];if("string"===typeof e)try{e=JSON.parse(e)}catch(t){console.error(t)}return e}}},g=_,y=Object(d["a"])(g,o,a,!1,null,null,null),x=y.exports,w=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-btn",{attrs:{label:e.node.name},on:{click:function(t){return t.stopPropagation(),e._inject(t)}}})},C=[],$={name:"NodeButton",mixins:[b],methods:{_inject:function(e){this.inject((new Date).getTime()/1e3)}}},k=$,q=Object(d["a"])(k,w,C,!1,null,null,null),O=q.exports,S=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticClass:"ellipsis"},[e._v(e._s(e.node.name)+": "+e._s(e.displayValue))])},j=[],E={name:"NodeLabel",mixins:[x],computed:{displayValue:function(){if("undefined"===typeof this.data)return"";try{return JSON.stringify(this.data)}catch(e){return String(this.data)}}}},T=E,I=Object(d["a"])(T,S,j,!1,null,null,null),D=I.exports;t["a"]={Base:h,Input:b,Output:x,Button:O,Label:D}},"95fd":function(e,t,n){"use strict";var i=n("8947"),r=n.n(i);r.a},"9e10":function(e,t,n){"use strict";var i=n("cd23"),r=n.n(i);r.a},a8cc:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"flow-node"},[n("div",{ref:"dynW"})])},r=[],o=(n("f751"),n("90ee")),a={name:"FlowNode",components:o["a"],props:["flow","node"],data:function(){return{instance:null}},computed:{computedFlow:function(){if("string"===typeof this.flow){var e=this.$ething.arbo.get(this.flow);if(!e)throw"The flow id="+this.flow+" does not exist anymore";return e}return this.flow},computedNode:function(){if("string"===typeof this.node){var e=this.computedFlow.attr("nodes");for(var t in e)if(e[t].id===this.node)return e[t];throw"The node id="+this.node+" from the flow id="+this.computedFlow.id()+" does not exist anymore"}return this.node},nodeType:function(){return this.$ethingUI.get(this.computedNode.type)},nodeComponent:function(){var e=this.nodeType.node||"Base";return"string"===typeof e&&(e=o["a"][e]),Vue.extend(e)}},mounted:function(){var e=this,t=new this.nodeComponent({propsData:Object.assign({flow:this.computedFlow,node:this.computedNode},this.$attrs),parent:this});t.$on("inject",(function(t){e.$emit("inject",t)})),t.$mount(this.$refs.dynW),this.instance=t},beforeDestroy:function(){this.instance&&this.instance.$destroy()},methods:{}},s=a,c=n("2877"),l=Object(c["a"])(s,i,r,!1,null,null,null);t["a"]=l.exports},ab0f:function(e,t,n){"use strict";var i=n("8a02"),r=n.n(i);r.a},b314:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-input",e._b({class:e.elementId,attrs:{debounce:"500"},scopedSlots:e._u([e.__enabled?{key:"append",fn:function(){return[n("q-icon",{staticClass:"cursor-pointer",attrs:{name:e.isMenuOpen?"arrow_drop_up":"arrow_drop_down"}},[n("q-menu",{attrs:{fit:"",target:"."+e.elementId,"max-height":e.maxHeight,"no-focus":""},on:{show:e.__menuShow,hide:e.__menuHide}},[e.loading?n("div",{staticClass:"q-ma-md text-center text-faded"},[n("div",{staticClass:"q-ma-md"},[e._v("loading...")]),n("q-spinner-oval",{attrs:{color:"faded",size:"36px"}})],1):n("div",[e.c_items&&0!==e.c_items.length?n("q-list",{attrs:{separator:"",dense:""}},[e._l(e.c_items,(function(t,i){return n("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],key:i,class:{selected:t.value===e.__value},attrs:{clickable:""},on:{click:function(n){e.__value=t.value}}},[e._t("item-content",[n("q-item-section",[e._v(e._s(t.label||t.value))])],{item:t})],2)})),e.__isAsync?n("q-btn",{attrs:{flat:"",color:"faded",icon:"refresh",label:"refresh",size:"sm"},on:{click:function(t){return e.__async()}}}):e._e()],2):n("div",{staticClass:"q-ma-md text-center text-faded"},[n("div",[e._v(e._s(e.emptyMessage))]),e.__isAsync?n("q-btn",{attrs:{flat:"",color:"faded",icon:"refresh",label:"refresh",size:"sm"},on:{click:function(t){return e.__async()}}}):e._e()],1)],1)])],1)]},proxy:!0}:null],null,!0),model:{value:e.__value,callback:function(t){e.__value=t},expression:"__value"}},"q-input",e.$attrs,!1))},r=[],o=(n("f751"),{name:"Combobox",inheritAttrs:!1,props:{value:{},items:{},maxHeight:{type:String,default:"200px"},emptyMessage:{type:String,default:"empty"}},data:function(){return{elementId:"__id_"+this.$ethingUI.utils.generateId(),isMenuOpen:!1,loading:!1,c_items:null}},computed:{__isAsync:function(){return"function"===typeof this.items},__enabled:function(){return this.__isAsync||Array.isArray(this.items)&&this.items.length>0},__value:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}},watch:{items:{handler:function(e){Array.isArray(e)?this.__setItems(e):"function"===typeof e&&(this.c_items=null)},immediate:!0}},methods:{__menuShow:function(){this.isMenuOpen=!0,this.__isAsync&&null===this.c_items&&!this.loading&&this.__async()},__menuHide:function(){this.isMenuOpen=!1},__async:function(){var e=this;this.loading=!0;var t=function(t){e.__setItems(t),e.loading=!1};this.items(t)},__setItems:function(e){this.c_items=(e||[]).map((function(e){return e="string"===typeof e?{value:e,label:e}:Object.assign({},e),e}))}}}),a=o,s=(n("bf20"),n("2877")),c=Object(s["a"])(a,i,r,!1,null,"d6398f26",null);t["a"]=c.exports},bc8f:function(e,t,n){"use strict";var i=n("23df"),r=n.n(i);r.a},bf20:function(e,t,n){"use strict";var i=n("7dda"),r=n.n(i);r.a},c271:function(e,t,n){},c2dc:function(e,t,n){"use strict";var i=n("0c6b"),r=n.n(i);r.a},c658:function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"g",(function(){return f}));n("ac6a"),n("cadf"),n("06db"),n("456d");var i=n("11ec"),r=n("ed08");function o(e,t,n,i,r){n=n||{};var o=Object.keys(e).concat(Object.keys(t)).filter((function(e,t,n){return n.indexOf(e)===t}));return o.forEach((function(o){var a="undefined"!==typeof n[o]?n[o]:i;a&&(e[o]=a(e[o],t[o],r))})),e}function a(e,t){return"undefined"==typeof e?t:"undefined"==typeof t?e:Object(r["isPlainObject"])(e)&&Object(r["isPlainObject"])(t)?Object(i["a"])(!0,{},e,t):t}function s(e,t,n,i){if("function"!==typeof t){var r=t;t=function(){return r}}if("function"!==typeof e){var o=e;e=function(){return o}}return i=i||a,function(){var r=Array.prototype.slice.call(arguments);n=n||{},n.args=r;var o="function"===typeof e?e.apply(this,r):e,a="function"===typeof t?t.apply(this,r):t;return i(o,a,n)}}function c(e,t,n,i){return"undefined"===typeof t?i:t}function l(e,t,n,i){e||(e={}),t||(t={}),i=i||a;var r=Object.keys(e).concat(Object.keys(t)).filter((function(e,t,n){return n.indexOf(e)===t})),o={};return r.forEach((function(r){o[r]=i(e[r],t[r],n)})),o}function u(e,t,n,i){if(!e)return t;if(!t)return e;var r=e.concat(t);return i&&(r=r.filter((function(e,t,n){return n.indexOf(e)===t}))),r}var d=function(e,t,n){return u(e,t,n,!0)};function f(e,t,n){if(!e)return t;if(!t||Object(r["isEmptyObject"])(t))return e;if(Object(r["isVueComponent"])(t))return t;var o=Object(i["a"])(!0,{},t);return o.mixins=[e],o}},c7b2:function(e,t,n){"use strict";var i={};n.r(i),n.d(i,"widgets",(function(){return Yt})),n.d(i,"FlowNodes",(function(){return Gt["a"]})),n.d(i,"Chart",(function(){return h["a"]})),n.d(i,"EntityApi",(function(){return q})),n.d(i,"FlowNode",(function(){return O["a"]})),n.d(i,"ImageViewer",(function(){return D})),n.d(i,"Modal",(function(){return R})),n.d(i,"ResourceEditor",(function(){return G})),n.d(i,"ResourceQItem",(function(){return te})),n.d(i,"ResourceSelect",(function(){return ne["a"]})),n.d(i,"PluginSelect",(function(){return ie["a"]})),n.d(i,"Widget",(function(){return re["a"]})),n.d(i,"ResourceObservable",(function(){return oe})),n.d(i,"ResourceActivity",(function(){return tn})),n.d(i,"Combobox",(function(){return nn["a"]})),n.d(i,"ResourceList",(function(){return rn["a"]})),n.d(i,"ResourceCreateModal",(function(){return on["a"]})),n.d(i,"DynamicComponent",(function(){return dn}));n("5df3"),n("097d"),n("551c"),n("a481"),n("28a5"),n("f751"),n("7f7f"),n("ac6a"),n("cadf"),n("06db"),n("456d");var r,o,a=n("426a"),s=n.n(a),c=n("18d6"),l=n("2a19"),u=n("4328"),d=n.n(u),f=n("ed08"),h=n("0292"),m=(n("80c5"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("q-list",e._l(e.operations,(function(t){return n("q-expansion-item",{key:t.name,attrs:{"expand-separator":"",icon:"keyboard_arrow_right",label:t.name,caption:e.operationReturnToString(t)}},[n("q-card",{staticClass:"content"},[t.description?n("q-card-section",[n("q-markdown",{staticClass:"text-faded"},[e._v(e._s(t.description))])],1):e._e(),e.hasParameters(t)?n("q-card-section",[n("form-schema",{attrs:{schema:t.schema},on:{error:function(e){t.inputError=e}},model:{value:t.model,callback:function(n){e.$set(t,"model",n)},expression:"operation.model"}})],1):e._e(),n("q-card-section",[n("q-btn",{attrs:{loading:t.loading,disable:t.inputError,color:"primary",icon:"done",label:"execute"},on:{click:function(n){return e.execute(t)}}})],1),t.error?n("q-card-section",[n("q-banner",{staticClass:"bg-negative text-white"},[n("q-icon",{attrs:{left:"",name:"mdi-alert"}}),e._v(" "+e._s(String(t.error))+"\n          ")],1)],1):e._e(),t.result?n("q-card-section",{staticClass:"result"},["image"===t.resultType?n("img",{attrs:{src:t.result},on:{load:function(e){t.loading=!1},error:function(e){t.loading=!1,t.error="an error occured",t.result=null}}}):"audio"===t.resultType?n("audio",{attrs:{controls:"",src:t.result,type:t.resultContentType}}):"video"===t.resultType?n("video",{attrs:{controls:"",autoplay:"",src:t.result,type:t.resultContentType}}):"videoflash"===t.resultType?n("object",{staticClass:"videoplayer",attrs:{width:"425",height:"300",data:"http://releases.flowplayer.org/swf/flowplayer-3.2.18.swf",type:"application/x-shockwave-flash"}},[n("param",{attrs:{name:"movie",value:"http://releases.flowplayer.org/swf/flowplayer-3.2.18.swf"}}),n("param",{attrs:{name:"allowfullscreen",value:"true"}}),n("param",{attrs:{name:"allowscriptaccess",value:"always"}}),e._v('":{\\"url\\":\\"\' + operation.result + \'\\"},\\"playlist\\":[{\\"url\\":\\"\' + operation.result + \'\\"}]}\'" />\n          ')]):"json"===t.resultType?n("pre",{directives:[{name:"highlightjs",rawName:"v-highlightjs"}]},[n("code",{staticClass:"json"},[e._v(e._s(t.result))])]):"html"===t.resultType?n("pre",{directives:[{name:"highlightjs",rawName:"v-highlightjs"}]},[n("code",{staticClass:"html"},[e._v(e._s(t.result))])]):"xml"===t.resultType?n("pre",{directives:[{name:"highlightjs",rawName:"v-highlightjs"}]},[n("code",{staticClass:"xml"},[e._v(e._s(t.result))])]):"text"===t.resultType?n("pre",[n("code",{staticClass:"plain"},[e._v(e._s(t.result))])]):e._e()]):e._e()],1)],1)})),1)],1)}),p=[],v=n("8993"),b=n.n(v),_=function(e){var t=document.createElement("audio");return!(!t.canPlayType||!t.canPlayType(e).replace(/no/,""))},g=function(e){var t=document.createElement("video");return!(!t.canPlayType||!t.canPlayType(e).replace(/no/,""))},y=function(e,t){if(e instanceof Blob){var n=new window.FileReader;n.readAsText(e),n.onloadend=function(){t(n.result)}}else t(e)},x=function(e){return e instanceof s.a.Resource?e.id():e instanceof s.a.Plugin?e.type():void 0},w={name:"EntityApi",props:["entity"],data:function(){return{operations:[],_entityId:null}},watch:{entity:{handler:function(e){e&&this._entityId!=x(e)&&this.buildApi()},immediate:!0}},methods:{buildApi:function(){var e=this.$ethingUI.get(this.entity).methods,t=[];for(var n in e){var i=e[n];t.push({name:n,description:i.description,return:i.return,inputError:!1,error:!1,loading:!1,ts:0,result:null,resultType:null,resultContentType:null,schema:{additionalProperties:!1,properties:i.arguments,required:i.required,type:"object"},model:{}})}this.operations=t},hasParameters:function(e){return Object.keys(e.schema.properties||{}).length},operationReturnToString:function(e){var t=e.return;return"string"===typeof t?t:"object"===b()(t)&&null!==t?t.type:""},execute:function(e){var t=e.return;e.ts=Date.now(),e.error=!1,e.loading=!0,e.result=null,e.resultType=null,e.resultContentType=null,/^image\//.test(t)||/^multipart\/x-mixed-replace/.test(t)||"video/x-motion-jpeg"==t||"video/x-jpeg"==t?(e.result=this.toUrl(e)+"&_ts="+e.ts,e.resultType="image"):/^audio\//.test(t)&&_(t)?(e.resultContentType=t,e.result=this.toUrl(e)+"&_ts="+e.ts,e.resultType="audio",e.loading=!1):/^video\//.test(t)?(g(t)?(e.resultContentType=t,e.result=this.toUrl(e)+"&_ts="+e.ts,e.resultType="video"):(e.result=this.toUrl(e)+"&_ts="+e.ts,e.resultType="videoflash"),e.loading=!1):this.entity.execute(e.name,e.model,"blob").then((function(t){e.loading=!1;var n=t.type;t&&0!=t.size?/json/.test(n)?y(t,(function(t){try{e.result=JSON.stringify(JSON.parse(t),null,"  "),e.resultType="json"}catch(n){e.error="can't parse JSON.  Raw result:\n\n"+t}})):"text/html"===n?y(t,(function(t){e.result=t,e.resultType="html"})):/xml/.test(n)?y(t,(function(t){e.result=t,e.resultType="xml"})):/text/.test(n)?y(t,(function(t){e.result=t,e.resultType="text"})):e.error="Unable to render the response":(e.result=null,e.resultType="empty")})).catch((function(t){e.error=t})).finally((function(){e.loading=!1}))},toUrl:function(e){return this.entity.executeUrl(e.name,e.model)}}},C=w,$=(n("e89c"),n("2877")),k=Object($["a"])(C,m,p,!1,null,"1329ee34",null),q=k.exports,O=n("a8cc"),S=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"fit"},[n("div",{ref:"container",class:e.__class,style:e.__style},[n(e.__zoom?"v-zoomer":"div",{directives:[{name:"show",rawName:"v-show",value:!e.error,expression:"!error"}],tag:"component",staticStyle:{width:"100%",height:"100%"}},[n("img",{key:e.key,staticStyle:{"object-fit":"contain",width:"100%",height:"100%"},attrs:{src:e.__url,alt:""},on:{load:e.onload,error:e.onerror}})]),n("div",{staticClass:"absolute-top row items-center q-pa-sm",style:e.__toolbarStyle},[n("div",{staticClass:"col text-subtitle1"},[e.noTitle?e._e():n("span",[e._v(e._s(e.__data.title))])]),n("div",{staticClass:"col-auto"},[n("q-btn",{attrs:{round:"",flat:"",icon:"mdi-refresh"},on:{click:function(t){return e.refresh()}}}),n("q-btn",{attrs:{round:"",flat:"",icon:e.fullscreen?"fullscreen_exit":"fullscreen"},on:{click:function(t){return e.toggleFullscreen()}}})],1)]),n("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"absolute-center"},[n("q-circular-progress",{attrs:{indeterminate:"",size:"48px"}})],1),n("div",{directives:[{name:"show",rawName:"v-show",value:e.error,expression:"error"}],staticClass:"absolute-center text-negative"},[e._v("\n      Unable to load the picture\n    ")])],1)])},j=[],E={name:"ImageViewer",props:{source:{},noTitle:Boolean,zoom:{type:String,default:"both"},contentStyle:Object,contentClass:String,toolbarStyle:Object},data:function(){return{fullscreen:!1,key:1,urlSuffix:"",loading:!0,error:!1}},computed:{__data:function(){return/^https?:\/\//.test(this.source)?{url:this.source,title:this.source}:this.source instanceof this.$ething.File?{url:this.source.getContentUrl(!1),title:this.source.name()}:void 0},__url:function(){var e=this.__data.url;return e+(-1===e.indexOf("?")?"?":"&")+this.urlSuffix},__zoom:function(){return"none"!==this.zoom&&("fullscreen"===this.zoom?this.fullscreen:"inline"!==this.zoom||!this.fullscreen)},__class:function(){var e=this.fullscreen?"fullscreen":"relative-position fit";return this.contentClass&&(e+=" "+this.contentClass),e},__style:function(){var e={color:"white","background-color":"#2b2b2b"};return!this.fullscreen&&this.contentStyle&&Object.assign(e,this.contentStyle),e},__toolbarStyle:function(){var e={background:"rgba(0,0,0,0.47)"};return this.toolbarStyle&&Object.assign(e,this.toolbarStyle),e}},methods:{toggleFullscreen:function(){this.fullscreen=!this.fullscreen,this.fullscreen?document.body.appendChild(this.$refs.container):this.$el.appendChild(this.$refs.container)},refresh:function(){this.loading=!0,this.error=!1,this.source instanceof this.$ething.File?this.urlSuffix="_ts="+Date.now():this.key+=1},onload:function(){this.loading=!1},onerror:function(){this.error=!0,this.loading=!1}}},T=E,I=Object($["a"])(T,S,j,!1,null,null,null),D=I.exports,M=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-dialog",e._b({ref:"modal",staticClass:"column",attrs:{value:e.value,maximized:100==e.__size},on:{input:function(t){return e.$emit("input",t)},show:function(t){return e.$emit("show",t)},"escape-key":function(t){return e.$emit("cancel")},dismiss:function(t){return e.$emit("cancel")}}},"q-dialog",e.$attrs,!1),[n("div",{staticClass:"column bg-white no-wrap",style:e.__dimCss},[n("div",{staticClass:"col-auto bg-primary text-white q-py-sm q-px-md title"},[n("div",{staticClass:"row items-center"},[e.icon?n("q-icon",{attrs:{name:e.icon,left:""}}):e._e(),e.title?n("div",{staticClass:"text-h6"},[e._v(e._s(e.title))]):e._e(),n("q-space"),n("q-btn",{attrs:{dense:"",flat:"",icon:"close"},on:{click:e.onCloseBtnClick}})],1)]),n("div",{staticClass:"col scroll relative-position",style:e.__contentDimCss},[n("div",{class:e.__contentClass},[e._t("default")],2),n("q-space"),!e.noButtons&&e.scroll?n("div",{staticClass:"q-py-sm q-px-md buttons row items-center"},[e.validBtnHide?e._e():n("q-btn",{attrs:{color:e.validBtnColor,label:e.validBtnLabel,disable:e.validBtnDisable,loading:e.validBtnLoading,flat:""},on:{click:function(t){return e.onValidBtnClick()}}}),e.cancelBtnHide?e._e():n("q-btn",{attrs:{color:e.cancelBtnColor,label:e.cancelBtnLabel,disable:e.cancelBtnDisable,flat:""},on:{click:function(t){return e.onCancelBtnClick()}}}),e._l(e.buttons,(function(t,i){return n("q-btn",{key:i,attrs:{color:t.color,label:t.label,flat:t.flat,disable:t.disable},on:{click:function(n){return e.onBtnClick(t)}}})})),e._t("buttons"),n("q-space"),e._t("buttons-right")],2):e._e()],1),e.noButtons||e.scroll?e._e():n("div",{staticClass:"col-auto q-py-sm q-px-md buttons row items-center"},[e.validBtnHide?e._e():n("q-btn",{attrs:{color:e.validBtnColor,label:e.validBtnLabel,disable:e.validBtnDisable,loading:e.validBtnLoading,flat:""},on:{click:function(t){return e.onValidBtnClick()}}}),e.cancelBtnHide?e._e():n("q-btn",{attrs:{color:e.cancelBtnColor,label:e.cancelBtnLabel,disable:e.cancelBtnDisable,flat:""},on:{click:function(t){return e.onCancelBtnClick()}}}),e._l(e.buttons,(function(t,i){return n("q-btn",{key:i,attrs:{color:t.color,label:t.label,flat:t.flat,disable:t.disable},on:{click:function(n){return e.onBtnClick(t)}}})})),e._t("buttons"),n("q-space"),e._t("buttons-right")],2)])])},A=[],F={xs:[100,100,100,100,100],sm:[70,80,100,100,100],md:[60,70,80,90,100],lg:[50,60,70,80,90],xl:[25,40,50,70,90]},B=["xs","sm","md","lg","xl"],P={name:"Modal",props:{title:String,icon:String,value:{},size:{type:String,default:"md"},minHeight:String,scroll:Boolean,noContentPadding:Boolean,noButtons:Boolean,validBtnHide:Boolean,validBtnDisable:Boolean,validBtnLoading:Boolean,validBtnLabel:{type:String,default:"Valid"},validBtnColor:{type:String,default:"primary"},cancelBtnHide:Boolean,cancelBtnDisable:Boolean,cancelBtnLabel:{type:String,default:"Cancel"},cancelBtnColor:{type:String,default:"negative"},buttons:Array},data:function(){return{}},computed:{__contentClass:function(){var e=[];return this.noContentPadding||e.push("q-pa-md"),e.join(" ")},__size:function(){for(var e in F)if(this.$q.screen[e]){var t=B.indexOf(this.size);return-1!==t?F[e][t]:100}return 100},__dimCss:function(){if(100!=this.__size)return{width:this.__size+"%",maxWidth:this.__size+"vw"}},__contentDimCss:function(){if(100!=this.__size)return{maxHeight:"80vh",minHeight:this.minHeight}}},methods:{onValidBtnClick:function(){this.$emit("valid")},onCancelBtnClick:function(){this.$emit("cancel"),this.hide()},onBtnClick:function(e){e.onclick.call(this)},onCloseBtnClick:function(){this.$emit("cancel"),this.hide()},hide:function(){this.$refs.modal&&this.$refs.modal.hide()},show:function(){this.$refs.modal&&this.$refs.modal.show()},toggle:function(){this.$refs.modal&&this.$refs.modal.toggle()}}},L=P,z=(n("855d"),Object($["a"])(L,M,A,!1,null,"08a3f40a",null)),R=z.exports,U=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"resource-editor"},[e.$slots.default?n("div",[e._t("default")],2):e._e(),e.meta.description?n("div",[n("q-markdown",[e._v(e._s(e.meta.description.trim()))])],1):e._e(),n("div",[n("form-schema",{attrs:{schema:e.schema},on:{error:function(t){e.inputError=t}},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1),n("q-inner-loading",{staticClass:"text-center",attrs:{showing:!e.ready}},[n("div",{staticClass:"q-pa-lg text-primary"},[e._v("loading...")]),n("q-spinner-oval",{attrs:{color:"primary",size:"50px"}})],1)],1)},N=[],V=n("11ec"),H=n("4d7c"),W={name:"ResourceEditor",props:["resource"],data:function(){var e=this,t=this.getSchemaModel((function(){e.$nextTick((function(){e.ready=!0}))}));return{inputError:!1,create:!(this.resource instanceof s.a.Resource),type:this.resource instanceof s.a.Resource?this.resource.type():this.resource,schema:t.schema,model:t.model,meta:t.meta,ready:!1}},watch:{inputError:function(e){this.$emit("error",e)}},methods:{submit:function(){var e=this;if(this.inputError)return Promise.reject("form error");var t=null;return t=this.create?s.a.Resource.create(Object.assign({type:this.type},this.model)).then((function(t){return e.meta.created(t),t})):this.resource.set(Object.assign({},this.model)),t},getSchemaModel:function(e){var t=this,n=this.resource instanceof s.a.Resource?this.resource.type():this.resource,i=this.resource instanceof s.a.Resource?this.resource:null,r=i?this.$ethingUI.get(i):this.$ethingUI.get(n);r=this.customize(Object(V["a"])(!0,{},r),i,n);var o=r.required||[],a={},c={},l=0,u=function(){l--,l<=0&&"function"===typeof e&&e()},d=function(e){var n=r.properties[e]["$required"]||-1!==o.indexOf(e);if((!r.properties[e]["$readOnly"]||n)&&(a[e]=r.properties[e],r.properties[e]["$required"]&&-1===o.indexOf(e)&&o.push(e),i)){var s=r.properties[e].get(i);s instanceof Promise?(l++,s.then((function(n){t.$set(t.model,e,n)})).finally(u)):c[e]=s}};for(var f in r.properties)d(f);var h=Object.keys(a);return o=o.filter((function(e){return-1!==h.indexOf(e)})),l||u(),{model:c,schema:{type:"object",required:o,properties:a,$order:["name"]},meta:r}},customize:function(e,t,n){return t||("resources/File"===n?(e.properties.content={id:"resource.content",type:"string",$component:"file"},e.properties.name["$dependencies"]={"resource.content":function(e,t,n){n.files.length>0&&(t.c_value=n.files[0].name)}}):"resources/Table"===n&&(e.properties.content={id:"resource.content",type:"string",$component:"file",accept:".json,.csv",$converter:function(e,t,n,i){var r=function(e){if(!Array.isArray(e))return i("invalid file content");for(var t in e){if("object"!==b()(e[t])||null===e[t])return i("invalid file content");if(!e[t].date)return i("no date field for the item "+t);var r=!1;for(var o in e[t])if("date"!=o&&"id"!=o){r=!0;break}if(!r)return i("no data for the item "+t)}n(e)};/\.json$/i.test(e.name)?r(JSON.parse(t)):/\.csv$/i.test(e.name)?H().fromString(t).then((function(e){r(e)})):i("invalid file type")}},e.properties.name["$dependencies"]={"resource.content":function(e,t,n){n.files.length>0&&(t.c_value=n.files[0].name)}})),e}}},Q=W,Y=(n("6cbd"),Object($["a"])(Q,U,N,!1,null,"2a3dd2bf",null)),G=Y.exports,J=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-item",{staticClass:"item",attrs:{clickable:"",link:!e.readonly},on:{click:e.click}},[e._l(e.level,(function(t){return n("div",{class:e.gen(t)})})),n("q-item-section",{attrs:{avatar:""}},[n("q-avatar",{attrs:{icon:e.meta.icon,"text-color":"white",color:e.meta.color}})],1),n("q-item-section",{attrs:{avatar:""}},[n("q-item-label",[n("span",{staticClass:"vertical-middle text-black"},[e._v(e._s(e.resource.basename()))]),e.showParent?n("small",{staticClass:"parent text-faded vertical-bottom on-right",class:e.readonly?"":"cursor-pointer",on:{click:e.clickCreatedBy}},[e._v(e._s(e.createdBy.basename()))]):e._e(),e.showConnected&&!e.resource.connected()?n("q-icon",{staticClass:"vertical-middle on-right",attrs:{name:"mdi-lan-disconnect",color:"warning"}}):e._e(),e.resource.public()?n("q-icon",{staticClass:"vertical-middle on-right",attrs:{name:"share",color:"warning"}}):e._e()],1),e.showType?n("q-item-label",{staticClass:"text-no-wrap",attrs:{caption:""}},[e._v(e._s(e.meta.title))]):e._e(),e.dense?e._e():[n("q-item-label",{staticClass:"text-no-wrap",attrs:{caption:""}},[e._v(e._s(e.$ethingUI.utils.dateToString(e.date,"never")))]),e.showBattery?n("q-item-label",{staticClass:"lt-sm",attrs:{caption:""}},[e._v("battery: "+e._s(e.resource.battery())+"%")]):e._e(),e.showLocation?n("q-item-label",{staticClass:"lt-sm",attrs:{caption:""}},[e._v("location: "+e._s(e.resource.location()))]):e._e(),e.showSize?n("q-item-label",{attrs:{caption:""}},[e._v(e._s(e.$ethingUI.utils.sizeToString(e.resource.size())))]):e._e(),e.showLength?n("q-item-label",{attrs:{caption:""}},[e._v(e._s(e.resource.length())+" rows")]):e._e(),e.showError?n("q-item-label",{staticClass:"text-negative ellipsis",attrs:{caption:""}},[n("q-icon",{attrs:{name:"mdi-alert"}}),e._v(" "+e._s(e.resource.attr("error")))],1):e._e()]],2),n("q-item-section"),e.dense?e._e():n("q-item-section",{attrs:{side:""}},[n("div",{staticClass:"row justify-end"},e._l(e.badges,(function(e,t){return n("dynamic-component",{key:t,staticClass:"gt-sm",attrs:{component:e}})})),1)]),e.readonly?e._e():n("q-item-section",{attrs:{side:""}},[n("div",[e._t("buttons-prepend"),e._l(e.actions,(function(e,t){return n("q-btn",{key:t,staticClass:"gt-xs",attrs:{icon:e.icon,label:e.forceLabel?e.label:null,flat:"",dense:"",color:e.color||"secondary"},on:{click:function(t){return t.stopPropagation(),e.click()}}})})),n("q-btn",{staticClass:"gt-xs",attrs:{icon:"delete",round:"",flat:"",dense:""},on:{click:function(t){return t.stopPropagation(),e.remove(t)}}}),n("q-btn",{staticClass:"gt-xs",attrs:{icon:"settings",round:"",flat:"",dense:""},on:{click:function(t){return t.stopPropagation(),e.openSettings()}}}),n("q-btn",{staticClass:"lt-sm",attrs:{icon:"more_vert",round:"",flat:"",dense:""},on:{click:function(t){return t.stopPropagation(),e.more(t)}}})],2)])],2)},K=[],Z=(n("55dd"),n("8615"),n("c5f6"),{name:"ResourceQItem",props:{resource:{},level:{type:Number,default:0},noParent:Boolean,readonly:Boolean,dense:Boolean},data:function(){return{}},computed:{date:function(){return this.resource instanceof this.$ething.Device?this.resource.lastSeenDate():this.resource.modifiedDate()},createdBy:function(){return this.resource.createdBy()?this.$ething.arbo.get(this.resource.createdBy()):null},showParent:function(){return!this.noParent&&!!this.createdBy},showType:function(){return this.resource instanceof this.$ething.Device},showConnected:function(){return this.resource instanceof this.$ething.Device},showError:function(){return this.resource instanceof this.$ething.Device&&this.resource.attr("error")},showBattery:function(){return this.resource instanceof this.$ething.Device&&this.resource.hasBattery()},showLocation:function(){return this.resource instanceof this.$ething.Device&&this.resource.location()},showSize:function(){return this.resource instanceof this.$ething.File},showLength:function(){return this.resource instanceof this.$ething.Table},meta:function(){return this.$ethingUI.get(this.resource)},badges:function(){var e=Object.values(this.meta.badges);return e.sort((function(e,t){return t.zIndex-e.zIndex})),e},actions:function(){var e=Object.values(this.meta.actions());return e.sort((function(e,t){return t.zIndex-e.zIndex})),e}},methods:{gen:function(e){return["pad","pad-"+e]},openSettings:function(){this.$router.push({name:"resourceEdit",params:{id:this.resource.id()}})},more:function(){var e=this,t=[],n={};this.actions.forEach((function(e,i){var r="custom"+i;t.push({label:e.label,color:e.color||"secondary",icon:e.icon,id:r}),n[r]=function(){return e.click()}})),t.push({label:"Delete",color:"negative",icon:"delete",id:"remove"}),n["remove"]=function(){return e.remove()},t.push({label:"Settings",icon:"settings",id:"settings",color:"grey"}),n["settings"]=function(){return e.openSettings()},this.$q.bottomSheet({title:this.resource.basename(),actions:t}).onOk((function(e){n[t]()}))},remove:function(){var e=this,t=this.resource.name();confirm('Do you really want to remove definitely "'+this.resource.name()+'" ?')&&this.resource.remove().then((function(){e.$q.notify('"'+t+'" removed !')}))},click:function(){this.readonly?this.$emit("click",this.resource):this.$ethingUI.open(this.resource)},clickCreatedBy:function(e){this.readonly||(e.stopPropagation(),this.$ethingUI.open(this.createdBy))}}}),X=Z,ee=(n("cc33"),Object($["a"])(X,J,K,!1,null,"6b37202c",null)),te=ee.exports,ne=n("ffbd"),ie=n("15b6"),re=n("9023"),oe={name:"ResourceObservable",props:["resource","attribute"],data:function(){return{lastValue:void 0,lastUpdate:null}},watch:{resource:{handler:function(e,t){var n=this;if(e!==t&&(this.lastUpdate=null),!this.lastUpdate||e.modifiedDate()>this.lastUpdate){if(this.lastUpdate=e.modifiedDate(),this.attribute){var i=Array.isArray(this.attribute)?this.attribute:[this.attribute];return this.lastValue||(this.lastValue=[]),void i.forEach((function(t,i){var r=e.attr(t),o=n.lastValue&&i<n.lastValue.length?n.lastValue[i]:void 0;o!==r&&n.$emit("change",e,t,r),n.lastValue[i]=r}))}this.$emit("change",e)}},deep:!0},attribute:function(){this.lastValue=void 0}},render:function(e){}},ae={inheritAttrs:!1,props:{color:String,bgColor:String,primaryColor:String,secondaryColor:String,accentColor:String,resource:{}},methods:{setError:function(e){this.$emit("error",e)}},errorHandler:function(e,t,n){console.error("widget error:",e,t,n)}},se=ae,ce=Object($["a"])(se,r,o,!1,null,null,null),le=ce.exports,ue=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("chart",{attrs:{preferences:e.resource||{},history:e.history,expended:"",minimal:"",readonly:"","no-zoom":"",chartOptions:e.chartOptions}})},de=[],fe=n("bc78"),he={name:"WChart",components:{Chart:h["a"]},mixins:[le],props:{history:{default:86400}},data:function(){return{chartOptions:{chart:{backgroundColor:"rgba(255, 255, 255, 0.0)"},plotOptions:{series:{color:this.primaryColor}},title:{style:{color:this.color},text:null},subtitle:{text:null}}}}},me=he,pe=Object($["a"])(me,ue,de,!1,null,null,null),ve=pe.exports,be=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("image-viewer",{attrs:{source:e.resource,"no-title":"",zoom:"fullscreen","content-style":{color:e.color,"background-color":"transparent"},"toolbar-style":{background:"transparent"}}})},_e=[],ge={name:"WImage",components:{ImageViewer:D},mixins:[le]},ye=ge,xe=Object($["a"])(ye,be,_e,!1,null,"582ca451",null),we=xe.exports,Ce=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("image-viewer",{ref:"view",attrs:{source:e.source,"no-title":"",zoom:"fullscreen",toolbarStyle:{background:"transparent"},"content-style":{color:e.color,"background-color":"transparent"},"toolbar-style":{background:"transparent"}}})},$e=[],ke={name:"WCamera",components:{ImageViewer:D},props:{refreshInterval:{default:30}},data:function(){return{timerId:null}},computed:{source:function(){return this.resource.executeUrl("snapshot")}},mounted:function(){var e=this;this.timerId=setInterval((function(){e.$refs.view.refresh()}),1e3*this.refreshInterval)},beforeDestroy:function(){null!==this.timerId&&clearInterval(this.timerId)},mixins:[le]},qe=ke,Oe=Object($["a"])(qe,Ce,$e,!1,null,null,null),Se=Oe.exports,je=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"absolute-center text-center"},[n("div",{staticClass:"time"},[n("span",{staticClass:"text-weight-bold"},[e._v(e._s(e.hours)+":"+e._s(e.minutes)+" ")]),n("small",{staticStyle:{filter:"brightness(90%)"}},[e._v(e._s(e.seconds))])]),n("span",{staticClass:"weekday",staticStyle:{filter:"brightness(90%)"}},[e._v("\n        "+e._s(e.weekday)+"\n    ")])])])},Ee=[],Te=n("25d4"),Ie=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function De(e,t,n){return n=n||"0",e+="",e.length>=t?e:new Array(t-e.length+1).join(n)+e}var Me={name:"WClock",mixins:[le],props:{},data:function(){return{hours:0,minutes:0,seconds:0,weekday:"",timerId:null}},mounted:function(){var e=this;this.timerId=setInterval((function(){e.refreshTime()}),1e3)},beforeDestroy:function(){null!==this.timerId&&clearInterval(this.timerId)},methods:{refreshTime:function(){var e=new Date;this.hours=De(e.getHours(),2),this.minutes=De(e.getMinutes(),2),this.seconds=De(e.getSeconds(),2),this.weekday=Ie[e.getDay()]}}};Object(Te["c"])("clock",{component:Me,title:"clock",description:"Display the time"});for(var Ae=Me,Fe=Ae,Be=Object($["a"])(Fe,je,Ee,!1,null,null,null),Pe=Be.exports,Le=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"fit",class:e.outputs.length&&e.inputs.length?"row items-center":""},[e.inputs.length?n("div",{staticClass:"inputs column justify-around items-center",class:e.outputs.length?"col-6":"fit"},e._l(e.inputs,(function(t,i){return n("flow-node",{key:i,staticClass:"col-auto",attrs:{flow:e.resource,node:t}})})),1):e._e(),e.outputs.length?n("div",{staticClass:"outputs column justify-around items-center",class:e.inputs.length?"col-6":"fit"},e._l(e.outputs,(function(t,i){return n("flow-node",{key:i,staticClass:"col-auto",attrs:{flow:e.resource,node:t}})})),1):e._e()])},ze=[],Re={name:"WFlow",extends:le,components:{FlowNode:O["a"]},computed:{parsedFlow:function(){var e=this,t=this.resource.attr("nodes"),n=[],i=[];return t.forEach((function(t){e.$ethingUI.isSubclass(t.type,"nodes/Input")?n.push(t):e.$ethingUI.isSubclass(t.type,"nodes/Output")&&i.push(t)})),{inputs:n,outputs:i}},inputs:function(){return this.parsedFlow.inputs},outputs:function(){return this.parsedFlow.outputs}}},Ue=Re,Ne=Object($["a"])(Ue,Le,ze,!1,null,null,null),Ve=Ne.exports,He=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("flow-node",{staticClass:"absolute-center",attrs:{flow:e.resource,node:e.node}})},We=[],Qe={name:"WFlowNode",extends:le,components:{FlowNode:O["a"]},props:["node"]},Ye=Qe,Ge=Object($["a"])(Ye,He,We,!1,null,null,null),Je=Ge.exports,Ke=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("knob",{attrs:{value:e.brightness,set:e.__setBrightness,color:e.color,"bg-color":e.bgColor,"primary-color":e.primaryColor}},[[n("div",{staticClass:"top",style:e.__topStyle,on:{click:function(t){return t.stopPropagation(),e.__toggle(t)}}},[n("div",{staticClass:"absolute-center"},[e._v(e._s(e.__stateTxt))])]),n("div",{staticClass:"bottom",style:e.__bottomStyle,on:{click:function(t){t.stopPropagation(),e.colorModel=!0}}},[n("q-icon",{staticClass:"absolute-center",attrs:{name:"mdi-palette"}}),n("q-dialog",{attrs:{"transition-show":"scale","transition-hide":"scale"},model:{value:e.colorModel,callback:function(t){e.colorModel=t},expression:"colorModel"}},[n("q-color",{staticStyle:{width:"50%"},attrs:{value:e.displayHex,"no-header":"","default-view":"palette",palette:e.palette},on:{input:e.__setColor}})],1)],1)]],2)},Ze=[],Xe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"fit column no-wrap text-center q-pt-sm q-gutter-y-sm q-pl-sm q-gutter-x-sm"},[e.label?n("div",{staticClass:"col-auto"},[e._v(e._s(e.label))]):e._e(),n("div",{staticClass:"col relative-position"},[n("q-resize-observer",{on:{resize:e.updateLayout}}),n("q-knob",{ref:"knob",staticClass:"q-knob--no-shadow",attrs:{value:e.__valueNumber,min:e.min,max:e.max,readonly:e.__readonly,color:"primary","show-value":"",size:e.knobSize,thickness:e.thickness,"track-color":"track-color-custom",disable:e.writing},on:{change:e.__change}},[n("div",{staticClass:"toto relative-position",style:{width:e.innerSize+"px",height:e.innerSize+"px",fontSize:e.fontSize}},[e._t("default",[e.__centerButton?n("q-avatar",{attrs:{color:e.__state?"primary":"#bdbdbd","text-color":"white","font-size":"30%",size:e.buttonSize},on:{click:function(t){return t.stopPropagation(),e.__toggle(t)}}},[e._v("\n            "+e._s(e.__state?e.buttonLabelOn:e.buttonLabelOff)+"\n          ")]):n("div",{staticClass:"text-center text-primary"},[e.icon?n("q-icon",{staticClass:"light",staticStyle:{"vertical-align":"text-bottom"},attrs:{name:e.icon}}):e._e(),n("div",{staticClass:"big"},[e._v(e._s(e.value))]),e.unit?n("div",{staticClass:"light"},[e._v(e._s(e.unit))]):e._e()],1)])],2)])],1)])},et=[],tt=(n("ee1d"),{name:"WKnob",mixins:[le],props:{label:String,unit:String,icon:String,min:{type:Number,default:0},max:{type:Number,default:100},thickness:{type:Number,default:.2},value:{},set:Function,buttonValue:{},buttonSet:Function,buttonLabelOn:{type:String,default:"On"},buttonLabelOff:{type:String,default:"Off"}},data:function(){return{knobSize:"64px",fontSize:"16px",buttonSize:"56px",writing:!1,innerSize:0}},computed:{__readonly:function(){return!this.set},__centerButton:function(){return!!this.buttonSet},__valueNumber:function(){var e=this.value;return"string"===typeof e&&(e=parseInt(e)),"number"!==typeof e||Number.isNaN(e)?0:e},__state:function(){return!!this.buttonValue}},mounted:function(){this.__refreshTrackColor()},methods:{updateLayout:function(e){if(e.height||e.width){var t=Math.min(e.width,e.height);this.knobSize=t+"px";var n=t*(1-this.thickness);this.innerSize=Math.floor(n)-8,this.buttonSize=n-8+"px";var i=1.2,r=1.5,o=r+1+1,a=n/(o*i);this.fontSize=Math.floor(a)+"px"}},__refreshTrackColor:function(){var e=this.$refs.knob;if(e){var t=e.$el.querySelector(".text-track-color-custom");if(t){var n=this.primaryColor.substring(0,7)+"40";t.style.color=n}}},__change:function(e){var t=this;this.set&&(this.writing=!0,Promise.resolve(this.set(e)).catch((function(e){t.setError(e)})).finally((function(){t.writing=!1})))},__toggle:function(){var e=this;this.buttonSet&&(this.writing=!0,Promise.resolve(this.buttonSet(!this.__state)).catch((function(t){e.setError(t)})).finally((function(){e.writing=!1})))}}}),nt=tt,it=(n("ab0f"),n("c2dc"),Object($["a"])(nt,Xe,et,!1,null,"08deb0eb",null)),rt=it.exports,ot=n("1c16"),at=fe["a"].hexToRgb,st=fe["a"].rgbToHsv,ct=fe["a"].hsvToRgb,lt=fe["a"].rgbToHex,ut=[],dt=100;dt>0;dt-=10)for(var ft=0;ft<360;ft+=36)ut.push(lt(ct({h:ft,s:dt,v:100})));var ht={name:"WRGBLight",mixins:[le],components:{Knob:rt},data:function(){return{writing:!1,colorModel:!1,palette:ut}},computed:{brightness:function(){return this.resource.attr("level")||0},hue:function(){return this.resource.attr("hue")},saturation:function(){return this.resource.attr("saturation")},displayHex:function(){return this.state?lt(ct({h:this.hue,s:this.saturation,v:100})):"#777"},state:function(){return this.resource.attr("state")},__stateTxt:function(){return this.state?"On":"Off"},__topStyle:function(){return{backgroundColor:this.state?this.primaryColor:"#bdbdbd",color:"white"}},__notWhiteTextColor:function(){return this.__isWhite(this.color)?this.bgColor:this.color},__bottomStyle:function(){return{backgroundColor:this.displayHex,color:this.__isWhite(this.displayHex)?this.__notWhiteTextColor:"white",borderColor:this.state?this.primaryColor:"#bdbdbd"}}},methods:{__isWhite:function(e){return/^#ffffff/i.test(e)||"white"===e},__setBrightness:function(e){var t=this;this.writing=!0,Promise.resolve(this.resource.execute("setLevel",e)).catch((function(e){t.setError(e)})).finally((function(){t.writing=!1}))},__setColor:Object(ot["a"])((function(e){var t=this,n=st(at(e));this.writing=!0,Promise.resolve(this.resource.execute("setColor",{hue:n.h,saturation:n.s})).catch((function(e){t.setError(e)})).finally((function(){t.writing=!1}))}),400,!0),__toggle:function(){var e=this;this.writing=!0,Promise.resolve(this.resource.execute("setState",!this.state)).catch((function(t){e.setError(t)})).finally((function(){e.writing=!1}))}}},mt=ht,pt=(n("7a95"),Object($["a"])(mt,Ke,Ze,!1,null,"063212a0",null)),vt=pt.exports,bt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"fit",class:e.vertical?"row":"column no-wrap items-stretch"},[n("q-resize-observer",{on:{resize:e.updateLayout}}),n("div",{staticClass:"col",class:e.vertical?"column no-wrap items-stretch":"row"},[n("q-btn",{staticClass:"col",attrs:{flat:"",icon:"mdi-arrow-up-bold"},on:{click:function(t){return e.__up()}}}),n("q-btn",{staticClass:"col",attrs:{flat:"",label:"stop"},on:{click:function(t){return e.__stop()}}}),n("q-btn",{staticClass:"col",attrs:{flat:"",icon:"mdi-arrow-down-bold"},on:{click:function(t){return e.__down()}}})],1),n("div",{staticClass:"col-auto relative-position",style:e.__barStyle},[n("div",{staticClass:"absolute",style:e.__barContentStyle})])],1)},_t=[],gt={name:"WCover",mixins:[le],data:function(){return{writing:!1,vertical:!0}},computed:{__position:function(){return Math.round(this.resource.attr("position"))||0},__barStyle:function(){return this.vertical?{width:"8px"}:{height:"8px"}},__barContentStyle:function(){return this.vertical?{bottom:0,width:"100%",height:this.__position+"%",backgroundColor:this.color}:{left:0,height:"100%",width:this.__position+"%",backgroundColor:this.color}}},methods:{__up:function(){var e=this;this.writing=!0,Promise.resolve(this.resource.execute("open_cover")).catch((function(t){e.setError(t)})).finally((function(){e.writing=!1}))},__down:function(){var e=this;this.writing=!0,Promise.resolve(this.resource.execute("close_cover")).catch((function(t){e.setError(t)})).finally((function(){e.writing=!1}))},__stop:function(){var e=this;this.writing=!0,Promise.resolve(this.resource.execute("stop_cover")).catch((function(t){e.setError(t)})).finally((function(){e.writing=!1}))},updateLayout:function(e){if(e.height||e.width){var t=e.width/e.height;this.vertical=t<2}}}},yt=gt,xt=Object($["a"])(yt,bt,_t,!1,null,null,null),wt=xt.exports,Ct=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"fit",class:e.vertical?"column no-wrap items-stretch":"row"},[n("q-resize-observer",{on:{resize:e.updateLayout}}),n("div",{staticClass:"col no-wrap",class:e.controlsVertical?"column items-stretch":"row items-center"},[n("q-btn",{staticClass:"col",attrs:{stretch:"",flat:"",icon:"mdi-chevron-up"},on:{click:function(t){return e.__up()}}}),n("div",{staticClass:"col-auto text-center text-no-wrap q-ma-md",style:{fontSize:e.valueFontSize}},[e._v("\n      "+e._s(e.__targetTemperature)+" "),n("span",{staticStyle:{"font-size":"50%"}},[e._v(e._s(e.__unit))])]),n("q-btn",{staticClass:"col",attrs:{stretch:"",flat:"",icon:"mdi-chevron-down"},on:{click:function(t){return e.__down()}}})],1)],1)},$t=[],kt={name:"WThermostat",mixins:[le],data:function(){return{writing:!1,vertical:!0,controlsVertical:!1,valueFontSize:"100%"}},computed:{__targetTemperature:function(){return this.resource.attr("target_temperature")||0},__unit:function(){return this.$ethingUI.get(this.resource).properties.target_temperature.unit}},methods:{__up:function(){var e=this;this.writing=!0,Promise.resolve(this.resource.execute("set_target_temperature",this.__targetTemperature+1)).catch((function(t){e.setError(t)})).finally((function(){e.writing=!1}))},__down:function(){var e=this;this.writing=!0,Promise.resolve(this.resource.execute("set_target_temperature",this.__targetTemperature-1)).catch((function(t){e.setError(t)})).finally((function(){e.writing=!1}))},updateLayout:function(e){if(e.height||e.width)if(Math.max(e.width,e.height)<200)this.vertical=!0,this.controlsVertical=!1,this.valueFontSize="100%";else{var t=e.width/e.height;this.vertical=t<4,this.controlsVertical=t<.5,this.valueFontSize=Math.min(e.width,e.height)>250?"400%":"200%"}}}},qt=kt,Ot=Object($["a"])(qt,Ct,$t,!1,null,null,null),St=Ot.exports,jt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"column fit text-center text-primary no-wrap q-pt-sm q-gutter-y-sm"},[e.label&&!e.horizontal?n("span",{staticClass:"col-auto"},[e._v(e._s(e.label))]):e._e(),n("div",{staticClass:"col column justify-center",style:{fontSize:e.fontSize}},[n("q-resize-observer",{on:{resize:e.updateLayout}}),n("div",{staticClass:"col-auto text-no-wrap"},[e.icon?n("q-icon",{staticClass:"light big",staticStyle:{"vertical-align":"text-bottom"},attrs:{name:e.icon}}):e._e(),e.label&&e.horizontal?n("span",{staticClass:"q-mr-sm light"},[e._v(e._s(e.label))]):e._e(),n("span",{staticClass:"text-bold big"},[e._v(e._s(e.value))]),e.unit?n("span",{staticClass:"light"},[e._v(e._s(e.unit))]):e._e()],1)],1)])},Et=[],Tt={name:"WLabel",mixins:[le],props:{label:String,unit:String,icon:String,value:{},horizontal:Boolean},data:function(){return{fontSize:"16px"}},methods:{updateLayout:function(e){if(e.height||e.width){var t=e.height,n=1.5,i=2,r=i;!this.horizontal&&this.label&&(r+=1);var o=t/(1*n*r),a=e.width/(this.horizontal&&this.label?20:10);this.fontSize=Math.floor(Math.min(o,a))+"px"}}}},It=Tt,Dt=(n("6fa4"),Object($["a"])(It,jt,Et,!1,null,"557c353e",null)),Mt=Dt.exports,At=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"column fit justify-center q-pa-sm no-wrap"},[e._l(e.items,(function(t,i){return[n("div",{staticClass:"col-auto item row"},[e.__hasIcons?n("div",{staticClass:"col-auto text-secondary"},[e.__getProp(t,"icon")?n("q-icon",{staticStyle:{"vertical-align":"baseline"},attrs:{name:e.__getProp(t,"icon"),left:""}}):n("q-icon",{staticStyle:{"vertical-align":"baseline",visibility:"hidden"},attrs:{name:"mdi-minus",left:""}})],1):e._e(),e.__getProp(t,"label")?n("div",{staticClass:"col ellipsis"},[n("span",[e._v(e._s(e.__getProp(t,"label")))])]):e._e(),n("span",{staticClass:"text-bold text-primary col-auto"},[e._v(e._s(e.__getProp(t,"value")))]),e.__getProp(t,"unit")?n("span",{staticClass:"text-primary col-auto"},[e._v(e._s(e.__getProp(t,"unit")))]):e._e()])]}))],2)},Ft=[],Bt={name:"WMultiLabel",mixins:[le],props:{items:Array},computed:{__hasIcons:function(){for(var e in this.items){var t=this.items[e];if(this.__getProp(t,"icon"))return!0}}},methods:{__value:function(e){var t=e.value;if("function"==typeof t)try{t=t()}catch(n){console.error(n),t="?"}return t},__getProp:function(e,t){var n=e[t];if("function"==typeof n)try{n=n.call(this)}catch(i){console.error(i),n=void 0}return n}}},Pt=Bt,Lt=Object($["a"])(Pt,At,Ft,!1,null,null,null),zt=Lt.exports,Rt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"fit row no-wrap"},[n("div",{staticClass:"col-6 q-pa-xs"},[n("q-btn",{staticClass:"fit no-border-radius",style:e.__value?e.__activeStyle:e.__passiveStyle,attrs:{label:e.labelOn,icon:e.iconOn,disable:e.writing,flat:"",size:e.__value?"150%":"80%"},on:{click:function(t){return e.__set(!0)}}})],1),n("div",{staticClass:"col-6 q-pa-xs"},[n("q-btn",{staticClass:"fit no-border-radius",style:e.__value?e.__passiveStyle:e.__activeStyle,attrs:{label:e.labelOff,icon:e.iconOff,disable:e.writing,flat:"",size:e.__value?"80%":"150%"},on:{click:function(t){return e.__set(!1)}}})],1)])},Ut=[],Nt={name:"WSwitch",mixins:[le],props:{labelOn:{type:String,default:"On"},labelOff:{type:String,default:"Off"},iconOn:String,iconOff:String,value:{},set:Function},data:function(){return{writing:!1}},computed:{__value:function(){return!!this.value},__activeStyle:function(){return{backgroundColor:this.primaryColor,color:"white"}},__passiveStyle:function(){return{}}},methods:{__set:function(e){var t=this;this.set&&(this.writing=!0,Promise.resolve(this.set(e)).catch((function(e){t.setError(e)})).finally((function(){t.writing=!1})))}}},Vt=Nt,Ht=Object($["a"])(Vt,Rt,Ut,!1,null,null,null),Wt=Ht.exports,Qt={WLabel:Mt,WKnob:rt,WMultiLabel:zt,WSwitch:Wt},Yt={Base:le,WChart:ve,WImage:we,WCamera:Se,WRGBLight:vt,WClock:Pe,WFlow:Ve,WFlowNode:Je,WCover:wt,WThermostat:St,generic:Qt},Gt=n("90ee"),Jt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"q-px-md"},[e.items.length>0?n("q-timeline",{attrs:{layout:"dense"}},e._l(e.items,(function(t,i){return n("q-timeline-entry",{key:i,attrs:{subtitle:t.dateStr,color:"secondary"},scopedSlots:e._u([{key:"title",fn:function(){return[n("div",{staticClass:"text-secondary text-subtitle1"},[t.icon?n("q-icon",{attrs:{name:t.icon}}):e._e(),e._v(" "+e._s(t.title))],1),e.multiple?n("div",{staticClass:"text-purple text-subtitle2 cursor-pointer",on:{click:function(n){return e.openResource(t.resource)}}},[e._v("\n          "+e._s(t.resource.name())+"\n        ")]):e._e()]},proxy:!0}],null,!0)},[n("div",{staticClass:"text-faded"},[e._v("\n        "+e._s(t.dataStr)+"\n      ")])])})),1):n("div",{staticClass:"q-pa-md text-center text-faded"},[e._v("No activity. Please wait...")])],1)},Kt=[],Zt={name:"ResourceActivity",props:{source:{},historyLength:{type:Number,default:20},reverse:Boolean},computed:{multiple:function(){return Array.isArray(this.source)&&this.source.length>1},items:function(){var e=this,t=[],n=this.source;return Array.isArray(n)||(n=[n]),n.forEach((function(n){n instanceof e.$ething.Resource&&(n=n.id());var i=e.$root.activityData[n];i&&(t=t.concat(i))})),t.sort((function(e,t){return e.timeStamp-t.timeStamp})),this.historyLength>0&&(t=t.slice(Math.max(t.length-this.historyLength,0))),this.reverse||t.reverse(),t.map((function(t){var n=e.$ethingUI.get(t.type)||{};return{title:n.title||t.type,icon:n.icon,dateStr:e.$ethingUI.utils.dateToString(t.timeStamp),dataStr:e.$ethingUI.utils.describe(t.data),ts:t.timeStamp,event:t,resource:t.resource}}))}},methods:{openResource:function(e){this.$ethingUI.open(e)}}},Xt=Zt,en=Object($["a"])(Xt,Jt,Kt,!1,null,null,null),tn=en.exports,nn=n("b314"),rn=n("c86d"),on=n("7cd6"),an=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n(e.component.component,e._g(e._b({tag:"component"},"component",e.__attrs,!1),e.component.listeners()))},sn=[],cn={name:"DynamicComponent",inheritAttrs:!1,props:{component:{}},computed:{__attrs:function(){return Object(V["a"])(!0,{},this.component.attributes(),this.$attrs)}}},ln=cn,un=Object($["a"])(ln,an,sn,!1,null,null,null),dn=un.exports,fn=n("e35a"),hn=n("09bd"),mn=n.n(hn),pn=(n("f400"),n("3e67")),vn=n("c658"),bn=n("bd4c"),_n={icon:"attachment",color:"grey",properties:{data:{$readOnly:!0},modifiedDate:{getFormatted:function(e){return bn["b"].formatDate(this.get(e).getTime(),"YYYY-MM-DD HH:mm")}},createdDate:{getFormatted:function(e){return bn["b"].formatDate(this.get(e).getTime(),"YYYY-MM-DD HH:mm")}},extends:{getFormatted:function(e){return(this.get(e)||[]).join(", ")}}},cacheExpired:function(e,t){return-1!==t.indexOf("extends")},open:function(e){return{name:"resourceMain",params:{id:e.id()}}}},gn=n("7937"),yn={icon:"mdi-file",color:"green",properties:{size:{getFormatted:function(e){return gn["c"].humanStorageSize(this.get(e))}},contentModifiedDate:{getFormatted:function(e){return bn["b"].formatDate(this.get(e).getTime(),"YYYY-MM-DD HH:mm")}}},cacheExpired:function(e,t){return-1!==t.indexOf("name")},dynamic:function(e){var t,n={};"plot"===e.extension()?(t="mdi-file-chart",n.chart={component:ve,schema:{title:"chart",properties:{history:{description:"the past data to plot",type:"number",enum:[3600,21600,43200,86400,172800,604800,"all"],$labels:["1 hour","6 hours","12 hours","1 day","2 days","1 week","all"],default:86400}}},minWidth:250,minHeight:150}):/^text/.test(e.mime())?t="mdi-file-document":/^image/.test(e.mime())?(t="mdi-file-image",n.image={component:we,schema:{title:"image"},minWidth:320,minHeight:280}):/^video/.test(e.mime())?t="mdi-file-video":/^application/.test(e.mime())&&(t="mdi-file-xml");var i={};return t&&(i.icon=t),n&&(i.widgets=n),i},open:function(e){return/\.plot$/.test(e.basename())?"/chart/"+e.id():/image/.test(e.mime())?"/image/"+e.id():"/text/"+e.id()},actions:function(e){return{download:{label:"Download",icon:"cloud_download",click:function(){s.a.request({url:e.getContentUrl(),dataType:"blob"}).then((function(t){lr.utils.saveAs(t,e.basename())}))}}}}},xn=n("436b"),wn={icon:"mdi-table-large",color:"blue",properties:{length:{getFormatted:function(e){return this.get(e)+" rows"}},contentModifiedDate:{getFormatted:function(e){return bn["b"].formatDate(this.get(e).getTime(),"YYYY-MM-DD HH:mm")}}},widgets:{chart:{title:"chart",description:"plot the data",component:ve,schema:{properties:{history:{description:"the past data to plot",type:"number",enum:[3600,21600,43200,86400,172800,604800,"all"],$labels:["1 hour","6 hours","12 hours","1 day","2 days","1 week","all"],default:86400}}},minWidth:250,minHeight:150}},open:function(e,t){return"chart"===t?"/chart/"+e.id():"/table/"+e.id()},actions:function(e){return{plot:{label:"Plot chart",icon:"mdi-chart-line",click:function(){lr.router.push("/chart/"+e.id())}},download:{label:"Download",icon:"cloud_download",click:function(){xn["a"].create({title:'Download "'+e.name()+'"',message:"Format: ",options:{type:"radio",model:"csv",items:[{label:"CSV",value:"csv"},{label:"JSON",value:"json_pretty"}]},cancel:!0,persistent:!0,color:"secondary"}).onOk((function(t){s.a.request({url:e.getContentUrl()+"?fmt="+t,dataType:"blob"}).then((function(n){lr.utils.saveAs(n,e.basename()+"."+("json_pretty"==t?"json":t))}))}))}}}}},Cn={icon:"mdi-sitemap",color:"purple",virtual:!0,disableCreation:!1,properties:{lastSeenDate:{getFormatted:function(e){var t=this.get(e);return t?bn["b"].formatDate(t.getTime(),"YYYY-MM-DD HH:mm"):"never"}},location:{$hints:["living room","kitchen","garden","dining room","bathroom","room","room #2","room #3","room #4","outdoor","entrance hall","study","toilet","garage"]}},badges:function(e){return{battery:{component:"q-chip",attributes:function(){var t=e.attr("battery"),n=!1,i="battery_unknown",r="secondary";return"number"!==typeof t?(t="?",n=!0):(t=Math.round(t),t>95&&(i="mdi-battery"),t>85&&(i="mdi-battery-90"),t>75&&(i="mdi-battery-80"),t>65&&(i="mdi-battery-70"),t>55&&(i="mdi-battery-60"),t>45&&(i="mdi-battery-50"),t>35&&(i="mdi-battery-40"),t>25&&(i="mdi-battery-30"),t>15&&(i="mdi-battery-20"),t>=0&&(i="mdi-battery-alert"),t<=25&&(r="warning"),t<=5&&(r="negative")),{label:t+"%",icon:i,outline:!0,square:!0,dense:!0,color:r,style:n?"display: none;":""}},zIndex:100},location:{component:"q-chip",attributes:function(){var t=e.attr("location"),n=!1;return t||(t="?",n=!0),{label:t,icon:"location_on",outline:!0,square:!0,dense:!0,color:"secondary",style:n?"display: none;":""}},zIndex:99}}}},$n={icon:"mdi-ray-start-arrow",color:"orange",properties:{nodes:{$readOnly:!0},connections:{$readOnly:!0}},open:function(e,t){return"/flow/"+e.id()},widgets:function(e){return{"flow.full":{component:Ve,title:"Flow widget",description:"interact with flow"},"flow.node":{component:Je,title:"Flow node widget",description:"interact with flow",schema:{properties:{node:{description:"the input/output node to display",type:"string",$component:"ething.flow.node",$flow:e,$filter:function(e,t){return EThingUI.isSubclass(t.type,"nodes/Input")||EThingUI.isSubclass(t.type,"nodes/Output")}}}}}}},actions:function(e){return{flowEnable:{label:e.attr("enabled")?"stop":"run",forceLabel:!0,icon:e.attr("enabled")?"stop":"mdi-play",color:e.attr("enabled")?"negative":"secondary",click:function(){return e.set({enabled:!e.attr("enabled")}).catch((function(e){console.error(e)}))}}}}},kn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-list",e._l(e.items,(function(e){return n("resource-q-item",{key:e.id(),attrs:{resource:e}})})),1)},qn=[],On={name:"ListGroupItems",components:{ResourceQItem:te},props:{resource:{}},computed:{items:function(){var e=this,t=[];return this.resource.attr("items").forEach((function(n){var i=e.$ething.arbo.get(n);i&&t.push(i)})),t}},methods:{}},Sn=On,jn=Object($["a"])(Sn,kn,qn,!1,null,null,null),En=jn.exports,Tn={color:"cyan-6",dynamic:function(e){return{properties:{items:{items:{$filter:function(t){return t!==e}}}}}},components:{"group.list":{component:En,title:"Items"}}},In=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-scroll-area",{staticClass:"column fit justify-center q-pa-md no-wrap"},[n("div",{staticClass:"col-auto item row items-center q-my-xs cursor-pointer",on:{click:function(t){return e.__toggle(e.resource)}}},[n("div",{staticClass:"col ellipsis text-secondary"},[e._v("\n      ALL\n    ")]),n("div",{staticClass:"col-auto"},[n("q-icon",{staticStyle:{"font-size":"2em"},attrs:{name:e.__state(e.resource)?"mdi-lightbulb-on":"mdi-lightbulb-outline",color:e.__state(e.resource)?"primary":"light"}})],1)]),n("div",{staticClass:"col-auto"},[n("q-separator",{staticStyle:{opacity:"0.3"},attrs:{color:"secondary",spaced:""}})],1),e._l(e.items,(function(t){return n("div",{key:t.id(),staticClass:"col-auto item row items-center q-my-xs cursor-pointer",on:{click:function(n){return e.__toggle(t)}}},[n("div",{staticClass:"col ellipsis"},[e._v("\n      "+e._s(t.name())+"\n    ")]),n("div",{staticClass:"col-auto"},[n("q-icon",{staticStyle:{"font-size":"2em"},attrs:{name:e.__state(t)?"mdi-lightbulb-on":"mdi-lightbulb-outline",color:e.__state(t)?"primary":"light"}})],1)])}))],2)},Dn=[],Mn={name:"WLightGroupToggle",mixins:[le],data:function(){return{}},computed:{items:function(){var e=this,t=[];return this.resource.attr("items").forEach((function(n){var i=e.$ething.arbo.get(n);i&&t.push(i)})),t}},methods:{__state:function(e){return e.attr("state")},__toggle:function(e){this.__setState(e,!this.__state(e))},__setState:function(e,t){e.execute("setState",!!t)}}},An=Mn,Fn=Object($["a"])(An,In,Dn,!1,null,null,null),Bn=Fn.exports,Pn={widgets:function(e){return{lightGroup:{component:Bn,title:"toggle",description:"toggle lights"}}}},Ln={Resource:_n,File:yn,Table:wn,Device:Cn,Flow:$n,Group:Tn,LightGroup:Pn},zn=(n("7514"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},e._l(e.__sensors,(function(t,i){return n("div",{key:t.name,staticClass:"row items-stretch",class:i>0?"q-mt-xs":""},[n("div",{staticClass:"col-sm-auto col-xs-12",style:{height:"220px",width:e.$q.screen.xs?"":"220px"}},[n("widget",e._b({attrs:{resource:e.resource}},"widget",t.attrs,!1))],1),n("div",{staticClass:"gt-xs col q-ml-xs relative-position bg-white",staticStyle:{height:"220px"}},[t.chart?n("widget",e._b({attrs:{resource:e.resource}},"widget",t.chart,!1)):n("small",{staticClass:"absolute-center text-light"},[e._v("No data")])],1)])})),0)}),Rn=[],Un={name:"SensorsListView",inheritAttrs:!1,components:{Widget:re["a"]},props:{resource:{}},computed:{__sensors:function(){var e=[],t=this.$ethingUI.get(this.resource).properties;for(var n in t){var i=t[n];if(i.sensor){var r=i.title||n,o={};this.$attrs.color&&(o.color=this.$attrs.color),this.$attrs.bgColor&&(o.bgColor=this.$attrs.bgColor);var a={title:r,minHeight:220,minWidth:220,sensorName:n,widget:"sensor.label"},s=null;"number"===i.type&&"number"==typeof i.minimum&&"number"==typeof i.maximum&&(a.widget="sensor.knob",a.min=i.minimum,a.max=i.maximum),i.history&&(s={title:r,sensorName:n,widget:"sensor.graph"}),e.push({name:n,attrs:Object.assign(a,o),chart:Object.assign(s,o)})}}return e}}},Nn=Un,Vn=(n("bc8f"),Object($["a"])(Nn,zn,Rn,!1,null,"435f0a88",null)),Hn=Vn.exports,Wn={components:{"sensor.main":{component:Hn,title:"Sensors",icon:"mdi-access-point"}},badges:function(e){var t={},n=this.properties,i=function(i){var r=n[i];r.sensor&&(t[i]={component:"q-chip",attributes:function(){var t=e.attr(i),n=!1;"undefined"!=typeof t&&null!==t||(t="?",n=!0);var o=t+(r.unit||""),a=r.icon;return a||(o=r.title+": "+o),{label:o,icon:a,outline:!0,square:!0,dense:!0,color:"secondary",style:n?"display: none;":""}}})};for(var r in n)i(r);return t},widgets:function(e){var t={},n=[],i=[],r=[],o=this.properties;for(var a in o){var c=o[a];c.sensor&&(n.push(a),c.history&&i.push(a),"number"!=c.type&&"integer"!=c.type||r.push(a))}if(n.length>0){var l={schema:{properties:{},required:[]}};n.length>1&&(l.defaultTitle=function(e){var t=e.sensorName;return"%name% - "+o[t].title},l.schema.properties.sensorName={title:"sensor",enum:n,default:n[0],id:"sensor.widget.sensorName"},l.schema.required.push("sensorName"));var u=Object(V["a"])(!0,{},l,{component:Mt,title:"label",description:"show the current value of the sensor in a label",attributes:function(t){var i=t.sensorName||n[0],r=o[i];return{sensorName:i,icon:r.icon,unit:r.unit,value:e.attr(i)}}});if(t["sensor.label"]=u,n.length>1){var d={component:zt,title:"all",description:"show the current value of all available sensors",attributes:function(t){return{items:n.map((function(t){var n=o[t];return{label:n.title,unit:n.unit,icon:n.icon,value:e.attr(t)}}))}}};t["sensor.all"]=d}if(r.length>0){var f=Object(V["a"])(!0,{},l,{component:rt,title:"qnob",description:"show the current value of the sensor",attributes:function(t){var n=t.sensorName||r[0],i=o[n];return{sensorName:n,icon:i.icon,unit:i.unit,value:e.attr(n)}},schema:{properties:{min:{title:"minimum",type:"number",default:0},max:{title:"maximum",type:"number",default:100}},required:[]}});if(f.schema.properties.sensorName)f.schema.properties.min.$dependencies={"sensor.widget.sensorName":function(e,t,n){var i=o[e].minimum||0;t.$set(t.parent().c_schema.properties.min,"default",i)}},f.schema.properties.max.$dependencies={"sensor.widget.sensorName":function(e,t,n){var i=o[e].maximum;"number"!=typeof i&&(i=100),t.$set(t.parent().c_schema.properties.max,"default",i)}};else{f.schema.properties.min.default=o[r[0]].minimum||0;var h=o[r[0]].maximum;"number"==typeof h&&(f.schema.properties.max.default=h)}f.schema.properties.sensorName&&Object.assign(f.schema.properties.sensorName,{enum:r,default:r[0]}),t["sensor.knob"]=f}if(i.length>0){var m=Object(V["a"])(!0,{},l,{component:ve,title:"chart",description:"plot the value of the sensor",attributes:function(t){var n=t.sensorName||i[0],r=o[n],a=null;if(r.history){var c=s.a.arbo.find((function(t){return t.createdBy()==e.id()&&t.name()==n}));c.length>0&&(a=c[0])}return{sensorName:n,resource:a}},schema:{properties:{history:{description:"the past data to plot",type:"number",enum:[3600,21600,43200,86400,172800,604800,"all"],$labels:["1 hour","6 hours","12 hours","1 day","2 days","1 week","all"],default:86400}},required:[]}});m.schema.properties.sensorName&&Object.assign(m.schema.properties.sensorName,{enum:i,default:i[0]}),t["sensor.graph"]=m}}return t}},Qn={badges:function(e){return{state:{component:"q-chip",attributes:function(){return{label:e.attr("state")?"On":"Off",outline:!0,square:!0,dense:!0,color:"secondary"}},zIndex:10}}},widgets:function(e){return{"switch.state":{component:Mt,attributes:function(t){return{value:e.attr("state")?"On":"Off"}},title:"state",description:"show the state of the switch",minWidth:100,minHeight:100}}}},Yn={badges:function(e){return{state:{attributes:function(){return{clickable:!0}},listeners:function(){return{click:function(t){t.stopPropagation(),e.execute("toggle")}}},zIndex:10}}},components:function(e){return{"relay.switch":{icon:"mdi-lightbulb",component:"widget",attributes:function(){return{widget:"relay.switch",height:"80px"}},title:"Switch"}}},widgets:function(e){return{"relay.switch":{component:Wt,attributes:function(t){return{value:e.attr("state"),set:function(t){return e.execute("setState",t)}}},title:"switch",description:"toggle the device",minWidth:60,minHeight:60}}}},Gn={widgets:function(e){return{"relay.switch":{description:"toggle the light"}}}},Jn={badges:function(e){return{level:{component:"q-chip",attributes:function(){return{label:Math.round(e.attr("level")||0)+"%",outline:!0,square:!0,dense:!0,color:"secondary"}}}}},components:function(e){return{dimmer:{title:"level",component:"widget",attributes:function(){return{widget:"dimmer.knob",height:"150px"}}}}},widgets:function(e){return{"dimmer.label":{component:Mt,attributes:function(t){return{value:e.attr("level"),unit:"%"}},title:"level",description:"show the level as a label",minWidth:100,minHeight:100},"dimmer.knob":{component:rt,attributes:function(t){return{value:e.attr("level"),unit:"%",min:0,max:100}},title:"level",description:"show the level in a knob component",minWidth:160,minHeight:160}}}},Kn={badges:function(e){return{level:{component:"q-chip",attributes:function(){return{label:Math.round(e.attr("level")||0)+"%",outline:!0,square:!0,dense:!0,color:"secondary"}}}}},components:function(e){return{"dimmable.dimmer":{title:"level",component:"widget",attributes:function(){return{widget:"dimmable.dimmer",height:"150px"}}}}},widgets:function(e){return{"dimmable.dimmer":{component:rt,attributes:function(t){return{value:e.attr("level"),set:function(t){return e.execute("setLevel",t)},unit:"%",min:0,max:100}},title:"Dimmer",description:"adjust the level",minWidth:160,minHeight:160}}}},Zn={components:{camera:{title:"Camera",component:"widget",attributes:function(){return{widget:"camera",height:"500px"}}}},widgets:{camera:{component:Se,attributes:{refreshInterval:30},minWidth:160,minHeight:160,title:"Camera",description:"show the last image"}}},Xn={badges:function(e){return{state:{attributes:function(){return{label:e.attr("state")?"opened":"closed"}}}}},widgets:function(e){return{"sensor.label":{attributes:function(t){var n=e.attr("state");return{value:n?"opened":"closed",icon:n?"mdi-door-open":"mdi-door-closed"}}}}}},ei={components:function(e){return{"relay.switch":{disable:!0}}},widgets:function(e){return{"dimmable.dimmer":{attributes:function(t){return{buttonValue:e.attr("state"),buttonSet:function(t){return e.execute("setState",t)}}},description:"adjust the level"}}}},ti={components:function(e){return{"relay.switch":{disable:!0}}},widgets:function(e){return{"dimmable.dimmer":{attributes:function(t){return{buttonValue:e.attr("state"),buttonSet:function(t){return e.execute("setState",t)}}},description:"adjust the level"}}}},ni={components:function(e){return{"light.rgb":{icon:"mdi-lightbulb",component:"widget",attributes:function(){return{widget:"light.rgb",height:"150px"}},title:"RGBW light"},"dimmable.dimmer":{disable:!0},"relay.switch":{disable:!0}}},widgets:function(e){return{"light.rgb":{icon:"mdi-lightbulb",component:vt,title:"RGBW light",description:"control the light",minWidth:160,minHeight:200}}}},ii={badges:function(e){return{position:{component:"q-chip",attributes:function(){var t=Math.round(e.attr("position")||0);return{label:100==t?"open":0==t?"close":t+"%",outline:!0,square:!0,dense:!0,color:"secondary"}}}}},components:{cover:{title:"Cover",component:"widget",attributes:function(){return{widget:"cover",height:"100px"}}}},widgets:{cover:{component:wt,title:"Cover",description:"control the cover"}}},ri={components:{thermostat:{title:"Thermostat",component:"widget",attributes:function(){return{widget:"thermostat",height:"150px"}}}},badges:function(e){var t=this.properties["target_temperature"].unit;return{target_temperature:{component:"q-chip",attributes:function(){return{label:e.attr("target_temperature")+t,outline:!0,square:!0,dense:!0,color:"secondary",icon:"mdi-thermostat"}}}}},widgets:{thermostat:{component:St,title:"Thermostat",description:"control the thermostat"}}},oi={Sensor:Wn,Switch:Qn,Relay:Yn,Light:Gn,Dimmer:Jn,Dimmable:Kn,Camera:Zn,DoorSensor:Xn,DimmableRelay:ei,DimmableLight:ti,RGBWLight:ni,Cover:ii,Thermostat:ri},ai={icon:"mdi-signal-variant"},si={Signal:ai},ci={color:"#eeeeee"},li={properties:{method:{id:"HttpRequest.method"},body:{format:"text",$dependencies:{"HttpRequest.method":function(e,t,n){t.$set(t.parent().c_schema.properties.body,"$disabled",-1===["POST","PUT","PATCH"].indexOf(e))}}}}},ui={properties:{resource:{id:"ExecuteDevice.device"},method:{id:"ExecuteDevice.method",enum:[],$dependencies:{"ExecuteDevice.device":function(e,t,n){var i=this.$ething.arbo.get(e),r={};i&&(r=this.$ethingUI.get(i).methods),t.$set(t.c_schema,"enum",Object.keys(r))}}},args:{$dependencies:{"ExecuteDevice.method":function(e,t,n){var i=this.$ething.arbo.get(this.find("ExecuteDevice.device").c_value);if(i&&e){var r=this.$ethingUI.get(i).methods,o=r[e];if(o&&Object.keys(o.arguments).length>0){var a=o.arguments;Object.keys(a).forEach((function(e,t){var n=a[e];a[e]={$inline:!0,oneOf:[{additionalProperties:!1,properties:{type:{const:"value",title:"value"},value:n},required:["type","value"],type:"object"},{additionalProperties:!1,properties:{type:{const:"msg",title:"msg."},value:{minLength:1,type:"string"}},required:["type","value"],type:"object"},{additionalProperties:!1,properties:{type:{const:"flow",title:"flow."},value:{minLength:1,type:"string"}},required:["type","value"],type:"object"},{additionalProperties:!1,properties:{type:{const:"glob",title:"global."},value:{minLength:1,type:"string"}},required:["type","value"],type:"object"}]}}));var s={additionalProperties:!1,properties:a,required:o.required,type:"object"};return void this.$set(this.parent().c_schema.properties,"args",s)}}this.$delete(this.parent().c_schema.properties,"args")}}}}},di={node:"Button"},fi={node:"Label"},hi={Node:ci,HttpRequest:li,ExecuteDevice:ui,Button:di,Label:fi},mi={resources:Ln,interfaces:oi,signals:si,nodes:hi},pi={color:"grey",icon:"mdi-help",title:"",description:"",required:[],properties:{},virtual:!1,dynamic:null,cacheExpired:function(e,t){return!1},components:function(e){return{}},category:"",signals:[],created:function(e){},widgets:function(e){return{}},disableCreation:!1,open:function(e){},actions:function(e){return{}},badges:function(e){return{}},methods:{},node:null};function vi(e){var t;return t=e instanceof s.a.Resource?function(t){return{resource:e}}:e instanceof s.a.Plugin?function(t){return{plugin:e}}:function(t){return{instance:e}},{component:null,attributes:t,listeners:function(){return{}},zIndex:0,title:"",icon:""}}function bi(e,t,n){e||(e=vi(n.args[0])),t||(t={});var i=Object.keys(e).concat(Object.keys(t)).filter((function(e,t,n){return n.indexOf(e)===t})),r={};return i.forEach((function(i){r[i]="component"===i?Object(vn["g"])(e[i],t[i],n):"attributes"===i||"listeners"===i?Object(vn["c"])(e[i],t[i],n):Object(vn["b"])(e[i],t[i],n)})),r}function _i(e){return{component:null,attributes:function(){return{resource:e}},listeners:function(){return{}},zIndex:0}}function gi(e,t,n){e||(e=_i(n.args[0])),t||(t={});var i=Object.keys(e).concat(Object.keys(t)).filter((function(e,t,n){return n.indexOf(e)===t})),r={};return i.forEach((function(i){r[i]="component"===i?Object(vn["g"])(e[i],t[i],n):"attributes"===i||"listeners"===i?Object(vn["c"])(e[i],t[i],n):Object(vn["b"])(e[i],t[i],n)})),r}function yi(e){return{label:"",color:"",click:function(){},zIndex:0,disable:!1}}function xi(e,t,n){return e||(e=yi(n.args[0])),t||(t={}),Object(vn["b"])(e,t,n)}var wi={required:vn["a"],properties:vn["d"],virtual:vn["f"],dynamic:!1,signals:vn["a"],widgets:function(e,t,n){return Object(vn["c"])(e,t,n,(function(e,t,n){return Object(vn["d"])(e,t,n,Te["d"])}))},cacheExpired:function(e,t,n){return Object(vn["c"])(e,t,n,(function(e,t,n){return e||t}))},methods:vn["d"],data:vn["c"],components:function(e,t,n){return Object(vn["c"])(e,t,n,(function(e,t,n){return Object(vn["d"])(e,t,n,bi)}))},badges:function(e,t,n){return Object(vn["c"])(e,t,n,(function(e,t,n){return Object(vn["d"])(e,t,n,gi)}))},actions:function(e,t,n){return Object(vn["c"])(e,t,n,(function(e,t,n){return Object(vn["d"])(e,t,n,xi)}))}};function Ci(e,t,n){var i=t?t.split("/"):[],r=e;for(var o in i){var a=i[o];if("object"!==b()(r)||null===r)throw"definition of "+t+" not found";if("undefined"===typeof r[a]){if(!n)throw"definition of "+t+" not found";r[a]={}}r=r[a]}return r}function $i(e,t,n,i){"undefined"===typeof n&&"function"===typeof t&&(i=n,n=t,t=null),i=i||[],t=t||{};var r=!1,o=function(){r=!0};if(e=n(e,t,o,i.join("/")),!r&&"object"===b()(e)&&null!==e)for(var a in e){var s=e[a];if("object"===b()(s)&&null!==s){var c=i.slice(0);c.push(a),e[a]=$i(s,t[a],n,c)}}return e}function ki(e){if("undefined"!==typeof e["allOf"]){var t=e["allOf"],n=e._bases||[],i={};for(var r in t){var o=t[r],a=null;"string"===typeof o["$ref"]?(a=o["$ref"].substr(2),-1===n.indexOf(a)&&n.push(a)):Si(i,o)}var s=Object(V["a"])(!0,{},e);delete s.allOf,Si(i,s),i._bases=n,"undefined"===typeof i["type"]&&(i["type"]="class"),e=i}return e}function qi(e){return e}function Oi(e,t,n){var i=Object(V["a"])(!0,{},pi);if(!e)return i;var r=e.slice().reverse();return r.forEach((function(e){var r=Ci(t,e);if(r=Object(V["a"])(!0,{},r),n&&r.dynamic){!0;var o=r.dynamic.call(r,n);o&&Object(V["a"])(!0,r,o)}r=qi(r),Si(i,r)})),delete i._mro,delete i._bases,i._dep=e,i}function Si(e,t){return Object(vn["e"])(e,t,wi,vn["b"])}var ji=["type","title","properties","description","required","additionalProperties"];function Ei(e,t){var n=function(t){var n=e.properties[t];n.get||(n.get=function(e){return e[t]?e[t]():e.attr(t)}),n.getFormatted||(n.getFormatted=n.get)};for(var i in e.properties)n(i);var r=e.open;e.open=function(e){var t=r.call(this,e);("string"===typeof t||"object"===b()(t)&&null!==t)&&lr.router.push(t)},["badges","components","widgets","actions"].forEach((function(t){var n=e[t];e[t]=function(){var e=n.apply(this,arguments);return Object.keys(e).reduce((function(t,n){var i=e[n];return i.disable||(i._id=n,t[n]=i),t}),{})}}));var o={};if(ji.forEach((function(t){o[t]=e[t]})),e.schema=o,delete e.dynamic,t){var a=e.open;e.open=function(){return a.call(this,t)},e.widgets=e.widgets(t),e.components=e.components(t),e.badges=e.badges(t);var s=e.actions;e.actions=function(){return s.call(this,t)};var c=e.created;e.created=function(){return c.call(this,t)},e._instance=t}return e}var Ti=new Map;function Ii(e,t){var n=Ti.get(e);n&&n.cacheExpired(e,t)&&(console.log("[meta:cacheCheck] remove cache for ",e),Ti.delete(e))}function Di(e,t){var n=null,i={},r=!1;if("object"===b()(t)&&null!==t&&t._type?t=t._type:Array.isArray(t)?r=!0:"string"===typeof t||(n=t,t=Ai(n)),n){var o=Ti.get(n);if(o)return o}else if(!r){o=Ti.get(t);if(o)return o}return n?n instanceof s.a.Resource?i=Oi(n.attr("extends"),e,n):(i=Ci(e,t),i=Oi(i._mro||[],e,n)):r?i=Oi(t,e):(i=Ci(e,t),i=Oi(i._mro||[],e)),i=Ei(i,n),n?Ti.set(n,i):r||Ti.set(t,i),i}function Mi(e,t){var n=!1;if($i(t,(function(e,t,i,r){return"undefined"!==typeof e["allOf"]&&(n=!0,e=ki(e)),"class"===e["type"]&&(e._type=r,i()),e})),n){var i={};$i(t,(function(e,t,n,r){return"class"===e["type"]&&(i[r]=e._bases||[],n()),e}));var r=Object(pn["linearize"])(i,{reverse:!0,python:!0});for(var o in r){var a=Ci(t,o);a._mro=r[o]}}$i(t,mi,(function(t,n,i,r){if("class"===t["type"]){var o=r.split("/"),a=o.pop();o=o.join("/");var s=Ci(e.definitions,o,!0);s[a]=t,n&&(t=e.extend(r,n)),i()}return t}))}function Ai(e){if(e instanceof s.a.Resource)return e.type();if(e instanceof s.a.Plugin)return e.type();throw Error("not a valid instance "+e)}function Fi(e){if("string"===typeof e)return e;if(e instanceof s.a.Resource)return Ai(e);if("object"===b()(e)&&null!==e&&e._type)return e._type;if("object"===b()(e)&&null!==e&&e._instance)return Ai(e._instance);throw Error('invalid type: "'+e+'"')}var Bi={install:function(e){var t=e.EThingUI;s.a.on("ething.resource.updated",(function(e,t,n){Ii(t,n)})),Object.assign(t,{mergeClass:Si,definitions:{},iterate:function(e,t){t||"function"!==typeof e||(t=e,e=null),"string"===typeof e&&(e=Ci(this.definitions,e)),e=e||this.definitions,$i(e,(function(e,n,i,r){return"class"===e["type"]&&(t(e._type),i()),e}))},isDefined:function(e){try{return Ci(this.definitions,Fi(e)),!0}catch(t){return!1}},getRaw:function(e){try{return Ci(this.definitions,Fi(e))}catch(t){}},get:function(e){return Di(this.definitions,e)},isSubclass:function(e,t){if(t=Fi(t),e instanceof s.a.Resource&&e.isTypeof(t))return!0;if(e=Fi(e),e===t)return!0;var n=this.get(e);return n&&n._dep&&-1!==n._dep.indexOf(t)},getSubclass:function(e){var t=this;Array.isArray(e)||(e=[e]);var n=[];return 0==e.length?n:(this.iterate((function(i){var r=t.get(i),o=!1;if(-1!==e.indexOf(i))o=!0;else for(var a in e)if(t.isSubclass(r,e[a])){o=!0;break}o&&n.push(r)})),n)},extend:function(e,t){e=Fi(e);var n=Ci(this.definitions,e,!0);return Object(V["a"])(!0,n,t),Ti.forEach((function(t,n){-1!==t._dep.indexOf(e)&&Ti.delete(n)})),n},loadMeta:function(){var e=this;return s.a.request({url:"utils/definitions",dataType:"json"}).then((function(t){Mi(e,t),console.log("[meta] ething meta loaded !")}))}}),s.a.Resource.prototype.meta=function(){return t.get(this)}}},Pi=n("8055"),Li=n.n(Pi),zi=n("25b3"),Ri=n.n(zi),Ui=Ri()(Li.a.Manager),Ni={install:function(e){var t=e.EThingUI;function n(){var e=Li()(s.a.config.serverUrl+"/events",{autoConnect:!1}),n=Li()(s.a.config.serverUrl+"/notifications",{autoConnect:!1});Ui(e),e.on("connect",(function(){console.log("[socketio] connected"),t.emit("ui.server.connected"),n.open()})),e.on("disconnect",(function(){console.log("[socketio] disconnected"),t.emit("ui.server.disconnected"),n.close()})),e.on("*",(function(e,t){var n=JSON.parse(e.data[1]);s.a.dispatch(n)})),n.on("connect",(function(){var e="ething.cid",t=c["a"].getItem(e);t||(t=String(parseInt(1e9*Math.random())),c["a"].set(e,t)),n.emit("init",{cid:t})})),Object.assign(t,{eventsSocket:e,notifSocket:n})}Object.assign(t,{io:Li.a,ioPatch:Ui,initSockets:n})}},Vi=function(e){var t=e.EThingUI,n=e.Vue,i=new n;Object.assign(t,{on:function(){return i.$on.apply(i,arguments)},once:function(){return i.$once.apply(i,arguments)},off:function(){return i.$off.apply(i,arguments)},emit:function(){return i.$emit.apply(i,arguments)}})},Hi=function(e){var t=e.EThingUI,n=(e.Vue,null);s.a.on("signals/SettingsUpdated",(function(e){console.log("[app] settings updated"),null!==n&&clearTimeout(n),n=setTimeout((function(){n=null,t.loadSettings()}),500)})),Object.assign(t,{settings:{},loadSettings:function(){var e=this;return s.a.settings.get().then((function(t){return Object.assign(e.settings,t),e.settings}))}})},Wi=(n("3b2b"),n("a639")),Qi=function(e){var t=e.EThingUI;e.Vue;Object.assign(t,{dbSet:function(e,t,n){var i="session"===n?Wi["a"]:c["a"];i.set(e,t)},dbGet:function(e,t){var n="session"===t?Wi["a"]:c["a"];if(e instanceof RegExp){var i=n.getAll(),r={};for(var o in i)e.test(o)&&(r[o]=i[o]);return r}return"string"===typeof e?n.getItem(e):n.getAll()},dbDelete:function(e,t){var n="session"===t?Wi["a"]:c["a"];n.remove(e)}})},Yi={install:function(e){var t=e.EThingUI;Object.assign(t,{info:{},scopes:{},loadInfo:function(){var e=this,t=s.a.request({url:"utils/info",dataType:"json"});return t.then((function(t){console.log("[meta] ething info loaded !");var n=t.plugins;delete t.plugins,Object.assign(e,t,{loadedPlugins:n})})).catch((function(e){console.error("[meta] ething info error !")}))}})}},Gi={install:function(e){var t=e.EThingUI;function n(e){var n=this;return new Promise((function(i,r){var o=t.get(e);if(o.js_index){var a=e.name();Object(f["injectScript"])(s.a.config.serverUrl+"/api/plugins/"+a+"/index.js",(function(e){e?(console.error("[meta] plugin "+a+" fail loading"),r(n,e)):(console.log("[meta] plugin "+a+" loaded"),i(n))}))}else i()}))}Object.assign(t,{plugins:[],findPlugin:function(e){var t;for(t=0;t<this.plugins.length;t++){var n=this.plugins[t];if(n.name()===e||n.type()===e)return n}return null},loadPlugins:function(){return s.a.Plugin.list().then((function(e){t.plugins=e||[];var i=[];return e.forEach((function(e){i.push(n(e))})),Promise.all(i)}))}})}},Ji=["signals/ResourceUpdated"],Ki=50,Zi=function(e){var t,n=e.EThingUI,i=e.app,r=e.Vue;function o(){return t=i.data.activityData=n.activity={global:[]},t}function a(e,n){var i=e.type;if(e.originalEvent&&-1===Ji.indexOf(i)){var o=null;o=e.resource?e.resource.id():e.plugin?e.plugin.type():"global",t[o]||r.set(t,o,[]),t[o].push(e),Ki>0&&(t[o]=t[o].slice(Math.max(t[o].length-Ki,0)))}}o(),s.a.on("*",a),n.on("ui.loaded",(function(){o()}))},Xi=function(e){var t=e.EThingUI,n=e.Vue,i={error:{color:"negative",icon:"report_problem"},warning:{color:"warning",icon:"warning"},success:{color:"positive",icon:"thumb_up"}},r={},o=[];new n({data:{persistentNotifications:o}});function a(e){var n={message:"",title:null,mode:"info",timeout:15e3,id:null};"string"===typeof e?n.message=e:Object.assign(n,e);var a=n.id;if(a&&r[a]&&(r[a].dismiss(),delete r[a]),n.source){var c=s.a.arbo.get(n.source);c&&(n.resource=c)}if("undefined"===typeof n.open&&(n.open=function(){n.resource&&t.open(n.resource)}),n.message){var u=0==n.timeout,d=null;if(u)d=function(){var e=o.indexOf(n);-1!==e&&o.splice(e,1)},n=Object.assign({},i[n.mode]||{},n),o.push(n);else{var f=!1,h=n.message;n.title&&(f=!0,h='<div class="text-h6">'+t.utils.sanitizeHTML(n.title)+"</div>"+t.utils.sanitizeHTML(h)),d=l["a"].create(Object.assign({position:"bottom-right",textColor:"white",actions:[{icon:"close",color:"white",handler:function(){n.remove()}}]},i[n.mode]||{},{message:h,html:f,timeout:n.timeout}))}return a&&(r[a]=n),n.dismiss=d,n.remove=function(){d(),a&&s.a.request({method:"DELETE",url:"notifications/"+a})},n}}function c(e){var t=Object.assign({},e.data);t.timeout*=1e3,a(t)}function u(){s.a.request({url:"notifications",dataType:"json"}).then((function(e){e.forEach((function(e){0===e.timeout&&a(e)}))}))}s.a.on("signals/NotificationSent",c),t.on("ui.server.connected",u),Object.assign(t,{notify:a,persistentNotifications:o})},er={install:function(e){var t=e.EThingUI;function n(e){var n=[],i=[];return e.split(" ").forEach((function(e){e&&("!"===e[0]?i.push(e.replace("!","")):n.push(e))})),function(e){var r=!1;for(var o in n)if(t.isSubclass(e,n[o])){r=!0;break}if(r)for(var o in i)if(t.isSubclass(e,i[o])){r=!1;break}return r}}function i(e){return s.a.arbo.find(n(e))}Object.assign(t,{resource:{typeFilter:n,listFromTypes:i}})}},tr={install:function(e){var t=e.EThingUI;Object.assign(t,{menu:{root:[],devices:[{label:"Sensor",icon:"mdi-access-point",types:"interfaces/Sensor"},{label:"Light",icon:"mdi-lightbulb-outline",types:"interfaces/Light"},{label:"Switch",icon:"mdi-toggle-switch",types:"interfaces/Switch interfaces/Button !interfaces/Light"},{label:"Camera",icon:"photo_camera",types:"interfaces/Camera"},{label:"Cover",icon:"mdi-window-closed",types:"interfaces/Cover"},{label:"Thermostat",icon:"mdi-thermostat",types:"interfaces/Thermostat"}],addItem:function(e){this.root.push(e)},addDeviceItem:function(e){this.devices.push(e)}}})}},nr=n("1732"),ir=".dashboard.json",rr={install:function(e){var t=e.EThingUI,n=null,i=!1;function r(){var e=s.a.arbo.glob(ir).filter((function(e){return e instanceof s.a.File})),t=null;return e.length&&(t=e[0]),a(t),c()}function o(){i||c()}function a(e){n&&n.off("updated",o),n=e,e&&e.on("updated",o)}function c(){if(n)return n.read().then((function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(n){e={}}return t.dashboard.config=e,t.emit("ui.dashboard.config"),e}))}function l(e){var t=Object(nr["a"])();return e.etag=t,n?u(n,e):s.a.File.create({name:ir}).then((function(t){return a(t),u(t,e)})),t}function u(e,n){return i=!0,e.write(JSON.stringify(n,null,4)).then((function(){t.dashboard.config=n,t.emit("ui.dashboard.config")})).finally((function(){i=!1}))}Object.assign(t,{dashboard:{init:r,save:l,config:{}}})}};mn.a.shim();var or=36e5,ar={VERSION:"0.0.1",utils:f,components:i,EThing:s.a,form:fn},sr=f["getParameterByName"];function cr(e,t){Object.keys(t).forEach((function(n){var i=t[n];f["isVueComponent"](i)?void 0!==i.name&&e.component(i.name,i):f["isPlainObject"](i)&&cr(e,i)}))}ar.kioskMode=Object({NODE_ENV:"production",CLIENT:!0,SERVER:!1,DEV:!1,PROD:!0,MODE:"spa",API:!0,VERSION:"0.0.1",VUE_ROUTER_MODE:"hash",VUE_ROUTER_BASE:"/client/",APP_URL:"undefined"}).KIOSK||"1"===sr("kiosk"),ar.virtualKeyboardEnabled=Object({NODE_ENV:"production",CLIENT:!0,SERVER:!1,DEV:!1,PROD:!0,MODE:"spa",API:!0,VERSION:"0.0.1",VUE_ROUTER_MODE:"hash",VUE_ROUTER_BASE:"/client/",APP_URL:"undefined"}).VIRTUALKEYBOARD||"1"===sr("virtualkeyboard"),ar.install=function(e){var t=e.app,n=e.router,r=e.Vue,o=e.store;if(!ar.__installed){ar.__installed=!0,t.data=t.data||{},r.config.errorHandler=function(e,t,n){var i=null,r=t;if(t)if(t.$options.errorHandler)i=t.$options.errorHandler;else while(r.$parent)if(r=r.$parent,i=r.$options.errorHandler)break;i?i.call(r,e,t,n):console.error(e)},Object.assign(ar,{router:n,store:o,getVueInstance:function(){return this.router.app},open:function(e){this.get(e).open()}});var a=[Bi,Ni,Te["b"],Vi,Hi,Qi,Yi,Gi,Zi,Xi,er,tr,rr];a.forEach((function(e){var i="function"===typeof e?e:e.install;try{i({EThingUI:ar,Vue:r,router:n,store:o,app:t})}catch(a){console.error(a)}}));var u=null,f=!1,h=window.location.href,m=h.split("/");u=m[0]+"//"+m[2],u&&(s.a.config.serverUrl=u),f||(ar.autoLogin=/\/\/localhost/.test(s.a.config.serverUrl)),r.prototype.$ethingUI=ar,window&&(window.EThingUI=ar),i&&cr(r,i),Object.assign(ar,{dynamicServerUrl:f,getServerUrl:function(){return s.a.config.serverUrl},setServerUrl:function(e){c["a"].set("ething.server.url",e),s.a.config.serverUrl=e},needAuth:function(){return f&&!c["a"].getItem("ething.server.url")}}),t.data.state="begin",t.data.error=!1,Object.assign(ar,{reset:function(){t.data.state="begin",ar.eventsSocket&&ar.eventsSocket.close(),c["a"].remove("ething.auth.iat"),this.authRefreshTimer&&clearInterval(this.authRefreshTimer)},disconnect:function(){this.reset(),n.app.$router.push({name:"login",query:{redirect_uri:n.app.$router.currentRoute.path}})},logout:function(){var e=s.a.axios.request({method:"get",url:s.a.config.serverUrl+"/auth/logout"});return this.disconnect(),e},login:function(e,t,i){var r=this;return s.a.axios.request({method:"post",url:e+"/auth/password",headers:{"content-type":"application/x-www-form-urlencoded"},data:d.a.stringify({login:t,password:i})}).then((function(t){r.reset(),r.setServerUrl(e),c["a"].set("ething.auth.iat",Date.now());var i=n.app.$route.query.redirect_uri||"/";"/login"===i&&(i="/"),n.app.$router.replace(i)}))},authRefreshTimer:null,authRefresh:function(){return s.a.axios.request({method:"post",url:s.a.config.serverUrl+"/auth/refresh"}).then((function(){c["a"].set("ething.auth.iat",Date.now())}))}}),console.log("[app] ething configuring ..."),s.a.axios.defaults.withCredentials=!0,s.a.axios.interceptors.response.use((function(e){return e}),(function(e){if(e.response){var t=e.response.status;401!=t&&403!=t||ar.disconnect()}return Promise.reject(e)})),n.beforeEach((function(e,i,o){if("begin"===t.data.state&&"login"!==e.name){if(console.log("[app] begin..."),ar.needAuth())return console.warn("[app] no serverUrl found ! need to create a new session"),void o({name:"login",replace:!0,query:{redirect_uri:e.path}});t.data.state="initializing",console.log("[app] initializing..."),ar.initSockets(),ar.notifSocket.on("notification",(function(e){l["a"].create({color:"info",message:e.msg,position:"bottom-right",timeout:15e3,actions:[{icon:"close",color:"white",handler:function(){}}]})}));var a=t.router.app;window.app=a,window.quasar=a.$q,window.Vue=r;var u=ar.loadInfo(),d=ar.loadMeta(),f=ar.loadSettings(),h=s.a.arbo.load(null,!0).then((function(){console.log("[app] ething arbo loaded !")}));Promise.all([u,h,d,f]).then((function(){return Promise.all([ar.loadPlugins(),ar.dashboard.init()])})).then((function(){t.data.state="ok",console.log("[app] ething loaded !");var e=!1,i=null,r=null;function o(){i&&i(),e&&(setTimeout((function(){n.go()}),1e3),i=l["a"].create({type:"positive",color:"positive",message:"Reconnected to server !",icon:"thumb_up",position:"bottom-right",onDismiss:function(){i=null}}),r="connected")}function a(){e=!0,"disconnected"!==r&&(i&&i(),i=l["a"].create({type:"negative",color:"negative",message:"Lost connection to server !",icon:"report_problem",position:"bottom-right",timeout:0,onDismiss:function(){i=null}}),r="disconnected")}ar.on("ui.server.connected",o),ar.on("ui.server.disconnected",a),ar.eventsSocket.open();var s=c["a"].getItem("ething.auth.iat");s&&Date.now()-s>or&&ar.authRefresh(),ar.authRefreshTimer=setInterval((function(){ar.authRefresh()}),or),ar.emit("ui.loaded")})).catch((function(e){console.error(e),t.data.state="error",t.data.error=e})).finally((function(){o()}))}else o()}))}};var lr=t["a"]=ar},c86d:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"column"},[e.__showHeader?n("div",{staticClass:"col-auto row q-py-sm",class:e.headerClass,style:e.headerStyle},[e.__categories?[e.hideAll?e._e():n("q-btn",{attrs:{flat:"",label:"All","text-color":"number"!==typeof e.category_?"primary":"light",dense:e.$q.screen.lt.lg},on:{click:function(t){e.category_=null}}}),e._l(e.__categories,(function(t,i){return n("q-btn",{key:i,attrs:{flat:"","text-color":i===e.category_?"primary":"light",icon:t.icon,label:e.$q.screen.gt.xs?t.label:"",dense:e.$q.screen.lt.lg},on:{click:function(t){e.category_=i}}})}))]:e._e(),e._t("header-left"),n("q-space"),e._t("header-right"),e.__showSearch?n("q-input",{attrs:{dense:"",outlined:"","input-class":"text-right",debounce:"500"},scopedSlots:e._u([{key:"append",fn:function(){return[""===e.search_?n("q-icon",{attrs:{name:"search"}}):n("q-icon",{staticClass:"cursor-pointer",attrs:{name:"clear"},on:{click:function(t){e.search_=""}}})]},proxy:!0}],null,!1,3287058204),model:{value:e.search_,callback:function(t){e.search_=t},expression:"search_"}}):e._e(),e.sort?n("q-btn-dropdown",{attrs:{flat:"","text-color":"primary",label:e.$q.screen.gt.xs?e.__selectedSortItem?e.__selectedSortItem.label:"sort":null,icon:"mdi-sort",dense:e.$q.screen.lt.lg}},[n("q-list",e._l(e.__sortItems,(function(t,i){return n("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],key:i,attrs:{sort_items:"",clickable:"",active:t===e.__selectedSortItem,"active-class":"text-orange"},on:{click:function(n){e.sort_=t.name}}},[n("q-item-section",[e._v(e._s(t.label))])],1)})),1)],1):e._e(),!e.readonly&&e.__createTypes.length>0?[e.allowPairing?n("q-btn",{attrs:{flat:"","text-color":"primary",label:e.__pairing?"stop pairing":"pair",icon:"add"},on:{click:function(t){e.__pairing?e.$ething.stopPairing():e.$ething.startPairing()}}}):e._e(),n("q-btn",{attrs:{flat:"","text-color":"primary",label:e.$q.screen.gt.xs?"add":null,icon:"add"},on:{click:function(t){e.showCreatePopup_=!0}}}),n("resource-create-modal",{attrs:{types:e.__createTypes,open:""},model:{value:e.showCreatePopup_,callback:function(t){e.showCreatePopup_=t},expression:"showCreatePopup_"}})]:e._e()],2):e._e(),e.__filteredResources.length>0?[n("q-list",{staticClass:"col scroll",class:e.contentClass,style:e.contentStyle},[0==e.__groups.length?[e._l(e.__toItems(e.__filteredResources),(function(t,i){return[e._t("resource-item",[i>0&&0==t.level?n("q-separator"):e._e(),n("resource-q-item",{class:e.itemClass,style:e.itemStyle,attrs:{resource:t.resource,level:t.level,"no-parent":t.level>0,readonly:e.readonly,dense:e.dense},on:{click:function(n){return e.itemClick(t)}}})],{item:t})]}))]:[e._l(e.__groups,(function(t,i){return[i>0?n("q-separator"):e._e(),t.resources.length>0?n("q-expansion-item",{attrs:{icon:t.icon,label:t.label+" ("+t.resources.length+")","default-opened":"","header-class":"text-faded","header-inset-level":t.icon?0:1}},[e._l(e.__toItems(t.resources),(function(t,i){return[e._t("resource-item",[i>0&&0==t.level?n("q-separator"):e._e(),n("resource-q-item",{class:e.itemClass,style:e.itemStyle,attrs:{resource:t.resource,level:t.level,"no-parent":t.level>0,readonly:e.readonly,dense:e.dense},on:{click:function(n){return e.itemClick(t)}}})],{item:t})]}))],2):e._e()]}))]],2)]:n("div",{staticClass:"col relative-position",staticStyle:{"min-height":"50px"}},[n("div",{staticClass:"absolute-center text-caption text-faded"},[e._v("\n      "+e._s(e.__emptyMessage)+"\n    ")])])],2)},r=[],o=(n("28a5"),n("386d"),n("55dd"),n("c5f6"),n("57dc")),a={name:"ResourceList",mixins:[o["a"]],props:{categories:{},defaultCategory:Number,hideAll:Boolean,readonly:Boolean,dense:Boolean,sort:Boolean,search:Boolean,emptyMessage:{type:String,default:"<default>"},headerClass:{},headerStyle:{},contentClass:{},contentStyle:{},itemClass:{},itemStyle:{},allowPairing:Boolean},data:function(){return{category_:this.defaultCategory,showCreatePopup_:!1}},computed:{__showHeader:function(){return this.__categories||this.$slots["header-left"]||this.$slots["header-right"]||this.__showSearch||this.sort||!this.readonly&&this.__createTypes},__showSearch:function(){return this.search&&this.$q.screen.gt.sm},__checksum:function(){return this.__filteredResources.map((function(e){return e.id()})).join(" ")},__categories:function(){if(Array.isArray(this.categories))return this.__formatGroupList(this.categories)},__typename:function(){var e="resource";if("string"===typeof this.resources){var t=this.resources.split(" ");1==t.length&&(e=this.$ethingUI.get(t[0]).title)}return e},__emptyMessage:function(){var e=this.emptyMessage;return"<default>"===e&&(e="No "+this.__typename+" found"),e},__pairing:function(){return this.$ething.pairing}},watch:{category_:{handler:function(e){"number"===typeof e&&this.__categories?this.filter_=this.__categories[e].filter:this.filter_=null,this.$emit("update:category",e)},immediate:!0},__checksum:{handler:function(e,t){this.$emit("changed",this.__filteredResources.slice(0))},immediate:!0}},methods:{itemClick:function(e){this.$emit("click",e.resource)}}},s=a,c=n("2877"),l=Object(c["a"])(s,i,r,!1,null,null,null);t["a"]=l.exports},cc33:function(e,t,n){"use strict";var i=n("561e"),r=n.n(i);r.a},cd23:function(e,t,n){},cd50:function(e,t,n){var i={"./bmp":"0dcc","./bmp.js":"0dcc","./gif":"c416","./gif.js":"c416","./jpg":"135b","./jpg.js":"135b","./png":"e9ef","./png.js":"e9ef","./psd":"520c","./psd.js":"520c","./svg":"b0bf","./svg.js":"b0bf","./tiff":"f270","./tiff.js":"f270","./webp":"cf1e","./webp.js":"cf1e"};function r(e){var t=o(e);return n(t)}function o(e){if(!n.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}r.keys=function(){return Object.keys(i)},r.resolve=o,e.exports=r,r.id="cd50"},cf66:function(e,t,n){},dd5d:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-ething-resource"},[n("resource-select",{attrs:{value:e.c_value,resources:e.computed_filter,multiple:e.multiple,"use-id":"","create-types":e.createTypes,dense:"",error:!!e.error,"hide-bottom-space":""},on:{input:function(t){e.c_value=t}}})],1)},r=[],o=n("ffbd"),a=n("e35a"),s=n("b5ae"),c={name:"FormSchemaEthingResource",mixins:[a["FormComponent"]],components:{ResourceSelect:o["a"]},computed:{multiple:function(){return"array"===this.c_schema.type},__r_schema:function(){return this.multiple?this.c_schema.items:this.c_schema},computed_filter:function(){var e=this,t=this.__r_schema;return function(n){return e.filter(n,t)}},createTypes:function(){var e=this;if(!this.__r_schema["$onlyTypes"]&&!this.__r_schema["$must_throw"])return["resources/Resource"];var t=[];return this.__r_schema["$onlyTypes"]&&(t=t.concat(this.__r_schema["$onlyTypes"])),this.__r_schema["$must_throw"]&&this.$ethingUI.iterate("resources",(function(n){var i=e.$ethingUI.get(n);i.signals&&-1!==i.signals.indexOf(e.__r_schema["$must_throw"])&&t.push(n)})),t}},validations:function(){var e={};return"number"===typeof this.c_schema.minItems&&(e.minLength=Object(s["minLength"])(this.c_schema.minItems)),"number"===typeof this.c_schema.maxItems&&(e.maxLength=Object(s["maxLength"])(this.c_schema.maxItems)),{c_value:e}},methods:{filter:function(e,t){var n;if(t["$must_throw"]){n=!1;var i=this.$ethingUI.get(e).signals;for(var r in i)if(this.$ethingUI.isSubclass(i[r],t["$must_throw"])){n=!0;break}if(!n)return!1}if(t["$onlyTypes"]){n=!1;var o=t["$onlyTypes"];for(var r in o)if(e.isTypeof(o[r])){n=!0;break}if(!n)return!1}return!(t["$filter"]&&!t["$filter"].call(t,e))}}},l=c,u=n("2877"),d=Object(u["a"])(l,i,r,!1,null,"52798f4d",null);t["a"]=d.exports},ddda:function(e,t,n){},e35a:function(e,t,n){"use strict";n.r(t);n("7514"),n("c5f6"),n("ac6a"),n("cadf"),n("06db"),n("456d"),n("f751"),n("a481");var i=n("8993"),r=n.n(i),o=(n("20d6"),n("7f7f"),n("b5ae")),a=n("11ec"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-schema-layout",style:{display:e.inlined?"inline":"block"}},[(e.forceDescription||!e.inlined||e.forceDescriptionParent)&&e.schema.description?n("span",{staticClass:"form-schema-description text-caption q-my-sm",staticStyle:{display:"block"}},[n("q-markdown",[e._v(e._s(e.schema.description.trim()))])],1):e._e(),e._t("default"),!e.inlined&&e.error?n("small",{staticClass:"form-schema-error",staticStyle:{display:"block"}},[e._v("\n    "+e._s(e.error)+"\n  ")]):e._e()],2)},c=[],l={name:"formSchemaLayout",props:{forceDescription:Boolean},computed:{inlined:function(){return this.$parent.inlined},forceDescriptionParent:function(){return this.$parent.forceDescription},schema:function(){return this.$parent.c_schema},error:function(){return this.$parent.error},level:function(){return this.$parent.level}}},u=l,d=(n("0add"),n("2877")),f=Object(d["a"])(u,s,c,!1,null,"3c64e916",null),h=f.exports;n.d(t,"makeForm",(function(){return O})),n.d(t,"FormComponent",(function(){return S})),n.d(t,"registerForm",(function(){return _})),n.d(t,"unregisterForm",(function(){return g})),n.d(t,"addDefinitionsHandler",(function(){return j})),n.d(t,"resolve",(function(){return q})),n.d(t,"coreComponents",(function(){return v}));var m=!1,p=[],v=[],b=[],_=function(e,t){b.push({component:e,test:t,name:e.name?x(e.name):""})},g=function(e){var t=b.findIndex((function(t){return t.component===e}));-1!==t&&b.splice(t,1)};function y(e){if(null===e||"object"!==r()(e)||"isActiveClone"in e)return e;if(e instanceof Date)var t=new e.constructor;else t=e.constructor();for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e["isActiveClone"]=null,t[n]=y(e[n]),delete e["isActiveClone"]);return t}function x(e){return e.replace(/[_\.\-]/g,"").toLowerCase().replace(/^formschema/,"")}function w(e,t,n){var i=null;if(i="function"===typeof n?n:C(e),"function"===typeof i)try{return i(t)}catch(r){console.error(r)}}function C(e){if("undefined"!==typeof e.rule)return e.rule;if(Array.isArray(e.mixins))for(var t in e.mixins){var n=e.mixins[t],i=C(n);if(i)return i}}var $=function(e){if("string"===typeof e["$ref"]){var t=Object.assign({},e);delete t["$ref"];var n=e["$ref"],i=null;for(var o in p)if(i=p[o](n),"object"===r()(i)&&null!==i)break;e=q(Object(a["a"])(!0,t,i))}return e},k=function(e){if(Array.isArray(e.allOf)){var t=Object.assign({},e);delete t.allOf,e.allOf.forEach((function(e){t=Object(a["a"])(!0,t,q(e))})),e=t}return e},q=function(e){return k($(e))},O=function(e,t,n){var i=t.schema=q(t.schema);if(i&&0!==Object.keys(i).length){var r={props:t,on:n},o=i["$component"],a=o?x(o):void 0,s=!1;for(var c in b){var l=b[c];if(o&&l.name&&l.name===a)return e(l.component,r);if(!1===s&&w(l.component,i,l.test)&&(s=l.component,!o))break}for(var u in v){var d=v[u],f=d.name;if(o&&a===x(f))return e(d,r);if(!1===s&&w(d,i)&&(s=d,!o))break}if(o&&console.warn("[form] component not found: "+o),!1!==s)return e(s,r);console.error("unable to render the schema",Object.assign({},i))}},S={components:{FormSchemaLayout:h},inheritAttrs:!1,props:{inline:{default:"inherit"},value:{},schema:{},context:Object,required:{type:Boolean,default:!1},level:{type:Number,default:0},forceDescription:Boolean},data:function(){var e=this.schema.id;return e||(e=this.schema.type+"-"+parseInt(1e4*Math.random()),this.schema["$idPrefix"]&&(e=String(this.schema["$idPrefix"])+"-"+e)),{id:e,c_schema:null,formSchemaNode:!0,formSchemaCache:void 0}},watch:{schema:{handler:function(e,t){m&&this.log("watch schema",y(e)),this.c_schema=Object(a["a"])(!0,{},e)},immediate:!0,deep:!0},value:{handler:function(e,t){m&&this.log("watch value"),"undefined"!==typeof this.formSchemaCache&&(this.formSchemaCache=void 0,m&&this.log("clear cache"))},immediate:!0},c_value:{handler:function(e,t){m&&this.log("watch c_value",y(e),"prev",y(t)),this.$v.c_value.$touch()},immediate:!0},c_schema:{handler:function(e,t){"undefined"===typeof this.c_value&&"undefined"!==typeof e.default&&(this.c_value=e.default)},immediate:!0},error:{handler:function(e,t){m&&this.log("watch error",y(e),"prev",y(t)),this.$emit("error",e)},immediate:!0}},computed:{inlined:function(){var e=this.inline;if(""===e&&(e=!0),"undefined"!==typeof this.schema["$inline"]&&(e=this.schema["$inline"]),"inherit"===e){var t=this.parent();return!!t&&t.inlined}return!!e},c_value:{get:function(){return"undefined"!==typeof this.formSchemaCache?(m&&this.log("c_value.get (cache)",y(this.formSchemaCache)),this.formSchemaCache):(m&&this.log("c_value.get",y(this.value)),"undefined"!==typeof this.value?this.cast(this.value):this.value)},set:function(e){m&&this.log("c_value.set",y(e)),this.formSchemaCache=e,this.$emit("input",e)},cache:!0},error:function(){if(m&&this.log("compute error",this.$v.c_value.$error),!this.$v.c_value.$error)return!1;if("undefined"!=typeof this.$v.c_value.required&&!this.$v.c_value.required)return"Field is required";if("undefined"!=typeof this.$v.c_value.minLength&&!this.$v.c_value.minLength){if(1==this.$v.c_value.$params.minLength.min)return"must not be empty";var e="array"===this.c_schema.type?"items":"characters";return"must have minimum "+this.$v.c_value.$params.minLength.min+" "+e}if("undefined"!=typeof this.$v.c_value.maxLength&&!this.$v.c_value.maxLength){e="array"===this.c_schema.type?"items":"characters";return"must have maximum "+this.$v.c_value.$params.maxLength.max+" "+e}return"undefined"==typeof this.$v.c_value.minValue||this.$v.c_value.minValue?"undefined"==typeof this.$v.c_value.maxValue||this.$v.c_value.maxValue?"undefined"==typeof this.$v.c_value.between||this.$v.c_value.between?"undefined"==typeof this.$v.c_value.alpha||this.$v.c_value.alpha?"undefined"==typeof this.$v.c_value.alphaNum||this.$v.c_value.alphaNum?"undefined"==typeof this.$v.c_value.numeric||this.$v.c_value.numeric?"undefined"==typeof this.$v.c_value.email||this.$v.c_value.email?"undefined"==typeof this.$v.c_value.ipAddress||this.$v.c_value.ipAddress?"undefined"==typeof this.$v.c_value.macAddress||this.$v.c_value.macAddress?"undefined"==typeof this.$v.c_value.url||this.$v.c_value.url?"undefined"==typeof this.$v.c_value.regex||this.$v.c_value.regex?"Invalid value":"Does not match the pattern `"+this.$v.c_value.$params.regex.pattern+"`":"Accepts only URLs":"Accepts only valid MAC addresses like 00:ff:11:22:33:44:55":"Accepts only valid IPv4 addresses in dotted decimal notation like 127.0.0.1":"Accepts only valid email addresses":"Accepts only numerics":"Accepts only alphanumerics":"Accepts only alphabet characters":"must be between "+this.$v.c_value.$params.between.min+" and "+this.$v.c_value.$params.between.max:"must be lower than or equal to "+this.$v.c_value.$params.maxValue.max:"must be greater than or equal to "+this.$v.c_value.$params.minValue.min}},methods:{cast:function(e){return e},getDefault:function(){},log:function(){var e=Array.prototype.slice.call(arguments);e.unshift("["+this.id+"]"),console.log.apply(console,e)},getContext:function(e){if(!e){var t=this.parseContext(window["FormSchemaContext"]),n=this.parent();return n&&Object(a["a"])(!0,t,this.parseContext(n.getContext())),Object(a["a"])(!0,t,this.parseContext(this.context)),t}return this.getContext()[e]},parseContext:function(e){e=e||{};var t=e["global"]||{},n=this.$options.name,i=x(n);for(var r in e)if(x(r)===i){Object.assign(t,e[r]||{});break}return Object.assign(t,e[this.id]||{}),t},parent:function(){var e=this.$parent;while(e&&!e.formSchemaNode)e=e.$parent;return e},root:function(){var e,t=this;while(t)e=t,t=t.parent();return e},children:function(){return this._children(this)},_children:function(e){var t=[];for(var n in e.$children){var i=e.$children[n];i.formSchemaNode?t.push(i):t=t.concat(this._children(i))}return t},find:function(e){var t=this._find_down(this,e);return t||this._find_up(this,e)},_find_up:function(e,t){var n=e.parent();if(n){if(n._is(t))return n;var i=n.children();for(var r in i){var o=i[r];if(o!==e){var a=this._find_down(o,t);if(a)return a}}return this._find_up(n,t)}},_find_down:function(e,t){if(e._is(t))return e;var n=e.children();for(var i in n){var r=this._find_down(n[i],t);if(r)return r}},_is:function(e){return this.schema.id===e},_install_dep:function(e,t){var n=this;e.$on("input",(function(i){n.$nextTick((function(){t.call(n,i,n,e)}))})),t.call(this,e.c_value,this,e)}},validations:function(){return m&&this.log("validations",this.required),{c_value:this.required?{required:o["required"]}:{}}},mounted:function(){m&&this.log("mounting component");var e=!1;if(e||this.$v.c_value.$touch(),this.c_schema["$dependencies"])for(var t in this.c_schema["$dependencies"]){var n=this.c_schema["$dependencies"][t],i=this.find(t);m&&this.log("find node",t),i&&n?this._install_dep(i,n):i||console.warn('[form-schema] node with id ""'+t+'" not found for '+this.$options.name)}}};function j(e){p.push(e)}},e89c:function(e,t,n){"use strict";var i=n("c271"),r=n.n(i);r.a},ed08:function(e,t,n){"use strict";n.r(t);n("ac6a"),n("cadf"),n("456d");var i=n("8993"),r=n.n(i),o=(n("7f7f"),n("4917"),n("3b2b"),n("a481"),n("6b54"),n("06db"),n("bd4c")),a=n("7937"),s=n("bc78"),c=n("b06b"),l=n("426a"),u=n.n(l),d=n("21a6"),f=n.n(d);function h(){var e=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var t=0;t<e.length;t++)if(e[t]+"Hidden"in document)return e[t]+"Hidden";return null}function m(){var e=h();return!!e&&document[e]}function p(e,t,n){var i=n&&n.waitHidden||0,r=n&&n.waitShown||0,o=null,a=null;function s(t,n){t!==o&&(o=t,e(o,n))}function c(e,t){var n=e?r:i;null!==a&&(clearTimeout(a),a=null),n?a=setTimeout((function(){a=null,s(e,t)}),n):s(e,t)}var l=function(e,t){e.length>0&&c(e[0].isIntersecting,"element")},u=new IntersectionObserver(l);u.observe(t);var d=function(){c(!m(),"page")},f=h(),p=null;f&&(p=f.replace(/[H|h]idden/,"")+"visibilitychange",document.addEventListener(p,d,!1)),this.isVisible=function(){return o},this.destroy=function(){u.disconnect(),p&&document.removeEventListener(p,d,!1),null!==a&&(clearTimeout(a),a=null)}}n("5abe");var v=p,b=(n("551c"),n("7cd6")),_=function(e){return new Promise((function(t,n){var i=document.createElement("div");document.body.appendChild(i);var r=function(e){t(e),a.$destroy()},o=function(e){n(e||new Error),a.$destroy()},a=new Vue({el:i,data:function(){return{props:e}},render:function(t){return t(b["a"],{ref:"modal",props:e,on:{ok:r,cancel:o}})},mounted:function(){this.$refs.modal.show()}})}))};function g(e,t){var n=document.createElement("script"),i=document.getElementsByTagName("script")[0];n.async=1,n.onload=n.onreadystatechange=function(e,i){(i||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=n.onerror=null,n=void 0,i||t&&t())},n.onerror=function(e){n.onload=n.onreadystatechange=n.onerror=null,n=void 0,t&&t(!0)},n.src=e,i.parentNode.insertBefore(n,i)}var y=/%[^\s]+%/g;function x(e,t){var n,i=[],r=e;while(n=y.exec(e))i.push(n);return i.reverse().forEach((function(e){var n=e.index,i=e[0].length,a=e[0].substring(1,i-1),s=void 0;try{if("function"===typeof t)s=t(a);else{var c=t[a];s="function"===typeof c?c.call(t):c}}catch(l){}s instanceof Date&&(s=o["b"].formatDate(s.getTime(),"YYYY-MM-DD HH:mm:ss")),r=r.substring(0,n)+String(s)+r.substring(n+i,r.length)})),r}n.d(t,"formatDate",(function(){return w})),n.d(t,"generateId",(function(){return C})),n.d(t,"sanitizeHTML",(function(){return $})),n.d(t,"isPlainObject",(function(){return q})),n.d(t,"isRegExp",(function(){return O})),n.d(t,"extend",(function(){return S})),n.d(t,"getParameterByName",(function(){return j})),n.d(t,"dateToString",(function(){return E})),n.d(t,"sizeToString",(function(){return T})),n.d(t,"colorNameToHex",(function(){return I})),n.d(t,"describe",(function(){return D})),n.d(t,"saveAs",(function(){return M})),n.d(t,"isDefined",(function(){return A})),n.d(t,"isEmptyObject",(function(){return F})),n.d(t,"isVueComponent",(function(){return B})),n.d(t,"VisibilityObserver",(function(){return v})),n.d(t,"createModal",(function(){return _})),n.d(t,"injectScript",(function(){return g})),n.d(t,"parse",(function(){return x})),n.d(t,"openURL",(function(){return c["a"]})),n.d(t,"date",(function(){return o["b"]})),n.d(t,"format",(function(){return a["c"]})),n.d(t,"colors",(function(){return s["a"]}));var w=o["b"].formatDate;function C(e){e=e||5;for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=n.length,r=0;r<e;r++)t+=n.charAt(Math.floor(Math.random()*i));return t}function $(e){var t=document.createElement("div");return t.textContent=e,t.innerHTML}var k=Object.prototype.toString;function q(e){return"[object Object]"===k.call(e)}function O(e){return"[object RegExp]"===k.call(e)}function S(e){e=e||{};for(var t=1,n=arguments.length;t<n;++t){var i=arguments[t];if(i)for(var r in i)i.hasOwnProperty(r)&&(q(i[r])?e[r]=S(e[r],i[r]):e[r]=i[r])}return e}function j(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),i=n.exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}function E(e,t){if("string"!==typeof e&&"number"!==typeof e||(e=new Date(e)),!e)return"undefined"===typeof t?"-":t;var n=e.getTime();return o["b"].formatDate(n,"YYYY-MM-DD HH:mm:ss")}function T(e){return a["c"].humanStorageSize(e)}function I(e){if(e=e||"",/^#/.test(e))return e;var t=s["a"].getBrand(e);if(t)return t;var n=document.createElement("div");n.style.color=e;var i=window.getComputedStyle(document.body.appendChild(n)).color.match(/\d+/g).map((function(e){return parseInt(e,10)}));return document.body.removeChild(n),i.length>=3?"#"+((1<<24)+(i[0]<<16)+(i[1]<<8)+i[2]).toString(16).substr(1):e}function D(e){var t=[],n=function e(t){if(u.a.utils.isId(t)){var n=u.a.arbo.get(t);if(n)return n.name()}return Array.isArray(t)?t.map((function(t){return e(t)})).join(" "):"object"===r()(t)&&null!==t?0===Object.keys(t).length?"":"{...}":null===t?"":String(t)};for(var i in e){var o=e[i],a=n(o);a&&"undefined"!==typeof o&&t.push(i+": "+a)}return t.join(", ")}function M(e,t){return q(e)&&(e=JSON.stringify(e,null,2)),"string"===typeof e&&(e=new Blob([e],{type:"text/plain"})),f.a.saveAs(e,t||"data")}function A(e){return"undefined"!==typeof e}function F(e){return q(e)&&0==Object.keys(e).length}function B(e){return A(e.mixins)||A(e.extends)||A(e.el)||A(e.render)||A(e.template)||A(e.beforeCreate)||A(e.beforeDestroy)}},ef2b:function(e,t,n){},f29f:function(e,t,n){"use strict";var i=n("7367"),r=n.n(i);r.a},f4ae:function(e,t,n){},ffaf:function(e,t,n){},ffbd:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-select",e._b({attrs:{options:e.options,multiple:e.multiple,"use-input":e.enableFilter,"input-debounce":e.search_?300:0,"items-aligned":"","options-selected-class":"text-deep-orange","virtual-scroll-slice-size":200,placeholder:e.selectedResources.length?"search for a resource...":"Select a resource","display-value":e.selectedResources.length?"...":"Select a resource"},on:{filter:e.filterFn},scopedSlots:e._u([{key:"no-option",fn:function(){return[n("q-item",[n("q-item-section",{staticClass:"text-grey"},[e._v("\n        No resources available\n      ")])],1)]},proxy:!0},e.selectedResources.length?{key:"selected-item",fn:function(e){return[n("q-chip",{staticClass:"q-ml-none q-my-xs q-mr-xs",attrs:{removable:"",dense:"",tabindex:e.tabindex,color:e.opt.color,"text-color":"white",icon:e.opt.icon,label:e.opt.label},on:{remove:function(t){return e.removeAtIndex(e.index)}}})]}}:null,{key:"option",fn:function(t){return[t.opt.header?n("q-item-label",{directives:[{name:"show",rawName:"v-show",value:t.opt.resourcesLength>0,expression:"scope.opt.resourcesLength>0"}],attrs:{header:""}},[e._v(e._s(t.opt.label)+" ("+e._s(t.opt.resourcesLength)+")")]):n("q-item",e._g(e._b({directives:[{name:"show",rawName:"v-show",value:!t.opt.hide,expression:"!scope.opt.hide"}]},"q-item",t.itemProps,!1),t.itemEvents),[n("q-item-section",{attrs:{avatar:""}},[n("q-avatar",{attrs:{color:t.opt.color,"text-color":"white",icon:t.opt.icon}})],1),n("q-item-section",[n("q-item-label",[n("span",[e._v(e._s(t.opt.label))]),t.opt.createdBy?n("small",{staticClass:"text-faded q-ml-sm"},[e._v(e._s(t.opt.createdBy.basename()))]):e._e()]),n("q-item-label",{attrs:{caption:""}},[e._v(e._s(t.opt.title))])],1)],1)]}},e.disableCreate||0==e.__createTypes.length?null:{key:"append",fn:function(){return[n("q-icon",{staticClass:"cursor-pointer",attrs:{name:"add"},on:{click:function(t){t.preventDefault(),t.stopPropagation(),e.showCreatePopup_=!0}}}),n("resource-create-modal",{attrs:{types:e.__createTypes},model:{value:e.showCreatePopup_,callback:function(t){e.showCreatePopup_=t},expression:"showCreatePopup_"}})]},proxy:!0}],null,!0),model:{value:e.model,callback:function(t){e.model=t},expression:"model"}},"q-select",e.$attrs,!1))},r=[],o=(n("7f7f"),n("57dc")),a={name:"ResourceSelect",mixins:[o["a"]],props:{value:{},useId:Boolean,multiple:Boolean,createTypes:Array,enableFilter:Boolean,disableCreate:Boolean},data:function(){return{options:[],showCreatePopup_:!1,search__:""}},computed:{model:{get:function(){var e=this,t=[];return this.selectedResources.forEach((function(n){for(var i in e.options)e.options[i].value===n.id()&&t.push(e.options[i])})),this.multiple?t:t[0]},set:function(e){var t;t=e?this.multiple?this.useId?e.map((function(e){return e.value})):e.map((function(e){return e.resource})):this.useId?e.value:e.resource:this.multiple?[]:null,this.$emit("input",t)}},selectedResources:function(){var e=this;if(this.multiple){var t=[];return Array.isArray(this.value)?t=this.value:this.value&&(t=[this.value]),this.useId?t.map((function(t){return e.$ething.arbo.get(t)})):t}return this.value?[this.useId?this.$ething.arbo.get(this.value):this.value]:[]}},methods:{compute_options:function(){var e=this,t=this.__makeSearchFilter(this.search__),n=[],i=function(i){var r=e.$ethingUI.get(i),o=i.createdBy();o&&(o=e.$ething.arbo.get(o)),n.push({label:i.name(),value:i.id(),icon:r.icon,color:r.color,title:r.title,createdBy:o,resource:i,hide:!t(i)})};return this.__groups.length?this.__groups.forEach((function(e){0!=e.resources.length&&(n.push({label:e.label,icon:e.icon,disable:!0,header:!0,resourcesLength:e.resources.length}),e.resources.forEach(i))})):this.__filteredResources.forEach(i),n},filterFn:function(e,t,n){var i=this;this.search__=e,t((function(){i.options=i.compute_options()}))}},created:function(){this.options=this.compute_options()}},s=a,c=n("2877"),l=Object(c["a"])(s,i,r,!1,null,null,null);t["a"]=l.exports}},[[0,"runtime","vendor"]]]);