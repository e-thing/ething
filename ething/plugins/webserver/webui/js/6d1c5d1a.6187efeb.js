(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["6d1c5d1a"],{"092a":function(t,e,i){"use strict";var a=i("6834"),n=i.n(a);n.a},5169:function(t,e,i){},5434:function(t,e,i){"use strict";var a=i("5169"),n=i.n(a);n.a},6834:function(t,e,i){},b41f:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-page",{staticClass:"page"},[i("q-tabs",{staticClass:"bg-secondary text-white",model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[i("q-tab",{attrs:{label:"settings",name:"settings",icon:"settings"}}),i("q-tab",{attrs:{label:"api key",name:"apikey",icon:"mdi-key"}}),i("q-tab",{attrs:{label:"plugins",name:"plugins",icon:"mdi-puzzle"}}),i("q-tab",{attrs:{label:"clients",name:"clients",icon:"mdi-lan-connect"}}),i("q-tab",{attrs:{label:"about",name:"about",icon:"info"}})],1),i("q-separator"),i("q-tab-panels",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[i("q-tab-panel",{staticClass:"pane",attrs:{name:"settings"}},[i("settings-view")],1),i("q-tab-panel",{staticClass:"pane",attrs:{name:"apikey"}},[i("apikey-view")],1),i("q-tab-panel",{staticClass:"pane",attrs:{name:"plugins"}},[i("plugins-view")],1),i("q-tab-panel",{staticClass:"pane",attrs:{name:"clients"}},[i("clients-view")],1),i("q-tab-panel",{staticClass:"pane",attrs:{name:"about"}},[i("about-view")],1)],1)],1)},n=[],s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"page page-width-sm"},[!1===t.loading?i("div",[i("div",{staticClass:"page-block page-block-padding"},[i("div",{staticClass:"text-h6"},[t._v("General")]),i("form-schema",{staticClass:"q-my-md",attrs:{schema:t.$ethingUI.get("Config")},on:{error:function(e){t.error=e}},model:{value:t.settings["global"],callback:function(e){t.$set(t.settings,"global",e)},expression:"settings['global']"}})],1),t._l(t.plugins,function(e,a){return"object"===typeof e.schema?i("div",{key:a,staticClass:"page-block page-block-padding"},[i("div",{staticClass:"text-h6"},[t._v(t._s(a))]),i("form-schema",{staticClass:"q-my-md",attrs:{schema:e.schema},on:{error:function(t){e.error=t}},model:{value:t.settings[a],callback:function(e){t.$set(t.settings,a,e)},expression:"settings[name]"}})],1):t._e()}),t.saveError?i("q-banner",{staticClass:"bg-negative text-white page-block"},[i("q-icon",{attrs:{left:"",name:"mdi-alert"}}),t._v(" "+t._s(String(t.saveError))+"\n    ")],1):t._e(),i("div",{staticClass:"page-block page-block-transparent"},[i("q-btn",{attrs:{disable:t.globalError,loading:t.saving,color:"secondary",icon:"done",label:"save changes"},on:{click:t.onSave}})],1)],2):i("div",{staticClass:"absolute-center text-faded"},[t._v("loading ...")])])},o=[],l=(i("551c"),i("097d"),i("7f7f"),i("ac6a"),i("cadf"),i("06db"),i("456d"),{name:"SettingsView",data:function(){var t={};for(var e in this.$ethingUI.plugins){var i=this.$ethingUI.plugins[e];i.schema&&Object.keys(i.schema.properties).length&&(t[e]={error:!1,schema:i.schema})}return{loading:!0,saving:!1,error:!1,saveError:!1,settings:{},plugins:t,logLevels:[{label:"debug",value:"debug"},{label:"info",value:"info"},{label:"warning",value:"warning"},{label:"error",value:"error"},{label:"fatal",value:"fatal"}]}},computed:{globalError:function(){var t=this.error;if(!t)for(var e in this.plugins){this.plugins[e].error&&(t=!0);break}return t}},methods:{load:function(){var t=this;this.loading=!0,this.$ething.settings.get().then(function(e){for(var i in t.plugins)"undefined"==typeof e[i]&&(e[i]={});t.settings=e,t.loading=!1})},onSave:function(){var t=this,e=this.settings;this.saving=!0,this.saveError=!1,this.$ething.settings.set(e).then(function(){t.$q.notify({icon:"done",color:"positive",message:"Changes applied",timeout:1500})}).catch(function(e){t.saveError=e}).finally(function(){t.saving=!1})}},mounted:function(){this.load()}}),r=l,c=(i("5434"),i("2877")),d=Object(c["a"])(r,s,o,!1,null,"71d3bbc8",null),u=d.exports,v=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"page page-width-lg"},[!1===t.loading?i("div",[i("div",{staticClass:"page-block page-block-transparent"},[i("q-btn",{attrs:{icon:"add",label:"new API key",rounded:"",color:"secondary"},on:{click:function(e){return t.create()}}})],1),t.apikeys.length>0?i("div",{staticClass:"page-block page-block-padding"},[t._m(0),t._l(t.apikeys,function(e){return i("div",{key:e.id,staticClass:"item row items-center q-gutter-x-sm q-mt-md"},[i("div",{staticClass:"date col-xs-2 col-sm-2 col-md-2 text-faded ellipsis"},[t._v("\n          "+t._s(e.name)+"\n        ")]),i("div",{staticClass:"date col-xs-0 col-sm-0 col-md-2 text-faded ellipsis"},[t._v("\n          "+t._s(t.$ethingUI.utils.dateToString(e.modifiedDate))+"\n        ")]),i("div",{staticClass:"key col col-sm-5 col-md-5 col-lg-5"},[t._v("\n          "+t._s(e.value)+"\n        ")]),i("div",{staticClass:"scope col gt-xs text-faded ellipsis"},t._l(t.splitScopes(e.scope),function(e){return i("div",[t._v("\n            "+t._s(e)+"\n          ")])}),0),i("div",{staticClass:"controls col-auto"},[i("q-btn",{attrs:{icon:"settings",round:"",flat:"",dense:"",color:"faded"},on:{click:function(i){return t.edit(e)}}}),i("q-btn",{attrs:{icon:"delete",round:"",flat:"",dense:"",color:"negative"},on:{click:function(i){return t.remove(e)}}})],1)])})],2):i("div",{staticClass:"text-faded text-center q-py-lg"},[t._v("No API keys")])]):i("div",[t._v("loading ...")]),i("modal",{attrs:{title:t.editing?"Edit API key":"Create a new API key",icon:"mdi-key","valid-btn-label":t.editing?"Edit":"Create","cancel-btn-label":"Cancel","valid-btn-disable":t.error||t.addLoading},on:{valid:t.add},model:{value:t.modal,callback:function(e){t.modal=e},expression:"modal"}},[i("form-schema",{key:t.formKey,attrs:{schema:t.schema},on:{error:function(e){t.error=e}},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}}),t.serverError?i("q-banner",{staticClass:"bg-negative text-white q-mb-xl"},[i("q-icon",{attrs:{left:"",name:"mdi-alert"}}),t._v(" "+t._s(String(t.serverError))+"\n    ")],1):t._e()],1)],1)},g=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"item row items-center q-gutter-x-sm"},[i("div",{staticClass:"name col-xs-2 col-sm-2 col-md-2 text-secondary ellipsis"},[t._v("\n          name\n        ")]),i("div",{staticClass:"date col-xs-0 col-sm-0 col-md-2 text-secondary ellipsis"},[t._v("\n          date\n        ")]),i("div",{staticClass:"key col col-sm-5 col-md-5 col-lg-5 text-secondary"},[t._v("\n          value\n        ")]),i("div",{staticClass:"scope col gt-xs text-secondary"},[t._v("\n          scope\n        ")])])}],p=(i("28a5"),i("20d6"),i("f751"),{name:"ApikeyView",data:function(){return{loading:!0,apikeys:[],formKey:0,schema:{type:"object",additionalProperties:!1,required:["name"],properties:{name:{type:"string",minLength:1},scope:{type:"string",$component:"scope",default:""}}},model:{},error:!1,modal:!1,addLoading:!1,serverError:!1,editing:!1}},methods:{load:function(){var t=this;this.loading=!0,EThing.request({url:"apikey",dataType:"json"}).then(function(e){t.apikeys=e,t.loading=!1}).catch(function(t){console.error(t)})},reset:function(){this.serverError=!1,this.error=!1,this.model={},this.editing=!1,this.formKey++},add:function(){var t=this,e=Object.assign({},this.model);this.addLoading=!0,this.serverError=!1,EThing.request({method:this.editing?"PATCH":"POST",url:this.editing?"apikey/"+this.editing.id:"apikey",dataType:"json",data:e}).then(function(e){var i=t.apikeys||[],a=!1;for(var n in i)if(i[n].id==e.id){i[n]=e,a=!0;break}a||i.push(e),t.apikeys=i,t.modal=!1}).catch(function(e){t.serverError=e}).finally(function(){t.addLoading=!1})},create:function(){this.reset(),this.modal=!0},edit:function(t){this.reset(),this.model=Object.assign({},t),this.editing=t,this.modal=!0},remove:function(t){var e=this;EThing.request({method:"DELETE",url:"apikey/"+t.id}).then(function(){var i=e.apikeys.findIndex(function(e){return e.id===t.id});-1!==i&&e.apikeys.splice(i,1)}).catch(function(t){console.error(t)})},splitScopes:function(t){return t.split(" ")}},mounted:function(){this.load()}}),m=p,f=Object(c["a"])(m,v,g,!1,null,null,null),h=f.exports,b=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"page page-width-sm"},[i("div",{staticClass:"page-block page-block-padding"},[i("div",{staticClass:"text-h6 q-mb-md"},[t._v("Installed")]),t.installedPlugins.length>0?i("div",t._l(t.installedPlugins,function(e){return i("q-card",{key:e.name,staticClass:"q-my-sm bg-secondary text-white"},[i("q-card-section",[i("div",{staticClass:"row items-center no-wrap"},[i("div",{staticClass:"col"},[i("div",{staticClass:"text-h6"},[t._v("\n                "+t._s(e.name)+"\n              ")])]),i("div",{staticClass:"col-auto"},[e.package.version?i("q-badge",{attrs:{color:"white","text-color":"secondary"}},[t._v("version: "+t._s(e.package.version))]):t._e()],1)])]),i("q-card-section",[t._v("\n          "+t._s(e.package.summary||"no description")+"\n        ")])],1)}),1):i("div",{staticClass:"text-faded"},[t._v("\n      No plugin installed !\n    ")])]),t.localPlugins.length>0?i("div",{staticClass:"page-block page-block-padding"},[i("div",{staticClass:"text-h6 q-mb-md"},[t._v("Local")]),t._l(t.localPlugins,function(e){return i("q-card",{key:e.name,staticClass:"q-my-sm bg-secondary text-white"},[i("q-card-section",[i("div",{staticClass:"row items-center no-wrap"},[i("div",{staticClass:"col"},[i("div",{staticClass:"text-h6"},[t._v("\n              "+t._s(e.name)+" "),e.version?i("span",{attrs:{slot:"subtitle"},slot:"subtitle"},[t._v("version: "+t._s(e.version))]):t._e()])]),i("div",{staticClass:"col-auto"},[i("q-icon",{attrs:{slot:"right",name:"mdi-puzzle"},slot:"right"})],1)])]),i("q-card-section",[t._v("\n        location: "+t._s(e.package.location)+"\n      ")])],1)})],2):t._e(),t.builtinPlugins.length>0?i("div",{staticClass:"page-block page-block-padding"},[i("div",{staticClass:"text-h6 q-mb-md"},[t._v("Builtin")]),t._l(t.builtinPlugins,function(e){return i("q-card",{key:e.name,staticClass:"q-my-sm bg-secondary text-white"},[i("q-card-section",[i("div",{staticClass:"row items-center no-wrap"},[i("div",{staticClass:"col"},[i("div",{staticClass:"text-h6"},[t._v("\n              "+t._s(e.name)+" "),e.version?i("span",{attrs:{slot:"subtitle"},slot:"subtitle"},[t._v("version: "+t._s(e.version))]):t._e()])]),i("div",{staticClass:"col-auto"},[i("q-icon",{attrs:{slot:"right",name:"mdi-puzzle"},slot:"right"})],1)])])],1)})],2):t._e()])},_=[],k={name:"PluginsView",data:function(){return{}},computed:{plugins:function(){var t=[];for(var e in this.$ethingUI.plugins)t.push(Object.assign({name:e},this.$ethingUI.plugins[e]));return t.filter(function(t){return t.package})},installedPlugins:function(){return this.plugins.filter(function(t){return t.package.project_name})},localPlugins:function(){return this.plugins.filter(function(t){return!t.package.project_name&&!t.package.builtin})},builtinPlugins:function(){return this.plugins.filter(function(t){return!t.package.project_name&&t.package.builtin})}},methods:{},mounted:function(){}},y=k,C=Object(c["a"])(y,b,_,!1,null,null,null),q=C.exports,x=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"page page-width-sm"},[!1===t.loading?i("div",[t.clients.length>0?i("div",t._l(t.clients,function(e){return i("q-card",{key:e.id,staticClass:"page-block",attrs:{flat:""}},[i("q-card-section",[i("div",{staticClass:"row items-center no-wrap"},[i("div",{staticClass:"col"},[i("div",{staticClass:"text-h6"},[t._v("\n                "+t._s(e.ip)+" "),t.isCurrent(e)?i("small",{staticClass:"text-faded"},[t._v("(current)")]):t._e()])]),i("div",{staticClass:"col-auto"},[i("q-icon",{attrs:{name:"mdi-checkbox-blank-circle",color:e.online?"green":"red"}})],1)])]),i("q-card-section",{staticClass:"text-faded"},[i("div",[t._v("online: "+t._s(e.online))]),i("div",[t._v("platform: "+t._s(e.platform))]),i("div",[t._v("browser: "+t._s(e.browser))])]),i("q-separator"),i("q-card-actions",[i("q-btn",{attrs:{flat:"",color:"primary",label:"Identify"},on:{click:function(i){return t.notify(e,"hello !")}}}),i("q-btn",{attrs:{flat:"",color:"faded",label:"Remove"},on:{click:function(i){return t.remove(e)}}})],1)],1)}),1):i("div",{staticClass:"absolute-center text-faded"},[t._v("No API keys")])]):i("div",[t._v("loading ...")])])},w=[],E=i("18d6"),I={name:"ApikeyView",data:function(){return{loading:!0,clients:[]}},methods:{isCurrent:function(t){return t.id===E["a"].getItem("ething.cid")},load:function(){var t=this;this.loading=!0,EThing.request({url:"clients",dataType:"json"}).then(function(e){t.clients=e,t.loading=!1}).catch(function(t){console.error(t)})},remove:function(t){var e=this;EThing.request({method:"DELETE",url:"clients/"+t.id}).then(function(){var i=e.clients.findIndex(function(e){return e.id===t.id});-1!==i&&e.clients.splice(i,1)}).catch(function(t){console.error(t)})},notify:function(t,e){EThing.request({method:"POST",url:"clients/"+t.id+"/notify",contentType:"application/json; charset=utf-8",data:{msg:e}})}},mounted:function(){this.load()}},$=I,P=Object(c["a"])($,x,w,!1,null,null,null),j=P.exports,S=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"page page-width-sm"},[i("q-card",{staticClass:"page page-block",attrs:{flat:""}},[i("q-card-section",[i("div",{staticClass:"text-subtitle2"},[t._v("UI")]),i("div",[t._v("version: "+t._s(t.$ethingUI.VERSION))])]),i("q-card-section",[i("div",{staticClass:"text-subtitle2"},[t._v("JS api")]),i("div",[t._v("version: "+t._s(t.$ething.VERSION))])]),i("q-separator"),i("q-card-section",[i("div",{staticClass:"text-subtitle2"},[t._v("Server")]),i("div",[t._v("version: "+t._s(t.$ethingUI.info.VERSION))])]),i("q-card-section",[i("div",{staticClass:"text-subtitle2"},[t._v("Python")]),i("div",[t._v("version: "+t._s(t.$ethingUI.info.python.version)+" type: "+t._s(t.$ethingUI.info.python.type))])]),i("q-card-section",[i("div",{staticClass:"text-subtitle2"},[t._v("Platform")]),i("div",[t._v(t._s(t.$ethingUI.info.platform.name))])]),i("q-separator"),i("q-card-actions",{attrs:{vertical:""}},[i("q-btn",{attrs:{flat:""},on:{click:t.downloadLogFile}},[t._v("Download LOG file")])],1)],1)],1)},T=[],O=i("0967"),A=i("2b0e"),U=function(t,e){var i=window.open;if(!0===O["a"].is.cordova){if(void 0!==cordova&&void 0!==cordova.InAppBrowser&&void 0!==cordova.InAppBrowser.open)i=cordova.InAppBrowser.open;else if(void 0!==navigator&&void 0!==navigator.app)return navigator.app.loadUrl(t,{openExternal:!0})}else if(void 0!==A["default"].prototype.$q.electron)return A["default"].prototype.$q.electron.shell.openExternal(t);var a=i(t,"_blank");if(a)return a.focus(),a;e&&e()},V={name:"AboutView",methods:{downloadLogFile:function(){U(EThing.config.serverUrl+"/log.txt")}}},L=V,z=Object(c["a"])(L,S,T,!1,null,null,null),N=z.exports,B={name:"PageSettings",components:{SettingsView:u,ApikeyView:h,PluginsView:q,ClientsView:j,AboutView:N},data:function(){return{tab:"settings"}}},D=B,R=(i("092a"),Object(c["a"])(D,a,n,!1,null,"aec4c04e",null));e["default"]=R.exports}}]);