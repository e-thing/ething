(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["app"],{0:function(e,t,n){e.exports=n("2f39")},"0292":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:{expended:e.expended}},[n("q-resize-observable",{on:{resize:e.onResize}}),e.options?n("highstock",{ref:"highcharts",staticClass:"chart",class:{expended:e.expended},attrs:{options:e.options}}):n("div",{staticClass:"absolute-center text-center"},[n("q-btn",{attrs:{label:"new plot",icon:"timeline",flat:"",color:"primary"},on:{click:function(t){e.optionsModal=!0}}})],1),n("q-inner-loading",{staticClass:"text-center",attrs:{visible:e.loading}},[n("div",{staticClass:"q-pa-lg text-primary"},[e._v("loading...")]),n("q-spinner-oval",{attrs:{color:"primary",size:"50px"}})],1),n("modal",{attrs:{title:"Chart save",icon:"save",size:"xs","valid-btn-label":"Save"},on:{valid:e.onSave,show:e.$v.filename.$touch},model:{value:e.saveModal,callback:function(t){e.saveModal=t},expression:"saveModal"}},[n("q-field",{staticClass:"q-my-md",attrs:{label:"Filename",orientation:"vertical",error:e.$v.filename.$error,"error-label":"Required"}},[n("q-input",{on:{input:e.$v.filename.$touch},model:{value:e.filename,callback:function(t){e.filename=t},expression:"filename"}})],1)],1),n("modal",{attrs:{size:"lg","no-esc-dismiss":!e.options,"no-backdrop-dismiss":!e.options,title:"Chart options",icon:"edit","valid-btn-disable":e.$v.optionsData.$error},on:{valid:e.onOptionsValidate},model:{value:e.optionsModal,callback:function(t){e.optionsModal=t},expression:"optionsModal"}},[n("q-field",{staticClass:"q-my-md",attrs:{label:"Title",orientation:"vertical"}},[n("q-input",{model:{value:e.optionsData.title,callback:function(t){e.$set(e.optionsData,"title",t)},expression:"optionsData.title"}})],1),n("q-field",{staticClass:"q-my-md",attrs:{label:"Subtitle",orientation:"vertical"}},[n("q-input",{model:{value:e.optionsData.subtitle,callback:function(t){e.$set(e.optionsData,"subtitle",t)},expression:"optionsData.subtitle"}})],1),n("div",{staticClass:"q-my-md"},[n("div",{staticClass:"q-subheading q-mb-md"},[e._v("\n        Panes\n        "),n("q-btn",{attrs:{flat:"",size:"md",color:"blue-5",label:"Add pane",icon:"add"},on:{click:function(t){e.optionsData.panes.push({}),e.$v.optionsData.$touch()}}})],1),n("div",{staticClass:"q-ml-md q-mb-md"},e._l(e.optionsData.panes,function(t,i){return n("div",{key:i,staticClass:"pane"},[n("q-field",{staticClass:"q-my-md",attrs:{label:"name/unit",orientation:"vertical",error:e.$v.optionsData.panes.$each[i].name.$error,"error-label":"Required"}},[n("q-input",{attrs:{error:e.$v.optionsData.panes.$each[i].name.$error},on:{blur:e.$v.optionsData.panes.$each[i].name.$touch},model:{value:t.name,callback:function(n){e.$set(t,"name",n)},expression:"pane.name"}})],1),n("div",{staticClass:"q-my-md"},[n("div",{staticClass:"q-subheading q-mb-md"},[e._v("\n              Curves\n              "),n("q-btn",{attrs:{flat:"",size:"md",color:"cyan-5",label:"Add",icon:"add"},on:{click:function(n){t.curves.push({type:"line",data:{}}),e.$v.optionsData.$touch()}}})],1),n("div",{staticClass:"q-ml-md q-mb-md"},e._l(t.curves,function(r,a){return n("div",{key:a,staticClass:"curve"},[n("q-field",{staticClass:"q-my-md",attrs:{label:"name",orientation:"vertical",error:e.$v.optionsData.panes.$each[i].curves.$each[a].name.$error,"error-label":"Required"}},[n("q-input",{attrs:{error:e.$v.optionsData.panes.$each[i].curves.$each[a].name.$error},on:{blur:e.$v.optionsData.panes.$each[i].curves.$each[a].name.$touch},model:{value:r.name,callback:function(t){e.$set(r,"name",t)},expression:"curve.name"}})],1),n("q-field",{staticClass:"q-my-md",attrs:{label:"type",orientation:"vertical",error:e.$v.optionsData.panes.$each[i].curves.$each[a].type.$error,"error-label":"Required"}},[n("q-select",{attrs:{options:e.serieTypeOptions,error:e.$v.optionsData.panes.$each[i].curves.$each[a].type.$error},on:{blur:e.$v.optionsData.panes.$each[i].curves.$each[a].type.$touch},model:{value:r.type,callback:function(t){e.$set(r,"type",t)},expression:"curve.type"}})],1),n("q-field",{staticClass:"q-my-md",attrs:{label:"table",orientation:"vertical",error:e.$v.optionsData.panes.$each[i].curves.$each[a].data.resource.$error,"error-label":"Required"}},[n("resource-select",{attrs:{type:"resources/Table","use-id":"",error:e.$v.optionsData.panes.$each[i].curves.$each[a].data.resource.$error},on:{input:e.$v.optionsData.panes.$each[i].curves.$each[a].data.resource.$touch},model:{value:r.data.resource,callback:function(t){e.$set(r.data,"resource",t)},expression:"curve.data.resource"}})],1),r.data.resource?n("q-field",{staticClass:"q-my-md",attrs:{label:"key",orientation:"vertical",error:e.$v.optionsData.panes.$each[i].curves.$each[a].data.key.$error,"error-label":"Required"}},[n("q-select",{attrs:{options:e.optionsBuildKeyOptions(r,e.$v.optionsData.panes.$each[i].curves.$each[a].data.key),error:e.$v.optionsData.panes.$each[i].curves.$each[a].data.key.$error},on:{input:e.$v.optionsData.panes.$each[i].curves.$each[a].data.key.$touch},model:{value:r.data.key,callback:function(t){e.$set(r.data,"key",t)},expression:"curve.data.key"}})],1):e._e(),n("q-btn",{attrs:{flat:"",size:"md",color:"negative",label:"remove",icon:"delete"},on:{click:function(e){t.curves.splice(a,1)}}})],1)}))]),n("q-btn",{attrs:{flat:"",size:"md",color:"negative",label:"remove",icon:"delete"},on:{click:function(t){e.optionsData.panes.splice(i,1)}}})],1)}))])],1)],1)},r=[];i._withStripped=!0;n("7f7f"),n("ac6a"),n("cadf");var a=n("426a"),o=n.n(a),s=n("a026"),l=n("58a2"),c=n("ea7f"),u=n.n(c),d=n("37d8"),h=n.n(d),f=n("0319"),m=n.n(f),p=n("b0d5"),v=n("ffbd"),b=n("1fe0"),y=n("b5ae");function g(){this.sources=[],this.history="all"}h()(u.a),m()(u.a),s["default"].use(l["a"],{Highcharts:u.a}),g.prototype.clear=function(){this.sources=[],this.history="all"},g.prototype.setHistory=function(e){this.history=e},g.prototype.add=function(e,t){var n=this,i=o.a.arbo.get(e.resource);if(i instanceof o.a.Table){var r=null,a=e.key;for(var s in this.sources)if(this.sources[s].resource===i.id()){r=this.sources[s];break}r||(r={resource:i.id(),keys:[],done:[],fetch:function(e){var t=this,i=o.a.arbo.get(this.resource),r=null;if("number"===typeof n.history){var a=new Date(Date.now()-1e3*parseInt(n.history));r="date > dateTime('"+a.toISOString()+"')"}i.select({fields:["date"].concat(this.keys),query:r}).then(function(e){t.done.forEach(function(t){t(e)})}).finally(function(){e()})}},this.sources.push(r)),r.keys.push(a),r.done.push(function(e){var n=e.filter(function(e){return e.hasOwnProperty(a)}).map(function(e){var t=new Date(e.date),n=e[a];return"number"!=typeof n&&("string"===typeof n?n=parseFloat(e[a]):"boolean"===typeof n&&(n=n?1:0)),[t.getTime(),n]});t(n)})}},g.prototype.load=function(e){var t=this.sources.length;function n(){t--,0===t&&"function"===typeof e&&e()}this.sources.forEach(function(e){e.fetch.call(e,n)})};var _={name:"Chart",props:{preferences:{},expended:Boolean,dense:Boolean,readonly:Boolean,history:{},chartOptions:{type:Object,default:function(){return{}}}},components:{ResourceSelect:v["a"]},data:function(){var e="",t=!1;if("string"===typeof this.preferences){var n=this.$ething.arbo.get(this.preferences);n instanceof this.$ething.File&&(t=n)}else this.preferences instanceof this.$ething.File&&(t=this.preferences);return t&&(e=t.name()),{loading:!1,dataSource:new g,options:!1,optionsModal:!this.preferences,optionsData:{panes:[{curves:[{type:"line",data:{}}]}]},serieTypeOptions:[{label:"line",value:"line"},{label:"column",value:"column"},{label:"scatter",value:"scatter"},{label:"area",value:"area"},{label:"spline",value:"spline"}],saveModal:!1,filename:e,file:t,table:null}},validations:function(){return{filename:{required:y["required"]},optionsData:{required:y["required"],panes:{required:y["required"],minLength:Object(y["minLength"])(1),$each:{name:{required:y["required"]},curves:{required:y["required"],minLength:Object(y["minLength"])(1),$each:{name:{required:y["required"]},type:{required:y["required"]},data:{required:y["required"],resource:{required:y["required"]},key:{required:y["required"]}}}}}}}}},methods:{load:function(e){var t=this;this.loading=!0,this.currentPreferences=Object(p["a"])(!0,{},e),this.dataSource.clear(),this.dataSource.setHistory(this.history||e.history||"all");var n=e.title;this.dense&&e.subtitle&&(n?n+=" - "+e.subtitle:n=e.subtitle),this.options=Object(p["a"])(!0,{chart:{plotBorderWidth:1,zoomType:"x"},exporting:{menuItemDefinitions:{refresh:{onclick:function(){t.refresh()},text:"refresh"},options:{onclick:function(){t.optionsModal=!0},text:"options"},save:{onclick:function(){t.currentPreferences&&(t.saveModal=!0)},text:"save"}},buttons:{contextButton:{menuItems:this.readonly?["refresh","separator","downloadPNG","downloadJPEG","downloadPDF"]:["refresh","options","save","separator","downloadPNG","downloadJPEG","downloadPDF"]}}},rangeSelector:{buttons:[{type:"hour",count:12,text:"12h"},{type:"day",count:1,text:"1d"},{type:"week",count:1,text:"1w"},{type:"month",count:1,text:"1m"},{type:"all",text:"All"}],selected:1,enabled:!this.dense},tooltip:{xDateFormat:"%Y-%m-%d %H:%M",valueDecimals:3},navigator:{enabled:!this.dense},xAxis:{type:"datetime",ordinal:!1,tickLength:5},credits:{enabled:!1},plotOptions:{column:{dataGrouping:{approximation:"average"}},series:{animation:!1}},series:[],yAxis:[],title:{text:n},subtitle:{text:this.dense?null:e.subtitle},time:{useUTC:!1}},this.chartOptions);var i=5,r=(100-(e.panes.length-1)*i)/e.panes.length;e.panes.forEach(function(e,n){var a="axis-"+n,o={title:{text:e.name||""},resize:{enabled:!0},height:r+"%",top:n*(r+i)+"%",offset:0,labels:{align:"right",x:-3,y:4},lineWidth:1,opposite:!1,showLastLabel:!0,gridLineWidth:1,id:a};t.options.yAxis.push(o),e.curves.forEach(function(e,n){var i={showInNavigator:!0,type:e.type||"line",name:e.name||"data "+n,data:[],yAxis:a};t.dataSource.add(e.data,function(e){if(e.length&&(i.data=e,-1===t.options.series.indexOf(i))){var n=!0;for(var r in e){var a=e[r][1];if(0!=a&&1!=a){n=!1;break}}n&&(i.step="left"),t.options.series.push(i)}})})}),this.dataSource.load(function(){t.loading=!1})},refresh:function(){var e=this;this.loading=!0,this.dataSource.load(function(){e.loading=!1})},onOptionsValidate:function(){this.load(this.optionsData),this.optionsModal=!1},optionsBuildKeyOptions:function(e){var t=this.$ething.arbo.get(e.data.resource);if(t){var n=t.keys();return n.length&&this.$set(e.data,"key",n[0]),n.map(function(e){return{label:e,value:e}})}},onSave:function(){var e=this,t=JSON.stringify(this.currentPreferences,null,4);/\.plot$/.test(this.filename)||(this.filename=this.filename+".plot"),this.file&&this.file.name()===this.filename?this.file.write(t):this.filename.length&&this.$ething.File.create({name:this.filename,content:t}).then(function(t){e.file=t}),this.saveModal=!1},chart:function(){return this.$refs.highcharts?this.$refs.highcharts.chart:void 0},onResize:function(e){this.resize()},resize:Object(b["a"])(function(){var e=this.chart();e&&e.reflow()},1e3),onTableUpdate:function(e,t){-1!==t.indexOf("contentModifiedDate")&&this.refresh()}},mounted:function(){var e=this;if(this.$v.optionsData.$touch(),this.file)this.file.read().then(function(t){try{var n="string"===typeof t?JSON.parse(t):t;e.optionsData=n,e.load(n)}catch(e){console.error("[chart] unable to load chart file",e)}});else{var t={},n=null;if("string"===typeof this.preferences&&(n=this.$ething.arbo.get(this.preferences)),this.preferences instanceof this.$ething.Table&&(n=this.$ething.arbo.get(this.preferences.id())),n){this.table=n,n.on("updated",this.onTableUpdate);var i=this.$ething.arbo.get(n.createdBy());i&&(t.subtitle='<a href="#'+this.$ethingUI.route(i)+'">'+i.basename()+"</a>"),t.title='<a href="#'+this.$ethingUI.route(n)+'">'+n.basename()+"</a>",t.panes=[],n.keys().forEach(function(e){var i={name:e,curves:[{name:e,type:"line",data:{resource:n.id(),key:e}}]};t.panes.push(i)})}else t=this.preferences;t&&(this.optionsData=t,this.load(t))}},beforeDestroy:function(){this.table&&this.table.off("updated",this.onTableUpdate)}},w=_,$=(n("3a02"),n("2877")),x=Object($["a"])(w,i,r,!1,null,"474d6775",null);x.options.__file="Chart.vue";t["a"]=x.exports},"034f":function(e,t,n){"use strict";var i=n("fb1c"),r=n.n(i);r.a},"09ff":function(e,t,n){"use strict";var i=n("9360"),r=n.n(i);r.a},"0b44":function(e,t,n){},1:function(e,t){},1847:function(e,t,n){},"1e5d":function(e,t,n){},"25d4":function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"d",function(){return r}),n.d(t,"a",function(){return a}),n.d(t,"c",function(){return s});n("f751");var i={},r={component:null,attributes:{},zIndex:0,title:"",icon:"",minWidth:0,minHeight:0,schema:{type:"object"},in:["dashboard"]},a={type:"object",required:["color","bgColor"],properties:{color:{type:"string",$component:"color",description:"The color of the widget",default:"#027be3"},bgColor:{title:"background color",type:"string",$component:"color",description:"The color of the widget's background",default:"#ffffff"}}};function o(e){if(i.hasOwnProperty(e))return i[e]}function s(e,t){if(!t.component)throw new Error("No component attribute set in the widget definition");return i[e]=Object.assign({},r,t),i[e]}t["b"]={install:function(e){var t=e.EThingUI;Object.assign(t,{widgets:i,findWidget:o,registerWidget:s})}}},"268c":function(e,t,n){},"2a5a":function(e,t,n){"use strict";var i=n("afb4"),r=n.n(i);r.a},"2ce3":function(e,t,n){},"2f39":function(e,t,n){"use strict";n.r(t);n("ac6a"),n("4a91"),n("a114"),n("d14b"),n("113c"),n("df75"),n("1e5d"),n("7e6d");var i=n("a026"),r=n("e84f"),a=n("7051"),o=n("2040"),s=n("cf12"),l=n("46a9"),c=n("32a1"),u=n("f30c"),d=n("ce67"),h=n("482e"),f=n("1731"),m=n("9e58"),p=n("cc4a"),v=n("363b"),b=n("c563"),y=n("db7b"),g=n("c081"),_=n("9413"),w=n("52b5"),$=n("1180"),x=n("1e55"),C=n("506f"),k=n("91c8"),q=n("9541"),S=n("b8d9"),O=n("7d43"),j=n("4630c"),E=n("2d04"),D=n("c604"),I=n("53fe"),T=n("206e"),F=n("b7b8"),W=n("77e2"),A=n("79e9"),M=n("5d8b"),L=n("5931"),B=n("dd1f"),R=n("525b"),U=n("f25e"),P=n("3d5b"),H=n("e57e"),V=n("7ea0"),N=n("94e3"),Q=n("bc9b"),z=n("db18"),Y=n("ac83"),K=n("0952"),J=n("2a70"),G=n("ef81"),X=n("4bf4"),Z=n("eebf"),ee=n("6aa0"),te=n("53fc"),ne=n("b5b8"),ie=n("c1f9"),re=n("7646"),ae=n("6580"),oe=n("3a08"),se=n("3054"),le=n("6ddb"),ce=n("93f5"),ue=n("6186"),de=n("03d8"),he=n("2bd2"),fe=n("ed20"),me=n("133b"),pe=n("6780"),ve=n("f9d8"),be=n("37c5"),ye=n("0bae"),ge=n("a9a0");i["default"].use(r["a"],{config:{},components:{QLayout:a["a"],QLayoutHeader:o["a"],QLayoutDrawer:s["a"],QPageContainer:l["a"],QPage:c["a"],QToolbar:u["a"],QToolbarTitle:d["a"],QBtn:h["a"],QBtnGroup:f["a"],QBtnDropdown:m["a"],QWindowResizeObservable:p["a"],QResizeObservable:v["a"],QTabs:b["a"],QTab:y["a"],QTabPane:g["a"],QRouteTab:_["a"],QIcon:w["a"],QList:$["a"],QListHeader:x["a"],QItem:C["a"],QItemSeparator:k["a"],QItemTile:q["a"],QItemMain:S["a"],QItemSide:O["a"],QBreadcrumbs:j["a"],QBreadcrumbsEl:E["a"],QTable:D["a"],QTableColumns:I["a"],QInnerLoading:T["a"],QSpinnerOval:F["a"],QSpinnerPie:W["a"],QField:A["a"],QInput:M["a"],QSelect:L["a"],QRadio:B["a"],QCheckbox:R["a"],QColor:U["a"],QDatetime:P["a"],QChipsInput:H["a"],QAutocomplete:V["a"],QSlider:N["a"],QToggle:Q["a"],QKnob:z["a"],QCollapsible:Y["a"],QModal:K["a"],QModalLayout:J["a"],QAlert:G["a"],QChip:X["a"],QPageSticky:Z["a"],QFab:ee["a"],QFabAction:te["a"],QPopover:ne["a"],QOptionGroup:ie["a"],QCard:re["a"],QCardTitle:ae["a"],QCardMain:oe["a"],QCardSeparator:se["a"],QCardActions:le["a"],QScrollArea:ce["a"],QSearch:ue["a"],QTooltip:de["a"]},directives:{CloseOverlay:he["a"]},plugins:{Screen:fe["a"],Notify:me["a"],Dialog:pe["a"],LocalStorage:ve["a"],SessionStorage:be["a"],ActionSheet:ye["a"],Loading:ge["a"]}});var _e=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"q-app"}},[n("router-view")],1)},we=[];_e._withStripped=!0;var $e={name:"App"},xe=$e,Ce=(n("034f"),n("2877")),ke=Object(Ce["a"])(xe,_e,we,!1,null,null,null);ke.options.__file="App.vue";var qe=ke.exports,Se=n("2f62");i["default"].use(Se["a"]);var Oe=new Se["a"].Store({modules:{},strict:!0}),je=Oe,Ee=n("8c4f"),De=[{path:"/",component:function(){return n.e("7a20b6f9").then(n.bind(null,"7b3d"))},children:[{path:"",redirect:"dashboard"},{path:"data/:path*",name:"data",component:function(){return n.e("4b467f1e").then(n.bind(null,"c635"))}},{path:"devices",name:"devices",component:function(){return n.e("4b2fd5de").then(n.bind(null,"19e2"))}},{path:"table/:id",component:function(){return n.e("3b914df5").then(n.bind(null,"a2a3"))},meta:{back:!0}},{path:"flow/:id",component:function(){return n.e("355c2d3c").then(n.bind(null,"ace6"))},meta:{back:!0}},{path:"chart/:id",component:function(){return n.e("83c9de22").then(n.bind(null,"af1b"))},meta:{back:!0}},{path:"chart",component:function(){return n.e("83c9de22").then(n.bind(null,"af1b"))}},{path:"text/:id",component:function(){return n.e("13bcb548").then(n.bind(null,"c48b"))},meta:{back:!0}},{path:"image/:id",component:function(){return n.e("53e8f1c0").then(n.bind(null,"283a"))},meta:{back:!0}},{path:"resource/:id",component:function(){return n.e("2d210ba0").then(n.bind(null,"b8b6"))},meta:{back:!0}},{path:"create/:type",name:"create",component:function(){return n.e("2d0c89ac").then(n.bind(null,"561f"))},meta:{back:!0}},{path:"device/:id",component:function(){return n.e("93b9028a").then(n.bind(null,"180f"))},meta:{back:!0}},{path:"dashboard",name:"dashboard",component:function(){return n.e("32004473").then(n.bind(null,"ec95"))}},{path:"settings",component:function(){return n.e("1af3a6a5").then(n.bind(null,"b41f"))}},{path:"flows",name:"flows",component:function(){return n.e("4b467416").then(n.bind(null,"c352"))}},{path:"test",component:function(){return n.e("143d97f2").then(n.bind(null,"c961"))}}]},{path:"/login",name:"login",component:function(){return n.e("7c7700fd").then(n.bind(null,"013f"))}},{path:"*",component:function(){return n.e("4b4818b8").then(n.bind(null,"ee5d"))}}];i["default"].use(Ee["a"]);var Ie=new Ee["a"]({mode:"hash",base:"/client/",scrollBehavior:function(){return{y:0}},routes:De}),Te=Ie,Fe=function(){var e="function"===typeof je?je():je,t="function"===typeof Te?Te({store:e}):Te;e.$router=t;var n={el:"#q-app",router:t,store:e,render:function(e){return e(qe)}};return{app:n,store:e,router:t}},We=n("a925"),Ae={failed:"Action failed",success:"Action was successful"},Me={en:Ae},Le=function(e){var t=e.app,n=e.Vue;n.use(We["a"]),t.i18n=new We["a"]({locale:"en",fallbackLocale:"en",messages:Me})},Be=n("c7b2"),Re=function(e){Be["a"].install(e)},Ue=n("1dce"),Pe=n.n(Ue),He=function(e){var t=e.Vue;t.use(Pe.a)},Ve=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.visible?n("vue-touch-keyboard",{staticClass:"vkeyboard",attrs:{layout:e.layout,cancel:e.hide,accept:e.accept,change:e.change,next:e.next,input:e.input,options:e.options}}):e._e()},Ne=[];Ve._withStripped=!0;var Qe=n("f186"),ze=n.n(Qe),Ye=(n("a245"),n("abcf")),Ke=Ye["b"].style,Je=null,Ge=function(e){if(Je){var t=e.target.nodeName.toLowerCase();if("input"==t||"textarea"==t){var n=e.target,i=null;if("input"==t){var r=n.getAttribute("type");switch(r){case"number":i="numeric";break}}Je.show(n,i)}}},Xe=function(e){Je||(Je=e,document.body.addEventListener?document.body.addEventListener("focus",Ge,!0):document.body.onfocusin=Ge)},Ze=function(e){Je&&(Je=null,document.body.addEventListener?document.body.removeEventListener("focus",Ge,!0):document.body.onfocusin=null)},et={name:"VKeyboard",components:{"vue-touch-keyboard":ze.a.component},data:function(){return{visible:!1,layout:"normal",input:null,options:{useKbEvents:!1,preventClickEvent:!0}}},methods:{accept:function(e){this.hide()},show:function(e,t){this.input=e,this.layout=e.dataset.layout||t||"normal",this.visible||(this.visible=!0)},hide:function(){this.visible=!1},change:function(e,t){var n=new InputEvent("input",{data:e,bubbles:!0,cancelable:!0});this.input.dispatchEvent(n)},next:function(){var e=this,t=document.querySelectorAll("input"),n=!1;t=[].filter.call(t,function(e){return"none"!==Ke(e,"display")}),t.forEach(function(i,r){!n&&i==e.input&&r<t.length-1&&(n=!0,e.$nextTick(function(){t[r+1].focus()}))}),n||(this.input.blur(),this.hide())}},mounted:function(){Xe(this)},beforeDestroy:function(){Ze(this)}},tt=et,nt=(n("2a5a"),Object(Ce["a"])(tt,Ve,Ne,!1,null,null,null));nt.options.__file="VKeyboard.vue";var it=nt.exports,rt=function(e){e.app,e.router;var t=e.Vue;e.store;t.component("VKeyboard",it)},at=(n("6b5b"),n("a70e")),ot=n.n(at),st=n("5ad2"),lt=n.n(st),ct=n("8dcb"),ut=n.n(ct);ot.a.registerLanguage("json",lt.a),ot.a.registerLanguage("xml",ut.a);var dt,ht,ft={install:function(e){e.directive("highlightjs",{deep:!0,bind:function(e,t){var n,i,r=e.querySelectorAll("code");for(i=0;i<r.length;i+=1)n=r[i],"string"===typeof t.value&&(n.textContent=t.value),ot.a.highlightBlock(n)},componentUpdated:function(e,t){var n,i,r=e.querySelectorAll("code");for(i=0;i<r.length;i+=1)n=r[i],"string"===typeof t.value&&(n.textContent=t.value),ot.a.highlightBlock(n)}})}},mt=function(e){var t=e.Vue;t.use(ft)},pt=n("426a"),vt=n.n(pt),bt=function(e){var t=e.Vue;new t({data:{arbo:vt.a.arbo}});t.prototype.$ething=vt.a,window&&(window.EThing=vt.a)},yt=(n("7f7f"),n("f44e")),gt=(n("f751"),{name:"FormSchema",props:{value:{}},render:function(e){var t=this;return Object(yt["makeForm"])(e,Object.assign({value:this.value},this.$attrs),{input:function(e){t.$emit("input",e)},error:function(e){t.$emit("error",e)}})}}),_t=gt,wt=Object(Ce["a"])(_t,dt,ht,!1,null,null,null);wt.options.__file="FormSchema.vue";var $t=wt.exports,xt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-select"},[n("q-select",{attrs:{value:e.c_value,options:e.items,error:!!e.error,multiple:e.isMultiple},on:{input:function(t){e.c_value=t}}})],1)},Ct=[];xt._withStripped=!0;var kt={name:"FormSchemaSelect",mixins:[yt["FormComponent"]],computed:{enumSchema:function(){return this.isBoolean?Object.assign({enum:[!0,!1],$labels:["True","False"]},this.c_schema):this.isMultiple?this.c_schema.items:this.c_schema},items:function(){var e=this;return(this.enumSchema.enum||[]).map(function(t,n,i){var r=i.length;return{label:String(e.getLabel(e.enumSchema,t,n,r)),value:t,icon:e.getIcon(e.enumSchema,t,n,r)}})},isMultiple:function(){return"array"===this.c_schema.type&&this.c_schema.items.enum},isBoolean:function(){return"boolean"===this.c_schema.type}},methods:{getLabel:function(e,t,n,i){var r=e["$labels"]||[];if(Array.isArray(r)){if(n<r.length)return r[n]}else if("function"===typeof r)return r.call(this,t,n,i);return t},getIcon:function(e,t,n,i){var r=e["$icons"]||[];if(Array.isArray(r)){if(n<r.length)return r[n]}else if("function"===typeof r)return r.call(this,t,n,i)}},rule:function(e){return"undefined"!=typeof e.enum||"array"===e.type&&e.items.enum||"boolean"===e.type}},qt=kt,St=Object(Ce["a"])(qt,xt,Ct,!1,null,null,null);St.options.__file="Select.vue";var Ot=St.exports,jt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-radio"},e._l(e.items,function(t,i){return n("q-radio",{key:i,attrs:{val:"item.value",label:"item.label"},model:{value:e.c_value,callback:function(t){e.c_value=t},expression:"c_value"}})}))},Et=[];jt._withStripped=!0;var Dt={name:"FormSchemaRadio",mixins:[Ot],rule:function(e){return"undefined"!=typeof e.enum||"boolean"===e.type}},It=Dt,Tt=Object(Ce["a"])(It,jt,Et,!1,null,null,null);Tt.options.__file="Radio.vue";var Ft=Tt.exports,Wt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-checkbox"},e._l(e.items,function(t,i){return n("q-checkbox",{key:i,attrs:{val:"item.value",label:"item.label"},model:{value:e.c_value,callback:function(t){e.c_value=t},expression:"c_value"}})}))},At=[];Wt._withStripped=!0;var Mt={name:"FormSchemaCheckbox",mixins:[Ot],rule:function(e){return"array"===e.type&&e.items.enum}},Lt=Mt,Bt=Object(Ce["a"])(Lt,Wt,At,!1,null,null,null);Bt.options.__file="Checkbox.vue";var Rt=Bt.exports,Ut=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-input"},[n("q-input",e._b({attrs:{type:e.inputType,value:e.c_value,error:!!e.error,placeholder:e.c_schema["$placeholder"]},on:{input:function(t){e.c_value=t}}},"q-input",e.attributes,!1))],1)},Pt=[];Ut._withStripped=!0;var Ht=n("b5ae"),Vt=(n("3b2b"),n("78ef")),Nt=function(e){return Object(Vt["withParams"])({type:"regex",pattern:e},function(t){return!Object(Vt["req"])(t)||new RegExp(e).test(t)})},Qt={name:"FormSchemaInput",mixins:[yt["FormComponent"]],validations:function(){var e={};return"string"===this.c_schema.type?("number"===typeof this.c_schema.minLength&&(e.minLength=Object(Ht["minLength"])(this.c_schema.minLength)),"number"===typeof this.c_schema.maxLength&&(e.maxLength=Object(Ht["maxLength"])(this.c_schema.maxLength)),"string"===typeof this.c_schema.pattern&&(e.regex=Nt(this.c_schema.pattern)),"email"===this.c_schema.format&&(e.email=Ht["email"])):"number"!==this.c_schema.type&&"integer"!==this.c_schema.type||("number"===typeof this.c_schema.minimum&&(e.minValue=Object(Ht["minValue"])(this.c_schema.minimum)),"number"===typeof this.c_schema.maximum&&(e.maxValue=Object(Ht["maxValue"])(this.c_schema.maximum))),{c_value:e}},computed:{inputType:function(){return"string"===this.c_schema.type?"email"===this.c_schema.format?"email":"url"===this.c_schema.format?"url":"text":"number"===this.c_schema.type||"integer"===this.c_schema.type?"number":"text"},isNumber:function(){return"number"===this.c_schema.type||"integer"===this.c_schema.type},isInteger:function(){return"integer"===this.c_schema.type},attributes:function(){var e={};return this.isInteger&&(e.decimals=0),this.isNumber&&("number"===typeof this.c_schema.minimum&&(e.min=this.c_schema.minimum),"number"===typeof this.c_schema.maximum&&(e.max=this.c_schema.maximum),"number"===typeof this.c_schema.multipleOf&&(e.step=this.c_schema.multipleOf)),"string"===this.c_schema.type&&"number"===typeof this.c_schema.maxLength&&(e.maxlength=this.c_schema.maxLength),e}},rule:function(e){return-1!==["string","number","integer"].indexOf(e.type)}},zt=Qt,Yt=Object(Ce["a"])(zt,Ut,Pt,!1,null,null,null);Yt.options.__file="Input.vue";var Kt=Yt.exports,Jt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-file"},[n("div",[n("span",{staticClass:"q-mr-md relative-position overflow-hidden"},[n("q-icon",{attrs:{name:"add",color:"primary"}}),e._v(" add file\n      "),n("input",{ref:"file",staticClass:"file-input absolute-full cursor-pointer",attrs:{type:"file",accept:e.c_schema.accept},on:{change:e.__add}})],1),e._l(e.files,function(t,i){return n("small",{key:i,staticClass:"text-faded"},[e._v("\n      "+e._s(t.name)+" ("+e._s(t.__size)+")\n    ")])})],2)])},Gt=[];Jt._withStripped=!0;n("28a5");var Xt=n("177b"),Zt=Xt["c"].humanStorageSize,en={name:"FormSchemaFile",mixins:[yt["FormComponent"]],data:function(){return{files:[]}},methods:{__add:function(e,t){var n=this;t=Array.prototype.slice.call(t||e.target.files),this.$refs.file.value="";t=t.map(function(e){return e.__size=Zt(e.size),e.__timestamp=(new Date).getTime(),e.__converting=!0,n.convert(e,function(t){n.$nextTick(function(){e.__converting=!1,n.c_value=t})},function(e){n.files=[],n.$emit("error",String(e)),n.c_value=void 0}),e}),this.files=t},convert:function(e,t,n){var i=this,r=function(r){var a=i.c_schema["$converter"];if("function"===typeof a)try{a.call(i,e,r,t,n)}catch(e){n(e)}else t(r)};if("data-url"===this.c_schema.format){var a=new FileReader;a.onloadend=function(e){r(a.result)},a.readAsDataURL(e)}else if("base64"===this.c_schema.format){var o=new FileReader;o.onloadend=function(e){var t=o.result,n=t.split(",",2);r(n[1])},o.readAsDataURL(e)}else if("text"===this.c_schema.format){var s=new FileReader;s.onloadend=function(e){r(s.result)},s.readAsText(e)}else r(e)}},rule:function(e){return"string"===e.type&&-1!==["data-url","base64"].indexOf(e.format)}},tn=en,nn=(n("bb8d"),Object(Ce["a"])(tn,Jt,Gt,!1,null,"9df36636",null));nn.options.__file="File.vue";var rn=nn.exports,an=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-password"},[n("q-input",{attrs:{type:"password",value:e.c_value,error:!!e.error},on:{input:function(t){e.c_value=t}}})],1)},on=[];an._withStripped=!0;var sn={name:"FormSchemaPassword",mixins:[Kt]},ln=sn,cn=Object(Ce["a"])(ln,an,on,!1,null,null,null);cn.options.__file="Password.vue";var un=cn.exports,dn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-textarea"},[n("q-input",{attrs:{type:"textarea",value:e.c_value,error:!!e.error,placeholder:e.c_schema["$placeholder"],rows:e.c_schema["$rows"]},on:{input:function(t){e.c_value=t}}})],1)},hn=[];dn._withStripped=!0;var fn={name:"FormSchemaTextarea",mixins:[Kt]},mn=fn,pn=Object(Ce["a"])(mn,dn,hn,!1,null,null,null);pn.options.__file="Textarea.vue";var vn=pn.exports,bn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-color"},[n("q-color",{style:{"border-bottom":"4px solid "+e.c_value},attrs:{value:e.c_value,error:!!e.error,"format-model":"hex","hide-underline":""},on:{input:function(t){e.c_value=t}}})],1)},yn=[];bn._withStripped=!0;var gn={name:"FormSchemaColor",mixins:[Kt],methods:{cast:function(e){return e||"#FF0000"}},rule:function(e){return"string"===e.type&&"color"===e.format}},_n=gn,wn=Object(Ce["a"])(_n,bn,yn,!1,null,null,null);wn.options.__file="Color.vue";var $n=wn.exports,xn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-datetime"},[n("q-datetime",{attrs:{type:e.datetype,value:e.c_value,error:!!e.error,format24h:""},on:{input:function(t){e.c_value=t}}})],1)},Cn=[];xn._withStripped=!0;var kn={name:"FormSchemaDatetime",mixins:[yt["FormComponent"]],computed:{datetype:function(){return"date"===this.c_schema.format?"date":"time"===this.c_schema.format?"time":"datetime"}},rule:function(e){return"string"===e.type&&-1!==["date-time","date","time"].indexof(e.format)}},qn=kn,Sn=Object(Ce["a"])(qn,xn,Cn,!1,null,null,null);Sn.options.__file="Datetime.vue";var On=Sn.exports,jn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-object",class:{indent:e.level}},[e.items.length>0?e._l(e.items,function(t){return n("div",{key:t.key,staticClass:"form-schema-object-item",class:{"form-schema-object-item-required":t.required,"form-schema-object-item-error":!!e.errors[t.key]},style:{display:e.inlined?"inline":"block"}},[t.schema.$hideLabel?e._e():n("div",{staticClass:"form-schema-object-item-title q-field-label q-field-label-inner",style:{display:e.inlined?"inline":"block"}},[e._v("\n        "+e._s(t.schema.title||t.key)+"\n        "),e.inlined||t.required?e._e():n("small",[e._v("(optional)")])]),n("form-schema",{attrs:{required:t.required,inline:e.inlined,schema:t.schema,value:t.model,level:e.level+1},on:{input:function(n){e.onChildValueChange(t,n)},error:function(n){e.onChildErrorChange(t,n)}}})],1)}):n("div",[n("small",{staticClass:"text-faded"},[e._v("empty")])])],2)},En=[];jn._withStripped=!0;n("8615"),n("cadf"),n("456d");var Dn=n("7037"),In=n.n(Dn);function Tn(e){return"object"===In()(e)&&null!==e}var Fn={name:"FormSchemaObject",mixins:[yt["FormComponent"]],data:function(){return{errors:{}}},computed:{items:function(){var e=this,t=this.c_schema,n=t.required||[],i=[],r=[];for(var a in t.properties)!t.properties[a]||t.properties[a]["$disabled"]?r.push(a):t.properties[a]["$readOnly"]?i.push(a):t.properties[a]["$required"]&&-1===n.indexOf(a)&&n.push(a);var o=n.concat(Object.keys(t.properties||{}).filter(function(e){return-1===n.indexOf(e)&&-1===i.indexOf(e)})).filter(function(e){return-1===r.indexOf(e)&&!!t.properties[e]});if(t["$order"])for(var s=t["$order"].length;s>0;s--){var l=t["$order"][s-1],c=o.indexOf(l);-1!==c&&(o.splice(c,1),o.unshift(l))}var u=!1;Object.keys(this.errors).forEach(function(t){-1===o.indexOf(t)&&(delete e.errors[t],u=!0)}),u&&this.$emit("error",Object.values(this.errors).some(function(e){return e}));var d=Object.assign({},this.c_value),h=!1;return Object.keys(d).forEach(function(e){-1===o.indexOf(e)&&(delete d[e],h=!0)}),h&&(this.c_value=d),o.map(function(i){return{key:i,schema:t.properties[i],required:-1!==n.indexOf(i),model:(e.c_value||{})[i]}})}},methods:{onChildValueChange:function(e,t){if(Tn(this.c_value))this.$set(this.c_value,e.key,t);else{var n={};n[e.key]=t,this.c_value=n}},onChildErrorChange:function(e,t){this.$set(this.errors,e.key,t),this.$emit("error",Object.values(this.errors).some(function(e){return e}))}},rule:function(e){return"object"===e.type||"object"===In()(e.properties)}},Wn=Fn,An=(n("f2b1"),Object(Ce["a"])(Wn,jn,En,!1,null,"72c5be27",null));An.options.__file="Object.vue";var Mn=An.exports,Ln=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-array",class:{indent:e.level}},[n("div",[n("q-btn",{staticClass:"q-mb-xs",attrs:{outline:"",dense:"",label:"Add item",icon:"add",size:"xs",color:"grey"},on:{click:e.addItem}})],1),n("div",{staticClass:"form-schema-array-content"},[e._l(e.items,function(t,i){return n("div",{key:i,staticClass:"form-schema-array-item"},[n("div",{staticClass:"form-schema-array-item-header"},[n("q-btn",{staticStyle:{"vertical-align":"middle"},attrs:{size:"xs",color:"negative",label:"remove",icon:"delete"},on:{click:function(t){e.removeItem(i)}}}),i>0?n("q-btn",{attrs:{flat:"",size:"sm",color:"secondary",label:"up",icon:"arrow_drop_up"},on:{click:function(t){e.moveItem(i,"up")}}}):e._e(),i<e.items.length-1?n("q-btn",{attrs:{flat:"",size:"sm",color:"secondary",label:"down",icon:"arrow_drop_down"},on:{click:function(t){e.moveItem(i,"down")}}}):e._e()],1),n("form-schema",{attrs:{inline:"",schema:t.schema,value:e.getModel(i),level:e.level+1},on:{input:function(t){e.onChildValueChange(i,t)},error:function(t){e.onChildErrorChange(i,t)}}})],1)}),n("div",{staticClass:"form-schema-array-bottom-padding relative-position",staticStyle:{height:"48px"}},[e.items.length?e._e():n("small",{staticClass:"absolute-center faded"},[e._v("empty")])])],2)])},Bn=[];Ln._withStripped=!0;var Rn={name:"FormSchemaArray",mixins:[yt["FormComponent"]],data:function(){return{items:[]}},watch:{c_value:function(){this.refreshFromModel()}},methods:{refreshFromModel:function(){var e=this;this.items=(this.c_value||[]).map(function(t){return{schema:e.c_schema.items||{}}})},getModel:function(e){return Array.isArray(this.c_value)&&e<this.c_value.length?this.c_value[e]:void 0},addItem:function(){this.items.push({schema:this.c_schema.items||{}})},removeItem:function(e){this.items.splice(e,1),this.c_value.splice(e,1)},moveItem:function(e,t){var n=this.items.splice(e,1),i=this.c_value.splice(e,1);this.items.splice(e+("up"===t?-1:1),0,n[0]),this.c_value.splice(e+("up"===t?-1:1),0,i[0])},onChildValueChange:function(e,t){this.c_value?this.$set(this.c_value,e,t):this.c_value=[t]},onChildErrorChange:function(e,t){this.$set(this.items[e],"error",t),this.$emit("error",Object.values(this.items).some(function(e){return e.error}))}},mounted:function(){this.refreshFromModel()},rule:function(e){return"array"===e.type}},Un=Rn,Pn=(n("cb61"),Object(Ce["a"])(Un,Ln,Bn,!1,null,"fa66c2ee",null));Pn.options.__file="Array.vue";var Hn=Pn.exports,Vn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-input"},[n("pre",[e._v(e._s(e.c_value))])])},Nn=[];Vn._withStripped=!0;var Qn={name:"FormSchemaConst",mixins:[yt["FormComponent"]],rule:function(e){return"undefined"!==typeof e.const}},zn=Qn,Yn=Object(Ce["a"])(zn,Vn,Nn,!1,null,null,null);Yn.options.__file="Const.vue";var Kn=Yn.exports,Jn=[Ot,Ft,Rt,rn,On,$n,Kt,un,vn,On,Hn,Mn,Kn],Gn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-bluetooth-interface"},[n("div",{staticClass:"row"},[n("q-input",{staticClass:"col",attrs:{type:"number",value:e.c_value,error:!!e.error,prefix:"hci"},on:{input:function(t){e.c_value=t}}}),n("q-btn",{staticClass:"col-auto",attrs:{flat:"",color:"faded",icon:"search"}},[n("q-popover",{attrs:{anchor:"bottom right",self:"top right",fit:""},on:{show:e.show}},[n("div",{staticStyle:{width:"260px"}},[e.loading?n("div",{staticClass:"q-ma-md text-center text-faded"},[n("div",{staticClass:"q-ma-md"},[e._v("loading...")]),n("q-spinner-oval",{attrs:{color:"primary",size:"50px"}})],1):0===e.interfaces.length?n("div",{staticClass:"q-ma-md text-faded"},[e._v("no bluetooth interface detected")]):n("q-list",{attrs:{separator:"",link:""}},[n("q-btn",{attrs:{flat:"",color:"faded",icon:"refresh",label:"refresh"},on:{click:function(t){e.refresh()}}}),e._l(e.interfaces,function(t,i){return n("q-item",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}],key:i,nativeOn:{click:function(n){e.c_value=e.parseIntFromHci(t.hci)}}},[n("q-item-main",[n("q-item-tile",{attrs:{label:""}},[e._v(e._s(t.hci))]),t.address?n("q-item-tile",{attrs:{sublabel:""}},[e._v("mac: "+e._s(t.address))]):e._e(),t.name?n("q-item-tile",{attrs:{sublabel:""}},[e._v("name: "+e._s(t.name))]):e._e(),t.status?n("q-item-tile",{attrs:{sublabel:""}},[e._v("status: "+e._s(t.status))]):e._e(),t.manufacturer?n("q-item-tile",{attrs:{sublabel:""}},[e._v("manufacturer: "+e._s(t.manufacturer))]):e._e()],1)],1)})],2)],1)])],1)],1)])},Xn=[];Gn._withStripped=!0;n("4917");var Zn={name:"FormSchemaBluetoothInterface",mixins:[yt["FormComponent"]],data:function(){return{interfaces:[],loading:!0,loaded:!1}},methods:{show:function(){this.loaded||(this.loaded=!0),this.refresh()},refresh:function(){var e=this;this.loading=!0,vt.a.request({url:"utils/bluetooth_list",dataType:"json"}).then(function(t){e.interfaces=t}).finally(function(){e.loading=!1})},parseIntFromHci:function(e){return parseInt(e.match(/^hci([0-9]+)$/)[1])}}},ei=Zn,ti=Object(Ce["a"])(ei,Gn,Xn,!1,null,null,null);ti.options.__file="BluetoothInterface.vue";var ni=ti.exports,ii=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-editor",attrs:{"force-description":""}},[n("codemirror",{ref:"cm",attrs:{value:e.c_value||"",options:e.cmOption},on:{input:function(t){e.c_value=t}}})],1)},ri=[];ii._withStripped=!0;var ai=n("8f94"),oi=(n("a7be"),n("f9d4"),n("ced0"),n("db91"),n("8c33"),n("10b2"),{name:"FormSchemaEditor",mixins:[yt["FormComponent"]],components:{codemirror:ai["codemirror"]},data:function(){return{cmOption:{mode:this.schema["$lang"]||"text",tabSize:4,styleActiveLine:!0,lineNumbers:!0,lineWrapping:!1,styleSelectedText:!0,matchBrackets:!0,autoCloseBrackets:!0,showCursorWhenSelecting:!0,extraKeys:{Ctrl:"autocomplete"},hintOptions:{completeSingle:!1},viewportMargin:1/0}}},mounted:function(){var e=this;this.$nextTick(function(){e.$refs.cm.refresh()})}}),si=oi,li=(n("95ee"),Object(Ce["a"])(si,ii,ri,!1,null,null,null));li.options.__file="Editor.vue";var ci=li.exports,ui=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-ething-flow-node"},[n("flow-node-select",{attrs:{value:e.c_value,filter:e.computed_filter,multiple:e.multiple,flow:e.flow,"use-id":""},on:{input:function(t){e.c_value=t}}})],1)},di=[];ui._withStripped=!0;var hi=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-select",e._b({attrs:{value:e.formattedValue,options:e.options,multiple:e.multiple},on:{input:function(t){e.$emit("input",t)}}},"q-select",e.$attrs,!1))},fi=[];hi._withStripped=!0;n("7514");var mi={name:"FlowNodeSelect",props:{filter:{},value:{},useId:Boolean,multiple:Boolean,flow:{}},computed:{computedFlow:function(){return"string"===typeof this.flow?this.$ething.arbo.get(this.flow):this.flow},formattedValue:function(){return this.multiple?Array.isArray(this.value)?this.value:this.value?[this.value]:[]:this.value},nodes:function(){var e=this,t=[];return this.$ething.arbo.find(function(e){return e instanceof vt.a.Flow}).forEach(function(n){e.computedFlow&&n.id()!==e.computedFlow.id()||n.attr("nodes").forEach(function(i){e.filter&&!e.filter.call(e,n,i)||t.push({flow:n,node:i})})}),t},options:function(){var e=this;return this.nodes.map(function(t){var n,i=t.node,r=t.node;return n=e.flow?e.useId?r.id:r:{flow:e.useId?i.id():i,node:e.useId?r.id:r},{label:r.name,value:n,icon:e.$ethingUI.get(r.type).icon,leftColor:e.$ethingUI.get(r.type).color,inset:!0,stamp:e.$ethingUI.get(r.type).title,sublabel:e.flow?null:i.basename}})}}},pi=mi,vi=Object(Ce["a"])(pi,hi,fi,!1,null,null,null);vi.options.__file="FlowNodeSelect.vue";var bi=vi.exports,yi={name:"FormSchemaEthingFlowNode",mixins:[yt["FormComponent"]],components:{FlowNodeSelect:bi},computed:{multiple:function(){return"array"===this.c_schema.type},computed_filter:function(){var e=this,t=this.c_schema;return function(n,i){return e.filter(n,i,t)}},flow:function(){var e=this.c_schema["$flow"];return"$context"===e&&(e=this.getContext("flow")),"function"===typeof e&&(e=e.call(this.c_schema)),e}},methods:{filter:function(e,t,n){var i=n["$filter"];return!(i&&!i.call(n,e,t))}}},gi=yi,_i=Object(Ce["a"])(gi,ui,di,!1,null,null,null);_i.options.__file="EthingFlowNode.vue";var wi=_i.exports,$i=n("64fd"),xi=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-cron"},[n("q-btn",{attrs:{flat:"",color:"primary",icon:"edit",label:e.c_value?"change":"set"},on:{click:function(t){e.editing=!0}}}),n("div",[e._v(e._s(e.readableExp))]),n("modal",{attrs:{title:"Cron editor",icon:"event"},on:{valid:e.apply},model:{value:e.editing,callback:function(t){e.editing=t},expression:"editing"}},[n("cron",{staticClass:"q-ma-md",attrs:{value:e.c_value},on:{input:function(t){e.editedExp=t}}})],1)],1)},Ci=[];xi._withStripped=!0;n("6b54");var ki=n("80c5"),qi=n("2772"),Si=n.n(qi),Oi={name:"FormSchemaCron",mixins:[yt["FormComponent"]],components:{Cron:ki["a"]},data:function(){return{editedExp:null,editing:!1}},computed:{readableExp:function(){return this.c_value?Si.a.toString(this.c_value):""}},methods:{apply:function(){this.editing=!1,this.c_value=this.editedExp}}},ji=Oi,Ei=Object(Ce["a"])(ji,xi,Ci,!1,null,null,null);Ei.options.__file="Cron.vue";var Di=Ei.exports,Ii=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-host"},[n("div",{staticClass:"row"},[n("q-input",{staticClass:"col",attrs:{value:e.c_value,error:!!e.error},on:{input:function(t){e.c_value=t}}}),n("q-btn",{staticClass:"q-ml-sm col-auto",attrs:{color:"primary",icon:"search"}},[n("q-popover",{ref:"popover",attrs:{anchor:"bottom right",self:"top right",fit:""},on:{show:e.showHosts}},[n("div",{staticStyle:{width:"260px"}},[e.loading?n("div",{staticClass:"q-ma-md text-center text-faded"},[n("div",{staticClass:"q-ma-md"},[e._v("scanning...")]),n("q-spinner-oval",{attrs:{color:"primary",size:"50px"}})],1):0===e.hosts.length?n("div",{staticClass:"q-ma-md text-faded"},[e._v("no host detected")]):n("q-list",{attrs:{separator:"",link:""}},[n("q-btn",{attrs:{flat:"",color:"faded",icon:"refresh",label:"refresh"},on:{click:function(t){e.refresh(!0)}}}),e._l(e.hosts,function(t,i){return n("q-item",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}],key:i,nativeOn:{click:function(n){e.c_value=t.hostname||t.ip}}},[n("q-item-main",[n("q-item-tile",{attrs:{label:""}},[e._v(e._s(t.hostname||t.ip))]),t.mac?n("q-item-tile",{attrs:{sublabel:""}},[e._v("mac: "+e._s(t.mac))]):e._e(),t.vendor?n("q-item-tile",{attrs:{sublabel:""}},[e._v("vendor: "+e._s(t.vendor))]):e._e()],1)],1)})],2)],1)])],1)],1)])},Ti=[];Ii._withStripped=!0;var Fi=[],Wi=!1,Ai=null,Mi=3e5;function Li(e,t){"function"===typeof e&&(t=e,e=!1),!1===Wi&&(e=!0),(e||Date.now()-Wi>Mi)&&(Wi=Date.now(),Ai=vt.a.request({url:"utils/net_list",dataType:"json"}).then(function(e){Fi=e})),Ai.finally(function(){"function"===typeof t&&t(Fi)})}var Bi={name:"FormSchemaHost",mixins:[yt["FormComponent"]],data:function(){return{hosts:[],loading:!0,skipNext:!1}},methods:{showHosts:function(){this.skipNext?this.skipNext=!1:this.refresh()},refresh:function(e){var t=this;this.loading=!0,Li(e,function(e){t.hosts=e,t.loading=!1,t.skipNext=!0,t.$refs.popover.hide(),t.$refs.popover.show()})}},mounted:function(){}},Ri=Bi,Ui=Object(Ce["a"])(Ri,Ii,Ti,!1,null,null,null);Ui.options.__file="Host.vue";var Pi=Ui.exports,Hi=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-oneof"},[n("div",{class:e.inlined?"row":""},[n("q-select",{class:e.inlined?e.subschema?"col-auto":"col-12":"",attrs:{options:e.selectOptions},model:{value:e.subtypeindex,callback:function(t){e.subtypeindex=t},expression:"subtypeindex"}}),e.subschema?n("form-schema",{class:e.inlined?"col":"",attrs:{inline:e.inlined,level:e.level+1,schema:e.subschema,required:"",value:e.subvalue},on:{input:function(t){e.subvalue=t},error:function(t){e.$emit("error",t)}}}):e._e()],1)])},Vi=[];Hi._withStripped=!0;var Ni={name:"FormSchemaOneof",mixins:[yt["FormComponent"]],data:function(){return{localIndex:0}},computed:{items:function(){var e=this,t=this.c_schema.oneOf||[];return t.map(function(t,n,i){var r=i.length,a=t.properties.type.const;return{label:String(e.getLabel(e.c_schema,t,n,r)),schema:t,icon:e.getIcon(e.c_schema,t,n,r),type:a}})},selectOptions:function(){return this.items.map(function(e,t){return{label:e.label,value:t,icon:e.icon}})},subvalue:{get:function(){if(this.c_value)return this.c_value.value},set:function(e){this.c_value?this.$set(this.c_value,"value",e):this.c_value={type:this.subtype,value:e}}},subtype:{get:function(){if(this.c_value)return this.c_value.type},set:function(e){this.c_value={type:e}}},subtypeindex:{get:function(){var e=this.subtype;for(var t in this.items)if(this.items[t].type===e)return parseInt(t)},set:function(e){this.subtype=this.items[e].type}},subschema:function(){if("undefined"!==typeof this.subtypeindex)return this.items[this.subtypeindex].schema.properties.value}},watch:{subschema:function(e,t){e||this.$emit("error",!1)}},methods:{getDefault:function(){try{return{type:this.items[0].type}}catch(e){}},getLabel:function(e,t,n,i){if("undefined"!==typeof e["$labels"]){var r=e["$labels"];if(Array.isArray(r)){if(n<r.length)return r[n]}else if("function"===typeof r)return r.call(this,t,n,i)}return t.title||t.properties.type.title||t.properties.type.const},getIcon:function(e,t,n,i){if("undefined"!==typeof e["$icons"]){var r=e["$icons"];if(Array.isArray(r)){if(n<r.length)return r[n]}else if("function"===typeof r)return r.call(this,t,n,i)}return"undefined"!==typeof t["$icon"]?t["$icon"]:"undefined"!==typeof t.properties.type["$icon"]?t.properties.type["$icon"]:void 0}},rule:function(e){if(Array.isArray(e.oneOf)){var t=!0;if(e.oneOf.forEach(function(e){e.properties&&e.properties.type&&e.properties.type.const||(t=!1)}),t)return!0}}},Qi=Ni,zi=Object(Ce["a"])(Qi,Hi,Vi,!1,null,null,null);zi.options.__file="Oneof.vue";var Yi=zi.exports,Ki=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-optional",class:{indent:e.level}},[n("div",[n("q-toggle",{attrs:{label:"enable"},model:{value:e.enabled,callback:function(t){e.enabled=t},expression:"enabled"}})],1),e.enabled?n("form-schema",{ref:"sub",attrs:{required:"",schema:e.filteredSchema,value:e.cachedValue,level:e.level},on:{input:e.onChildValueChange,error:function(t){e.$emit("error",t)}}}):e._e()],1)},Ji=[];Ki._withStripped=!0;n("673e");var Gi=n("b0d5"),Xi={name:"FormSchemaOptional",mixins:[yt["FormComponent"]],computed:{filteredSchema:function(){var e=Object.assign({},this.c_schema);delete e.anyOf,delete e.description;var t=this.c_schema.anyOf.filter(function(e){return"null"!==e.type});return 1==t.length?e=Object(Gi["a"])(!0,e,t[0]):e.anyOf=t,e}},data:function(){return{enabled:!1,cachedValue:void 0}},watch:{c_value:function(){this.refreshFromModel()},enabled:function(e){var t=this;this.$nextTick(function(){e?(t.c_value=t.$refs["sub"].c_value,t.$emit("error",t.$refs["sub"].error)):(t.c_value=null,t.$emit("error",!1))})}},methods:{refreshFromModel:function(){this.enabled=null!==this.c_value&&"undefined"!==typeof this.c_value,this.enabled&&(this.cachedValue=this.c_value)},onChildValueChange:function(e){this.cachedValue=e,this.c_value=e}},mounted:function(){this.refreshFromModel()},rule:function(e){if(Array.isArray(e.anyOf)){var t=e.anyOf.filter(function(e){return"null"===e.type});if(t.length>0&&t.length<e.anyOf.length)return!0}}},Zi=Xi,er=Object(Ce["a"])(Zi,Ki,Ji,!1,null,null,null);er.options.__file="Optional.vue";var tr=er.exports,nr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-scheduler"},[e.c_value&&e.c_value.length?n("div",e._l(e.c_value,function(t,i){return n("q-item",{key:i,attrs:{dense:""}},[n("q-item-side",{attrs:{icon:"schedule"}}),n("q-item-main",[n("q-item-tile",{attrs:{label:""}},[e._v(e._s(e.toString(t)))])],1),n("q-item-side",{attrs:{right:""}},[n("q-btn",{attrs:{icon:"delete",round:"",flat:"",dense:"",color:"negative"},on:{click:function(t){e.c_value.splice(i,1)}}})],1)],1)})):n("div",{staticClass:"q-ma-md text-faded"},[e._v("\n    no scheduling\n  ")]),n("q-btn",{attrs:{color:"blue-5",label:"Add",icon:"add",flat:""},on:{click:function(t){e.modal=!0}}}),n("modal",{attrs:{title:"Scheduler",icon:"schedule","valid-btn-label":"add","cancel-btn-label":"Close","valid-btn-disable":e.itemError},on:{valid:e.add},model:{value:e.modal,callback:function(t){e.modal=t},expression:"modal"}},[n("form-schema",{attrs:{schema:e.itemSchema},on:{error:function(t){e.itemError=t}},model:{value:e.itemModel,callback:function(t){e.itemModel=t},expression:"itemModel"}})],1)],1)},ir=[];nr._withStripped=!0;var rr=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];function ar(e,t,n){return n=n||"0",e+="",e.length>=t?e:new Array(t-e.length+1).join(n)+e}function or(e){var t=e.mode,n=e.start,i=e.end;switch(t){case"daily":return"every day between "+n.hour+":"+ar(n.minute,2)+" and "+i.hour+":"+ar(i.minute,2);case"weekly":return"between "+rr[n.weekday-1]+" "+n.hour+":"+ar(n.minute,2)+" and "+rr[i.weekday-1]+" "+i.hour+":"+ar(i.minute,2);case"monthly":return"between "+n.monthday+sr(n.monthday)+" "+n.hour+":"+ar(n.minute,2)+" and "+i.monthday+sr(i.monthday)+" "+i.hour+":"+ar(i.minute,2)}}function sr(e){if(e<10||e>=20){if(e%=10,1==e)return"st";if(2==e)return"nd";if(3==e)return"rd"}return"th"}var lr={name:"FormSchemaScheduler",mixins:[yt["FormComponent"]],data:function(){for(var e=[],t=1;t<=31;t++)e.push(t);return{modal:!1,itemSchema:{type:"object",additionalProperties:!1,required:["mode","start","end"],properties:{mode:{id:"FormSchemaScheduler.mode",enum:["daily","weekly","monthly"],default:"daily"},start:{type:"object",additionalProperties:!1,required:["weekday","monthday","time"],properties:{monthday:{label:"day of month",enum:e,$dependencies:{"FormSchemaScheduler.mode":function(e,t,n){t.$set(t.parent().c_schema.properties.monthday,"$disabled","monthly"!==e)}}},weekday:{label:"week day",enum:[1,2,3,4,5,6,7],$labels:rr,$dependencies:{"FormSchemaScheduler.mode":function(e,t,n){t.$set(t.parent().c_schema.properties.weekday,"$disabled","weekly"!==e)}}},time:{type:"string",format:"time"}}},end:{type:"object",additionalProperties:!1,required:["weekday","monthday","time"],properties:{monthday:{label:"day of month",enum:e,$dependencies:{"FormSchemaScheduler.mode":function(e,t,n){t.$set(t.parent().c_schema.properties.monthday,"$disabled","monthly"!==e)}}},weekday:{label:"week day",enum:[1,2,3,4,5,6,7],$labels:rr,$dependencies:{"FormSchemaScheduler.mode":function(e,t,n){t.$set(t.parent().c_schema.properties.weekday,"$disabled","weekly"!==e)}}},time:{type:"string",format:"time"}}}}},itemModel:{},itemError:!1}},methods:{toString:or,add:function(){var e=this.c_value?this.c_value.slice(0):[],t=Object(Gi["a"])(!0,{},this.itemModel),n=new Date(t.start.time);delete t.start["time"],t.start["hour"]=n.getHours(),t.start["minute"]=n.getMinutes();var i=new Date(t.end.time);delete t.end["time"],t.end["hour"]=i.getHours(),t.end["minute"]=n.getMinutes(),e.push(t),this.c_value=e,this.modal=!1}}},cr=lr,ur=Object(Ce["a"])(cr,nr,ir,!1,null,null,null);ur.options.__file="Scheduler.vue";var dr=ur.exports,hr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-scope"},[n("q-select",{attrs:{multiple:"","display-value":e.formattedModel.length?e.formattedModel.join(" "):"none",value:e.formattedModel,options:e.selectOptions,error:!!e.error},on:{input:function(t){e.formattedModel=t}}})],1)},fr=[];hr._withStripped=!0;var mr={name:"FormSchemaScope",mixins:[yt["FormComponent"]],data:function(){var e=[];for(var t in this.$ethingUI.scopes){var n=this.$ethingUI.scopes[t];e.push({label:t,value:t,sublabel:n.description})}return{selectOptions:e}},computed:{formattedModel:{get:function(){return(this.c_value||"").split(" ").filter(function(e){return e.length})},set:function(e){e=e.join(" "),this.c_value=e}}}},pr=mr,vr=(n("5876"),Object(Ce["a"])(pr,hr,fr,!1,null,"02e38fce",null));vr.options.__file="Scope.vue";var br=vr.exports,yr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-serial-port"},[n("div",{staticClass:"row"},[n("q-input",{staticClass:"col",attrs:{value:e.c_value,error:!!e.error},on:{input:function(t){e.c_value=t}}}),n("q-btn",{staticClass:"col-auto",attrs:{flat:"",color:"faded",icon:"search"}},[n("q-popover",{attrs:{anchor:"bottom right",self:"top right",fit:""},on:{show:e.show}},[n("div",{staticStyle:{width:"260px"}},[e.loading?n("div",{staticClass:"q-ma-md text-center text-faded"},[n("div",{staticClass:"q-ma-md"},[e._v("loading...")]),n("q-spinner-oval",{attrs:{color:"primary",size:"50px"}})],1):0===e.ports.length?n("div",{staticClass:"q-ma-md text-faded"},[e._v("no serial port found")]):n("q-list",{attrs:{separator:"",link:""}},[n("q-btn",{attrs:{flat:"",color:"faded",icon:"refresh",label:"refresh"},on:{click:function(t){e.refresh()}}}),e._l(e.ports,function(t,i){return n("q-item",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}],key:i,nativeOn:{click:function(n){e.c_value=t.device}}},[n("q-item-main",[n("q-item-tile",{attrs:{label:""}},[e._v(e._s(t.device))]),t.product?n("q-item-tile",{attrs:{sublabel:""}},[e._v("product: "+e._s(t.product))]):e._e(),t.manufacturer?n("q-item-tile",{attrs:{sublabel:""}},[e._v("manufacturer: "+e._s(t.manufacturer))]):e._e(),t.description?n("q-item-tile",{attrs:{sublabel:""}},[e._v("description: "+e._s(t.description))]):e._e()],1)],1)})],2)],1)])],1)],1)])},gr=[];yr._withStripped=!0;var _r={name:"FormSchemaSerialPort",mixins:[yt["FormComponent"]],data:function(){return{ports:[],loading:!0,loaded:!1}},methods:{show:function(){this.loaded||(this.loaded=!0),this.refresh()},refresh:function(){var e=this;this.loading=!0,vt.a.request({url:"utils/serial_ports_list",dataType:"json"}).then(function(t){e.ports=t}).finally(function(){e.loading=!1})}}},wr=_r,$r=Object(Ce["a"])(wr,yr,gr,!1,null,null,null);$r.options.__file="SerialPort.vue";var xr=$r.exports,Cr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-week-calendar"},[e.c_value&&e.c_value.length?n("div",e._l(e.c_value,function(t,i){return n("q-item",{key:i,attrs:{dense:""}},[n("q-item-side",{attrs:{icon:"schedule"}}),n("q-item-main",[n("q-item-tile",{attrs:{label:""}},[e._v(e._s(e.toString(t)))])],1)],1)})):n("div",{staticClass:"q-ma-md text-faded"},[e._v("\n    no scheduling\n  ")]),n("q-btn",{attrs:{color:"blue-5",label:"Select",icon:"add",flat:""},on:{click:function(t){e.modal=!0}}}),n("modal",{attrs:{title:"Scheduler",icon:"schedule","valid-btn-hide":"","cancel-btn-label":"Close","cancel-btn-color":"faded"},model:{value:e.modal,callback:function(t){e.modal=t},expression:"modal"}},[n("div",{staticClass:"overflow-hidden"},[n("div",{staticClass:"row gutter-xs non-selectable"},e._l(e.days,function(t){return n("div",{staticClass:"col day"},[n("div",{staticClass:"column"},[n("div",{staticClass:"col-auto header q-py-md text-center"},[n("span",{staticClass:"gt-xs"},[e._v(e._s(t.name))]),n("span",{staticClass:"xs"},[e._v(e._s(e.printSmall(t.name)))])]),e._l(t.hours,function(t){return n("div",{staticClass:"col-auto hour q-pa-xs",class:{selected:t.selected},on:{mousedown:function(n){e.select(t)},mouseover:function(n){e.mouseOver(n,t)},mouseup:e.updateValue}},[e._v("\n              "+e._s(t.index)+"\n            ")])})],2)])}))])])],1)},kr=[];Cr._withStripped=!0;n("6c7b");var qr=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Sr={name:"FormSchemaWeekCalendar",mixins:[yt["FormComponent"]],data:function(){return{days:this.fromValue(this.c_value),selectMode:!0,modal:!1}},methods:{select:function(e){e.selected=!e.selected,this.selectMode=e.selected},mouseOver:function(e,t){1===e.buttons&&(t.selected=this.selectMode)},updateValue:function(){var e=[];this.days.forEach(function(t,n){var i=n,r=!1,a=null;t.hours.forEach(function(t){t.selected!=r&&(t.selected?a={start:{weekDay:i,hour:t.index}}:(a.end={weekDay:i,hour:t.index},e.push(a),a=null)),r=t.selected}),a&&(a.end={weekDay:i,hour:24},e.push(a),a=null)}),this.c_value=e},inSelection:function(e,t,n){var i=function(e,t){return 100*e+t};for(var r in e){var a=i(e[r].start.weekDay,e[r].start.hour),o=i(e[r].end.weekDay,e[r].end.hour),s=i(t,n);if(s>=a&&s<o)return!0}return!1},fromValue:function(e){var t=this,n=qr.map(function(n,i){return{name:n,hours:Array(24).fill(0).map(function(n,r){return{index:r,selected:!!e&&t.inSelection(e,i,r)}})}});return n},toString:function(e){return e.start.weekDay===e.end.weekDay?qr[e.start.weekDay]+" "+e.start.hour+"h - "+e.end.hour+"h":qr[e.start.weekDay]+" "+e.start.hour+"h - "+qr[e.end.weekDay]+" "+e.end.hour+"h"},printSmall:function(e){return e.substring(0,3)}},mounted:function(){this.updateValue()}},Or=Sr,jr=(n("a658"),Object(Ce["a"])(Or,Cr,kr,!1,null,"542f3464",null));jr.options.__file="WeekCalendar.vue";var Er=jr.exports,Dr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-array-modal"},[n("div",[n("q-btn",{attrs:{flat:"",size:"md",label:"Add item",icon:"add"},on:{click:e.addItem}})],1),e._l(e.items,function(t,i){return n("div",{key:i,staticClass:"formField"},[n("div",{staticClass:"row items-center"},[n("div",{staticClass:"label col text-faded"},[n("q-icon",{attrs:{name:"keyboard_arrow_right",color:"primary"}}),e._v("\n        "+e._s(e.getLabel(i))+"\n      ")],1),i>0?n("q-btn",{staticClass:"col-auto",attrs:{flat:"",size:"sm",color:"secondary",icon:"arrow_drop_up"},on:{click:function(t){e.moveItem(i,"up")}}}):e._e(),i<e.items.length-1?n("q-btn",{staticClass:"col-auto",attrs:{flat:"",size:"sm",color:"secondary",icon:"arrow_drop_down"},on:{click:function(t){e.moveItem(i,"down")}}}):e._e(),n("q-btn",{staticClass:"col-auto",attrs:{flat:"",size:"sm",color:"secondary",label:"edit",icon:"edit"},on:{click:function(t){e.editItem(i)}}}),n("q-btn",{staticClass:"col-auto",attrs:{flat:"",size:"sm",color:"negative",label:"remove",icon:"delete"},on:{click:function(t){e.removeItem(i)}}})],1)])}),n("modal",{attrs:{title:"Add item",icon:"add","valid-btn-disable":e.edit.error,"valid-btn-label":"Add"},on:{valid:e.onEditDone},model:{value:e.edit.show,callback:function(t){e.$set(e.edit,"show",t)},expression:"edit.show"}},[n("form-schema",{attrs:{schema:e.schema.items||{},value:e.edit.model},on:{input:function(t){e.edit.model=t},error:function(t){e.edit.error=t}}})],1)],2)},Ir=[];Dr._withStripped=!0;var Tr={name:"FormSchemaArrayModal",mixins:[yt["FormComponent"]],data:function(){return{items:[],edit:{show:!1,model:void 0,error:!1}}},watch:{model:function(){this.refreshFromModel()}},validations:function(){var e={};return"number"===typeof this.c_schema.minItems&&(e.minLength=Object(Ht["minLength"])(this.c_schema.minItems)),"number"===typeof this.c_schema.maxItems&&(e.maxLength=Object(Ht["maxLength"])(this.c_schema.maxItems)),{c_value:e}},methods:{refreshFromModel:function(){var e=this;this.items=(this.c_value||[]).map(function(t){return{schema:e.c_schema.items||{}}})},getLabel:function(e){var t=this.c_value._label;return"string"===typeof t?t:"function"===typeof t?t.call(this,e,this.c_value[e]):-1!==["string","boolean","integer","int","long","number","float","double"].indexOf(this.c_schema.items.type)?String(this.c_value[e]):"item #"+e},getModel:function(e){return Array.isArray(this.c_value)&&e<this.c_value.length?this.c_value[e]:void 0},addItem:function(){this.edit.key=-1,this.edit.model=void 0,this.edit.show=!0},onEditDone:function(){-1===this.edit.key?this.c_value.push(this.edit.model):this.$set(this.c_value,this.edit.key,this.edit.model),this.edit.show=!1},removeItem:function(e){this.items.splice(e,1),this.c_value.splice(e,1)},moveItem:function(e,t){var n=this.c_value.splice(e,1);this.c_value.splice(e+("up"===t?-1:1),0,n[0])},editItem:function(e){this.edit.key=e,this.edit.model=this.c_value[e],this.edit.show=!0},onChildValueChange:function(e,t){this.$set(this.c_value,e,t)},onChildErrorChange:function(e,t){this.items[e].error=t,this.$emit("error",Object.values(this.items).some(function(e){return e.error}))}},mounted:function(){this.refreshFromModel()}},Fr=Tr,Wr=(n("6dc1"),Object(Ce["a"])(Fr,Dr,Ir,!1,null,"33ba09a8",null));Wr.options.__file="ArrayModal.vue";var Ar=Wr.exports,Mr={BluetoothInterface:ni,Editor:ci,EthingFlowNode:wi,EthingResource:$i["a"],Cron:Di,Host:Pi,Oneof:Yi,Optional:tr,Scheduler:dr,Scope:br,SerialPort:xr,WeekCalendar:Er,ArrayModal:Ar};for(var Lr in Jn)yt["coreComponents"].push(Jn[Lr]);for(var Br in Mr)yt["registerForm"](Mr[Br]);var Rr=function(e){var t=e.Vue;t.component("FormSchema",$t),t.config.optionMergeStrategies.validations=t.config.optionMergeStrategies.data},Ur=n("bc3a"),Pr=n.n(Ur),Hr=function(e){var t=e.Vue;t.prototype.$axios=Pr.a,window&&(window.axios=Pr.a)},Vr=Fe(),Nr=Vr.app,Qr=Vr.store,zr=Vr.router;[Le,Re,He,rt,mt,bt,Rr,Hr].forEach(function(e){e({app:Nr,router:zr,store:Qr,Vue:i["default"],ssrContext:null})}),new i["default"](Nr)},"2faf":function(e,t,n){},"3a02":function(e,t,n){"use strict";var i=n("f2a8"),r=n.n(i);r.a},"3bef":function(e,t,n){},"3ce8":function(e,t,n){"use strict";var i=n("cfe2"),r=n.n(i);r.a},"409c":function(e,t,n){"use strict";var i=n("d776"),r=n.n(i);r.a},"4a6c":function(e,t,n){"use strict";var i=n("2ce3"),r=n.n(i);r.a},"4fd8":function(e,t,n){},5639:function(e,t,n){},5876:function(e,t,n){"use strict";var i=n("4fd8"),r=n.n(i);r.a},"5a31":function(e,t,n){"use strict";var i=n("2faf"),r=n.n(i);r.a},"5bff":function(e,t,n){"use strict";var i=n("5639"),r=n.n(i);r.a},"5f55":function(e,t,n){},"64fd":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-ething-resource"},[n("resource-select",{attrs:{value:e.c_value,filter:e.computed_filter,multiple:e.multiple,"use-id":"","create-types":e.createTypes},on:{input:function(t){e.c_value=t}}})],1)},r=[];i._withStripped=!0;var a=n("ffbd"),o=n("f44e"),s={name:"FormSchemaEthingResource",mixins:[o["FormComponent"]],components:{ResourceSelect:a["a"]},computed:{multiple:function(){return"array"===this.c_schema.type},computed_filter:function(){var e=this,t=this.c_schema;return function(n){return e.filter(n,t)}},createTypes:function(){var e=this,t=[];return this.c_schema["$onlyTypes"]&&(t=t.concat(this.c_schema["$onlyTypes"])),this.c_schema["$must_throw"]&&this.$ethingUI.iterate("resources",function(n){var i=e.$ethingUI.get(n);-1!==i.signals.indexOf(e.c_schema["$must_throw"])&&t.push(n)}),t}},methods:{filter:function(e,t){var n;if(t["$must_throw"]){n=!1;var i=this.$ethingUI.get(e).signals;for(var r in i)if(this.$ethingUI.isSubclass(i[r],t["$must_throw"])){n=!0;break}if(!n)return!1}if(t["$onlyTypes"]){n=!1;var a=t["$onlyTypes"];for(var r in a)if(e.isTypeof(a[r])){n=!0;break}if(!n)return!1}return!(t["$filter"]&&!t["$filter"].call(t,e))}}},l=s,c=(n("7ac6"),n("2877")),u=Object(c["a"])(l,i,r,!1,null,"98797c06",null);u.options.__file="EthingResource.vue";t["a"]=u.exports},6659:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-item",{staticClass:"item",attrs:{link:!e.readonly},nativeOn:{click:function(t){e.open(e.resource)}}},[e._l(e.level,function(t){return n("div",{class:e.gen(t)})}),n("q-item-side",{attrs:{icon:e.meta.icon,inverted:"",color:e.meta.color}}),n("q-item-main",[n("q-item-tile",{attrs:{label:""}},[n("span",{staticClass:"vertical-middle text-black"},[e._v(e._s(e.resource.basename()))]),e.showParent?n("small",{staticClass:"parent text-faded vertical-bottom on-right",class:e.readonly?"":"cursor-pointer",on:{click:function(t){t.stopPropagation(),e.open(e.createdBy)}}},[e._v(e._s(e.createdBy.basename()))]):e._e(),e.showConnected&&!e.resource.connected()?n("q-icon",{staticClass:"vertical-middle on-right",attrs:{name:"mdi-lan-disconnect",color:"warning"}}):e._e(),e.resource.public()?n("q-icon",{staticClass:"vertical-middle on-right",attrs:{name:"share",color:"warning"}}):e._e()],1),n("q-item-tile",{attrs:{sublabel:""}},[e._v(e._s(e.$ethingUI.utils.dateToString(e.date)))]),e.showType?n("q-item-tile",{attrs:{sublabel:""}},[e._v(e._s(e.meta.title))]):e._e(),e.showBattery?n("q-item-tile",{staticClass:"lt-sm",attrs:{sublabel:""}},[e._v("battery: "+e._s(e.resource.battery())+"%")]):e._e(),e.showLocation?n("q-item-tile",{staticClass:"lt-sm",attrs:{sublabel:""}},[e._v("location: "+e._s(e.resource.location()))]):e._e(),e.showSize?n("q-item-tile",{attrs:{sublabel:""}},[e._v(e._s(e.$ethingUI.utils.sizeToString(e.resource.size())))]):e._e(),e.showLength?n("q-item-tile",{attrs:{sublabel:""}},[e._v(e._s(e.resource.length())+" rows")]):e._e(),e.showError?n("q-item-tile",{attrs:{sublabel:"",color:"negative"}},[n("q-icon",{attrs:{name:"mdi-alert"}}),e._v(" "+e._s(e.resource.attr("error")))],1):e._e()],1),Object.keys(e.data).length>0?n("q-item-side",{staticClass:"data gt-sm ellipsis",attrs:{right:""}},[e._v("\n    "+e._s(e.$ethingUI.utils.describe(e.data))+"\n  ")]):e._e(),e.showLocation?n("q-item-side",{staticClass:"gt-xs",attrs:{right:""}},[n("q-chip",{attrs:{small:"",detail:"",icon:"location_on"}},[e._v("\n      "+e._s(e.resource.location())+"\n    ")])],1):e._e(),e.showBattery?n("q-item-side",{staticClass:"gt-xs",attrs:{right:""}},[n("resource-battery-chip",{attrs:{resource:e.resource}})],1):e._e(),e.readonly?e._e():[e.showChart?n("q-item-side",{staticClass:"gt-xs",attrs:{right:""}},[n("q-btn",{attrs:{icon:"mdi-chart-line",round:"",flat:"",dense:"",color:"secondary"},on:{click:function(t){return t.stopPropagation(),e.chart(t)}}})],1):e._e(),e.showDownload?n("q-item-side",{staticClass:"gt-xs",attrs:{right:""}},[n("q-btn",{attrs:{icon:"cloud_download",round:"",flat:"",dense:"",color:"secondary"},on:{click:function(t){return t.stopPropagation(),e.download(t)}}})],1):e._e(),n("q-item-side",{staticClass:"gt-xs",attrs:{right:""}},[n("q-btn",{attrs:{icon:"delete",round:"",flat:"",dense:""},on:{click:function(t){return t.stopPropagation(),e.remove(t)}}})],1),n("q-item-side",{staticClass:"gt-xs",attrs:{right:""}},[n("q-btn",{attrs:{icon:"settings",round:"",flat:"",dense:""},on:{click:function(t){return t.stopPropagation(),e.settings(t)}}})],1),n("q-item-side",{staticClass:"lt-sm",attrs:{right:""}},[n("q-btn",{attrs:{icon:"more_vert",round:"",flat:"",dense:""},on:{click:function(t){return t.stopPropagation(),e.more(t)}}})],1)]],2)},r=[];i._withStripped=!0;n("7f7f"),n("c5f6");var a=n("691a"),o={name:"ResourceQItem",components:{ResourceBatteryChip:a["a"]},props:{resource:{},level:{type:Number,default:0},noParent:Boolean,readonly:Boolean},data:function(){return{}},computed:{date:function(){var e=this.resource.modifiedDate();if(this.resource instanceof this.$ething.Device){var t=this.resource.lastSeenDate();if(t&&t>e)return t}return e},createdBy:function(){return this.resource.createdBy()?this.$ething.arbo.get(this.resource.createdBy()):null},showParent:function(){return!this.noParent&&!!this.createdBy},showType:function(){return this.resource instanceof this.$ething.Device},showConnected:function(){return this.resource instanceof this.$ething.Device},showError:function(){return this.resource instanceof this.$ething.Device&&this.resource.attr("error")},showBattery:function(){return this.resource instanceof this.$ething.Device&&this.resource.hasBattery()},showLocation:function(){return this.resource instanceof this.$ething.Device&&this.resource.location()},showSize:function(){return this.resource instanceof this.$ething.File},showLength:function(){return this.resource instanceof this.$ething.Table},showChart:function(){return this.resource instanceof this.$ething.Table&&this.resource.length()},showDownload:function(){return this.resource instanceof this.$ething.File||this.resource instanceof this.$ething.Table},meta:function(){return this.$ethingUI.get(this.resource)},data:function(){return this.meta.data||{}}},methods:{gen:function(e){return["pad","pad-"+e]},batteryIcon:function(e){return e>95?"mdi-battery":e>85?"mdi-battery-90":e>75?"mdi-battery-80":e>65?"mdi-battery-70":e>55?"mdi-battery-60":e>45?"mdi-battery-50":e>35?"mdi-battery-40":e>25?"mdi-battery-30":e>15?"mdi-battery-20":e>=0?"mdi-battery-alert":"battery unknown"},batteryColor:function(e){return e<=15?"negative":e<=40?"warning":void 0},settings:function(){this.$router.push("/resource/"+this.resource.id())},more:function(){var e=this,t=[];this.showChart&&t.push({label:"Plot chart",color:"secondary",icon:"mdi-chart-line",handler:function(){return e.chart()}}),t.push({label:"Delete",color:"negative",icon:"delete",handler:function(){return e.remove()}}),t.push({label:"Settings",icon:"settings",handler:function(){e.settings()}}),this.$q.actionSheet({title:this.resource.basename(),actions:t}).catch(function(){})},remove:function(){var e=this,t=this.resource.name(),n=this.$ething.arbo.list().filter(function(t){return t.createdBy()===e.resource.id()}),i=[];return n.length&&i.push({label:"Remove also the children resources",value:"removeChildren",color:"secondary"}),this.$q.dialog({title:"Remove",message:"Do you really want to remove definitely the "+this.resource.type()+' "'+this.resource.name()+'" ?',options:{type:"checkbox",model:[],items:i},ok:"Remove",cancel:"Cancel"}).then(function(n){e.resource.remove(-1!==n.indexOf("removeChildren")).then(function(){e.$q.notify('"'+t+'" removed !')})})},chart:function(){this.$router.push("/chart/"+this.resource.id())},download:function(){var e=this;this.resource instanceof this.$ething.File?this.$ething.request({url:this.resource.getContentUrl(),dataType:"blob"}).then(function(t){e.$ethingUI.utils.saveAs(t,e.resource.basename())}):this.resource instanceof this.$ething.Table&&this.$q.dialog({title:'Download "'+this.resource.name()+'"',message:"Format: ",options:{type:"radio",model:"csv",items:[{label:"CSV",value:"csv"},{label:"JSON",value:"json_pretty"}]},cancel:!0,preventClose:!0,color:"secondary"}).then(function(t){e.$ething.request({url:e.resource.getContentUrl()+"?fmt="+t,dataType:"blob"}).then(function(n){e.$ethingUI.utils.saveAs(n,e.resource.basename()+"."+("json_pretty"==t?"json":t))})})},open:function(e){this.readonly||this.$ethingUI.open(e)}}},s=o,l=(n("ea44"),n("2877")),c=Object(l["a"])(s,i,r,!1,null,"16e4c67f",null);c.options.__file="ResourceQItem.vue";t["a"]=c.exports},"688f":function(e,t,n){"use strict";var i=n("fd77"),r=n.n(i);r.a},"691a":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return"number"===typeof e.battery?n("q-chip",e._b({attrs:{small:"",detail:"",icon:e.batteryIcon(e.battery),color:e.batteryColor(e.battery)}},"q-chip",e.$attrs,!1),[e._v("\n  "+e._s(e.battery)+"%\n")]):e._e()},r=[];i._withStripped=!0;var a={name:"ResourceBatteryChip",props:{resource:{}},data:function(){return{}},computed:{battery:function(){return this.resource.battery()}},methods:{batteryIcon:function(e){return e>95?"mdi-battery":e>85?"mdi-battery-90":e>75?"mdi-battery-80":e>65?"mdi-battery-70":e>55?"mdi-battery-60":e>45?"mdi-battery-50":e>35?"mdi-battery-40":e>25?"mdi-battery-30":e>15?"mdi-battery-20":e>=0?"mdi-battery-alert":"battery unknown"},batteryColor:function(e){return e<=15?"negative":e<=40?"warning":void 0}}},o=a,s=n("2877"),l=Object(s["a"])(o,i,r,!1,null,null,null);l.options.__file="ResourceBatteryChip.vue";t["a"]=l.exports},"6a65":function(e,t,n){"use strict";var i=n("268c"),r=n.n(i);r.a},"6b5b":function(e,t,n){},"6b60":function(e,t,n){"use strict";var i=n("80fb"),r=n.n(i);r.a},"6c9f":function(e,t,n){},"6dc1":function(e,t,n){"use strict";var i=n("6c9f"),r=n.n(i);r.a},"74b6":function(e,t,n){},"7ac6":function(e,t,n){"use strict";var i=n("1847"),r=n.n(i);r.a},"7e6d":function(e,t,n){},"80c5":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"row cell"},[n("div",{staticClass:"col-xs-12 col-sm-3 title text-bold"},[e._v("\n      Schedule\n    ")]),n("div",{staticClass:"col-xs-12 col-sm-9 cell-content"},[n("div",{staticClass:"text-faded"},[e._v("\n        Select the schedule that the trigger should run on.\n      ")]),n("q-list",{attrs:{"no-border":""}},[n("q-item",{attrs:{tag:"label"}},[n("q-item-side",[n("q-radio",{attrs:{val:"daily"},model:{value:e.model.schedule,callback:function(t){e.$set(e.model,"schedule",t)},expression:"model.schedule"}})],1),n("q-item-main",[n("q-item-tile",{attrs:{label:""}},[e._v("Daily")]),n("q-item-tile",{attrs:{sublabel:""}},[e._v("Allows you to configure a trigger that will run once, hourly or minutely daily")])],1)],1),n("q-item",{attrs:{tag:"label"}},[n("q-item-side",[n("q-radio",{attrs:{val:"weekly"},model:{value:e.model.schedule,callback:function(t){e.$set(e.model,"schedule",t)},expression:"model.schedule"}})],1),n("q-item-main",[n("q-item-tile",{attrs:{label:""}},[e._v("Days per week")]),n("q-item-tile",{attrs:{sublabel:""}},[e._v("Allows you to configure a trigger that will run once, hourly or minutely on certain days of the week")])],1)],1),n("q-item",{attrs:{tag:"label"}},[n("q-item-side",[n("q-radio",{attrs:{val:"monthly"},model:{value:e.model.schedule,callback:function(t){e.$set(e.model,"schedule",t)},expression:"model.schedule"}})],1),n("q-item-main",[n("q-item-tile",{attrs:{label:""}},[e._v("Days per month")]),n("q-item-tile",{attrs:{sublabel:""}},[e._v("Allows you to configure a trigger that will run on a specific date of the month or specific day of the week")])],1)],1),n("q-item",{attrs:{tag:"label"}},[n("q-item-side",[n("q-radio",{attrs:{val:"cron"},model:{value:e.model.schedule,callback:function(t){e.$set(e.model,"schedule",t)},expression:"model.schedule"}})],1),n("q-item-main",[n("q-item-tile",{attrs:{label:""}},[e._v("Cron expression")]),n("q-item-tile",{attrs:{sublabel:""}},[e._v("Allows you to configure a trigger that will run according to the specific CRON expression")])],1)],1)],1)],1)]),"weekly"==e.model.schedule?n("div",{staticClass:"row cell"},[n("div",{staticClass:"col-xs-12 col-sm-3 title text-bold"},[e._v("\n      Run Days\n    ")]),n("div",{staticClass:"col-xs-12 col-sm-9 cell-content"},[n("div",{staticClass:"text-faded"},[e._v("\n        Select what days of the week the scheduler should execute.\n      ")]),n("div",{staticClass:"q-my-md"},e._l(e.weekdays,function(t){return n("q-checkbox",{key:t,staticClass:"q-mr-md q-my-sm",attrs:{val:t,label:t},model:{value:e.model.days,callback:function(t){e.$set(e.model,"days",t)},expression:"model.days"}})}))])]):e._e(),"monthly"==e.model.schedule?n("div",{staticClass:"row cell"},[n("div",{staticClass:"col-xs-12 col-sm-3 title text-bold"},[e._v("\n      On\n    ")]),n("div",{staticClass:"col-xs-12 col-sm-9 cell-content"},[n("div",{staticClass:"text-faded"},[e._v("\n        Select when in the month the trigger should execute\n      ")]),n("q-list",{attrs:{"no-border":""}},[n("q-item",{attrs:{tag:"label"}},[n("q-item-side",[n("q-radio",{attrs:{val:"day"},model:{value:e.model.on,callback:function(t){e.$set(e.model,"on",t)},expression:"model.on"}})],1),n("q-item-main",[n("q-item-tile",{attrs:{label:""}},[e._v("Specific date of every month")])],1)],1),n("q-item",{attrs:{tag:"label"}},[n("q-item-side",[n("q-radio",{attrs:{val:"weekday"},model:{value:e.model.on,callback:function(t){e.$set(e.model,"on",t)},expression:"model.on"}})],1),n("q-item-main",[n("q-item-tile",{attrs:{label:""}},[e._v("Specific day of week of every month")])],1)],1)],1),"day"==e.model.on?n("div",[e._v("\n        The\n        "),n("q-select",{staticClass:"inline",attrs:{options:e.onMonthlyDaysOptions,"hide-underline":""},model:{value:e.model.onDay,callback:function(t){e.$set(e.model,"onDay",t)},expression:"model.onDay"}}),e._v("\n        of every month\n      ")],1):e._e(),"weekday"==e.model.on?n("div",[e._v("\n        The\n        "),n("q-select",{staticClass:"inline",attrs:{options:[{label:"First",value:1},{label:"Second",value:2},{label:"Third",value:3},{label:"Fourth",value:4}],"hide-underline":""},model:{value:e.model.onWeekdayOrdinal,callback:function(t){e.$set(e.model,"onWeekdayOrdinal",t)},expression:"model.onWeekdayOrdinal"}}),n("q-select",{staticClass:"inline",attrs:{options:e.onMonthlyWeekdaysOptions,"hide-underline":""},model:{value:e.model.onWeekday,callback:function(t){e.$set(e.model,"onWeekday",t)},expression:"model.onWeekday"}}),e._v("\n        of every month\n      ")],1):e._e()],1)]):e._e(),"daily"==e.model.schedule||"weekly"==e.model.schedule?n("div",{staticClass:"row cell"},[n("div",{staticClass:"col-xs-12 col-sm-3 title text-bold"},[e._v("\n      Interval\n    ")]),n("div",{staticClass:"col-xs-12 col-sm-9 cell-content"},[n("q-select",{staticClass:"inline",attrs:{options:[{label:"Runs once",value:"once"},{label:"Every x hours",value:"repeatHours"},{label:"Every x minutes",value:"repeatMinutes"}],"hide-underline":""},model:{value:e.model.interval,callback:function(t){e.$set(e.model,"interval",t)},expression:"model.interval"}})],1)]):e._e(),"monthly"==e.model.schedule||("daily"==e.model.schedule||"weekly"==e.model.schedule)&&"once"==e.model.interval?n("div",{staticClass:"row cell"},[n("div",{staticClass:"col-xs-12 col-sm-3 title text-bold"},[e._v("\n      Start Time\n    ")]),n("div",{staticClass:"col-xs-12 col-sm-9 cell-content"},[e._v("\n\n      Starting at\n      "),n("q-datetime",{staticClass:"inline",attrs:{type:"time",format24h:"","hide-underline":""},model:{value:e.model.startTime,callback:function(t){e.$set(e.model,"startTime",t)},expression:"model.startTime"}})],1)]):e._e(),"daily"!=e.model.schedule&&"weekly"!=e.model.schedule||"repeatHours"!=e.model.interval&&"repeatMinutes"!=e.model.interval?e._e():n("div",{staticClass:"row cell"},[n("div",{staticClass:"col-xs-12 col-sm-3 title text-bold"},[e._v("\n      Repeat\n    ")]),n("div",{staticClass:"col-xs-12 col-sm-9 cell-content"},[e._v("\n      Every\n      "),n("q-select",{staticClass:"inline",attrs:{options:"repeatHours"==e.model.interval?e.everyHoursOptions:e.everyMinutesOptions,"hide-underline":""},model:{value:e.model.every,callback:function(t){e.$set(e.model,"every",t)},expression:"model.every"}}),"repeatHours"==e.model.interval?n("span",[e._v("\n        hours\n      ")]):n("span",[e._v("\n        minutes\n      ")])],1)]),"cron"==e.model.schedule?n("div",{staticClass:"row cell"},[n("div",{staticClass:"col-xs-12 col-sm-3 title text-bold"},[e._v("\n      Cron Expression\n    ")]),n("div",{staticClass:"col-xs-12 col-sm-9 cell-content"},[n("div",{staticClass:"text-faded"},[e._v("\n        Enter the cron expression to configure when the trigger shoud execute\n      ")]),n("q-input",{staticClass:"q-my-md",attrs:{placeholder:"min hour day month weekday","hide-underline":"","float-label":"Cron expression"},model:{value:e.model.cron,callback:function(t){e.$set(e.model,"cron",t)},expression:"model.cron"}})],1)]):e._e()])},r=[];i._withStripped=!0;n("28a5"),n("f751");var a=n("f490"),o={name:"Cron",props:["value"],data:function(){for(var e=[],t=1;t<=12;t++)e.push({label:String(t),value:t});var n=[];for(t=1;t<=59;t++)n.push({label:String(t),value:t});var i=[];for(t=1;t<=31;t++)i.push({label:String(t),value:t});var r=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"];return{model:Object.assign({schedule:"daily",interval:"once",startTime:a["d"].buildDate({hours:15,minutes:0}),every:1,days:[],on:"day",onDay:1,onWeekdayOrdinal:1,onWeekday:"monday",cron:this.value||"* 1 * * *"},this.value?this.unserialize(this.value):null),weekdays:r,everyHoursOptions:e,everyMinutesOptions:n,onMonthlyWeekdaysOptions:r.map(function(e){return{label:e,value:e}}),onMonthlyDaysOptions:i,cron:""}},watch:{model:{handler:function(){this.cron=this.serialize()},deep:!0,immediate:!0},cron:{handler:function(e){this.$emit("input",e)},immediate:!0}},methods:{weekdayToIndex:function(e){var t=this.weekdays.indexOf(e)+1;return 7==t&&(t=0),t},indexToWeekday:function(e){return e=parseInt(e),0==e&&(e=7),this.weekdays[e-1]},serialize:function(){var e=this,t=this.model;if("cron"==t.schedule)return t.cron;if("daily"==t.schedule||"weekly"==t.schedule){var n="*";if("weekly"==t.schedule&&(n=t.days.map(function(t){return e.weekdayToIndex(t)}).join(","),n||(n="*")),"once"==t.interval){var i=t.startTime.getHours(),r=t.startTime.getMinutes();return r+" "+i+" * * "+n}if("repeatHours"==t.interval){var a=t.every||1;return 1==a?"0 * * * "+n:"0 */"+a+" * * "+n}if("repeatMinutes"==t.interval){a=t.every||1;return 1==a?"* * * * "+n:"*/"+a+" * * * "+n}}if("monthly"==t.schedule){i=t.startTime.getHours(),r=t.startTime.getMinutes();if("day"==t.on){var o=t.onDay||1;return r+" "+i+" "+o+" * *"}if("weekday"==t.on){n=["1-7","8-14","15-21","22-28"];return r+" "+i+" "+n[t.onWeekdayOrdinal-1]+" * "+this.weekdayToIndex(t.onWeekday)}}},unserialize:function(e){var t=this,n={},i=e.split(" "),r=/^[0-9]+$/,o=/^\*\/[0-9]+$/;if(5===i.length)if(r.test(i[0])&&r.test(i[1])&&(n.startTime=a["d"].buildDate({hours:parseInt(i[1]),minutes:parseInt(i[0])})),"*"==i[2]&&"*"==i[3]){var s="daily";if("*"!=i[4]&&(s=null,/^[0-6](,[0-6])*$/.test(i[4])&&(s="weekly",n.days=i[4].split(",").map(function(e){return t.indexToWeekday(e)}))),s){if(r.test(i[0])&&r.test(i[1]))return n.schedule=s,n.interval="once",n;if("0"==i[0]&&o.test(i[1]))return n.schedule=s,n.interval="repeatHours",n.every=parseInt(i[1].substr(2)),n;if("0"==i[0]&&"*"==i[1])return n.schedule=s,n.interval="repeatHours",n.every=1,n;if("*"==i[1]&&o.test(i[0]))return n.schedule=s,n.interval="repeatMinutes",n.every=parseInt(i[0].substr(2)),n;if("*"==i[1]&&"*"==i[0])return n.schedule=s,n.interval="repeatMinutes",n.every=1,n}}else if("*"!=i[2]&&"*"==i[3]){if(r.test(i[2])&&"*"==i[4])return n.schedule="monthly",n.on="day",n.onDay=parseInt(i[2]),n;var l=["1-7","8-14","15-21","22-28"];if(/^[0-6]$/.test(i[4])&&-1!==l.indexOf(i[2]))return n.schedule="monthly",n.on="weekday",n.onWeekdayOrdinal=l.indexOf(i[2])+1,n.onWeekday=this.indexToWeekday(i[4]),n}return n.schedule="cron",n.cron=e,n}}},s=o,l=(n("dce1"),n("2877")),c=Object(l["a"])(s,i,r,!1,null,"84122568",null);c.options.__file="Cron.vue";t["a"]=c.exports},"80fb":function(e,t,n){},"8b81":function(e,t,n){},"8ec6":function(e,t,n){},9023:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"widget",class:{"widget-err":e.hasError},style:e.style},[e.hasError?n("div",{staticClass:"widget-err-layer fit"},[n("div",{staticClass:"absolute-center text-center ellipsis-3-lines q-caption"},[e._v("\n          "+e._s(e.error||"error")+"\n      ")])]):e._e(),n("div",{staticClass:"widget-content-layer",class:e.inline?"":"fit"},[n(e.component,e._b({ref:"inner",tag:"component",on:{error:function(t){e.error=t}}},"component",e.$attrs,!1))],1)])},r=[];i._withStripped=!0;n("c5f6");var a=n("25d4"),o={name:"Widget",components:a["e"],inheritAttrs:!1,props:{component:{},minWidth:Number,minHeight:Number,inline:Boolean},data:function(){return{error:!1,widgetInstance:null}},computed:{style:function(){var e={},t=this.widgetInstance;return t&&(e["background-color"]=t.bgColor||"#FFFFFF",e["color"]=t.color||"#027be3",this.minWidth&&(e.minWidth=this.minWidth+"px",this.inline&&(e.width=e.minWidth)),this.minHeight&&(e.minHeight=this.minHeight+"px",e.height=this.inline?e.minHeight:"1px")),e},hasError:function(){return!!this.error}},mounted:function(){this.widgetInstance=this.$refs.inner},methods:{hasContentOverflow:function(){var e=null;return this.widgetInstance&&(e=this.widgetInstance.$el),!!e&&e.scrollWidth>e.clientWidth}}},s=o,l=(n("5a31"),n("2877")),c=Object(l["a"])(s,i,r,!1,null,null,null);c.options.__file="Widget.vue";t["a"]=c.exports},"90ee":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("strong",[e._v(e._s(e.node.name))])},r=[];i._withStripped=!0;var a={name:"NodeBase",props:["flow","node"],metadata:{height:48,width:200}},o=a,s=n("2877"),l=Object(s["a"])(o,i,r,!1,null,null,null);l.options.__file="Base.vue";var c,u,d=l.exports,h={name:"NodeInput",mixins:[d],methods:{inject:function(e){this.$ething.request({url:"flows/"+this.flow.id()+"/inject/"+this.node.id,method:"POST",contentType:"application/json; charset=utf-8",data:e})}}},f=h,m=Object(s["a"])(f,c,u,!1,null,null,null);m.options.__file="Input.vue";var p,v,b=m.exports,y=(n("7f7f"),{name:"NodeOutput",mixins:[d],computed:{data:function(){var e=this.flow.data()[this.node.name];if("string"===typeof e)try{e=JSON.parse(e)}catch(e){}return e}}}),g=y,_=Object(s["a"])(g,p,v,!1,null,null,null);_.options.__file="Output.vue";var w=_.exports,$=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-btn",{attrs:{label:e.node.name},on:{click:e._inject}})},x=[];$._withStripped=!0;var C={name:"NodeButton",mixins:[b],methods:{_inject:function(){this.inject((new Date).getTime()/1e3)}}},k=C,q=Object(s["a"])(k,$,x,!1,null,null,null);q.options.__file="Button.vue";var S=q.exports,O=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticClass:"ellipsis"},[e._v(e._s(e.node.name)+": "+e._s(e.displayValue))])},j=[];O._withStripped=!0;var E={name:"NodeLabel",mixins:[w],computed:{displayValue:function(){return"undefined"===typeof this.data?"":String(this.data)}}},D=E,I=Object(s["a"])(D,O,j,!1,null,null,null);I.options.__file="Label.vue";var T=I.exports;t["a"]={Base:d,Input:b,Output:w,Button:S,Label:T}},9360:function(e,t,n){},"95ee":function(e,t,n){"use strict";var i=n("74b6"),r=n.n(i);r.a},"9ba1":function(e,t,n){"use strict";var i=n("c372"),r=n.n(i);r.a},"9cb0":function(e,t,n){"use strict";var i=n("fe54"),r=n.n(i);r.a},a33a:function(e,t,n){},a658:function(e,t,n){"use strict";var i=n("d394"),r=n.n(i);r.a},a8cc:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"flow-node"},[n("div",{ref:"dynW"})])},r=[];i._withStripped=!0;n("f751");var a=n("90ee"),o={name:"FlowNode",components:a["a"],props:["flow","node"],data:function(){return{instance:null}},computed:{computedFlow:function(){if("string"===typeof this.flow){var e=this.$ething.arbo.get(this.flow);if(!e)throw"The flow id="+this.flow+" does not exist anymore";return e}return this.flow},computedNode:function(){if("string"===typeof this.node){var e=this.computedFlow.attr("nodes");for(var t in e)if(e[t].id===this.node)return e[t];throw"The node id="+this.node+" from the flow id="+this.computedFlow.id()+" does not exist anymore"}return this.node},nodeType:function(){return this.$ethingUI.get(this.computedNode.type)},nodeComponent:function(){var e=this.nodeType.node||"Base";return"string"===typeof e&&(e=a["a"][e]),Vue.extend(e)},nodeComponentMeta:function(){var e=this.nodeComponent.options.metadata;return"function"===typeof e?e.call(this):e}},mounted:function(){var e=this,t=new this.nodeComponent({propsData:Object.assign({flow:this.computedFlow,node:this.computedNode},this.$attrs),parent:this});t.$on("inject",function(t){e.$emit("inject",t)}),t.$mount(this.$refs.dynW),this.instance=t},beforeDestroy:function(){this.instance&&this.instance.$destroy()},methods:{}},s=o,l=n("2877"),c=Object(l["a"])(s,i,r,!1,null,null,null);c.options.__file="FlowNode.vue";t["a"]=c.exports},afb4:function(e,t,n){},bb8d:function(e,t,n){"use strict";var i=n("a33a"),r=n.n(i);r.a},c09d:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("q-list",{attrs:{"no-border":""}},e._l(e.operations,function(t){return n("q-collapsible",{key:t.name,attrs:{icon:"keyboard_arrow_right",label:t.name,sublabel:e.operationReturnToString(t)}},[n("div",{staticClass:"content"},[t.description?n("blockquote",{staticClass:"q-my-md"},[n("vue-markdown",{staticClass:"markdown",attrs:{anchorAttributes:{target:"_blank"}}},[e._v(e._s(t.description))])],1):e._e(),e.hasParameters(t)?n("form-schema",{staticClass:"q-my-md",attrs:{schema:t.schema},on:{error:function(e){t.inputError=e}},model:{value:t.model,callback:function(n){e.$set(t,"model",n)},expression:"operation.model"}}):e._e(),n("div",{staticClass:"q-my-md"},[n("q-btn",{attrs:{loading:t.loading,disable:t.inputError,color:"primary",icon:"done",label:"execute"},on:{click:function(n){e.execute(t)}}})],1),t.error?n("q-alert",{staticClass:"q-my-md",attrs:{type:"negative"}},[e._v("\n          "+e._s(String(t.error))+"\n        ")]):e._e(),t.result?n("div",{staticClass:"result q-my-md"},["image"===t.resultType?n("img",{attrs:{src:t.result},on:{load:function(e){t.loading=!1},error:function(e){t.loading=!1,t.error="an error occured",t.result=null}}}):"audio"===t.resultType?n("audio",{attrs:{controls:"",src:t.result,type:t.resultContentType}}):"video"===t.resultType?n("video",{attrs:{controls:"",autoplay:"",src:t.result,type:t.resultContentType}}):"videoflash"===t.resultType?n("object",{staticClass:"videoplayer",attrs:{width:"425",height:"300",data:"http://releases.flowplayer.org/swf/flowplayer-3.2.18.swf",type:"application/x-shockwave-flash"}},[n("param",{attrs:{name:"movie",value:"http://releases.flowplayer.org/swf/flowplayer-3.2.18.swf"}}),n("param",{attrs:{name:"allowfullscreen",value:"true"}}),n("param",{attrs:{name:"allowscriptaccess",value:"always"}}),e._v('":{\\"url\\":\\"\' + operation.result + \'\\"},\\"playlist\\":[{\\"url\\":\\"\' + operation.result + \'\\"}]}\'" />\n          ')]):"json"===t.resultType?n("pre",{directives:[{name:"highlightjs",rawName:"v-highlightjs"}]},[n("code",{staticClass:"json"},[e._v(e._s(t.result))])]):"html"===t.resultType?n("pre",{directives:[{name:"highlightjs",rawName:"v-highlightjs"}]},[n("code",{staticClass:"html"},[e._v(e._s(t.result))])]):"xml"===t.resultType?n("pre",{directives:[{name:"highlightjs",rawName:"v-highlightjs"}]},[n("code",{staticClass:"xml"},[e._v(e._s(t.result))])]):"text"===t.resultType?n("pre",[n("code",{staticClass:"plain"},[e._v(e._s(t.result))])]):e._e()]):e._e()],1)])}))],1)},r=[];i._withStripped=!0;var a=n("7037"),o=n.n(a),s=(n("ac6a"),n("cadf"),n("456d"),n("7f7f"),n("a481"),n("426a"),n("9ce6")),l=n.n(s),c=(n("a026"),function(e){var t=document.createElement("audio");return!(!t.canPlayType||!t.canPlayType(e).replace(/no/,""))}),u=function(e){var t=document.createElement("video");return!(!t.canPlayType||!t.canPlayType(e).replace(/no/,""))},d=function(e,t){if(e instanceof Blob){var n=new window.FileReader;n.readAsText(e),n.onloadend=function(){t(n.result)}}else t(e)},h={name:"DeviceApi",components:{VueMarkdown:l.a},props:["device"],data:function(){return{operations:this.buildApi()}},computed:{},methods:{buildApi:function(){var e=this.$ethingUI.get(this.device).methods,t=[];for(var n in e){var i=e[n];t.push({name:n,description:i.description,return:i.return,inputError:!1,error:!1,loading:!1,ts:0,result:null,resultType:null,resultContentType:null,schema:{additionalProperties:!1,properties:i.arguments,required:i.required,type:"object"},model:{}})}return t},hasParameters:function(e){return Object.keys(e.schema.properties||{}).length},operationReturnToString:function(e){var t=e.return;return"string"===typeof t?t:"object"===o()(t)&&null!==t?t.type:""},execute:function(e){var t=e.return;e.ts=Date.now(),e.error=!1,e.loading=!0,e.result=null,e.resultType=null,e.resultContentType=null,/^image\//.test(t)||/^multipart\/x-mixed-replace/.test(t)||"video/x-motion-jpeg"==t||"video/x-jpeg"==t?(e.result=this.toUrl(e)+"&_ts="+e.ts,e.resultType="image"):/^audio\//.test(t)&&c(t)?(e.resultContentType=t,e.result=this.toUrl(e)+"&_ts="+e.ts,e.resultType="audio",e.loading=!1):/^video\//.test(t)?(u(t)?(e.resultContentType=t,e.result=this.toUrl(e)+"&_ts="+e.ts,e.resultType="video"):(e.result=this.toUrl(e)+"&_ts="+e.ts,e.resultType="videoflash"),e.loading=!1):this.device.execute(e.name,e.model,"blob").then(function(t){e.loading=!1;var n=t.type;t&&0!=t.size?/json/.test(n)?d(t,function(t){try{e.result=JSON.stringify(JSON.parse(t),null,"  "),e.resultType="json"}catch(n){e.error="can't parse JSON.  Raw result:\n\n"+t}}):"text/html"===n?d(t,function(t){e.result=t,e.resultType="html"}):/xml/.test(n)?d(t,function(t){e.result=t,e.resultType="xml"}):/text/.test(n)?d(t,function(t){e.result=t,e.resultType="text"}):e.error="Unable to render the response":(e.result=null,e.resultType="empty")}).catch(function(t){e.error=t}).finally(function(){e.loading=!1})},toUrl:function(e){var t="devices/"+this.device.id()+"/call/"+e.name;return e.model&&(t+="?"+this.$ething.utils.param(e.model)),this.$ething.toApiUrl(t,!0)}}},f=h,m=(n("3ce8"),n("2877")),p=Object(m["a"])(f,i,r,!1,null,"7e330b35",null);p.options.__file="DeviceApi.vue";t["a"]=p.exports},c372:function(e,t,n){},c658:function(e,t,n){"use strict";n.d(t,"d",function(){return a}),n.d(t,"b",function(){return o}),n.d(t,"e",function(){return s}),n.d(t,"c",function(){return l}),n.d(t,"a",function(){return u}),n.d(t,"f",function(){return d});n("ac6a"),n("cadf"),n("456d");var i=n("b0d5"),r=n("ed08");function a(e,t,n,i,r){n=n||{};var a=Object.keys(e).concat(Object.keys(t)).filter(function(e,t,n){return n.indexOf(e)===t});return a.forEach(function(a){var o="undefined"!==typeof n[a]?n[a]:i;o&&(e[a]=o(e[a],t[a],r))}),e}function o(e,t){return"undefined"==typeof e?t:"undefined"==typeof t?e:Object(r["isPlainObject"])(e)&&Object(r["isPlainObject"])(t)?Object(i["a"])(!0,{},e,t):t}function s(e,t,n,i){return"undefined"===typeof t?i:t}function l(e,t,n,i){e||(e={}),t||(t={}),i=i||o;var r=Object.keys(e).concat(Object.keys(t)).filter(function(e,t,n){return n.indexOf(e)===t}),a={};return r.forEach(function(r){a[r]=i(e[r],t[r],n)}),a}function c(e,t,n,i){if(!e)return t;if(!t)return e;var r=e.concat(t);return i&&(r=r.filter(function(e,t,n){return n.indexOf(e)===t})),r}var u=function(e,t,n){return c(e,t,n,!0)};function d(e,t,n){if(!e)return t;if(!t||Object(r["isEmptyObject"])(t))return e;if(Object(r["isVueComponent"])(t))return t;var a=Object(i["a"])(!0,{},t);return a.mixins=[e],a}},c7b2:function(e,t,n){"use strict";var i={};n.r(i),n.d(i,"widgets",function(){return Tt}),n.d(i,"FlowNodes",function(){return Ft["a"]}),n.d(i,"Chart",function(){return d["a"]}),n.d(i,"DeviceApi",function(){return h["a"]}),n.d(i,"FlowNode",function(){return f["a"]}),n.d(i,"ImageViewer",function(){return m["a"]}),n.d(i,"Modal",function(){return x}),n.d(i,"ResourceBatteryChip",function(){return C["a"]}),n.d(i,"ResourceEditor",function(){return k["a"]}),n.d(i,"ResourceQItem",function(){return q["a"]}),n.d(i,"ResourceSelect",function(){return S["a"]}),n.d(i,"Widget",function(){return O["a"]});n("551c"),n("a481"),n("28a5"),n("f751"),n("7f7f"),n("cadf"),n("456d"),n("ac6a");var r=n("426a"),a=n.n(r),o=n("f9d8"),s=n("133b"),l=n("4328"),c=n.n(l),u=n("ed08"),d=n("0292"),h=(n("80c5"),n("c09d")),f=n("a8cc"),m=n("e700"),p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-modal",e._b({ref:"modal",staticClass:"column",attrs:{value:e.value,"content-css":e.contentCss},on:{input:function(t){e.$emit("input",t)},show:function(t){e.$emit("show",t)},"escape-key":function(t){e.$emit("cancel")},dismiss:function(t){e.$emit("cancel")}}},"q-modal",e.$attrs,!1),[n("q-modal-layout",{attrs:{"header-class":"no-shadow","footer-class":"no-shadow"}},[e.title?n("q-toolbar",{attrs:{slot:"header"},slot:"header"},[e.icon?n("q-icon",{staticClass:"q-ml-sm",attrs:{name:e.icon}}):e._e(),n("q-toolbar-title",[e._v("\n        "+e._s(e.title)+"\n      ")]),e.$attrs["no-esc-dismiss"]?e._e():n("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"close"},on:{click:e.onCloseBtnClick}})],1):e._e(),n("div",{staticClass:"q-py-md q-px-lg"},[e._t("default")],2),e.noButtons?e._e():n("q-toolbar",{attrs:{slot:"footer",inverted:""},slot:"footer"},[n("q-toolbar-title",[e.validBtnHide?e._e():n("q-btn",{staticClass:"q-mr-sm",attrs:{color:e.validBtnColor,label:e.validBtnLabel,disable:e.validBtnDisable,loading:e.validBtnLoading},on:{click:function(t){e.onValidBtnClick()}}}),e.cancelBtnHide?e._e():n("q-btn",{staticClass:"q-mr-sm",attrs:{color:e.cancelBtnColor,label:e.cancelBtnLabel,disable:e.cancelBtnDisable,flat:""},on:{click:function(t){e.onCancelBtnClick()}}}),e._l(e.buttons,function(t,i){return n("q-btn",{key:i,staticClass:"q-mr-sm",attrs:{color:t.color,label:t.label,flat:t.flat,disable:t.disable},on:{click:function(n){e.onBtnClick(t)}}})}),e._t("buttons")],2)],1)],1)],1)},v=[];p._withStripped=!0;var b={name:"Modal",props:{title:String,icon:String,value:{},size:{type:String,default:"md"},noButtons:Boolean,validBtnHide:Boolean,validBtnDisable:Boolean,validBtnLoading:Boolean,validBtnLabel:{type:String,default:"Valid"},validBtnColor:{type:String,default:"primary"},cancelBtnHide:Boolean,cancelBtnDisable:Boolean,cancelBtnLabel:{type:String,default:"Cancel"},cancelBtnColor:{type:String,default:"negative"},buttons:Array},data:function(){return{}},computed:{contentCss:function(){var e={};return"xs"==this.size?e={minWidth:"30vw",minHeight:"40vh"}:"sm"==this.size?e={minWidth:"40vw",minHeight:"50vh"}:"md"==this.size?e={minWidth:"50vw",minHeight:"70vh"}:"lg"==this.size?e={minWidth:"70vw",minHeight:"80vh"}:"xl"==this.size&&(e={minWidth:"90vw",minHeight:"90vh"}),e}},methods:{onValidBtnClick:function(){this.$emit("valid")},onCancelBtnClick:function(){this.$emit("cancel"),this.hide()},onBtnClick:function(e){e.onclick.call(this)},onCloseBtnClick:function(){this.$emit("cancel"),this.hide()},hide:function(){this.$refs.modal&&this.$refs.modal.hide()},show:function(){this.$refs.modal&&this.$refs.modal.show()},toggle:function(){this.$refs.modal&&this.$refs.modal.toggle()}}},y=b,g=(n("9cb0"),n("2877")),_=Object(g["a"])(y,p,v,!1,null,"0e355ad8",null);_.options.__file="Modal.vue";var w,$,x=_.exports,C=n("691a"),k=n("d6ac"),q=n("6659"),S=n("ffbd"),O=n("9023"),j={name:"WWidget",inheritAttrs:!1,props:{color:{type:String,default:"#027be3"},bgColor:{type:String,default:"#ffffff"}},data:function(){return{error:!1}},watch:{error:function(e,t){this.$emit("error",e)}},methods:{setError:function(e){this.error=e}},errorHandler:function(e,t,n){this.error=String(e)}},E=j,D=Object(g["a"])(E,w,$,!1,null,null,null);D.options.__file="WWidget.vue";var I=D.exports,T=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"column"},[e.noHeader?e._e():n("div",{staticClass:"col-auto text-center text-faded ellipsis"},[e._v("\n    "+e._s(e.title)+"\n    "),e._t("header")],2),n("div",{staticClass:"col relative-position"},[e._t("default")],2),e.noFooter?e._e():n("div",{staticClass:"col-auto text-center text-faded ellipsis"},[e._t("footer")],2)])},F=[];T._withStripped=!0;var W={name:"WLayout",props:{title:String,noHeader:Boolean,noFooter:Boolean}},A=W,M=(n("4a6c"),Object(g["a"])(A,T,F,!1,null,"7cfbf224",null));M.options.__file="WLayout.vue";var L,B,R=M.exports,U={name:"WResource",mixins:[I],props:["resource"],data:function(){return{}},computed:{r:function(){if(this.resource instanceof a.a.Resource)return this.resource;var e=a.a.arbo.get(this.resource);return e||this.setError("the resource does not exist anymore ! ("+this.resource+")"),e}}},P=U,H=Object(g["a"])(P,L,B,!1,null,null,null);H.options.__file="WResource.vue";var V=H.exports,N=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("chart",{attrs:{preferences:e.r,history:e.history,expended:"",dense:"",readonly:"",chartOptions:{chart:{backgroundColor:"rgba(255, 255, 255, 0.0)"},plotOptions:{series:{color:e.color}},title:{style:{color:e.color}}}}})},Q=[];N._withStripped=!0;var z={name:"WChart",components:{Chart:d["a"]},mixins:[V],props:{history:{default:86400}}},Y=z,K=(n("6b60"),Object(g["a"])(Y,N,Q,!1,null,"07a12752",null));K.options.__file="WChart.vue";var J=K.exports,G=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("image-viewer",{attrs:{source:e.r,"no-title":""}})},X=[];G._withStripped=!0;var Z={name:"WImage",components:{ImageViewer:m["a"]},mixins:[V]},ee=Z,te=(n("409c"),Object(g["a"])(ee,G,X,!1,null,"46ca1584",null));te.options.__file="WImage.vue";var ne=te.exports,ie=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("w-device-layout",e._b({attrs:{resource:e.resource}},"w-device-layout",e.$attrs,!1),[n("div",{staticClass:"absolute-center"},[n("q-toggle",{attrs:{value:!!e.value,disable:e.reading||e.writing,color:e.color,"keep-color":""},on:{input:e.toggle}})],1)])},re=[];function ae(e,t){return new Promise(function(n,i){e.attr?n(t.attr(e.attr)):e.fn?t.execute(e.fn).then(function(e){n(e)}).catch(function(e){i(e)}):e.dataProp?n(t.data(e.dataProp)):i(new Error("invalid widget configuration"))})}ie._withStripped=!0;var oe,se,le={name:"WDeviceRead",mixins:[V],props:{fn:{},attr:{},dataProp:{}},data:function(){return{value:null,lastUpdate:null,reading:!1}},watch:{r:function(){(!this.lastUpdate||this.r.modifiedDate()>this.lastUpdate)&&this.update()}},methods:{read:function(){var e=this;this.reading=!0;var t=ae(this,this.r);return t.finally(function(){e.reading=!1}),t},update:function(){var e=this;this.lastUpdate=this.r.modifiedDate(),this.read().then(function(t){e.value=t})}},mounted:function(){this.update()},read:ae},ce=le,ue=Object(g["a"])(ce,oe,se,!1,null,null,null);ue.options.__file="WDeviceRead.vue";var de=ue.exports;function he(e,t,n){var i=e.attr_setter,r=e.fn_setter,a=e.dataProp_setter;return i||r||a||(e.attr?i=e.attr:e.fn?r=e.fn:e.dataProp&&(a=e.dataProp)),new Promise(function(e,o){i?t.set({attr_setter:n}).then(function(){e()}).catch(function(e){o(e)}):r?t.execute(r,n).then(function(){e()}).catch(function(e){o(e)}):a?t.setData(a,n).then(function(){e()}).catch(function(e){o(e)}):o(new Error("invalid widget configuration"))})}var fe,me,pe={name:"WDeviceReadWrite",mixins:[de],props:{fn_setter:{},attr_setter:{},dataProp_setter:{}},data:function(){return{writing:!1}},methods:{write:function(e){var t=this;this.writing=!0;var n=he(this,this.r,e);return n.finally(function(){t.writing=!1,t.update()}),n}},write:he},ve=pe,be=Object(g["a"])(ve,fe,me,!1,null,null,null);be.options.__file="WDeviceReadWrite.vue";var ye=be.exports,ge=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("w-layout",e._b({},"w-layout",e.$attrs,!1),[n("small",{staticClass:"cursor-pointer",attrs:{slot:"header"},on:{click:function(t){e.$ethingUI.open(e.r)}},slot:"header"},[e._v("\n    "+e._s(e.r.basename())+"\n  ")]),e._t("default"),n("small",{attrs:{slot:"footer"},slot:"footer"},[e._v("\n    "+e._s(e.date)+"\n  ")])],2)},_e=[];ge._withStripped=!0;var we={name:"WDeviceLayout",mixins:[V],components:{WLayout:R},computed:{date:function(){var e=this.r.lastSeenDate();return e||(e=this.r.modifiedDate()),this.$ethingUI.utils.dateToString(e)}}},$e=we,xe=Object(g["a"])($e,ge,_e,!1,null,null,null);xe.options.__file="WDeviceLayout.vue";var Ce=xe.exports,ke={name:"WSwitch",mixins:[ye],components:{WDeviceLayout:Ce},methods:{toggle:function(e){var t=this;this.write(e).then(function(){t.setError(!1)}).catch(function(e){t.setError(e)})}}},qe=ke,Se=(n("6a65"),Object(g["a"])(qe,ie,re,!1,null,"7d86fa30",null));Se.options.__file="WSwitch.vue";var Oe=Se.exports,je=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("w-device-layout",e._b({attrs:{resource:e.resource}},"w-device-layout",e.$attrs,!1),[n("div",{staticClass:"absolute-center"},[n("span",{staticClass:"value",style:{color:e.color}},[e._v("\n        "+e._s(null===e.value?"?":e.value)+"\n    ")]),e.unit?n("small",{staticClass:"unit",staticStyle:{filter:"brightness(90%)"}},[e._v("\n        "+e._s(e.unit)+"\n    ")]):e._e()])])},Ee=[];je._withStripped=!0;var De={name:"WDeviceLabel",mixins:[de],components:{WDeviceLayout:Ce},props:{unit:String}},Ie=De,Te=Object(g["a"])(Ie,je,Ee,!1,null,null,null);Te.options.__file="WDeviceLabel.vue";var Fe=Te.exports,We=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("w-device-layout",e._b({attrs:{resource:e.resource}},"w-device-layout",e.$attrs,!1),[n("div",{staticClass:"fit column items-center justify-center"},e._l(e.computedItems,function(t,i){return n("div",{key:i,staticClass:"col-auto"},[t.label?n("span",{staticClass:"label text-faded"},[e._v("\n          "+e._s(t.label)+" :\n      ")]):e._e(),n("span",{staticClass:"value",style:t._style},[t.icon?[e.isUrlIcon(t.value)?n("img",{staticClass:"vertical-middle",attrs:{src:t.value}}):n("q-icon",{attrs:{name:t.value}})]:[e._v("\n          "+e._s(t.value)+"\n        ")]],2),t.unit?n("small",{staticClass:"unit",staticStyle:{filter:"brightness(90%)"}},[e._v("\n          "+e._s(t.unit)+"\n      ")]):e._e()])}))])},Ae=[];We._withStripped=!0;n("55dd"),n("7514");var Me={name:"WDeviceMultiLabel",mixins:[V],components:{WDeviceLayout:Ce},props:{items:Array},data:function(){return{computedItems:[],lastUpdate:null}},watch:{r:function(){(!this.lastUpdate||this.r.modifiedDate()>this.lastUpdate)&&this.update()}},methods:{update:function(){var e=this;this.lastUpdate=this.r.modifiedDate();var t=this.items.map(function(t,n){var i=Object.assign({label:"",value:void 0,unit:null,color:e.color,offset:0,coefficient:0,map:{},icon:!1,done:null,nullValue:void 0,skipIfNull:!1,_loading:!0,_error:!1,_prev:e.computedItems[n],_promise:null,_style:{},_skipped:!1},t);return i._promise=de.read(i,e.r).then(function(e){i.value=e}).catch(function(e){i._error=!0}).finally(function(){i._loading=!1,"function"===typeof i.done&&i.done.call(i,i),i.color&&(i._style.color=i.color),e.computedValue(i),!i.skipIfNull||null!==i.value&&"undefined"!==typeof i.value||(i._skipped=!0)}),i});Promise.all(t.map(function(e){return e._promise})).then(function(){e.computedItems=t.filter(function(e){return!e._skipped})})},computedValue:function(e){if(null===e.nullValue||"undefined"===typeof e.nullValue||null!==e.value&&"undefined"!==typeof e.value||(e.value=e.nullValue),e.coefficient&&(e.value*=e.coefficient),e.offset&&(e.value+=e.offset),e.map){var t;if(Array.isArray(e.map))t=e.map;else for(var n in t=[],e.map)t.push({key:n,value:e.map[n]});var i=t.find(function(t){return t.key===e.value});if(i||(i=t.find(function(e){return"*"===e.key})),i)e.value=i.value;else if("number"===typeof e.value){var r=t.map(function(e){return e.key}).filter(function(e){return"number"===typeof e}).sort(),a=e.value,o=null,s=null;r.forEach(function(e){var t=Math.abs(e-a);(null===o||t<=o)&&(o=t,s=e)}),null!==s&&(i=t.find(function(e){return e.key===s}),e.value=i.value)}}return e.value},isUrlIcon:function(e){return/^https?:\/\//.test(e)}},mounted:function(){this.update()}},Le=Me,Be=Object(g["a"])(Le,We,Ae,!1,null,null,null);Be.options.__file="WDeviceMultiLabel.vue";var Re=Be.exports,Ue=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("w-device-layout",e._b({attrs:{resource:e.resource}},"w-device-layout",e.$attrs,!1),[n("div",{staticClass:"absolute-center"},[n("q-knob",{attrs:{value:null===e.value?0:e.value,min:e.min,max:e.max,readonly:"",color:e.color}},[e._v("\n      "+e._s(e.value)+" "),n("small",{staticClass:"unit"},[e._v(e._s(e.unit))])])],1)])},Pe=[];Ue._withStripped=!0;n("c5f6");var He={name:"WDeviceKnob",mixins:[de],components:{WDeviceLayout:Ce},props:{unit:String,min:{type:Number,default:0},max:{type:Number,default:100}}},Ve=He,Ne=Object(g["a"])(Ve,Ue,Pe,!1,null,null,null);Ne.options.__file="WDeviceKnob.vue";var Qe=Ne.exports,ze=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("image-viewer",{ref:"view",attrs:{source:e.source,"no-title":""}})},Ye=[];ze._withStripped=!0;var Ke={name:"WCamera",components:{ImageViewer:m["a"]},props:{refreshInterval:{default:30}},data:function(){return{timerId:null}},computed:{source:function(){return this.r.executeUrl("snapshot")}},mounted:function(){var e=this;this.timerId=setInterval(function(){e.$refs.view.refresh()},1e3*this.refreshInterval)},beforeDestroy:function(){null!==this.timerId&&clearInterval(this.timerId)},mixins:[V]},Je=Ke,Ge=(n("df6e"),Object(g["a"])(Je,ze,Ye,!1,null,"26aebaa8",null));Ge.options.__file="WCamera.vue";var Xe=Ge.exports,Ze=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("w-device-layout",e._b({attrs:{resource:e.resource}},"w-device-layout",e.$attrs,!1),[n("div",{staticClass:"absolute-center"},[n("q-knob",{attrs:{value:e.value,min:e.min,max:e.max,disable:e.writing,color:e.color},on:{change:e.setLevel}},[e._v("\n      "+e._s(e.value)+" "),n("small",{staticClass:"unit",staticStyle:{filter:"brightness(90%)"}},[e._v(e._s(e.unit))])])],1)])},et=[];Ze._withStripped=!0;var tt={name:"WDimmable",mixins:[ye],components:{WDeviceLayout:Ce},props:{unit:String,min:{type:Number,default:0},max:{type:Number,default:100}},methods:{setLevel:function(e){var t=this;this.write(e).then(function(){t.setError(!1)}).catch(function(e){t.setError(e)})}}},nt=tt,it=(n("5bff"),Object(g["a"])(nt,Ze,et,!1,null,"ce99074e",null));it.options.__file="WDimmable.vue";var rt,at,ot=it.exports,st={name:"WGenericSensor",mixins:[Re],methods:{update:function(){this.lastUpdate=this.r.modifiedDate();var e=this.r.data(),t=[];for(var n in e)t.push({label:n,unit:null,value:e[n]});this.computedItems=t}}},lt=st,ct=Object(g["a"])(lt,rt,at,!1,null,null,null);ct.options.__file="WGenericSensor.vue";var ut=ct.exports,dt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"absolute-center text-center"},[n("div",{staticClass:"time"},[n("span",{staticClass:"text-weight-bold"},[e._v(e._s(e.hours)+":"+e._s(e.minutes)+" ")]),n("small",{staticStyle:{filter:"brightness(90%)"}},[e._v(e._s(e.seconds))])]),n("span",{staticClass:"weekday",staticStyle:{filter:"brightness(90%)"}},[e._v("\n        "+e._s(e.weekday)+"\n    ")])])])},ht=[];dt._withStripped=!0;var ft=n("25d4"),mt=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function pt(e,t,n){return n=n||"0",e+="",e.length>=t?e:new Array(t-e.length+1).join(n)+e}var vt={name:"WClock",mixins:[I],props:{},data:function(){return{hours:0,minutes:0,seconds:0,weekday:"",timerId:null}},mounted:function(){var e=this;this.timerId=setInterval(function(){e.refreshTime()},1e3)},beforeDestroy:function(){null!==this.timerId&&clearInterval(this.timerId)},methods:{refreshTime:function(){var e=new Date;this.hours=pt(e.getHours(),2),this.minutes=pt(e.getMinutes(),2),this.seconds=pt(e.getSeconds(),2),this.weekday=mt[e.getDay()]}}};Object(ft["c"])("clock",{component:vt,schema:{title:"clock",description:"Display the time"}});var bt=vt,yt=bt,gt=(n("688f"),Object(g["a"])(yt,dt,ht,!1,null,"37b888e8",null));gt.options.__file="WClock.vue";var _t=gt.exports,wt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("w-layout",{attrs:{noFooter:"",title:e.r.basename()}},[n("div",{staticClass:"row items-center"},[n("div",{staticClass:"inputs",class:e.outputs.length?"col-6":"col-12"},e._l(e.inputs,function(t,i){return n("div",{key:i},[n("flow-node",{attrs:{flow:e.r,node:t}})],1)})),n("div",{staticClass:"outputs",class:e.inputs.length?"col-6":"col-12"},e._l(e.outputs,function(t,i){return n("div",{key:i},[n("flow-node",{attrs:{flow:e.r,node:t}})],1)}))])])},$t=[];wt._withStripped=!0;var xt={name:"WFlow",extends:V,components:{WLayout:R,FlowNode:f["a"]},computed:{parsedFlow:function(){var e=this,t=this.r.attr("nodes"),n=[],i=[];return t.forEach(function(t){e.$ethingUI.isSubclass(t.type,"nodes/inputs/Input")?n.push(t):e.$ethingUI.isSubclass(t.type,"nodes/outputs/Output")&&i.push(t)}),{inputs:n,outputs:i}},inputs:function(){return this.parsedFlow.inputs},outputs:function(){return this.parsedFlow.outputs}}},Ct=xt,kt=Object(g["a"])(Ct,wt,$t,!1,null,null,null);kt.options.__file="WFlow.vue";var qt=kt.exports,St=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("w-layout",{attrs:{noFooter:"",title:e.r.basename()}},[n("flow-node",{staticClass:"absolute-center",attrs:{flow:e.r,node:e.node}})],1)},Ot=[];St._withStripped=!0;var jt={name:"WFlowNode",extends:V,components:{WLayout:R,FlowNode:f["a"]},props:["node"]},Et=jt,Dt=Object(g["a"])(Et,St,Ot,!1,null,null,null);Dt.options.__file="WFlowNode.vue";var It=Dt.exports,Tt={WWidget:I,WLayout:R,WResource:V,WChart:J,WImage:ne,WSwitch:Oe,WDeviceLayout:Ce,WDeviceRead:de,WDeviceReadWrite:ye,WDeviceLabel:Fe,WDeviceMultiLabel:Re,WDeviceKnob:Qe,WCamera:Xe,WDimmable:ot,WGenericSensor:ut,WClock:_t,WFlow:qt,WFlowNode:It},Ft=n("90ee"),Wt=n("f44e"),At=n("09bd"),Mt=n.n(At),Lt=n("7037"),Bt=n.n(Lt),Rt=n("a026"),Ut=n("b0d5"),Pt=n("3e67"),Ht=n("c658"),Vt=n("f490"),Nt={icon:"attachment",color:"grey",properties:{createdBy:{$component:"ething.resource",$readOnly:!0},data:{$readOnly:!0},modifiedDate:{getFormatted:function(e){return Vt["d"].formatDate(this.get(e).getTime(),"YYYY-MM-DD HH:mm")}},createdDate:{getFormatted:function(e){return Vt["d"].formatDate(this.get(e).getTime(),"YYYY-MM-DD HH:mm")}},extends:{getFormatted:function(e){return(this.get(e)||[]).join(", ")}}}},Qt=n("177b"),zt={icon:"mdi-file",color:"green",properties:{size:{getFormatted:function(e){return Qt["c"].humanStorageSize(this.get(e))}},contentModifiedDate:{getFormatted:function(e){return Vt["d"].formatDate(this.get(e).getTime(),"YYYY-MM-DD HH:mm")}}},dynamic:function(e){var t,n={};"plot"===e.extension()?(t="mdi-file-chart",n.chart={component:J,schema:{title:"chart",properties:{history:{description:"the past data to plot",type:"number",enum:[3600,21600,43200,86400,172800,604800,"all"],$labels:["1 hour","6 hours","12 hours","1 day","2 days","1 week","all"],default:86400}}},minWidth:250,minHeight:150}):/^text/.test(e.mime())?t="mdi-file-document":/^image/.test(e.mime())?(t="mdi-file-image",n.image={component:ne,schema:{title:"image"},minWidth:320,minHeight:280}):/^video/.test(e.mime())?t="mdi-file-video":/^application/.test(e.mime())&&(t="mdi-file-xml");var i={};return t&&(i.icon=t),n&&(i.widgets=n),i},open:function(e,t){return/\.plot$/.test(e.basename())?"/chart/"+e.id():/image/.test(e.mime())?"/image/"+e.id():"/text/"+e.id()}},Yt={icon:"mdi-table",color:"blue",properties:{length:{getFormatted:function(e){return this.get(e)+" rows"}},contentModifiedDate:{getFormatted:function(e){return Vt["d"].formatDate(this.get(e).getTime(),"YYYY-MM-DD HH:mm")}}},widgets:{chart:{component:J,schema:{title:"chart",properties:{history:{description:"the past data to plot",type:"number",enum:[3600,21600,43200,86400,172800,604800,"all"],$labels:["1 hour","6 hours","12 hours","1 day","2 days","1 week","all"],default:86400}}},minWidth:250,minHeight:150}},open:function(e,t){return"chart"===t?"/chart/"+e.id():"/table/"+e.id()}},Kt={icon:"mdi-sitemap",color:"purple",virtual:!0,disableCreation:!1,properties:{battery:{$readOnly:!0},connected:{$readOnly:!0},lastSeenDate:{getFormatted:function(e){var t=this.get(e);return t?Vt["d"].formatDate(t.getTime(),"YYYY-MM-DD HH:mm"):"never"}}},open:function(e,t){return"/device/"+e.id()}},Jt={icon:"mdi-ray-start-arrow",color:"orange",properties:{nodes:{$readOnly:!0},connections:{$readOnly:!0}},open:function(e,t){return"/flow/"+e.id()},widgets:function(e){return{"flow.full":{component:qt,schema:{title:"Flow widget",description:"interact with flow"}},"flow.node":{component:It,schema:{title:"Flow node widget",description:"interact with flow",properties:{node:{description:"the input/output node to display",type:"string",$component:"ething.flow.node",$flow:e,$filter:function(e,t){return EThingUI.isSubclass(t.type,"nodes/inputs/Input")||EThingUI.isSubclass(t.type,"nodes/outputs/Output")}}}}}}}},Gt={Resource:Nt,File:zt,Table:Yt,Device:Kt,Flow:Jt},Xt={icon:"mdi-thermometer",data:function(e){return{temperature:e.attr("temperature")+"°C"}},widgets:{"temperature.label":{in:["dashboard"],component:Fe,attributes:{attr:"temperature",unit:"°C"},schema:{title:"temperature (label)",description:"show the temperature"},minWidth:100,minHeight:100,title:"temperature",icon:"mdi-thermometer"},"temperature.knob":{in:["dashboard","devicePage"],component:Qe,attributes:{attr:"temperature",unit:"°C",min:-20,max:50},schema:{title:"temperature (knob)",description:"show the temperature"},minWidth:160,minHeight:180}}},Zt={icon:"mdi-toggle-switch",data:function(e){return{state:e.attr("state")?"on":"off"}},widgets:{"switch.state":{in:["dashboard","devicePage"],component:Re,attributes:{items:[{attr:"state",map:[{key:!0,value:"On"},{key:!1,value:"Off"}]}]},schema:{title:"state (label)",description:"show the state of the switch"},minWidth:100,minHeight:100}}},en={icon:"mdi-toggle-switch",data:function(e){return{state:e.attr("state")?"on":"off"}},widgets:{"relay.switch":{in:["dashboard","devicePage"],component:Oe,attributes:{attr:"state",fn_setter:"setState"},schema:{title:"switch",description:"toggle the device"},minWidth:60,minHeight:60}}},tn={icon:"mdi-radiobox-marked"},nn={icon:"lightbulb outline",widgets:{"relay.switch":{schema:{description:"toggle the light"}}}},rn={icon:"mdi-contrast-circle",data:function(e){return{level:e.attr("level")+"%"}},widgets:{"dimmer.label":{in:["dashboard"],component:Fe,attributes:{attr:"level",unit:"%"},schema:{title:"level (label)",description:"show the level"},minWidth:100,minHeight:100},"dimmer.knob":{in:["dashboard","devicePage"],component:Qe,attributes:{attr:"level",unit:"%",min:0,max:100},schema:{title:"level (knob)",description:"show the level"},minWidth:160,minHeight:180}}},an={icon:"mdi-contrast-circle",data:function(e){return{level:e.attr("level")+"%"}},widgets:{"dimmable.dimmer":{in:["dashboard","devicePage"],component:ot,attributes:{attr:"level",fn_setter:"setLevel"},schema:{label:"qnob",description:"adjust the level"},minWidth:160,minHeight:160}}},on={icon:"photo_camera",widgets:{camera:{in:["dashboard","devicePage"],component:Xe,attributes:{refreshInterval:30},minWidth:160,minHeight:160,schema:{title:"camera",description:"show the last image"}}}},sn={icon:"mdi-weather-windy",data:function(e){return{wind:e.attr("wind_speed")+"m/s"}},widgets:{"anemometer.wind":{in:["dashboard","devicePage"],component:Re,attributes:{items:[{label:"wind speed",attr:"wind_speed",unit:"m/s"},{label:"wind direction",attr:"wind_direction",skipIfNull:!0,map:[{key:0,value:"N"},{key:45,value:"N-E"},{key:90,value:"E"},{key:135,value:"S-E"},{key:180,value:"S"},{key:225,value:"S-O"},{key:270,value:"O"},{key:315,value:"N-O"}]}]},schema:{title:"wind information",description:"show the wind speed and wind direction"},minWidth:100,minHeight:100}}},ln={icon:"mdi-weight",data:function(e){return{pressure:e.attr("pressure")+"Pa"}},widgets:{"pressure.label":{in:["dashboard","devicePage"],component:Fe,attributes:{attr:"pressure",unit:"Pa"},schema:{title:"pressure (label)",description:"show the pressure (in Pa)"},minWidth:100,minHeight:100}}},cn={icon:"mdi-weight",data:function(e){return{"light level":e.attr("light_level")+"Lux"}},widgets:{"lightLevel.label":{in:["dashboard","devicePage"],component:Fe,attributes:{attr:"light_level",unit:"Lux"},schema:{title:"light level (label)",description:"show the light level (in Lux)"},minWidth:100,minHeight:100}}},un={icon:"mdi-water-percent",data:function(e){return{humidity:e.attr("humidity")+"%"}},widgets:{"humidity.label":{in:["dashboard"],component:Fe,attributes:{attr:"humidity",unit:"%"},schema:{title:"humidity (label)",description:"show the humidity level (in %)"},minWidth:100,minHeight:100},"humidity.knob":{in:["dashboard","devicePage"],component:Qe,attributes:{attr:"humidity",unit:"%",min:0,max:100},schema:{title:"humidity (knob)",description:"show the humidity level (in %)"},minWidth:160,minHeight:180}}},dn={icon:"mdi-water-percent",data:function(e){return{moisture:e.attr("moisture")+"%"}},widgets:{"moisture.label":{in:["dashboard"],component:Fe,attributes:{attr:"moisture",unit:"%"},schema:{title:"moisture (label)",description:"show the moisture level (in %)"},minWidth:100,minHeight:100},"moisture.knob":{in:["dashboard","devicePage"],component:Qe,attributes:{attr:"moisture",unit:"%",min:0,max:100},schema:{title:"moisture (knob)",description:"show the moisture level (in %)"},minWidth:160,minHeight:180}}},hn={icon:"mdi-door",data:function(e){return{state:e.attr("state")?"opened":"closed"}},widgets:{"door.state":{in:["dashboard","devicePage"],component:Re,attributes:{items:[{attr:"state",map:[{key:!0,value:"opened"},{key:!1,value:"closed"}]}]},schema:{title:"state (label)",description:"show the door state"},minWidth:100,minHeight:100}}},fn={Thermometer:Xt,Switch:Zt,Relay:en,Button:tn,Light:nn,Dimmer:rn,Dimmable:an,Camera:on,Anemometer:sn,PressureSensor:ln,LightSensor:cn,HumiditySensor:un,MoistureSensor:dn,DoorSensor:hn},mn={},pn={Signal:mn},vn={color:"#eeeeee"},bn={properties:{method:{id:"HttpRequest.method"},body:{format:"text",$dependencies:{"HttpRequest.method":function(e,t,n){t.$set(t.parent().c_schema.properties.body,"$disabled",-1===["POST","PUT","PATCH"].indexOf(e))}}}}},yn={properties:{resource:{id:"ExecuteDevice.device"},method:{id:"ExecuteDevice.method",enum:[],$dependencies:{"ExecuteDevice.device":function(e,t,n){var i=this.$ething.arbo.get(e),r={};i&&(r=this.$ethingUI.get(i).methods),t.$set(t.c_schema,"enum",Object.keys(r))}}},args:{$dependencies:{"ExecuteDevice.method":function(e,t,n){var i=this.$ething.arbo.get(this.find("ExecuteDevice.device").c_value);if(i&&e){var r=this.$ethingUI.get(i).methods,a=r[e];if(a&&Object.keys(a.arguments).length>0){var o={additionalProperties:!1,properties:a.arguments,required:a.required,type:"object"};return void this.$set(this.parent().c_schema.properties,"args",o)}}this.$delete(this.parent().c_schema.properties,"args")}}}}},gn={node:"Button"},_n={node:"Label"},wn={Node:vn,HttpRequest:bn,ExecuteDevice:yn,Button:gn,Label:_n},$n={resources:Gt,interfaces:fn,signals:pn,nodes:wn},xn={color:"grey",icon:"mdi-help",title:"",description:"",required:[],properties:{},virtual:!1,dynamic:null,category:"",signals:[],widgets:{},disableCreation:!1,open:null,methods:{},data:{},node:null},Cn={required:Ht["a"],properties:Ht["c"],virtual:Ht["e"],dynamic:!1,signals:Ht["a"],widgets:function(e,t,n){return Object(Ht["c"])(e,t,n,function(e,t,i){if(!e)return t.title||(t.title=n.title),t.icon||(t.icon=n.icon),t;if(!t)return e;var r=Object.keys(e).concat(Object.keys(t)).filter(function(e,t,n){return n.indexOf(e)===t}),a={};return r.forEach(function(n){a[n]="component"===n?Object(Ht["f"])(e[n],t[n]):Object(Ht["b"])(e[n],t[n])}),a})},methods:Ht["c"],data:Ht["c"]},kn=["widgets","data"];function qn(e,t,n){var i=t?t.split("/"):[],r=e;for(var a in i){var o=i[a];if("object"!==Bt()(r)||null===r)throw"definition of "+t+" not found";if("undefined"===typeof r[o]){if(!n)throw"definition of "+t+" not found";r[o]={}}r=r[o]}return r}function Sn(e,t,n,i){"undefined"===typeof n&&"function"===typeof t&&(i=n,n=t,t=null),i=i||[],t=t||{};var r=!1,a=function(){r=!0};if(e=n(e,t,a,i.join("/")),!r&&"object"===Bt()(e)&&null!==e)for(var o in e){var s=e[o];if("object"===Bt()(s)&&null!==s){var l=i.slice(0);l.push(o),e[o]=Sn(s,t[o],n,l)}}return e}function On(e){if("undefined"!==typeof e["allOf"]){var t=e["allOf"],n=e._bases||[],i={};for(var r in t){var a=t[r],o=null;"string"===typeof a["$ref"]?(o=a["$ref"].substr(2),-1===n.indexOf(o)&&n.push(o)):Dn(i,a)}var s=Object(Ut["a"])(!0,{},e);delete s.allOf,Dn(i,s),i._bases=n,"undefined"===typeof i["type"]&&(i["type"]="class"),e=i}return e}function jn(e){if("undefined"!==typeof e["widgets"])for(var t in e.widgets){var n=e.widgets[t];if("string"===typeof n.component){var i=Rt["default"].component(n.component);i?e.widgets[t]=i:(console.error("unknown component "+n.component),e.widgets[t]={})}"string"===typeof n.in&&(n.in=[n.in])}return e}function En(e,t,n){var i={};if(!e)return i;var r=e.slice().reverse();return r.forEach(function(e){var r=qn(t,e);if(r=Object(Ut["a"])(!0,{},r),n){if(r.dynamic){var a=r.dynamic.call(r,n);a&&Object(Ut["a"])(!0,r,a)}kn.forEach(function(e){"function"===typeof r[e]&&(r[e]=r[e].call(r,n))})}r=jn(r),Dn(i,r)}),delete i._mro,delete i._bases,i._dep=e,i}function Dn(e,t){return Object(Ht["d"])(e,t,Cn,Ht["b"],t)}function In(e,t){e=Object(Ut["a"])(!0,{},xn,e);var n=function(t){var n=e.properties[t];n.get||(n.get=function(e){return e[t]?e[t]():e.attr(t)}),n.getFormatted||(n.getFormatted=n.get)};for(var i in e.properties)n(i);if("function"!==typeof e.open){var r=e.open;e.open=function(){return r}}for(var a in e.widgets)e.widgets[a]=Object.assign({},ft["d"],e.widgets[a]);if(delete e.dynamic,t){var o=e.open;e.open=function(e){return o.call(this,t,e)},e._resource=t}return e}var Tn={};function Fn(e,t){var n=null,i=null,r={};if(t instanceof a.a.Resource?(n=t,t=t.type(),i=n.id()):"object"===Bt()(t)&&null!==t&&t._type&&(t=t._type),"string"!==typeof t)throw"type must be a string";if(n){if(i in Tn)return Tn[i]}else if(t in Tn)return Tn[t];return n?r=En(n.attr("extends"),e,n):(r=qn(e,t),r=En(r._mro||[],e)),r=In(r,n),n?Tn[i]=r:Tn[t]=r,r}function Wn(e,t){var n=!1;if(Sn(t,function(e,t,i,r){return"undefined"!==typeof e["allOf"]&&(n=!0,e=On(e)),"class"===e["type"]&&(e._type=r,i()),e}),n){var i={};Sn(t,function(e,t,n,r){return"class"===e["type"]&&(i[r]=e._bases||[],n()),e});var r=Object(Pt["linearize"])(i,{reverse:!0,python:!0});for(var a in r){var o=qn(t,a);o._mro=r[a]}}Sn(t,$n,function(t,n,i,r){if("class"===t["type"]){var a=r.split("/"),o=a.pop();a=a.join("/");var s=qn(e.definitions,a,!0);s[o]=t,n&&(t=e.extend(r,n)),i()}return t})}function An(e){if("string"===typeof e)return e;if(e instanceof a.a.Resource)return e.type();if("object"===Bt()(e)&&null!==e&&e._type)return e._type;if("object"===Bt()(e)&&null!==e&&e._resource)return e._resource.type();throw Error('invalid type: "'+e+'"')}var Mn={install:function(e){var t=e.EThingUI;Object.assign(t,{mergeClass:Dn,definitions:{},iterate:function(e,t){t||"function"!==typeof e||(t=e,e=null),"string"===typeof e&&(e=qn(this.definitions,e)),e=e||this.definitions,Sn(e,function(e,n,i,r){return"class"===e["type"]&&(t(e._type),i()),e})},isDefined:function(e){try{return qn(this.definitions,An(e)),!0}catch(e){return!1}},get:function(e){return Fn(this.definitions,e)},isSubclass:function(e,t){if(e=An(e),t=An(t),e===t)return!0;var n=this.get(e);return n&&n._dep&&-1!==n._dep.indexOf(t)},extend:function(e,t){e=An(e);var n=qn(this.definitions,e);return Object(Ut["a"])(!0,n,t),Object.keys(Tn).forEach(function(t){var n=Tn[t];-1!==n._dep.indexOf(e)&&delete Tn[t]}),n},loadMeta:function(){var e=this;return a.a.request({url:"utils/definitions",dataType:"json"}).then(function(t){Wn(e,t),console.log("[meta] ething meta loaded !")})}}),a.a.Resource.prototype.meta=function(){return t.get(this)}}},Ln=n("8055"),Bn=n.n(Ln),Rn=n("25b3"),Un=n.n(Rn),Pn=Un()(Bn.a.Manager),Hn={install:function(e){var t=e.EThingUI,n=Bn()(a.a.config.serverUrl+"/events",{autoConnect:!1}),i=Bn()(a.a.config.serverUrl+"/notifications",{autoConnect:!1});Pn(n),n.on("connect",function(){console.log("[socketio] connected"),t.emit("ui.server.connected"),i.open()}),n.on("disconnect",function(){console.log("[socketio] disconnected"),t.emit("ui.server.disconnected"),i.close()}),n.on("*",function(e,t){var n=e.data[1];a.a.arbo.dispatch(JSON.parse(n))}),i.on("connect",function(){var e="ething.cid",t=o["a"].get.item(e);t||(t=String(parseInt(1e9*Math.random())),o["a"].set(e,t)),i.emit("init",{cid:t})}),Object.assign(t,{io:Bn.a,ioPatch:Pn,eventsSocket:n,notifSocket:i})}},Vn=function(e){var t=e.EThingUI,n=e.Vue,i=new n;Object.assign(t,{on:function(){return i.$on.apply(i,arguments)},once:function(){return i.$once.apply(i,arguments)},off:function(){return i.$off.apply(i,arguments)},emit:function(){return i.$emit.apply(i,arguments)}})},Nn=function(e){var t=e.EThingUI;e.Vue;a.a.on("ConfigUpdated",function(e){console.log("[app] settings updated",e),t.settings=e.data.config}),Object.assign(t,{settings:{},loadSettings:function(){var e=this;return a.a.settings.get().then(function(t){return e.settings=t,t})}})},Qn=(n("3b2b"),n("37c5")),zn=function(e){var t=e.EThingUI;e.Vue;Object.assign(t,{dbSet:function(e,t,n){var i="session"===n?Qn["a"]:o["a"];i.set(e,t)},dbGet:function(e,t){var n="session"===t?Qn["a"]:o["a"];if(e instanceof RegExp){var i=n.get.all(),r={};for(var a in i)e.test(a)&&(r[a]=i[a]);return r}return"string"===typeof e?n.get.item(e):n.get.all()},dbDelete:function(e,t){var n="session"===t?Qn["a"]:o["a"];n.remove(e)}})},Yn={install:function(e){var t=e.EThingUI;Object.assign(t,{info:{},plugins:{},scopes:{},loadInfo:function(){var e=this,t=a.a.request({url:"utils/info",dataType:"json"});return t.then(function(t){console.log("[meta] ething info loaded !"),Object.assign(e,t)}).catch(function(e){console.error("[meta] ething info error !")})}})}},Kn={install:function(e){var t=e.EThingUI;Object.assign(t,{loadPlugins:function(){var e=this.plugins||{},t=[],n=function(n){var i=e[n];i.js_index&&t.push(new Promise(function(e,t){Object(u["injectScript"])(a.a.config.serverUrl+"/api/plugin/"+n+"/index.js",function(i){i?(console.error("[meta] plugin "+n+" fail loading"),t()):(console.log("[meta] plugin "+n+" loaded"),e())})}))};for(var i in e)n(i);return Promise.all(t)}})}};Mt.a.shim();var Jn=36e5,Gn={VERSION:"0.1.0",utils:u,components:i,EThing:a.a,form:Wt},Xn=u["getParameterByName"];function Zn(e,t){Object.keys(t).forEach(function(n){var i=t[n];u["isVueComponent"](i)?void 0!==i.name&&e.component(i.name,i):u["isPlainObject"](i)&&Zn(e,i)})}Gn.kioskMode=Object({NODE_ENV:"production",CLIENT:!0,SERVER:!1,DEV:!1,PROD:!0,THEME:"mat",MODE:"spa",API:!0,VERSION:"0.1.0",VUE_ROUTER_MODE:"hash",VUE_ROUTER_BASE:"/client/",APP_URL:"undefined"}).KIOSK||"1"===Xn("kiosk"),Gn.virtualKeyboardEnabled=Object({NODE_ENV:"production",CLIENT:!0,SERVER:!1,DEV:!1,PROD:!0,THEME:"mat",MODE:"spa",API:!0,VERSION:"0.1.0",VUE_ROUTER_MODE:"hash",VUE_ROUTER_BASE:"/client/",APP_URL:"undefined"}).VIRTUALKEYBOARD||"1"===Xn("virtualkeyboard"),Gn.install=function(e){var t=e.app,n=e.router,r=e.Vue,l=e.store;if(!Gn.__installed){Gn.__installed=!0,r.config.errorHandler=function(e,t,n){var i=null,r=t;if(t)if(t.$options.errorHandler)i=t.$options.errorHandler;else while(r.$parent)if(r=r.$parent,i=r.$options.errorHandler)break;i?i.call(r,e,t,n):console.error(e)},Object.assign(Gn,{router:n,store:l,getVueInstance:function(){return this.router.app},route:function(e,t){return this.get(e).open(t)},open:function(e,t){var i=Gn.route(e,t);i&&n.push(i)}});var u=[Mn,Hn,ft["b"],Vn,Nn,zn,Yn,Kn];u.forEach(function(e){var t="function"===typeof e?e:e.install;t({EThingUI:Gn,Vue:r,router:n,store:l})});var d=null,h=!1,f=window.location.href,m=f.split("/");d=m[0]+"//"+m[2],d&&(a.a.config.serverUrl=d),h||(Gn.autoLogin=/\/\/localhost/.test(a.a.config.serverUrl)),r.prototype.$ethingUI=Gn,window&&(window.EThingUI=Gn),i&&Zn(r,i),Object.assign(Gn,{dynamicServerUrl:h,getServerUrl:function(){return a.a.config.serverUrl},setServerUrl:function(e){o["a"].set("ething.server.url",e),a.a.config.serverUrl=e},needAuth:function(){return h&&!o["a"].get.item("ething.server.url")}}),t.data=t.data||{},t.data.state="begin",t.data.error=!1,Gn.notifSocket.on("notification",function(e){console.log("[app] notification received",e),s["a"].create({type:"info",message:e.msg,detail:e.subject,position:"bottom-right",timeout:15e3,actions:[{label:"Close",handler:function(){}}]})}),Object.assign(Gn,{reset:function(){t.data.state="begin",Gn.eventsSocket.close(),o["a"].remove("ething.auth.iat"),this.authRefreshTimer&&clearInterval(this.authRefreshTimer)},disconnect:function(){this.reset(),n.app.$router.push({name:"login",query:{redirect_uri:n.app.$router.currentRoute.path}})},logout:function(){var e=a.a.axios.request({method:"get",url:a.a.config.serverUrl+"/auth/logout"});return this.disconnect(),e},login:function(e,t,i){var r=this;return a.a.axios.request({method:"post",url:e+"/auth/password",headers:{"content-type":"application/x-www-form-urlencoded"},data:c.a.stringify({login:t,password:i})}).then(function(t){r.reset(),r.setServerUrl(e),o["a"].set("ething.auth.iat",Date.now());var i=n.app.$route.query.redirect_uri||"/";"/login"===i&&(i="/"),n.app.$router.replace(i)})},authRefreshTimer:null,authRefresh:function(){return a.a.axios.request({method:"post",url:a.a.config.serverUrl+"/auth/refresh"}).then(function(){o["a"].set("ething.auth.iat",Date.now())})}}),console.log("[app] ething configuring ..."),a.a.axios.defaults.withCredentials=!0,a.a.axios.interceptors.response.use(function(e){return e},function(e){if(e.response){var t=e.response.status;401!=t&&403!=t||Gn.disconnect()}return Promise.reject(e)}),n.beforeEach(function(e,i,l){if("begin"===t.data.state&&"login"!==e.name){if(console.log("[app] begin..."),Gn.needAuth())return console.warn("[app] no serverUrl found ! need to create a new session"),void l({name:"login",replace:!0,query:{redirect_uri:e.path}});t.data.state="initializing",console.log("[app] initializing...");var c=t.router.app;window.app=c,window.quasar=c.$q,window.Vue=r;var u=Gn.loadInfo(),d=Gn.loadMeta(),h=Gn.loadSettings(),f=a.a.arbo.load(null,!0).then(function(){console.log("[app] ething arbo loaded !")});Promise.all([u,f,d,h]).then(function(){return Gn.loadPlugins()}).then(function(){t.data.state="ok",console.log("[app] ething loaded !");var e=!1,i=null,r=null;function a(){i&&i(),e&&(setTimeout(function(){n.go()},1e3),i=s["a"].create({type:"positive",color:"positive",message:"Reconnected to server !",icon:"thumb_up",position:"bottom-right",onDismiss:function(){i=null}}),r="connected")}function l(){e=!0,"disconnected"!==r&&(i&&i(),i=s["a"].create({type:"negative",color:"negative",message:"Lost connection to server !",icon:"report_problem",position:"bottom-right",timeout:0,onDismiss:function(){i=null}}),r="disconnected")}Gn.on("ui.server.connected",a),Gn.on("ui.server.disconnected",l),Gn.eventsSocket.open();var c=o["a"].get.item("ething.auth.iat");c&&Date.now()-c>Jn&&Gn.authRefresh(),Gn.authRefreshTimer=setInterval(function(){Gn.authRefresh()},Jn)}).catch(function(e){console.error(e),t.data.state="error",t.data.error=e})}l()})}};t["a"]=Gn},cb61:function(e,t,n){"use strict";var i=n("8b81"),r=n.n(i);r.a},cfe2:function(e,t,n){},d394:function(e,t,n){},d6ac:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._t("default"),e.meta.description?n("vue-markdown",{staticClass:"markdown",attrs:{anchorAttributes:{target:"_blank"}}},[e._v(e._s(e.meta.description.trim()))]):e._e(),n("form-schema",{staticClass:"q-mb-xl",attrs:{schema:e.schema},on:{error:function(t){e.inputError=t}},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}}),n("q-inner-loading",{staticClass:"text-center",attrs:{visible:!e.ready}},[n("div",{staticClass:"q-pa-lg text-primary"},[e._v("loading...")]),n("q-spinner-oval",{attrs:{color:"primary",size:"50px"}})],1)],2)},r=[];i._withStripped=!0;var a=n("7037"),o=n.n(a),s=(n("7f7f"),n("ac6a"),n("cadf"),n("456d"),n("f751"),n("28a5"),n("551c"),n("426a")),l=n.n(s),c=n("9ce6"),u=n.n(c),d=n("b0d5"),h=n("4d7c"),f={name:"ResourceEditor",components:{VueMarkdown:u.a},props:["resource"],data:function(){var e=this,t=this.getSchemaModel(function(){e.$nextTick(function(){e.ready=!0})});return{inputError:!1,create:!(this.resource instanceof l.a.Resource),type:this.resource instanceof l.a.Resource?this.resource.type():this.resource,schema:t.schema,model:t.model,meta:t.meta,ready:!1}},watch:{inputError:function(e){this.$emit("error",e)}},methods:{submit:function(){if(this.inputError)return Promise.reject("form error");var e={},t=null;if(this.create){var n=this.type.split("/").pop();t="undefined"!==typeof l.a[n]?l.a[n].create(Object.assign(e,this.model)):l.a.Device.create(this.type,Object.assign(e,this.model))}else t=this.resource.set(Object.assign(e,this.model));return t},getSchemaModel:function(e){var t=this,n=this.resource instanceof l.a.Resource?this.resource.type():this.resource,i=this.resource instanceof l.a.Resource?this.resource:null,r=i?this.$ethingUI.get(i):this.$ethingUI.get(n);r=this.customize(Object(d["a"])(!0,{},r),i,n);var a=r.required||[],o={},s={},c=0,u=function(){c--,c<=0&&"function"===typeof e&&e()},h=function(e){var n=r.properties[e]["$required"]||-1!==a.indexOf(e);if((!r.properties[e]["$readOnly"]||n)&&(o[e]=r.properties[e],r.properties[e]["$required"]&&-1===a.indexOf(e)&&a.push(e),i)){var l=r.properties[e].get(i);l instanceof Promise?(c++,l.then(function(n){t.$set(t.model,e,n)}).finally(u)):s[e]=l}};for(var f in r.properties)h(f);var m=Object.keys(o);return a=a.filter(function(e){return-1!==m.indexOf(e)}),c||u(),{model:s,schema:{type:"object",required:a,properties:o,$order:["name"]},meta:r}},customize:function(e,t,n){return t||("resources/File"===n?(e.properties.content={id:"resource.content",type:"string",$component:"file"},e.properties.name["$dependencies"]={"resource.content":function(e,t,n){n.files.length>0&&(t.c_value=n.files[0].name)}}):"resources/Table"===n&&(e.properties.content={id:"resource.content",type:"string",$component:"file",accept:".json,.csv",$converter:function(e,t,n,i){var r=function(e){if(!Array.isArray(e))return i("invalid file content");for(var t in e){if("object"!==o()(e[t])||null===e[t])return i("invalid file content");if(!e[t].date)return i("no date field for the item "+t);var r=!1;for(var a in e[t])if("date"!=a&&"id"!=a){r=!0;break}if(!r)return i("no data for the item "+t)}n(e)};/\.json$/i.test(e.name)?r(JSON.parse(t)):/\.csv$/i.test(e.name)?h().fromString(t).then(function(e){r(e)}):i("invalid file type")}},e.properties.name["$dependencies"]={"resource.content":function(e,t,n){n.files.length>0&&(t.c_value=n.files[0].name)}})),e}}},m=f,p=n("2877"),v=Object(p["a"])(m,i,r,!1,null,null,null);v.options.__file="ResourceEditor.vue";t["a"]=v.exports},d776:function(e,t,n){},dce1:function(e,t,n){"use strict";var i=n("3bef"),r=n.n(i);r.a},df6e:function(e,t,n){"use strict";var i=n("5f55"),r=n.n(i);r.a},e700:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"card-carousel",class:{hasThumbnails:e.thumbnails,noTitle:!e.noTitle}},[n("div",{staticClass:"card-img"},[n("div",{staticClass:"img-wrapper"},[e.currentImage?n("div",[n("img",{key:e.imgKey,attrs:{src:e.addTimestampToUrl(e.currentImage.getSrc()),alt:""},on:{load:e.onload,error:e.onerror}}),e.loading?n("div",{staticClass:"loader text-center"},[e._v("loading...")]):e._e(),e.error?n("div",{staticClass:"error text-center text-negative"},[e._v("Error")]):e._e(),e.noTitle?e._e():n("div",{staticClass:"title text-center text-faded"},[e._v(e._s(e.currentImage.name()))])]):e._e()]),e.controls&&e.images.length>1?n("div",{staticClass:"actions"},[n("q-btn",{staticClass:"prev",attrs:{round:"",flat:"",size:"lg",icon:"chevron left"},on:{click:e.prevImage}}),n("q-btn",{staticClass:"next",attrs:{round:"",flat:"",size:"lg",icon:"chevron right"},on:{click:e.nextImage}})],1):e._e()]),e.thumbnails&&e.images.length>1?n("div",{staticClass:"thumbnails"},e._l(e.images,function(t,i){return n("div",{key:i,class:["thumbnail-image",e.activeImage==i?"active":""],on:{click:function(t){e.activateImage(i)}}},[n("img",{attrs:{src:t.getThumbSrc(t)}})])})):e._e()])},r=[];i._withStripped=!0;n("7f7f"),n("20d6");var a={name:"ImageViewer",props:{source:{},value:{},thumbnails:Boolean,controls:Boolean,noTitle:Boolean},data:function(){return{activeImage:0,images:[],imgKey:0,loading:!1}},computed:{currentImage:function(){return this.images[this.activeImage]}},watch:{source:function(e){this.setSource(e)},value:function(e){this.activateImage(e)},activeImage:{handler:function(){this.loading=!0,this.error=!1},immediate:!0}},mounted:function(){this.setSource(this.source),this.value&&this.activateImage(this.value)},methods:{setSource:function(e){var t=this;if(Array.isArray(e))this.images=e.map(function(e){return t.parseSource(e)}).filter(function(e){return!!e});else{var n=this.parseSource(e);this.images=[],n&&this.images.push(n)}},nextImage:function(){var e=this.activeImage+1;e>=this.images.length&&(e=0),this.activateImage(e)},prevImage:function(){var e=this.activeImage-1;e<0&&(e=this.images.length-1),this.activateImage(e)},activateImage:function(e){if("number"==typeof e)this.activeImage=e,this.$emit("input",this.images[this.activeImage].source);else{var t=this.images.findIndex(function(t){return t.source===e});-1!==t&&(this.activeImage=t)}},refresh:function(){this.loading=!0,this.error=!1,this.imgKey+=1},parseSource:function(e){var t={};return/^https?:\/\//.test(e)?t={type:"url",getSrc:function(){return e},name:function(){return e}}:e instanceof this.$ething.File&&(t={type:"resource.File",getSrc:function(){return e.getContentUrl(!1)},getThumbSrc:function(){return e.thumbnailLink(!1)},name:function(){return e.name()}}),t.source=e,t},addTimestampToUrl:function(e){return e+(-1===e.indexOf("?")?"?":"&")+Date.now()},onload:function(){this.loading=!1,this.error=!1},onerror:function(e){this.loading=!1,this.error=!0}}},o=a,s=(n("09ff"),n("2877")),l=Object(s["a"])(o,i,r,!1,null,"b9de5618",null);l.options.__file="ImageViewer.vue";t["a"]=l.exports},ea44:function(e,t,n){"use strict";var i=n("0b44"),r=n.n(i);r.a},ed08:function(e,t,n){"use strict";n.r(t);n("ac6a"),n("cadf"),n("456d");var i=n("7037"),r=n.n(i),a=(n("7f7f"),n("4917"),n("3b2b"),n("a481"),n("6b54"),n("f490")),o=n("177b"),s=n("426a"),l=n.n(s),c=n("21a6"),u=n.n(c);function d(){var e=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var t=0;t<e.length;t++)if(e[t]+"Hidden"in document)return e[t]+"Hidden";return null}function h(){var e=d();return!!e&&document[e]}function f(e,t,n){var i=n&&n.waitHidden||0,r=n&&n.waitShown||0,a=null,o=null;function s(t,n){t!==a&&(a=t,e(a,n))}function l(e,t){var n=e?r:i;null!==o&&(clearTimeout(o),o=null),n?o=setTimeout(function(){o=null,s(e,t)},n):s(e,t)}var c=function(e,t){e.length>0&&l(e[0].isIntersecting,"element")},u=new IntersectionObserver(c);u.observe(t);var f=function(){l(!h(),"page")},m=d(),p=null;m&&(p=m.replace(/[H|h]idden/,"")+"visibilitychange",document.addEventListener(p,f,!1)),this.isVisible=function(){return a},this.destroy=function(){u.disconnect(),p&&document.removeEventListener(p,f,!1),null!==o&&(clearTimeout(o),o=null)}}n("5abe");var m=f,p=(n("551c"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("modal",{ref:"modal",attrs:{value:e.value,title:e.title,icon:"add","valid-btn-disable":e.formError,"valid-btn-label":"create","valid-btn-loading":e.loading},on:{input:function(t){e.$emit("input",t)},valid:e.handler,cancel:e.onCancel}},[e.items.length>1?n("q-select",{staticClass:"q-mb-xl",attrs:{options:e.items},model:{value:e.selectedType,callback:function(t){e.selectedType=t},expression:"selectedType"}}):e._e(),e.selectedType?n("resource-editor",{key:e.selectedType,ref:"form",attrs:{resource:e.selectedType},on:{error:function(t){e.formError=t}}}):e._e(),e.error?n("q-alert",{staticClass:"q-mb-xl",attrs:{type:"negative"}},[e._v("\n    "+e._s(String(e.error))+"\n  ")]):e._e()],1)}),v=[];p._withStripped=!0;n("28a5");var b=n("d6ac"),y={name:"ResourceCreateModal",components:{ResourceEditor:b["a"]},props:{value:Boolean,types:Array},data:function(){return{selectedType:this.types[0],loading:!1,error:!1,formError:!1}},computed:{items:function(){var e=this,t=[];return this.types.forEach(function(n){var i=e.$ethingUI.get(n);i.virtual?e.$ethingUI.iterate("resources",function(i){e.$ethingUI.isSubclass(i,n)&&t.push(i)}):t.push(n)}),t=t.filter(function(e,t,n){return n.indexOf(e)===t}),t.map(function(t){var n=e.$ethingUI.get(t),i=t.split("/");return i.pop(),i=i.join(" "),{label:n.title,icon:n.icon,leftColor:n.color,sublabel:i,value:t}})},title:function(){return 1==this.items.length?"create "+this.items[0].label:"create"}},methods:{show:function(){return this.$refs.modal.show()},hide:function(){return this.$refs.modal?this.$refs.modal.hide():Promise.resolve()},onDone:function(e){this.hide(),this.$emit("ok")},onCancel:function(){this.hide(),this.$emit("cancel")},handler:function(){var e=this;this.loading=!0,this.$refs.form.submit().then(this.onDone).catch(function(t){e.error=t||"error"}).finally(function(){e.loading=!1})}}},g=y,_=n("2877"),w=Object(_["a"])(g,p,v,!1,null,null,null);w.options.__file="ResourceCreateModal.vue";var $=w.exports,x=function(e){return new Promise(function(t,n){var i=document.createElement("div");document.body.appendChild(i);var r=function(e){console.log("ok"),t(e),o.$destroy()},a=function(e){console.log("cancel",e),n(e||new Error),o.$destroy()},o=new Vue({el:i,data:function(){return{props:e}},render:function(t){return t($,{ref:"modal",props:e,on:{ok:r,cancel:a}})},mounted:function(){this.$refs.modal.show()}})})};function C(e,t){var n=document.createElement("script"),i=document.getElementsByTagName("script")[0];n.async=1,n.onload=n.onreadystatechange=function(e,i){(i||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=n.onerror=null,n=void 0,i||t&&t())},n.onerror=function(e){n.onload=n.onreadystatechange=n.onerror=null,n=void 0,t&&t(!0)},n.src=e,i.parentNode.insertBefore(n,i)}n.d(t,"isPlainObject",function(){return q}),n.d(t,"isRegExp",function(){return S}),n.d(t,"extend",function(){return O}),n.d(t,"getParameterByName",function(){return j}),n.d(t,"dateToString",function(){return E}),n.d(t,"sizeToString",function(){return D}),n.d(t,"colorNameToHex",function(){return I}),n.d(t,"describe",function(){return T}),n.d(t,"saveAs",function(){return F}),n.d(t,"isDefined",function(){return W}),n.d(t,"isEmptyObject",function(){return A}),n.d(t,"isVueComponent",function(){return M}),n.d(t,"VisibilityObserver",function(){return m}),n.d(t,"createModal",function(){return x}),n.d(t,"injectScript",function(){return C});var k=Object.prototype.toString;function q(e){return"[object Object]"===k.call(e)}function S(e){return"[object RegExp]"===k.call(e)}function O(e){e=e||{};for(var t=1,n=arguments.length;t<n;++t){var i=arguments[t];if(i)for(var r in i)i.hasOwnProperty(r)&&(q(i[r])?e[r]=O(e[r],i[r]):e[r]=i[r])}return e}function j(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),i=n.exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}function E(e){if("string"!==typeof e&&"number"!==typeof e||(e=new Date(e)),!e)return"-";var t=e.getTime();return a["d"].formatDate(t,"YYYY-MM-DD HH:mm")}function D(e){return o["c"].humanStorageSize(e)}function I(e){var t=document.createElement("div");t.style.color=e;var n=window.getComputedStyle(document.body.appendChild(t)).color.match(/\d+/g).map(function(e){return parseInt(e,10)});return document.body.removeChild(t),n.length>=3?"#"+((1<<24)+(n[0]<<16)+(n[1]<<8)+n[2]).toString(16).substr(1):e}function T(e){var t=[],n=function e(t){if(l.a.utils.isId(t)){var n=l.a.arbo.get(t);if(n)return n.name()}return Array.isArray(t)?t.map(function(t){return e(t)}).join(" "):"object"===r()(t)&&null!==t?0===Object.keys(t).length?"":"{...}":null===t?"":String(t)};for(var i in e){var a=e[i],o=n(a);o&&"undefined"!==typeof a&&t.push(i+": "+o)}return t.join(", ")}function F(e,t){return q(e)&&(e=JSON.stringify(e,null,2)),"string"===typeof e&&(e=new Blob([e],{type:"text/plain"})),u.a.saveAs(e,t||"data")}function W(e){return"undefined"!==typeof e}function A(e){return q(e)&&0==Object.keys(e).length}function M(e){return W(e.mixins)||W(e.extends)||W(e.el)||W(e.render)||W(e.template)||W(e.beforeCreate)||W(e.beforeDestroy)}},f2a8:function(e,t,n){},f2b1:function(e,t,n){"use strict";var i=n("8ec6"),r=n.n(i);r.a},f44e:function(e,t,n){"use strict";n.r(t);n("7514"),n("c5f6"),n("cadf"),n("456d"),n("ac6a"),n("f751"),n("a481");var i=n("7037"),r=n.n(i),a=(n("20d6"),n("7f7f"),n("b5ae")),o=n("b0d5"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-schema-layout",style:{display:e.inlined?"inline":"block"}},[!e.forceDescription&&e.inlined||!e.schema.description?e._e():n("small",{staticClass:"form-schema-description",staticStyle:{display:"block"}},[n("vue-markdown",{staticClass:"markdown",attrs:{anchorAttributes:{target:"_blank"}}},[e._v(e._s(e.schema.description.trim()))])],1),e._t("default"),!e.inlined&&e.error?n("small",{staticClass:"form-schema-error",staticStyle:{display:"block"}},[e._v("\n    "+e._s(e.error)+"\n  ")]):e._e()],2)},l=[];s._withStripped=!0;var c=n("9ce6"),u=n.n(c),d={name:"formSchemaLayout",components:{VueMarkdown:u.a},props:{forceDescription:Boolean},computed:{inlined:function(){return this.$parent.inlined},schema:function(){return this.$parent.c_schema},error:function(){return this.$parent.error},level:function(){return this.$parent.level}}},h=d,f=(n("9ba1"),n("2877")),m=Object(f["a"])(h,s,l,!1,null,"381c6d96",null);m.options.__file="FormSchemaLayout.vue";var p=m.exports;n("a026");n.d(t,"makeForm",function(){return j}),n.d(t,"FormComponent",function(){return E}),n.d(t,"registerForm",function(){return _}),n.d(t,"unregisterForm",function(){return w}),n.d(t,"addDefinitionsHandler",function(){return D}),n.d(t,"resolve",function(){return O}),n.d(t,"coreComponents",function(){return y});var v=!1,b=[],y=[],g=[],_=function(e,t){g.push({component:e,test:t,name:e.name?x(e.name):""})},w=function(e){var t=g.findIndex(function(t){return t.component===e});-1!==t&&g.splice(t,1)};function $(e){if(null===e||"object"!==r()(e)||"isActiveClone"in e)return e;if(e instanceof Date)var t=new e.constructor;else t=e.constructor();for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e["isActiveClone"]=null,t[n]=$(e[n]),delete e["isActiveClone"]);return t}function x(e){return e.replace(/[_\.\-]/g,"").toLowerCase().replace(/^formschema/,"")}function C(e,t,n){var i=null;if(i="function"===typeof n?n:k(e),"function"===typeof i)try{return i(t)}catch(e){}}function k(e){if("undefined"!==typeof e.rule)return e.rule;if(Array.isArray(e.mixins))for(var t in e.mixins){var n=e.mixins[t],i=k(n);if(i)return i}}var q=function(e){if("string"===typeof e["$ref"]){var t=Object.assign({},e);delete t["$ref"];var n=e["$ref"],i=null;for(var a in b)if(i=b[a](n),"object"===r()(i)&&null!==i)break;e=O(Object(o["a"])(!0,t,i))}return e},S=function(e){if(Array.isArray(e.allOf)){var t=Object.assign({},e);delete t.allOf,e.allOf.forEach(function(e){t=Object(o["a"])(!0,t,O(e))}),e=t}return e},O=function(e){return S(q(e))},j=function(e,t,n){var i=t.schema=O(t.schema);if(i&&0!==Object.keys(i).length){var r={props:t,on:n},a=i["$component"],o=a?x(a):void 0,s=!1;for(var l in g){var c=g[l];if(a&&c.name&&c.name===o)return e(c.component,r);if(!1===s&&C(c.component,i,c.test)&&(s=c.component,!a))break}for(var u in y){var d=y[u],h=d.name;if(a&&o===x(h))return e(d,r);if(!1===s&&C(d,i)&&(s=d,!a))break}if(a&&console.warn("[form] component not found: "+a),!1!==s)return e(s,r);console.error("unable to render the schema",Object.assign({},i))}},E={components:{FormSchemaLayout:p},props:{inline:{default:"inherit"},value:{},schema:{},context:Object,required:{type:Boolean,default:!1},level:{type:Number,default:0}},data:function(){var e=this.schema.id;return e||(e=this.schema.type+"-"+parseInt(1e4*Math.random()),this.schema["$idPrefix"]&&(e=String(this.schema["$idPrefix"])+"-"+e)),{id:e,c_schema:null,formSchemaNode:!0,formSchemaCache:void 0}},watch:{schema:{handler:function(e,t){v&&this.log("watch schema",$(e)),this.c_schema=Object(o["a"])(!0,{},e)},immediate:!0,deep:!0},value:{handler:function(e,t){v&&this.log("watch value"),"undefined"!==typeof this.formSchemaCache&&(this.formSchemaCache=void 0,v&&this.log("clear cache"))},immediate:!0},c_value:{handler:function(e,t){v&&this.log("watch c_value",$(e),"prev",$(t)),this.$v.c_value.$touch()},immediate:!0},error:{handler:function(e,t){v&&this.log("watch error",$(e),"prev",$(t)),this.$emit("error",e)},immediate:!0}},computed:{inlined:function(){var e=this.inline;if(""===e&&(e=!0),"undefined"!==typeof this.schema["$inline"]&&(e=r()(this.schema["$inline"])),"inherit"===e){var t=this.parent();return!!t&&t.inlined}return!!e},c_value:{get:function(){return"undefined"!==typeof this.formSchemaCache?(v&&this.log("c_value.get (cache)",$(this.formSchemaCache)),this.formSchemaCache):(v&&this.log("c_value.get",$(this.value)),"undefined"!==typeof this.value?this.cast(this.value):this.value)},set:function(e){v&&this.log("c_value.set",$(e)),this.formSchemaCache=e,this.$emit("input",e)},cache:!0},error:function(){return v&&this.log("compute error",this.$v.c_value.$error),!!this.$v.c_value.$error&&("undefined"==typeof this.$v.c_value.required||this.$v.c_value.required?"undefined"==typeof this.$v.c_value.minLength||this.$v.c_value.minLength?"undefined"==typeof this.$v.c_value.maxLength||this.$v.c_value.maxLength?"undefined"==typeof this.$v.c_value.minValue||this.$v.c_value.minValue?"undefined"==typeof this.$v.c_value.maxValue||this.$v.c_value.maxValue?"undefined"==typeof this.$v.c_value.between||this.$v.c_value.between?"undefined"==typeof this.$v.c_value.alpha||this.$v.c_value.alpha?"undefined"==typeof this.$v.c_value.alphaNum||this.$v.c_value.alphaNum?"undefined"==typeof this.$v.c_value.numeric||this.$v.c_value.numeric?"undefined"==typeof this.$v.c_value.email||this.$v.c_value.email?"undefined"==typeof this.$v.c_value.ipAddress||this.$v.c_value.ipAddress?"undefined"==typeof this.$v.c_value.macAddress||this.$v.c_value.macAddress?"undefined"==typeof this.$v.c_value.url||this.$v.c_value.url?"undefined"==typeof this.$v.c_value.regex||this.$v.c_value.regex?"Invalid value":"Does not match the pattern `"+this.$v.c_value.$params.regex.pattern+"`":"Accepts only URLs":"Accepts only valid MAC addresses like 00:ff:11:22:33:44:55":"Accepts only valid IPv4 addresses in dotted decimal notation like 127.0.0.1":"Accepts only valid email addresses":"Accepts only numerics":"Accepts only alphanumerics":"Accepts only alphabet characters":"must be between "+this.$v.c_value.$params.between.min+" and "+this.$v.c_value.$params.between.max:"must be lower than or equal to "+this.$v.c_value.$params.maxValue.max:"must be greater than or equal to "+this.$v.c_value.$params.minValue.min:"must have maximum "+this.$v.c_value.$params.maxLength.max+" characters":"must have minimum "+this.$v.c_value.$params.minLength.min+" characters":"Field is required")}},methods:{cast:function(e){return e},getDefault:function(){},log:function(){var e=Array.prototype.slice.call(arguments);e.unshift("["+this.id+"]"),console.log.apply(console,e)},getContext:function(e){if(!e){var t=this.parseContext(window["FormSchemaContext"]),n=this.parent();return n&&Object(o["a"])(!0,t,this.parseContext(n.getContext())),Object(o["a"])(!0,t,this.parseContext(this.context)),t}return this.getContext()[e]},parseContext:function(e){e=e||{};var t=e["global"]||{},n=this.$options.name,i=x(n);for(var r in e)if(x(r)===i){Object.assign(t,e[r]||{});break}return Object.assign(t,e[this.id]||{}),t},parent:function(){var e=this.$parent;while(e&&!e.formSchemaNode)e=e.$parent;return e},root:function(){var e,t=this;while(t)e=t,t=t.parent();return e},children:function(){return this._children(this)},_children:function(e){var t=[];for(var n in e.$children){var i=e.$children[n];i.formSchemaNode?t.push(i):t=t.concat(this._children(i))}return t},find:function(e){var t=this._find_down(this,e);return t||this._find_up(this,e)},_find_up:function(e,t){var n=e.parent();if(n){if(n._is(t))return n;var i=n.children();for(var r in i){var a=i[r];if(a!==e){var o=this._find_down(a,t);if(o)return o}}return this._find_up(n,t)}},_find_down:function(e,t){if(e._is(t))return e;var n=e.children();for(var i in n){var r=this._find_down(n[i],t);if(r)return r}},_is:function(e){return this.schema.id===e},_install_dep:function(e,t){var n=this;e.$on("input",function(i){n.$nextTick(function(){t.call(n,i,n,e)})}),t.call(this,e.c_value,this,e)}},validations:function(){return v&&this.log("validations",this.required),{c_value:this.required?{required:a["required"]}:{}}},mounted:function(){v&&this.log("mounting component");var e=!1;if("undefined"===typeof this.c_value){var t=void 0;t="undefined"!==typeof this.c_schema.default?this.c_schema.default:this.getDefault(),"undefined"!==typeof t&&(e=!0,v&&this.log("set default on mounted",t),this.c_value=t)}if(e||this.$v.c_value.$touch(),this.c_schema["$dependencies"])for(var n in this.c_schema["$dependencies"]){var i=this.c_schema["$dependencies"][n],r=this.find(n);v&&this.log("find node",n),r&&i?this._install_dep(r,i):r||console.warn('[form-schema] node with id ""'+n+'" not found for '+this.$options.name)}}};function D(e){b.push(e)}},fb1c:function(e,t,n){},fd77:function(e,t,n){},fe54:function(e,t,n){},ffbd:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-select",e._b({attrs:{value:e.formattedValue,options:e.options,multiple:e.multiple,after:e.after},on:{input:function(t){e.$emit("input",t)}}},"q-select",e.$attrs,!1))},r=[];i._withStripped=!0;n("7f7f"),n("7514"),n("28a5"),n("426a");var a=n("ed08"),o={name:"ResourceSelect",props:{type:String,notType:String,filter:{},value:{},useId:Boolean,multiple:Boolean,disableCreate:Boolean,createTypes:Array},data:function(){return{}},computed:{formattedValue:function(){return this.multiple?Array.isArray(this.value)?this.value:this.value?[this.value]:[]:this.value},resources:function(){var e=this,t=null,n=null;return this.notType&&(t=this.notType.split(/[ ;,]+/)),this.type&&(n=this.type.split(/[ ;,]+/)),this.$ething.arbo.find(function(i){if(t)for(var r in t)if(i.isTypeof(t[r]))return!1;if(n){var a=!1;for(var r in n)if(i.isTypeof(n[r])){a=!0;break}if(!a)return!1}return!e.filter||!!e.filter(i)})},options:function(){var e=this;return this.resources.map(function(t){for(var n=[],i=t,r=0;r<2;r++){var a=i.createdBy()?e.$ething.arbo.get(i.createdBy()):null;if(!a)break;n.push(a),i=a}var o=e.$ethingUI.get(t);return{label:t.name(),value:e.useId?t.id():t,icon:e.$ethingUI.get(t).icon,leftColor:e.$ethingUI.get(t).color,inset:!0,stamp:o.title,sublabel:n.length?n.reverse().map(function(e){return e.basename()}).join(" -> "):void 0}})},computedCreateTypes:function(){return this.createTypes?this.createTypes:this.type?this.type.split(/[ ;,]+/):[]},after:function(){var e=this;return this.disableCreate||0==this.computedCreateTypes.length?[]:[{icon:"add",handler:function(){e.openCreateModal()}}]}},methods:{openCreateModal:function(){Object(a["createModal"])({types:this.computedCreateTypes})}}},s=o,l=n("2877"),c=Object(l["a"])(s,i,r,!1,null,null,null);c.options.__file="ResourceSelect.vue";t["a"]=c.exports}},[[0,"runtime","vendor"]]]);