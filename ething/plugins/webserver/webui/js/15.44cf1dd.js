(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[15],{"08P6":function(t,e,n){"use strict";var o=n("ZQQ3"),i=n.n(o);i.a},"4ZMo":function(t,e,n){t.exports=n("ETiO")(286)},ZQQ3:function(t,e,n){},r7mn:function(t,e,n){t.exports=n("ETiO")(287)},yWG4:function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-page",{attrs:{padding:""}},[n("q-btn",{attrs:{label:"add node"},on:{click:function(e){t.addNodeToFlow({type:"event",model:{type:"events/CustomEvent",name:"toto"}})}}}),n("q-btn",{attrs:{label:"add event"},on:{click:function(e){t.addNodeClick("event")}}}),n("q-btn",{attrs:{label:"add condition"},on:{click:function(e){t.addNodeClick("condition")}}}),n("q-btn",{attrs:{label:"add action"},on:{click:function(e){t.addNodeClick("action")}}}),n("q-btn",{attrs:{label:"export"},on:{click:t.exportFlow}}),n("div",{ref:"flowchart",staticClass:"flowchart jtk-surface jtk-surface-nopan"},t._l(t.nodes,function(e){return n("div",{key:e.id,ref:"node",refInFor:!0,staticClass:"node",class:e.type,attrs:{"data-id":e.id}},[n("strong",[t._v(t._s(t.nodeTitle(e)))]),n("q-btn",{attrs:{flat:"",dense:"",icon:"edit",size:"sm",color:"faded"},on:{click:function(n){t.editNode(e)}}})],1)})),n("modal",{attrs:{title:"Add "+t.edit.type,icon:"add","valid-btn-disable":t.edit.error,"valid-btn-label":"Add"},on:{valid:t.onEditDone},model:{value:t.edit.show,callback:function(e){t.$set(t.edit,"show",e)},expression:"edit.show"}},[n("form-schema",{attrs:{schema:{format:"ething."+t.edit.type}},on:{error:function(e){t.edit.error=e}},model:{value:t.edit.model,callback:function(e){t.$set(t.edit,"model",e)},expression:"edit.model"}})],1)],1)},i=[];o._withStripped=!0;n("rGqo"),n("KKXr");var d=n("4ZMo"),s=(n("r7mn"),{connector:"StateMachine",paintStyle:{stroke:"red",strokeWidth:4},hoverPaintStyle:{stroke:"blue"},overlays:["Arrow"]}),a={strokeWidth:2,stroke:"#61B7CF",joinstyle:"round",outlineStroke:"white",outlineWidth:2},l={strokeWidth:3,stroke:"#216477",outlineWidth:5,outlineStroke:"white"},r={fill:"#216477",stroke:"#216477"},c={endpoint:"Dot",paintStyle:{stroke:"#7AB02C",fill:"transparent",radius:7,strokeWidth:1},isSource:!0,connector:["Flowchart",{stub:[40,60],gap:10,cornerRadius:5,alwaysRespectStubs:!0}],connectorStyle:a,hoverPaintStyle:r,connectorHoverStyle:l,dragOptions:{},overlays:[["Label",{location:[.5,1.5],label:"Drag",cssClass:"endpointSourceLabel",visible:!1}]]},u={endpoint:"Dot",paintStyle:{fill:"#7AB02C",radius:7},hoverPaintStyle:r,maxConnections:-1,dropOptions:{hoverClass:"hover",activeClass:"active"},isTarget:!0,overlays:[["Label",{location:[.5,-.5],label:"Drop",cssClass:"endpointTargetLabel",visible:!1}]]},p=function(t){},f={name:"PageTest",data:function(){return{instance:null,nodes:[],edit:{type:null,show:!1,model:void 0,error:!1,node:null}}},methods:{addNodeToFlow:function(t,e){var n=this;if(this.instance){if("undefined"===typeof t.id&&(t.id=this.getId()),"undefined"===typeof t.type)throw"no node.type defined";"undefined"===typeof t.x&&(t.x=0),"undefined"===typeof t.y&&(t.y=0),this.nodes.push(t),this.$nextTick(function(){var o=n.getNodeElement(t.id);t.el=o,o.style.left=t.x+"px",o.style.top=t.y+"px",n.instance.batch(function(){"event"==t.type?n.instance.addEndpoint(o,c,{anchor:"RightMiddle",uuid:t.id+".outputs.default"}):"condition"==t.type?(n.instance.addEndpoint(o,c,{anchor:"RightMiddle",uuid:t.id+".outputs.default"}),n.instance.addEndpoint(o,c,{anchor:"BottomCenter",uuid:t.id+".outputs.fail"}),n.instance.addEndpoint(o,u,{anchor:"LeftMiddle",uuid:t.id+".inputs.default"})):"action"==t.type&&(n.instance.addEndpoint(o,c,{anchor:"RightMiddle",uuid:t.id+".outputs.default"}),n.instance.addEndpoint(o,u,{anchor:"LeftMiddle",uuid:t.id+".inputs.default"})),n.instance.draggable(o,{grid:[20,20]})}),e&&e(t)})}},getId:function(){return String(Math.floor(1e7*Math.random())+1)},getNodeElement:function(t){if(this.$refs.node)for(var e in this.$refs.node){var n=this.$refs.node[e];if(n.getAttribute("data-id")==t)return n}},addNodeClick:function(t){this.edit.node=null,this.edit.type=t,this.edit.model=void 0,this.edit.error=!1,this.edit.show=!0},editNode:function(t){this.edit.node=t,this.edit.type=t.type,this.edit.model=t.model,this.edit.error=!1,this.edit.show=!0},onEditDone:function(){this.edit.show=!1,this.edit.node?this.edit.node.model=this.edit.model:this.addNodeToFlow({type:this.edit.type,model:this.edit.model})},nodeTitle:function(t){return t.model?t.model.type.split("/").pop():t.type},exportFlow:function(){if(this.instance){var t=this.nodes.map(function(t){return{x:t.el.style.left,y:t.el.style.top,id:t.id,type:t.type,model:t.model}}),e=this.instance.getConnections().map(function(t){var e=t.endpoints,n=e[0].element.getAttribute("data-id"),o=e[1].element.getAttribute("data-id"),i=e[0].getUuid().split(".").pop(),d=e[1].getUuid().split(".").pop();return{src:[n,i],dest:[o,d]}});return{nodes:t,connections:e}}},importFlow:function(t){var e=this;this.instance&&(t.nodes.forEach(function(t){e.addNodeToFlow(t)}),t.connections.forEach(function(t){var n=t.src,o=t.dest;e.instance.connect({uuids:[n[0]+".outputs."+n[1],o[0]+".inputs."+o[1]],editable:!0})}))}},mounted:function(){var t=this.instance=d["jsPlumb"].getInstance({DragOptions:{cursor:"pointer",zIndex:2e3},ConnectionOverlays:[["Arrow",{location:1,visible:!0,width:11,length:11,id:"ARROW",events:{}}],["Label",{location:.1,id:"label",cssClass:"aLabel",events:{}}]],Container:this.$refs.flowchart});t.registerConnectionType("basic",s),t.batch(function(){t.bind("connection",function(t,e){p(t.connection)}),t.bind("click",function(e,n){confirm("Delete connection from "+e.sourceId+" to "+e.targetId+"?")&&t.deleteConnection(e)})}),this.addNodeToFlow({type:"event",model:{type:"events/CustomEvent",name:"toto"},x:250,y:300}),this.addNodeToFlow({type:"action",model:{type:"actions/Wait",duration:1e3},x:550,y:300})}},h=f,y=(n("08P6"),n("KHd+")),v=Object(y["a"])(h,o,i,!1,null,null,null);v.options.__file="Test.vue";e["default"]=v.exports}}]);