(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["app"],{0:function(e,t,n){e.exports=n("2f39")},"0292":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:{expended:e.expended}},[n("q-resize-observer",{on:{resize:e.onResize}}),e.options?n("highstock",{ref:"highcharts",staticClass:"chart",class:{expended:e.expended},attrs:{options:e.options}}):n("div",{staticClass:"absolute-center text-center"},[n("q-btn",{attrs:{label:"new plot",icon:"timeline",flat:"",color:"primary"},on:{click:function(t){e.optionsModal=!0}}})],1),n("q-inner-loading",{staticClass:"text-center",attrs:{showing:e.loading}},[n("q-spinner-oval",{attrs:{color:"primary",size:"50px"}})],1),n("modal",{attrs:{title:"Chart save",icon:"save",size:"xs","valid-btn-label":"Save"},on:{valid:e.onSave,show:e.$v.filename.$touch},model:{value:e.saveModal,callback:function(t){e.saveModal=t},expression:"saveModal"}},[n("q-input",{attrs:{error:e.$v.filename.$error,"error-message":"Required",label:"Filename"},on:{input:e.$v.filename.$touch},model:{value:e.filename,callback:function(t){e.filename=t},expression:"filename"}})],1),n("modal",{attrs:{size:"lg","no-esc-dismiss":!e.options,"no-backdrop-dismiss":!e.options,title:"Chart options",icon:"edit","valid-btn-disable":e.$v.optionsData.$error},on:{valid:e.onOptionsValidate},model:{value:e.optionsModal,callback:function(t){e.optionsModal=t},expression:"optionsModal"}},[n("q-input",{attrs:{label:"Title"},model:{value:e.optionsData.title,callback:function(t){e.$set(e.optionsData,"title",t)},expression:"optionsData.title"}}),n("q-input",{attrs:{label:"Subtitle"},model:{value:e.optionsData.subtitle,callback:function(t){e.$set(e.optionsData,"subtitle",t)},expression:"optionsData.subtitle"}}),n("div",{staticClass:"q-my-md"},[n("div",{staticClass:"q-subheading q-mb-md"},[e._v("\n        Panes\n        "),n("q-btn",{attrs:{flat:"",size:"sm",color:"blue-5",label:"Add pane",icon:"add"},on:{click:function(t){e.optionsData.panes.push({curves:[]}),e.$v.optionsData.$touch()}}})],1),n("div",{staticClass:"q-ml-md q-mb-md"},e._l(e.optionsData.panes,function(t,i){return n("div",{key:i,staticClass:"pane"},[n("q-input",{attrs:{label:"name/unit",error:e.$v.optionsData.panes.$each[i].name.$error,"error-message":"Required"},on:{blur:e.$v.optionsData.panes.$each[i].name.$touch},model:{value:t.name,callback:function(n){e.$set(t,"name",n)},expression:"pane.name"}}),n("div",{staticClass:"q-my-md"},[n("div",{staticClass:"q-subheading q-mb-md"},[e._v("\n              Curves\n              "),n("q-btn",{attrs:{flat:"",size:"sm",color:"cyan-5",label:"Add",icon:"add"},on:{click:function(n){t.curves.push({type:"line",data:{}}),e.$v.optionsData.$touch()}}})],1),n("div",{staticClass:"q-ml-md q-mb-md"},e._l(t.curves,function(r,a){return n("div",{key:a,staticClass:"curve"},[n("q-input",{attrs:{label:"name",error:e.$v.optionsData.panes.$each[i].curves.$each[a].name.$error,"error-message":"Required"},on:{blur:e.$v.optionsData.panes.$each[i].curves.$each[a].name.$touch},model:{value:r.name,callback:function(t){e.$set(r,"name",t)},expression:"curve.name"}}),n("q-select",{attrs:{label:"type",options:e.serieTypeOptions,error:e.$v.optionsData.panes.$each[i].curves.$each[a].type.$error,"error-message":"Required"},on:{blur:e.$v.optionsData.panes.$each[i].curves.$each[a].type.$touch},model:{value:r.type,callback:function(t){e.$set(r,"type",t)},expression:"curve.type"}}),n("resource-select",{attrs:{type:"resources/Table",label:"table","use-id":"",error:e.$v.optionsData.panes.$each[i].curves.$each[a].data.resource.$error,"error-message":"Required"},on:{input:e.$v.optionsData.panes.$each[i].curves.$each[a].data.resource.$touch},model:{value:r.data.resource,callback:function(t){e.$set(r.data,"resource",t)},expression:"curve.data.resource"}}),r.data.resource?n("q-select",{attrs:{label:"key",options:e.optionsBuildKeyOptions(r,e.$v.optionsData.panes.$each[i].curves.$each[a].data.key),error:e.$v.optionsData.panes.$each[i].curves.$each[a].data.key.$error,"error-message":"Required"},on:{input:e.$v.optionsData.panes.$each[i].curves.$each[a].data.key.$touch},model:{value:r.data.key,callback:function(t){e.$set(r.data,"key",t)},expression:"curve.data.key"}}):e._e(),n("q-btn",{attrs:{flat:"",size:"sm",color:"negative",label:"remove",icon:"delete"},on:{click:function(e){return t.curves.splice(a,1)}}})],1)}),0)]),n("q-btn",{attrs:{flat:"",size:"sm",color:"negative",label:"remove",icon:"delete"},on:{click:function(t){return e.optionsData.panes.splice(i,1)}}})],1)}),0)])],1)],1)},r=[],a=(n("7f7f"),n("ac6a"),n("cadf"),n("551c"),n("06db"),n("097d"),n("426a")),o=n.n(a),s=n("2b0e"),c=n("58a2"),l=n("ea7f"),u=n.n(l),d=n("37d8"),h=n.n(d),f=n("0319"),m=n.n(f),p=n("11ec"),v=n("ffbd"),b=n("1c16"),y=n("b5ae");function g(){this.sources=[],this.history="all"}function _(e,t){e=new Date(e);if("number"!=typeof t)if("string"===typeof t){if(t=parseFloat(t),isNaN(t))return}else"boolean"===typeof t&&(t=t?1:0);return[e.getTime(),t]}h()(u.a),m()(u.a),s["default"].use(c["a"],{Highcharts:u.a}),g.prototype.clear=function(){this.sources=[],this.history="all"},g.prototype.setHistory=function(e){this.history=e},g.prototype.add=function(e,t){var n=this,i=o.a.arbo.get(e.resource);if(i instanceof o.a.Table){var r=null,a=e.key;for(var s in this.sources)if(this.sources[s].resource===i.id()){r=this.sources[s];break}r||(r={resource:i.id(),keys:[],done:[],fetch:function(e){var t=this,i=o.a.arbo.get(this.resource),r=null;if("number"===typeof n.history){var a=new Date(Date.now()-1e3*parseInt(n.history));r="$.date > dateTime('"+a.toISOString()+"')"}i.select({fields:["date"].concat(this.keys),query:r}).then(function(e){t.done.forEach(function(t){t(e)})}).finally(function(){e()})}},this.sources.push(r)),r.keys.push(a),r.done.push(function(e){var n=e.filter(function(e){return e.hasOwnProperty(a)}).map(function(e){return _(e.date,e[a])});t(n)})}},g.prototype.load=function(e){var t=this.sources.length;function n(){t--,0===t&&"function"===typeof e&&e()}this.sources.forEach(function(e){e.fetch.call(e,n)})};var w={name:"Chart",props:{preferences:{},expended:Boolean,dense:Boolean,minimal:Boolean,readonly:Boolean,noZoom:Boolean,history:{},chartOptions:{type:Object,default:function(){return{}}}},components:{ResourceSelect:v["a"]},data:function(){var e="",t=!1;if("string"===typeof this.preferences){var n=this.$ething.arbo.get(this.preferences);n instanceof this.$ething.File&&(t=n)}else this.preferences instanceof this.$ething.File&&(t=this.preferences);return t&&(e=t.name()),{loading:!1,dataSource:new g,options:!1,optionsModal:!this.preferences,optionsData:{panes:[{curves:[{type:"line",data:{}}]}]},serieTypeOptions:[{label:"line",value:"line"},{label:"column",value:"column"},{label:"scatter",value:"scatter"},{label:"area",value:"area"},{label:"spline",value:"spline"}],saveModal:!1,filename:e,file:t,table:null}},validations:function(){return{filename:{required:y["required"]},optionsData:{required:y["required"],panes:{required:y["required"],minLength:Object(y["minLength"])(1),$each:{name:{required:y["required"]},curves:{required:y["required"],minLength:Object(y["minLength"])(1),$each:{name:{required:y["required"]},type:{required:y["required"]},data:{required:y["required"],resource:{required:y["required"]},key:{required:y["required"]}}}}}}}}},methods:{load:function(e){var t=this;this.loading=!0,this.currentPreferences=Object(p["a"])(!0,{},e),this.dataSource.clear(),this.dataSource.setHistory(this.history||e.history||"all");var n=e.title;if(this.dense&&e.subtitle&&(n?n+=" - "+e.subtitle:n=e.subtitle),this.options=Object(p["a"])(!0,{chart:{plotBorderWidth:0,zoomType:this.noZoom?"":"x",spacingBottom:10},exporting:{menuItemDefinitions:{refresh:{onclick:function(){t.refresh()},text:"refresh"},options:{onclick:function(){t.optionsModal=!0},text:"options"},save:{onclick:function(){t.currentPreferences&&(t.saveModal=!0)},text:"save"}},buttons:{contextButton:{menuItems:this.readonly?["refresh","separator","downloadPNG","downloadJPEG","downloadPDF"]:["refresh","options","save","separator","downloadPNG","downloadJPEG","downloadPDF"]}},enabled:!this.minimal},rangeSelector:{buttons:[{type:"hour",count:12,text:"12h"},{type:"day",count:1,text:"1d"},{type:"week",count:1,text:"1w"},{type:"month",count:1,text:"1m"},{type:"all",text:"All"}],selected:this.noZoom?4:1,enabled:!(this.dense||this.minimal||this.noZoom)},tooltip:{xDateFormat:"%Y-%m-%d %H:%M",valueDecimals:3},navigator:{enabled:!(this.dense||this.minimal||this.noZoom)},scrollbar:{enabled:!this.noZoom},xAxis:{type:"datetime",ordinal:!1,tickLength:5},credits:{enabled:!1},plotOptions:{column:{dataGrouping:{approximation:"average"}},series:{animation:!1}},series:[],yAxis:[],title:{text:this.minimal?null:n},subtitle:{text:this.dense||this.minimal?null:e.subtitle},time:{useUTC:!1}},this.chartOptions),!e.panes)return this.loading=!1,void setTimeout(function(){t.chart().showLoading("no data")},1e3);var i=5,r=(100-(e.panes.length-1)*i)/e.panes.length;e.panes.forEach(function(e,n){var a="axis-"+n,o={title:{text:e.name||""},resize:{enabled:!0},height:r+"%",top:n*(r+i)+"%",offset:0,labels:{align:"right",x:-3,y:4},lineWidth:0,opposite:!1,showLastLabel:!0,gridLineWidth:1,id:a};t.options.yAxis.push(o),e.curves.forEach(function(e,n){var i=null;e.data.resource&&e.data.key&&(i="s-"+e.data.resource+"-"+e.data.key);var r={showInNavigator:!0,type:e.type||"line",name:e.name||"data "+n,data:[],yAxis:a,id:i};t.dataSource.add(e.data,function(e){if(e.length&&(r.data=e,-1===t.options.series.indexOf(r))){var n=!0;for(var i in e){var a=e[i][1];if(0!=a&&1!=a){n=!1;break}}n&&(r.step="left"),t.options.series.push(r)}})})}),this.dataSource.load(function(){t.loading=!1,0==t.options.series.length&&t.chart().showLoading("no data")})},refresh:function(){var e=this;this.loading=!0,this.dataSource.load(function(){e.loading=!1})},onOptionsValidate:function(){this.load(this.optionsData),this.optionsModal=!1},optionsBuildKeyOptions:function(e){var t=this.$ething.arbo.get(e.data.resource);if(t){var n=t.keys();return n.length&&this.$set(e.data,"key",n[0]),n.map(function(e){return{label:e,value:e}})}},onSave:function(){var e=this,t=JSON.stringify(this.currentPreferences,null,4);/\.plot$/.test(this.filename)||(this.filename=this.filename+".plot"),this.file&&this.file.name()===this.filename?this.file.write(t):this.filename.length&&this.$ething.File.create({name:this.filename,content:t}).then(function(t){e.file=t}),this.saveModal=!1},chart:function(){return this.$refs.highcharts?this.$refs.highcharts.chart:void 0},onResize:function(e){this.resize()},resize:Object(b["a"])(function(){var e=this.chart();e&&e.reflow()},1e3),onTableUpdate:function(e,t){-1!==t.indexOf("contentModifiedDate")&&this.refresh()},onTableDataAdded:function(e){var t=e.data,n=this.chart();for(var i in t)if("id"!==i&&"date"!==i){var r="s-"+this.table.id()+"-"+i,a=n.get(r);if(a){if("number"===typeof this.dataSource.history){var o=Date.now()-1e3*parseInt(this.dataSource.history),s=0;for(var c in a.xData){var l=a.xData[c];if(!(l<o))break;s++}for(c=0;c<s;c++)a.removePoint(0,!1)}var u=_(t.date,t[i]);u&&a.addPoint(u)}}}},mounted:function(){var e=this;if(this.$v.optionsData.$touch(),this.file)this.file.read().then(function(t){try{var n="string"===typeof t?JSON.parse(t):t;e.optionsData=n,e.load(n)}catch(i){console.error("[chart] unable to load chart file",i)}});else{var t={},n=null;if("string"===typeof this.preferences&&(n=this.$ething.arbo.get(this.preferences)),this.preferences instanceof this.$ething.Table&&(n=this.$ething.arbo.get(this.preferences.id())),n){this.table=n,n.on("TableDataAdded",this.onTableDataAdded);var i=this.$ething.arbo.get(n.createdBy());i&&(t.subtitle='<a href="#'+this.$ethingUI.route(i)+'">'+i.basename()+"</a>"),t.title='<a href="#'+this.$ethingUI.route(n)+'">'+n.basename()+"</a>",t.panes=[],n.keys().forEach(function(e){var i={name:e,curves:[{name:e,type:"line",data:{resource:n.id(),key:e}}]};t.panes.push(i)})}else t=this.preferences;t&&(this.optionsData=t,this.load(t))}},beforeDestroy:function(){this.table&&(this.table.off("updated",this.onTableUpdate),this.table.off("TableDataAdded",this.onTableDataAdded))}},x=w,$=(n("b4a1"),n("2877")),C=Object($["a"])(x,i,r,!1,null,"3333bf4b",null);t["a"]=C.exports},"0b6e":function(e,t,n){},"0de1":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.items.length>0?n("q-timeline",{attrs:{layout:"dense"}},e._l(e.items,function(t,i){return n("q-timeline-entry",{key:t.ts,attrs:{subtitle:t.dateStr,color:"secondary"},scopedSlots:e._u([{key:"title",fn:function(){return[n("div",{staticClass:"text-secondary text-subtitle1"},[t.icon?n("q-icon",{attrs:{name:t.icon}}):e._e(),e._v(" "+e._s(t.title))],1),e.multiple?n("div",{staticClass:"text-purple text-subtitle2"},[e._v("\n          "+e._s(t.resource.name())+"\n        ")]):e._e()]},proxy:!0}],null,!0)},[n("div",{staticClass:"text-faded"},[e._v("\n        "+e._s(t.dataStr)+"\n      ")])])}),1):n("div",{staticClass:"text-center text-faded"},[e._v("No activity. Please wait...")])],1)},r=[],a=(n("55dd"),n("c5f6"),{name:"ResourceActivity",props:{source:{},historyLength:{type:Number,default:20},reverse:Boolean},computed:{multiple:function(){return Array.isArray(this.source)&&this.source.length>1},items:function(){var e=this,t=[],n=this.source;return Array.isArray(n)||(n=[n]),n.forEach(function(n){n instanceof e.$ething.Resource&&(n=n.id());var i=e.$ethingUI.activity[n];i&&(t=t.concat(i))}),t.sort(function(e,t){return e.timeStamp-t.timeStamp}),this.historyLength>0&&(t=t.slice(Math.max(t.length-this.historyLength,0))),this.reverse||t.reverse(),t.map(function(t){var n=e.$ethingUI.get(t.type)||{},i=null;try{i=e.$ething.arbo.get(t.originalEvent.resource.id)}catch(r){}return{title:n.title||t.type,icon:n.icon,dateStr:e.$ethingUI.utils.dateToString(t.timeStamp),dataStr:e.$ethingUI.utils.describe(t.data),ts:t.timeStamp,event:t,resource:i}})}},methods:{}}),o=a,s=n("2877"),c=Object(s["a"])(o,i,r,!1,null,null,null);t["a"]=c.exports},1:function(e,t){},"113e":function(e,t,n){},"13f6":function(e,t,n){"use strict";var i=n("14ad"),r=n.n(i);r.a},"14ad":function(e,t,n){},"25d4":function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"d",function(){return a}),n.d(t,"a",function(){return o}),n.d(t,"c",function(){return c});n("f751");var i=n("11ec"),r={},a={component:null,attributes:{},zIndex:0,title:"",description:"",icon:"",minWidth:0,minHeight:0,schema:{type:"object"},devicePage:{padding:!0},in:["dashboard"]};function o(e,t){return{type:"object",required:["title"],properties:{title:{type:"string",minLength:0,default:t?"%name%":e.title||e.schema&&e.schema.title||""},color:{type:"string",$component:"color",$optional:!0,description:"The color of the widget",default:"#027be3"},bgColor:{title:"background color",type:"string",$component:"color",$optional:!0,$format:"hexa",description:"The color of the widget's background",default:"#ffffffff"}}}}function s(e){if(r.hasOwnProperty(e))return r[e]}function c(e,t){if(!t.component)throw new Error("No component attribute set in the widget definition");var n=t.component;return delete t.component,r[e]=Object(i["a"])(!0,{},a,t),r[e].component=n,r[e]}t["b"]={install:function(e){var t=e.EThingUI;Object.assign(t,{widgets:r,findWidget:s,registerWidget:c})}}},"2a5a":function(e,t,n){"use strict";var i=n("8aff"),r=n.n(i);r.a},"2a8f":function(e,t,n){"use strict";var i=n("fc1d"),r=n.n(i);r.a},"2f39":function(e,t,n){"use strict";n.r(t);var i=n("967e"),r=n.n(i),a=(n("96cf"),n("fa84")),o=n.n(a),s=(n("1867"),n("573e"),n("7d6e"),n("e54f"),n("62f2"),n("7e6d"),n("d5b2"),n("2b0e")),c=n("b05d"),l=n("4d5a"),u=n("c7a0"),d=n("2ea3"),h=n("9898"),f=n("07d0"),m=n("f2cc"),p=n("cb32"),v=n("58a8"),b=n("54e1"),y=n("9c40"),g=n("8c8f"),_=n("156b"),w=n("f09f"),x=n("a370"),$=n("4b7e"),C=n("b047"),k=n("58ea"),q=n("b498"),O=n("24e8"),S=n("54b4"),j=n("27f9"),E=n("ddd8"),T=n("3786"),D=n("8f8e"),I=n("9564"),F=n("6f48"),B=n("9f0a"),A=n("c1d0"),L=n("7bbf"),M=n("24a7"),R=n("c859"),U=n("0016"),N=n("068f"),P=n("74f7"),W=n("3845"),V=n("497d"),H=n("6ab5"),z=n("033f"),Q=n("e208"),Y=n("4e73"),G=n("b6d5"),J=n("edca"),K=n("3b16"),Z=n("7cbe"),X=n("4983"),ee=n("eb85"),te=n("2c91"),ne=n("0d59"),ie=n("1b41"),re=n("163c"),ae=n("8562"),oe=n("eaac"),se=n("357e"),ce=n("bd08"),le=n("db86"),ue=n("429b"),de=n("7460"),he=n("7867"),fe=n("adad"),me=n("823b"),pe=n("05eb"),ve=n("74af"),be=n("65c6"),ye=n("6ac5"),ge=n("05c0"),_e=n("7f67"),we=n("714f"),xe=n("f449"),$e=n("75c3"),Ce=n("12c5"),ke=n("696d"),qe=n("b12a"),Oe=n("7518"),Se=n("436b"),je=n("f508"),Ee=n("18d6"),Te=n("a639"),De=n("2a19");s["default"].use(c["a"],{config:{},components:{QLayout:l["a"],QPageContainer:u["a"],QPage:d["a"],QHeader:h["a"],QFooter:f["a"],QDrawer:m["a"],QAvatar:p["a"],QBadge:v["a"],QBanner:b["a"],QBtn:y["a"],QBtnGroup:g["a"],QBtnDropdown:_["a"],QCard:w["a"],QCardSection:x["a"],QCardActions:$["a"],QChip:C["a"],QCircularProgress:k["a"],QColor:q["a"],QDialog:O["a"],QExpansionItem:S["a"],QInput:j["a"],QSelect:E["a"],QRadio:T["a"],QCheckbox:D["a"],QToggle:I["a"],QBtnToggle:F["a"],QOptionGroup:B["a"],QSlider:A["a"],QRange:L["a"],QTime:M["a"],QDate:R["a"],QIcon:U["a"],QImg:N["a"],QInnerLoading:P["a"],QKnob:W["a"],QList:V["a"],QItem:H["a"],QItemSection:z["a"],QItemLabel:Q["a"],QMenu:Y["a"],QResizeObserver:G["a"],QScrollObserver:J["a"],QPagination:K["a"],QPopupProxy:Z["a"],QScrollArea:X["a"],QSeparator:ee["a"],QSpace:te["a"],QSpinner:ne["a"],QSpinnerOval:ie["a"],QSpinnerPie:re["a"],QSplitter:ae["a"],QTable:oe["a"],QTh:se["a"],QTr:ce["a"],QTd:le["a"],QTabs:ue["a"],QTab:de["a"],QRouteTab:he["a"],QTabPanels:fe["a"],QTabPanel:me["a"],QTimeline:pe["a"],QTimelineEntry:ve["a"],QToolbar:be["a"],QToolbarTitle:ye["a"],QTooltip:ge["a"]},directives:{ClosePopup:_e["a"],Ripple:we["a"],TouchHold:xe["a"],TouchPan:$e["a"],TouchSwipe:Ce["a"]},plugins:{AddressbarColor:ke["a"],AppFullscreen:qe["a"],BottomSheet:Oe["a"],Dialog:Se["a"],Loading:je["a"],LocalStorage:Ee["a"],SessionStorage:Te["a"],Notify:De["a"]}});var Ie=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"q-app"}},[n("router-view")],1)},Fe=[],Be={name:"App"},Ae=Be,Le=n("2877"),Me=Object(Le["a"])(Ae,Ie,Fe,!1,null,null,null),Re=Me.exports,Ue=n("8c4f"),Ne=[{path:"/",component:function(){return n.e("2d0e17d2").then(n.bind(null,"7b3d"))},children:[{path:"",redirect:"dashboard"},{path:"data/:path*",name:"data",component:function(){return n.e("4b467f1e").then(n.bind(null,"c635"))}},{path:"devices",name:"devices",component:function(){return n.e("4b2fd5de").then(n.bind(null,"19e2"))}},{path:"table/:id",component:function(){return n.e("2d208099").then(n.bind(null,"a2a3"))},meta:{back:!0}},{path:"flow/:id",component:function(){return n.e("e5378f5c").then(n.bind(null,"ace6"))},meta:{back:!0}},{path:"chart/:id",component:function(){return n.e("3f8f16ec").then(n.bind(null,"af1b"))},meta:{back:!0}},{path:"chart",component:function(){return n.e("3f8f16ec").then(n.bind(null,"af1b"))}},{path:"text/:id",component:function(){return n.e("57ff77f3").then(n.bind(null,"c48b"))},meta:{back:!0}},{path:"image/:id",component:function(){return n.e("2d0b344a").then(n.bind(null,"283a"))},meta:{back:!0}},{path:"resource/:id",component:function(){return n.e("2d210ba0").then(n.bind(null,"b8b6"))},meta:{back:!0}},{path:"create/:type",name:"create",component:function(){return n.e("2d0c89ac").then(n.bind(null,"561f"))},meta:{back:!0}},{path:"device/:id",component:function(){return n.e("70bb30e5").then(n.bind(null,"180f"))},meta:{back:!0}},{path:"dashboard",name:"dashboard",component:function(){return n.e("06380d56").then(n.bind(null,"ec95"))}},{path:"settings",component:function(){return n.e("6d1c5d1a").then(n.bind(null,"b41f"))}},{path:"flows",name:"flows",component:function(){return n.e("4b467416").then(n.bind(null,"c352"))}},{path:"test",component:function(){return n.e("2d217e67").then(n.bind(null,"c961"))}}]},{path:"/login",name:"login",component:function(){return n.e("334f41d4").then(n.bind(null,"013f"))}}];Ne.push({path:"*",component:function(){return n.e("4b4818b8").then(n.bind(null,"ee5d"))}});var Pe=Ne;s["default"].use(Ue["a"]);var We=function(){var e=new Ue["a"]({scrollBehavior:function(){return{x:0,y:0}},routes:Pe,mode:"hash",base:"/client/"});return e},Ve=function(){var e="function"===typeof We?We({Vue:s["default"]}):We,t={el:"#q-app",router:e,render:function(e){return e(Re)}};return{app:t,router:e}},He=n("a925"),ze={failed:"Action failed",success:"Action was successful"},Qe={"en-us":ze};s["default"].use(He["a"]);var Ye=new He["a"]({locale:"en-us",fallbackLocale:"en-us",messages:Qe}),Ge=function(e){var t=e.app;t.i18n=Ye},Je=n("c7b2"),Ke=n("0ae4"),Ze=n.n(Ke),Xe=(n("df2e"),function(e){Je["a"].install(e),e.Vue.use(Ze.a)}),et=n("1dce"),tt=n.n(et),nt=function(e){var t=e.Vue;t.use(tt.a)},it=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.visible?n("vue-touch-keyboard",{staticClass:"vkeyboard",attrs:{layout:e.layout,cancel:e.hide,accept:e.accept,change:e.change,next:e.next,input:e.input,options:e.options}}):e._e()},rt=[],at=n("f186"),ot=n.n(at),st=(n("a245"),n("f303")),ct=st["b"].style,lt=null,ut=function(e){if(lt){var t=e.target.nodeName.toLowerCase();if("input"==t||"textarea"==t){var n=e.target,i=null;if("input"==t){var r=n.getAttribute("type");switch(r){case"number":i="numeric";break}}lt.show(n,i)}}},dt=function(e){lt||(lt=e,document.body.addEventListener?document.body.addEventListener("focus",ut,!0):document.body.onfocusin=ut)},ht=function(e){lt&&(lt=null,document.body.addEventListener?document.body.removeEventListener("focus",ut,!0):document.body.onfocusin=null)},ft={name:"VKeyboard",components:{"vue-touch-keyboard":ot.a.component},data:function(){return{visible:!1,layout:"normal",input:null,options:{useKbEvents:!1,preventClickEvent:!0}}},methods:{accept:function(e){this.hide()},show:function(e,t){this.input=e,this.layout=e.dataset.layout||t||"normal",this.visible||(this.visible=!0)},hide:function(){this.visible=!1},change:function(e,t){var n=new InputEvent("input",{data:e,bubbles:!0,cancelable:!0});this.input.dispatchEvent(n)},next:function(){var e=this,t=document.querySelectorAll("input"),n=!1;t=[].filter.call(t,function(e){return"none"!==ct(e,"display")}),t.forEach(function(i,r){!n&&i==e.input&&r<t.length-1&&(n=!0,e.$nextTick(function(){t[r+1].focus()}))}),n||(this.input.blur(),this.hide())}},mounted:function(){dt(this)},beforeDestroy:function(){ht(this)}},mt=ft,pt=(n("2a5a"),Object(Le["a"])(mt,it,rt,!1,null,null,null)),vt=pt.exports,bt=function(e){e.app,e.router;var t=e.Vue;e.store;t.component("VKeyboard",vt)},yt=(n("6b5b"),n("a70e")),gt=n.n(yt),_t=n("5ad2"),wt=n.n(_t),xt=n("8dcb"),$t=n.n(xt);gt.a.registerLanguage("json",wt.a),gt.a.registerLanguage("xml",$t.a);var Ct,kt,qt={install:function(e){e.directive("highlightjs",{deep:!0,bind:function(e,t){var n,i,r=e.querySelectorAll("code");for(i=0;i<r.length;i+=1)n=r[i],"string"===typeof t.value&&(n.textContent=t.value),gt.a.highlightBlock(n)},componentUpdated:function(e,t){var n,i,r=e.querySelectorAll("code");for(i=0;i<r.length;i+=1)n=r[i],"string"===typeof t.value&&(n.textContent=t.value),gt.a.highlightBlock(n)}})}},Ot=function(e){var t=e.Vue;t.use(qt)},St=n("426a"),jt=n.n(St),Et=function(e){var t=e.Vue;new t({data:{arbo:jt.a.arbo}});t.prototype.$ething=jt.a,window&&(window.EThing=jt.a)},Tt=(n("7f7f"),n("e35a")),Dt=(n("f751"),{name:"FormSchema",props:{value:{}},render:function(e){var t=this;return Object(Tt["makeForm"])(e,Object.assign({value:this.value},this.$attrs),{input:function(e){t.$emit("input",e)},error:function(e){t.$emit("error",e)}})}}),It=Dt,Ft=Object(Le["a"])(It,Ct,kt,!1,null,null,null),Bt=Ft.exports,At=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-select"},[n("q-select",{attrs:{value:e.c_value,options:e.items,error:!!e.error,multiple:e.isMultiple,"hide-bottom-space":"",dense:"","emit-value":""},on:{input:function(t){e.c_value=t}}})],1)},Lt=[],Mt={name:"FormSchemaSelect",mixins:[Tt["FormComponent"]],computed:{enumSchema:function(){return this.isBoolean?Object.assign({enum:[!0,!1],$labels:["True","False"]},this.c_schema):this.isMultiple?this.c_schema.items:this.c_schema},items:function(){var e=this;return(this.enumSchema.enum||[]).map(function(t,n,i){var r=i.length;return{label:String(e.getLabel(e.enumSchema,t,n,r)),value:t,icon:e.getIcon(e.enumSchema,t,n,r)}})},isMultiple:function(){return"array"===this.c_schema.type&&this.c_schema.items.enum},isBoolean:function(){return"boolean"===this.c_schema.type}},methods:{getLabel:function(e,t,n,i){var r=e["$labels"]||[];if(Array.isArray(r)){if(n<r.length)return r[n]}else if("function"===typeof r)return r.call(this,t,n,i);return t},getIcon:function(e,t,n,i){var r=e["$icons"]||[];if(Array.isArray(r)){if(n<r.length)return r[n]}else if("function"===typeof r)return r.call(this,t,n,i)}},rule:function(e){return"undefined"!=typeof e.enum||"array"===e.type&&e.items.enum||"boolean"===e.type}},Rt=Mt,Ut=Object(Le["a"])(Rt,At,Lt,!1,null,null,null),Nt=Ut.exports,Pt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-radio"},e._l(e.items,function(t,i){return n("q-radio",{key:i,attrs:{val:"item.value",label:"item.label"},model:{value:e.c_value,callback:function(t){e.c_value=t},expression:"c_value"}})}),1)},Wt=[],Vt={name:"FormSchemaRadio",mixins:[Nt],rule:function(e){return"undefined"!=typeof e.enum||"boolean"===e.type}},Ht=Vt,zt=Object(Le["a"])(Ht,Pt,Wt,!1,null,null,null),Qt=zt.exports,Yt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-checkbox"},e._l(e.items,function(t,i){return n("q-checkbox",{key:i,attrs:{val:"item.value",label:"item.label"},model:{value:e.c_value,callback:function(t){e.c_value=t},expression:"c_value"}})}),1)},Gt=[],Jt={name:"FormSchemaCheckbox",mixins:[Nt],rule:function(e){return"array"===e.type&&e.items.enum}},Kt=Jt,Zt=Object(Le["a"])(Kt,Yt,Gt,!1,null,null,null),Xt=Zt.exports,en=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-input"},[n("q-input",e._b({attrs:{type:e.inputType,value:e.c_value,error:!!e.error,placeholder:e.c_schema["$placeholder"],"hide-bottom-space":"",dense:""},on:{input:function(t){e.c_value=e.__cast_input_val(t)}}},"q-input",e.attributes,!1))],1)},tn=[],nn=(n("c5f6"),n("b5ae")),rn=(n("3b2b"),n("78ef")),an=function(e){return Object(rn["withParams"])({type:"regex",pattern:e},function(t){return!Object(rn["req"])(t)||new RegExp(e).test(t)})},on=function(e){return void 0!==e&&null!==e},sn={name:"FormSchemaInput",mixins:[Tt["FormComponent"]],validations:function(){var e={};return"string"===this.c_schema.type?("number"===typeof this.c_schema.minLength&&(0===this.c_schema.minLength&&(e.required=on),e.minLength=Object(nn["minLength"])(this.c_schema.minLength)),"number"===typeof this.c_schema.maxLength&&(e.maxLength=Object(nn["maxLength"])(this.c_schema.maxLength)),"string"===typeof this.c_schema.pattern&&(e.regex=an(this.c_schema.pattern)),"email"===this.c_schema.format&&(e.email=nn["email"])):"number"!==this.c_schema.type&&"integer"!==this.c_schema.type||("number"===typeof this.c_schema.minimum&&(e.minValue=Object(nn["minValue"])(this.c_schema.minimum)),"number"===typeof this.c_schema.maximum&&(e.maxValue=Object(nn["maxValue"])(this.c_schema.maximum))),{c_value:e}},methods:{__cast_input_val:function(e){return"number"===this.inputType&&(e=Number(e)),e}},computed:{inputType:function(){return"string"===this.c_schema.type?"email"===this.c_schema.format?"email":"url"===this.c_schema.format?"url":"text":"number"===this.c_schema.type||"integer"===this.c_schema.type?"number":"text"},isNumber:function(){return"number"===this.c_schema.type||"integer"===this.c_schema.type},isInteger:function(){return"integer"===this.c_schema.type},attributes:function(){var e={};return this.isInteger&&(e.decimals=0),this.isNumber&&("number"===typeof this.c_schema.minimum&&(e.min=this.c_schema.minimum),"number"===typeof this.c_schema.maximum&&(e.max=this.c_schema.maximum),"number"===typeof this.c_schema.multipleOf&&(e.step=this.c_schema.multipleOf)),"string"===this.c_schema.type&&"number"===typeof this.c_schema.maxLength&&(e.maxlength=this.c_schema.maxLength),e}},rule:function(e){return-1!==["string","number","integer"].indexOf(e.type)}},cn=sn,ln=Object(Le["a"])(cn,en,tn,!1,null,null,null),un=ln.exports,dn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-file"},[n("div",[n("span",{staticClass:"q-mr-md relative-position overflow-hidden"},[n("q-icon",{attrs:{name:"add",color:"primary"}}),e._v(" add file\n      "),n("input",{ref:"file",staticClass:"file-input absolute-full cursor-pointer",attrs:{type:"file",accept:e.c_schema.accept},on:{change:e.__add}})],1),e._l(e.files,function(t,i){return n("small",{key:i,staticClass:"text-faded"},[e._v("\n      "+e._s(t.name)+" ("+e._s(t.__size)+")\n    ")])})],2)])},hn=[],fn=(n("28a5"),n("7937")),mn=fn["c"].humanStorageSize,pn={name:"FormSchemaFile",mixins:[Tt["FormComponent"]],data:function(){return{files:[]}},methods:{__add:function(e,t){var n=this;t=Array.prototype.slice.call(t||e.target.files),this.$refs.file.value="";t=t.map(function(e){return e.__size=mn(e.size),e.__timestamp=(new Date).getTime(),e.__converting=!0,n.convert(e,function(t){n.$nextTick(function(){e.__converting=!1,n.c_value=t})},function(e){n.files=[],n.$emit("error",String(e)),n.c_value=void 0}),e}),this.files=t},convert:function(e,t,n){var i=this,r=function(r){var a=i.c_schema["$converter"];if("function"===typeof a)try{a.call(i,e,r,t,n)}catch(o){n(o)}else t(r)};if("data-url"===this.c_schema.format){var a=new FileReader;a.onloadend=function(e){r(a.result)},a.readAsDataURL(e)}else if("base64"===this.c_schema.format){var o=new FileReader;o.onloadend=function(e){var t=o.result,n=t.split(",",2);r(n[1])},o.readAsDataURL(e)}else if("text"===this.c_schema.format){var s=new FileReader;s.onloadend=function(e){r(s.result)},s.readAsText(e)}else r(e)}},rule:function(e){return"string"===e.type&&-1!==["data-url","base64"].indexOf(e.format)}},vn=pn,bn=(n("79c7"),Object(Le["a"])(vn,dn,hn,!1,null,"720fca1e",null)),yn=bn.exports,gn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-password"},[n("q-input",{attrs:{type:"password",value:e.c_value,error:!!e.error,"hide-bottom-space":"",dense:""},on:{input:function(t){e.c_value=t}}})],1)},_n=[],wn={name:"FormSchemaPassword",mixins:[un]},xn=wn,$n=Object(Le["a"])(xn,gn,_n,!1,null,null,null),Cn=$n.exports,kn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-textarea"},[n("q-input",{attrs:{type:"textarea",value:e.c_value,error:!!e.error,placeholder:e.c_schema["$placeholder"],rows:e.c_schema["$rows"],"hide-bottom-space":"",dense:""},on:{input:function(t){e.c_value=t}}})],1)},qn=[],On={name:"FormSchemaTextarea",mixins:[un]},Sn=On,jn=Object(Le["a"])(Sn,kn,qn,!1,null,null,null),En=jn.exports,Tn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-color"},[n("q-input",{style:{"border-bottom":"4px solid "+e.c_value},attrs:{filled:"",error:!!e.error,"hide-bottom-space":"",dense:""},scopedSlots:e._u([{key:"append",fn:function(){return[n("q-icon",{staticClass:"cursor-pointer",attrs:{name:"colorize"}},[n("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[n("q-color",{attrs:{"format-model":e.c_schema.$format||"hex"},model:{value:e.c_value,callback:function(t){e.c_value=t},expression:"c_value"}})],1)],1)]},proxy:!0}]),model:{value:e.c_value,callback:function(t){e.c_value=t},expression:"c_value"}})],1)},Dn=[],In={name:"FormSchemaColor",mixins:[un],methods:{cast:function(e){return e||"#FF0000"}},rule:function(e){return"string"===e.type&&"color"===e.format}},Fn=In,Bn=Object(Le["a"])(Fn,Tn,Dn,!1,null,null,null),An=Bn.exports,Ln=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-datetime"},[n("q-input",{attrs:{filled:"",error:!!e.error,"hide-bottom-space":"",dense:""},scopedSlots:e._u([e.showDate?{key:"prepend",fn:function(){return[n("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[n("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[n("q-date",{attrs:{mask:"YYYY-MM-DD HH:mm"},model:{value:e._date,callback:function(t){e._date=t},expression:"_date"}})],1)],1)]},proxy:!0}:null,e.showTime?{key:"append",fn:function(){return[n("q-icon",{staticClass:"cursor-pointer",attrs:{name:"access_time"}},[n("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[n("q-time",{attrs:{mask:"YYYY-MM-DD HH:mm",format24h:""},model:{value:e._date,callback:function(t){e._date=t},expression:"_date"}})],1)],1)]},proxy:!0}:null],null,!0),model:{value:e._date,callback:function(t){e._date=t},expression:"_date"}})],1)},Mn=[],Rn={name:"FormSchemaDatetime",mixins:[Tt["FormComponent"]],computed:{showDate:function(){return"time"!==this.c_schema.format},showTime:function(){return"date"!==this.c_schema.format},_date:{get:function(){return this.c_value},set:function(e){this.c_value=e}}},rule:function(e){return"string"===e.type&&-1!==["date-time","date","time"].indexof(e.format)}},Un=Rn,Nn=Object(Le["a"])(Un,Ln,Mn,!1,null,null,null),Pn=Nn.exports,Wn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-range"},[n("q-slider",e._b({attrs:{value:"undefined"===typeof e.c_value?0:e.c_value,error:!!e.error,"label-always":""},on:{input:function(t){e.c_value=t}}},"q-slider",e.attributes,!1))],1)},Vn=[],Hn={name:"FormSchemaRange",mixins:[un],rule:function(e){return("number"===e.type||"integer"===e.type)&&"undefined"!==typeof e.minimum&&"undefined"!==typeof e.maximum}},zn=Hn,Qn=Object(Le["a"])(zn,Wn,Vn,!1,null,null,null),Yn=Qn.exports,Gn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-object",class:{indent:e.level}},[e.items.length>0?e._l(e.items,function(t){return n("div",{key:t.key,staticClass:"form-schema-object-item",class:{"form-schema-object-item-required":t.required,"form-schema-object-item-error":!!e.errors[t.key]},style:{display:e.inlined?"inline":"block"}},[t.schema.$hideLabel?e._e():n("div",{staticClass:"form-schema-object-item-title",style:{display:e.inlined?"inline":"block"}},[e._v("\n        "+e._s(t.schema.title||t.key)+"\n        "),t.schema.$optional?n("q-toggle",{staticClass:"q-ml-sm",attrs:{value:t.enable},on:{input:function(n){return e.onEnableChange(t,n)}}}):e._e()],1),t.enable?n("form-schema",{attrs:{required:t.required,inline:e.inlined,schema:t.schema,value:t.model,level:e.level+1},on:{input:function(n){return e.onChildValueChange(t,n)},error:function(n){return e.onChildErrorChange(t,n)}}}):e._e()],1)}):n("div",[n("small",{staticClass:"text-faded"},[e._v("empty")])])],2)},Jn=[],Kn=(n("8615"),n("ac6a"),n("cadf"),n("06db"),n("456d"),n("8993")),Zn=n.n(Kn);function Xn(e){return"object"===Zn()(e)&&null!==e}var ei={name:"FormSchemaObject",mixins:[Tt["FormComponent"]],data:function(){return{errors:{},cache:{}}},computed:{items:function(){var e=this,t=this.c_schema,n=t.required||[],i=[],r=[];for(var a in t.properties)!t.properties[a]||t.properties[a]["$disabled"]?r.push(a):t.properties[a]["$readOnly"]?i.push(a):t.properties[a]["$required"]&&-1===n.indexOf(a)&&!t.properties[a]["$optional"]&&n.push(a);var o=n.concat(Object.keys(t.properties||{}).filter(function(e){return-1===n.indexOf(e)&&-1===i.indexOf(e)})).filter(function(e){return-1===r.indexOf(e)&&!!t.properties[e]});if(t["$order"])for(var s=t["$order"].length;s>0;s--){var c=t["$order"][s-1],l=o.indexOf(c);-1!==l&&(o.splice(l,1),o.unshift(c))}var u=!1;Object.keys(this.errors).forEach(function(t){-1===o.indexOf(t)&&(delete e.errors[t],u=!0)}),u&&this.$emit("error",Object.values(this.errors).some(function(e){return e}));var d=Object.assign({},this.c_value),h=!1;return Object.keys(d).forEach(function(e){-1===o.indexOf(e)&&(delete d[e],h=!0)}),h&&(this.c_value=d),o.map(function(i){var r=t.properties[i],a=(e.c_value||{})[i],o=!0;return r.$optional&&(o=e.c_value&&i in e.c_value),{key:i,schema:r,required:-1!==n.indexOf(i),model:a,enable:o}})}},methods:{onChildValueChange:function(e,t){if(Xn(this.c_value))this.$set(this.c_value,e.key,t);else{var n={};n[e.key]=t,this.c_value=n}},onChildErrorChange:function(e,t){this.$set(this.errors,e.key,t),this.$emit("error",Object.values(this.errors).some(function(e){return e}))},onEnableChange:function(e,t){t?(this.$set(this.c_value,e.key,this.cache[e.key]),delete this.cache[e.key]):(this.cache[e.key]=this.c_value[e.key],this.$delete(this.c_value,e.key))}},rule:function(e){return"object"===e.type||"object"===Zn()(e.properties)}},ti=ei,ni=(n("9769"),Object(Le["a"])(ti,Gn,Jn,!1,null,"30f9bf49",null)),ii=ni.exports,ri=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-array",class:{indent:e.level}},[n("div",[n("q-btn",{staticClass:"q-mb-xs",attrs:{outline:"",dense:"",label:"Add item",icon:"add",size:"xs",color:"grey"},on:{click:e.addItem}})],1),n("div",{staticClass:"form-schema-array-content"},[e._l(e.items,function(t,i){return n("div",{key:i,staticClass:"form-schema-array-item"},[n("div",{staticClass:"form-schema-array-item-header"},[n("q-btn",{staticStyle:{"vertical-align":"middle"},attrs:{size:"xs",color:"negative",label:"remove",icon:"delete"},on:{click:function(t){return e.removeItem(i)}}}),i>0?n("q-btn",{attrs:{flat:"",size:"sm",color:"secondary",label:"up",icon:"arrow_drop_up"},on:{click:function(t){return e.moveItem(i,"up")}}}):e._e(),i<e.items.length-1?n("q-btn",{attrs:{flat:"",size:"sm",color:"secondary",label:"down",icon:"arrow_drop_down"},on:{click:function(t){return e.moveItem(i,"down")}}}):e._e()],1),n("form-schema",{attrs:{inline:"",schema:t.schema,value:e.getModel(i),level:e.level+1},on:{input:function(t){return e.onChildValueChange(i,t)},error:function(t){return e.onChildErrorChange(i,t)}}})],1)}),n("div",{staticClass:"form-schema-array-bottom-padding relative-position",staticStyle:{height:"48px"}},[e.items.length?e._e():n("small",{staticClass:"absolute-center faded"},[e._v("empty")])])],2)])},ai=[],oi={name:"FormSchemaArray",mixins:[Tt["FormComponent"]],data:function(){return{items:[]}},watch:{c_value:function(){this.refreshFromModel()}},methods:{refreshFromModel:function(){var e=this;this.items=(this.c_value||[]).map(function(t){return{schema:e.c_schema.items||{}}})},getModel:function(e){return Array.isArray(this.c_value)&&e<this.c_value.length?this.c_value[e]:void 0},addItem:function(){this.items.push({schema:this.c_schema.items||{}})},removeItem:function(e){this.items.splice(e,1),this.c_value.splice(e,1)},moveItem:function(e,t){var n=this.items.splice(e,1),i=this.c_value.splice(e,1);this.items.splice(e+("up"===t?-1:1),0,n[0]),this.c_value.splice(e+("up"===t?-1:1),0,i[0])},onChildValueChange:function(e,t){this.c_value?this.$set(this.c_value,e,t):this.c_value=[t]},onChildErrorChange:function(e,t){this.$set(this.items[e],"error",t),this.$emit("error",Object.values(this.items).some(function(e){return e.error}))}},mounted:function(){this.refreshFromModel()},rule:function(e){return"array"===e.type}},si=oi,ci=(n("36c33"),Object(Le["a"])(si,ri,ai,!1,null,"75d2c5d7",null)),li=ci.exports,ui=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-input"},[n("pre",[e._v(e._s(e.c_value))])])},di=[],hi={name:"FormSchemaConst",mixins:[Tt["FormComponent"]],rule:function(e){return"undefined"!==typeof e.const}},fi=hi,mi=Object(Le["a"])(fi,ui,di,!1,null,null,null),pi=mi.exports,vi=[Nt,Qt,Xt,yn,Pn,An,un,Cn,En,Yn,li,ii,pi],bi=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-bluetooth-interface"},[n("div",{staticClass:"row"},[n("q-input",{staticClass:"col",attrs:{type:"number",value:e.c_value,error:!!e.error,prefix:"hci","hide-bottom-space":"",dense:""},on:{input:function(t){e.c_value=t}},scopedSlots:e._u([{key:"append",fn:function(){return[n("q-icon",{staticClass:"cursor-pointer",attrs:{name:"search"}},[n("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[n("div",{staticStyle:{width:"260px"}},[e.loading?n("div",{staticClass:"q-ma-md text-center text-faded"},[n("div",{staticClass:"q-ma-md"},[e._v("loading...")]),n("q-spinner-oval",{attrs:{color:"primary",size:"50px"}})],1):0===e.interfaces.length?n("div",{staticClass:"q-ma-md text-faded"},[e._v("no bluetooth interface detected")]):n("q-list",{attrs:{separator:""}},[n("q-btn",{attrs:{flat:"",color:"faded",icon:"refresh",label:"refresh"},on:{click:function(t){return e.refresh()}}}),e._l(e.interfaces,function(t,i){return n("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],key:i,attrs:{clickable:""},on:{click:function(n){e.c_value=e.parseIntFromHci(t.hci)}}},[n("q-item-section",[n("q-item-label",[e._v(e._s(t.hci))]),t.address?n("q-item-label",{attrs:{caption:""}},[e._v("mac: "+e._s(t.address))]):e._e(),t.name?n("q-item-label",{attrs:{caption:""}},[e._v("name: "+e._s(t.name))]):e._e(),t.status?n("q-item-label",{attrs:{caption:""}},[e._v("status: "+e._s(t.status))]):e._e(),t.manufacturer?n("q-item-label",{attrs:{caption:""}},[e._v("manufacturer: "+e._s(t.manufacturer))]):e._e()],1)],1)})],2)],1)])],1)]},proxy:!0}])})],1)])},yi=[],gi=(n("4917"),n("551c"),n("097d"),{name:"FormSchemaBluetoothInterface",mixins:[Tt["FormComponent"]],data:function(){return{interfaces:[],loading:!0,loaded:!1}},methods:{show:function(){this.loaded||(this.loaded=!0),this.refresh()},refresh:function(){var e=this;this.loading=!0,jt.a.request({url:"utils/bluetooth_list",dataType:"json"}).then(function(t){e.interfaces=t}).finally(function(){e.loading=!1})},parseIntFromHci:function(e){return parseInt(e.match(/^hci([0-9]+)$/)[1])}}}),_i=gi,wi=Object(Le["a"])(_i,bi,yi,!1,null,null,null),xi=wi.exports,$i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-editor",attrs:{"force-description":""}},[n("codemirror",{ref:"cm",attrs:{value:e.c_value||"",options:e.cmOption},on:{input:function(t){e.c_value=t}}})],1)},Ci=[],ki=n("8f94"),qi=(n("a7be"),n("f9d4"),n("ced0"),n("db91"),n("8c33"),n("10b2"),{name:"FormSchemaEditor",mixins:[Tt["FormComponent"]],components:{codemirror:ki["codemirror"]},data:function(){return{cmOption:{mode:this.schema["$lang"]||"text",tabSize:4,styleActiveLine:!0,lineNumbers:!0,lineWrapping:!1,styleSelectedText:!0,matchBrackets:!0,autoCloseBrackets:!0,showCursorWhenSelecting:!0,extraKeys:{Ctrl:"autocomplete"},hintOptions:{completeSingle:!1},viewportMargin:1/0}}},mounted:function(){var e=this;this.$nextTick(function(){e.$refs.cm.refresh()})}}),Oi=qi,Si=(n("95fd"),Object(Le["a"])(Oi,$i,Ci,!1,null,null,null)),ji=Si.exports,Ei=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-ething-flow-node"},[n("flow-node-select",{attrs:{value:e.c_value,filter:e.computed_filter,multiple:e.multiple,flow:e.flow,"use-id":""},on:{input:function(t){e.c_value=t}}})],1)},Ti=[],Di=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-select",e._b({attrs:{value:e.formattedValue,options:e.options,multiple:e.multiple,"emit-value":""},on:{input:function(t){e.$emit("input",e._formatValueOut(t))}}},"q-select",e.$attrs,!1))},Ii=[],Fi=(n("7514"),{name:"FlowNodeSelect",props:{filter:{},value:{},useId:Boolean,multiple:Boolean,flow:{}},computed:{computedFlow:function(){return"string"===typeof this.flow?this.$ething.arbo.get(this.flow):this.flow},formattedValue:function(){if(this.multiple){var e=[];return Array.isArray(this.value)?e=this.value:this.value&&(e=[this.value]),e.map(this._formatValueIn)}return this._formatValueIn(this.value)},nodes:function(){var e=this,t=[];return this.$ething.arbo.find(function(e){return e instanceof jt.a.Flow}).forEach(function(n){e.computedFlow&&n.id()!==e.computedFlow.id()||n.attr("nodes").forEach(function(i){e.filter&&!e.filter.call(e,n,i)||t.push({flow:n,node:i})})}),t},options:function(){var e=this;return this.nodes.map(function(t){var n,i=t.flow,r=t.node;return n=e.flow?r.id:i.id()+":"+r.id,{label:r.name,value:n,icon:e.$ethingUI.get(r.type).icon,leftColor:e.$ethingUI.get(r.type).color,inset:!0,stamp:e.$ethingUI.get(r.type).title,sublabel:e.flow?null:i.basename()}})}},methods:{_formatValueIn:function(e){return this.flow?this.useId?e:e.id:this.useId?e.flow+":"+e.node:e.flow.id()+":"+e.node.id},_formatValueOut:function(e){if(this.flow){if(this.useId)return e;var t=this.nodes;for(var n in t)if(t[n].node.id===e)return t[n].node}else{var i=e.split(":"),r=i[0],a=i[1];if(this.useId)return{flow:r,node:a};t=this.nodes;for(var n in t)if(t[n].flow.id()===r&&t[n].node.id===a)return t[n]}}}}),Bi=Fi,Ai=Object(Le["a"])(Bi,Di,Ii,!1,null,null,null),Li=Ai.exports,Mi={name:"FormSchemaEthingFlowNode",mixins:[Tt["FormComponent"]],components:{FlowNodeSelect:Li},computed:{multiple:function(){return"array"===this.c_schema.type},computed_filter:function(){var e=this,t=this.c_schema;return function(n,i){return e.filter(n,i,t)}},flow:function(){var e=this.c_schema["$flow"];return"$context"===e&&(e=this.getContext("flow")),"function"===typeof e&&(e=e.call(this.c_schema)),e}},methods:{filter:function(e,t,n){var i=n["$filter"];if(i)if("string"===typeof i){if(!this.$ethingUI.isSubclass(t.type,i))return!1}else if(!i.call(n,e,t))return!1;return!0}}},Ri=Mi,Ui=Object(Le["a"])(Ri,Ei,Ti,!1,null,null,null),Ni=Ui.exports,Pi=n("dd5d"),Wi=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-cron"},[n("q-btn",{attrs:{flat:"",color:"primary",icon:"edit",label:e.c_value?"change":"set"},on:{click:function(t){e.editing=!0}}}),n("div",[e._v(e._s(e.readableExp))]),n("modal",{attrs:{title:"Cron editor",icon:"event"},on:{valid:e.apply},model:{value:e.editing,callback:function(t){e.editing=t},expression:"editing"}},[n("cron",{staticClass:"q-ma-md",attrs:{value:e.c_value},on:{input:function(t){e.editedExp=t}}})],1)],1)},Vi=[],Hi=(n("6b54"),n("80c5")),zi=n("2772"),Qi=n.n(zi),Yi={name:"FormSchemaCron",mixins:[Tt["FormComponent"]],components:{Cron:Hi["a"]},data:function(){return{editedExp:null,editing:!1}},computed:{readableExp:function(){return this.c_value?Qi.a.toString(this.c_value):""}},methods:{apply:function(){this.editing=!1,this.c_value=this.editedExp}}},Gi=Yi,Ji=Object(Le["a"])(Gi,Wi,Vi,!1,null,null,null),Ki=Ji.exports,Zi=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-host"},[n("div",{staticClass:"row"},[n("q-input",{staticClass:"col",attrs:{value:e.c_value,error:!!e.error,"hide-bottom-space":"",dense:""},on:{input:function(t){e.c_value=t}},scopedSlots:e._u([{key:"append",fn:function(){return[n("q-icon",{staticClass:"cursor-pointer",attrs:{name:"search"}},[n("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[n("div",{staticStyle:{width:"260px"}},[e.loading?n("div",{staticClass:"q-ma-md text-center text-faded"},[n("div",{staticClass:"q-ma-md"},[e._v("scanning...")]),n("q-spinner-oval",{attrs:{color:"primary",size:"50px"}})],1):0===e.hosts.length?n("div",{staticClass:"q-ma-md text-faded"},[e._v("no host detected")]):n("q-list",{attrs:{separator:""}},[n("q-btn",{attrs:{flat:"",color:"faded",icon:"refresh",label:"refresh"},on:{click:function(t){return e.refresh(!0)}}}),e._l(e.hosts,function(t,i){return n("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],key:i,attrs:{clickable:""},on:{click:function(n){e.c_value=t.hostname||t.ip}}},[n("q-item-section",[n("q-item-label",[e._v(e._s(t.hostname||t.ip))]),t.mac?n("q-item-label",{attrs:{caption:""}},[e._v("mac: "+e._s(t.mac))]):e._e(),t.vendor?n("q-item-label",{attrs:{caption:""}},[e._v("vendor: "+e._s(t.vendor))]):e._e()],1)],1)})],2)],1)])],1)]},proxy:!0}])})],1)])},Xi=[],er=[],tr=!1,nr=null,ir=3e5;function rr(e,t){"function"===typeof e&&(t=e,e=!1),!1===tr&&(e=!0),(e||Date.now()-tr>ir)&&(tr=Date.now(),nr=jt.a.request({url:"utils/net_list",dataType:"json"}).then(function(e){er=e})),nr.finally(function(){"function"===typeof t&&t(er)})}var ar={name:"FormSchemaHost",mixins:[Tt["FormComponent"]],data:function(){return{hosts:[],loading:!0,skipNext:!1}},methods:{showHosts:function(){this.skipNext?this.skipNext=!1:this.refresh()},refresh:function(e){var t=this;this.loading=!0,rr(e,function(e){t.hosts=e,t.loading=!1,t.skipNext=!0,t.$refs.popover.hide(),t.$refs.popover.show()})}},mounted:function(){}},or=ar,sr=Object(Le["a"])(or,Zi,Xi,!1,null,null,null),cr=sr.exports,lr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-oneof"},[n("div",{class:e.inlined?"row":""},[n("q-select",{class:e.inlined?e.subschema?"col-auto":"col-12":"",attrs:{options:e.selectOptions,"emit-value":"","display-value":e.subtype||"none","hide-bottom-space":"",dense:""},model:{value:e.subtypeindex,callback:function(t){e.subtypeindex=t},expression:"subtypeindex"}}),e.subschema?n("form-schema",{class:e.inlined?"col":"",attrs:{inline:e.inlined,level:e.level+1,schema:e.subschema,required:"",value:e.subvalue},on:{input:function(t){e.subvalue=t},error:function(t){return e.$emit("error",t)}}}):e._e()],1)])},ur=[],dr={name:"FormSchemaOneof",mixins:[Tt["FormComponent"]],data:function(){return{localIndex:0}},computed:{items:function(){var e=this,t=this.c_schema.oneOf||[];return t.map(function(t,n,i){var r=i.length,a=t.properties.type.const;return{label:String(e.getLabel(e.c_schema,t,n,r)),schema:t,icon:e.getIcon(e.c_schema,t,n,r),type:a}})},selectOptions:function(){return this.items.map(function(e,t){return{label:e.label,value:t,icon:e.icon}})},subvalue:{get:function(){if(this.c_value)return this.c_value.value},set:function(e){this.c_value?this.$set(this.c_value,"value",e):this.c_value={type:this.subtype,value:e}}},subtype:{get:function(){if(this.c_value)return this.c_value.type},set:function(e){this.c_value={type:e}}},subtypeindex:{get:function(){var e=this.subtype;for(var t in this.items)if(this.items[t].type===e)return parseInt(t)},set:function(e){this.subtype=this.items[e].type}},subschema:function(){if("undefined"!==typeof this.subtypeindex)return this.items[this.subtypeindex].schema.properties.value}},watch:{subschema:function(e,t){e||this.$emit("error",!1)}},methods:{getDefault:function(){try{return{type:this.items[0].type}}catch(e){}},getLabel:function(e,t,n,i){if("undefined"!==typeof e["$labels"]){var r=e["$labels"];if(Array.isArray(r)){if(n<r.length)return r[n]}else if("function"===typeof r)return r.call(this,t,n,i)}return t.title||t.properties.type.title||t.properties.type.const},getIcon:function(e,t,n,i){if("undefined"!==typeof e["$icons"]){var r=e["$icons"];if(Array.isArray(r)){if(n<r.length)return r[n]}else if("function"===typeof r)return r.call(this,t,n,i)}return"undefined"!==typeof t["$icon"]?t["$icon"]:"undefined"!==typeof t.properties.type["$icon"]?t.properties.type["$icon"]:void 0}},rule:function(e){if(Array.isArray(e.oneOf)){var t=!0;if(e.oneOf.forEach(function(e){e.properties&&e.properties.type&&e.properties.type.const||(t=!1)}),t)return!0}}},hr=dr,fr=Object(Le["a"])(hr,lr,ur,!1,null,null,null),mr=fr.exports,pr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-optional",class:{indent:e.level}},[n("div",[n("q-toggle",{attrs:{label:"enable"},model:{value:e.enabled,callback:function(t){e.enabled=t},expression:"enabled"}})],1),e.enabled?n("form-schema",{ref:"sub",attrs:{required:"",schema:e.filteredSchema,value:e.cachedValue,level:e.level},on:{input:e.onChildValueChange,error:function(t){return e.$emit("error",t)}}}):e._e()],1)},vr=[],br=(n("673e"),n("11ec")),yr={name:"FormSchemaOptional",mixins:[Tt["FormComponent"]],computed:{filteredSchema:function(){var e=Object.assign({},this.c_schema);delete e.anyOf,delete e.description;var t=this.c_schema.anyOf.filter(function(e){return"null"!==e.type});return 1==t.length?e=Object(br["a"])(!0,e,t[0]):e.anyOf=t,e}},data:function(){return{enabled:!1,cachedValue:void 0}},watch:{c_value:function(){this.refreshFromModel()},enabled:function(e){var t=this;this.$nextTick(function(){e?(t.c_value=t.$refs["sub"].c_value,t.$emit("error",t.$refs["sub"].error)):(t.c_value=null,t.$emit("error",!1))})}},methods:{refreshFromModel:function(){this.enabled=null!==this.c_value&&"undefined"!==typeof this.c_value,this.enabled&&(this.cachedValue=this.c_value)},onChildValueChange:function(e){this.cachedValue=e,this.c_value=e}},mounted:function(){this.refreshFromModel()},rule:function(e){if(Array.isArray(e.anyOf)){var t=e.anyOf.filter(function(e){return"null"===e.type});if(t.length>0&&t.length<e.anyOf.length)return!0}}},gr=yr,_r=Object(Le["a"])(gr,pr,vr,!1,null,null,null),wr=_r.exports,xr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-scheduler"},[e.c_value&&e.c_value.length?n("div",e._l(e.c_value,function(t,i){return n("q-item",{key:i,attrs:{dense:""}},[n("q-item-section",{attrs:{avatar:""}},[n("q-icon",{attrs:{name:"schedule"}})],1),n("q-item-section",[e._v("\n        "+e._s(e.toString(t))+"\n      ")]),n("q-item-section",{attrs:{side:""}},[n("q-btn",{attrs:{icon:"delete",round:"",flat:"",dense:"",color:"negative"},on:{click:function(t){return e.c_value.splice(i,1)}}})],1)],1)}),1):n("div",{staticClass:"q-ma-md text-faded"},[e._v("\n    no scheduling\n  ")]),n("q-btn",{attrs:{color:"blue-5",label:"Add",icon:"add",flat:""},on:{click:function(t){e.modal=!0}}}),n("modal",{attrs:{title:"Scheduler",icon:"schedule","valid-btn-label":"add","cancel-btn-label":"Close","valid-btn-disable":e.itemError},on:{valid:e.add},model:{value:e.modal,callback:function(t){e.modal=t},expression:"modal"}},[n("form-schema",{attrs:{schema:e.itemSchema},on:{error:function(t){e.itemError=t}},model:{value:e.itemModel,callback:function(t){e.itemModel=t},expression:"itemModel"}})],1)],1)},$r=[],Cr=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];function kr(e,t,n){return n=n||"0",e+="",e.length>=t?e:new Array(t-e.length+1).join(n)+e}function qr(e){var t=e.mode,n=e.start,i=e.end;switch(t){case"daily":return"every day between "+n.hour+":"+kr(n.minute,2)+" and "+i.hour+":"+kr(i.minute,2);case"weekly":return"between "+Cr[n.weekday-1]+" "+n.hour+":"+kr(n.minute,2)+" and "+Cr[i.weekday-1]+" "+i.hour+":"+kr(i.minute,2);case"monthly":return"between "+n.monthday+Or(n.monthday)+" "+n.hour+":"+kr(n.minute,2)+" and "+i.monthday+Or(i.monthday)+" "+i.hour+":"+kr(i.minute,2)}}function Or(e){if(e<10||e>=20){if(e%=10,1==e)return"st";if(2==e)return"nd";if(3==e)return"rd"}return"th"}var Sr={name:"FormSchemaScheduler",mixins:[Tt["FormComponent"]],data:function(){for(var e=[],t=1;t<=31;t++)e.push(t);return{modal:!1,itemSchema:{type:"object",additionalProperties:!1,required:["mode","start","end"],properties:{mode:{id:"FormSchemaScheduler.mode",enum:["daily","weekly","monthly"],default:"daily"},start:{type:"object",additionalProperties:!1,required:["weekday","monthday","time"],properties:{monthday:{label:"day of month",enum:e,$dependencies:{"FormSchemaScheduler.mode":function(e,t,n){t.$set(t.parent().c_schema.properties.monthday,"$disabled","monthly"!==e)}}},weekday:{label:"week day",enum:[1,2,3,4,5,6,7],$labels:Cr,$dependencies:{"FormSchemaScheduler.mode":function(e,t,n){t.$set(t.parent().c_schema.properties.weekday,"$disabled","weekly"!==e)}}},time:{type:"string",format:"time"}}},end:{type:"object",additionalProperties:!1,required:["weekday","monthday","time"],properties:{monthday:{label:"day of month",enum:e,$dependencies:{"FormSchemaScheduler.mode":function(e,t,n){t.$set(t.parent().c_schema.properties.monthday,"$disabled","monthly"!==e)}}},weekday:{label:"week day",enum:[1,2,3,4,5,6,7],$labels:Cr,$dependencies:{"FormSchemaScheduler.mode":function(e,t,n){t.$set(t.parent().c_schema.properties.weekday,"$disabled","weekly"!==e)}}},time:{type:"string",format:"time"}}}}},itemModel:{},itemError:!1}},methods:{toString:qr,add:function(){var e=this.c_value?this.c_value.slice(0):[],t=Object(br["a"])(!0,{},this.itemModel),n=new Date(t.start.time);delete t.start["time"],t.start["hour"]=n.getHours(),t.start["minute"]=n.getMinutes();var i=new Date(t.end.time);delete t.end["time"],t.end["hour"]=i.getHours(),t.end["minute"]=n.getMinutes(),e.push(t),this.c_value=e,this.modal=!1}}},jr=Sr,Er=Object(Le["a"])(jr,xr,$r,!1,null,null,null),Tr=Er.exports,Dr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-scope"},[n("q-select",{attrs:{multiple:"","display-value":e.formattedModel.length?e.formattedModel.join(" "):"none",value:e.formattedModel,options:e.selectOptions,error:!!e.error,"emit-value":""},on:{input:function(t){e.formattedModel=t}}})],1)},Ir=[],Fr={name:"FormSchemaScope",mixins:[Tt["FormComponent"]],data:function(){var e=[];for(var t in this.$ethingUI.scopes){var n=this.$ethingUI.scopes[t];e.push({label:t,value:t,sublabel:n.description})}return{selectOptions:e}},computed:{formattedModel:{get:function(){return(this.c_value||"").split(" ").filter(function(e){return e.length})},set:function(e){e=e.join(" "),this.c_value=e}}}},Br=Fr,Ar=Object(Le["a"])(Br,Dr,Ir,!1,null,"5a59212d",null),Lr=Ar.exports,Mr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-serial-port"},[n("div",{staticClass:"row"},[n("q-input",{staticClass:"col",attrs:{value:e.c_value,error:!!e.error,"hide-bottom-space":"",dense:""},on:{input:function(t){e.c_value=t}},scopedSlots:e._u([{key:"append",fn:function(){return[n("q-icon",{staticClass:"cursor-pointer",attrs:{name:"search"}},[n("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[n("div",{staticStyle:{width:"260px"}},[e.loading?n("div",{staticClass:"q-ma-md text-center text-faded"},[n("div",{staticClass:"q-ma-md"},[e._v("loading...")]),n("q-spinner-oval",{attrs:{color:"primary",size:"50px"}})],1):0===e.ports.length?n("div",{staticClass:"q-ma-md text-faded"},[e._v("no serial port found")]):n("q-list",{attrs:{separator:""}},[n("q-btn",{attrs:{flat:"",color:"faded",icon:"refresh",label:"refresh"},on:{click:function(t){return e.refresh()}}}),e._l(e.ports,function(t,i){return n("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],key:i,attrs:{clickable:""},on:{click:function(n){e.c_value=t.device}}},[n("q-item-section",[n("q-item-label",[e._v(e._s(t.device))]),t.product?n("q-item-label",{attrs:{caption:""}},[e._v("product: "+e._s(t.product))]):e._e(),t.manufacturer?n("q-item-label",{attrs:{caption:""}},[e._v("manufacturer: "+e._s(t.manufacturer))]):e._e(),t.description?n("q-item-label",{attrs:{caption:""}},[e._v("description: "+e._s(t.description))]):e._e()],1)],1)})],2)],1)])],1)]},proxy:!0}])})],1)])},Rr=[],Ur={name:"FormSchemaSerialPort",mixins:[Tt["FormComponent"]],data:function(){return{ports:[],loading:!0,loaded:!1}},methods:{show:function(){this.loaded||(this.loaded=!0),this.refresh()},refresh:function(){var e=this;this.loading=!0,jt.a.request({url:"utils/serial_ports_list",dataType:"json"}).then(function(t){e.ports=t}).finally(function(){e.loading=!1})}}},Nr=Ur,Pr=Object(Le["a"])(Nr,Mr,Rr,!1,null,null,null),Wr=Pr.exports,Vr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-week-calendar"},[e.c_value&&e.c_value.length?n("div",e._l(e.c_value,function(t,i){return n("q-item",{key:i,attrs:{dense:""}},[n("q-item-section",{attrs:{avatar:""}},[n("q-icon",{attrs:{name:"schedule"}})],1),n("q-item-section",[e._v("\n        "+e._s(e.toString(t))+"\n      ")])],1)}),1):n("div",{staticClass:"q-ma-md text-faded"},[e._v("\n    no scheduling\n  ")]),n("q-btn",{attrs:{color:"blue-5",label:"Select",icon:"add",flat:""},on:{click:function(t){e.modal=!0}}}),n("modal",{attrs:{title:"Scheduler",icon:"schedule","valid-btn-hide":"","cancel-btn-label":"Close","cancel-btn-color":"faded"},model:{value:e.modal,callback:function(t){e.modal=t},expression:"modal"}},[n("div",{staticClass:"overflow-hidden"},[n("div",{staticClass:"row q-gutter-xs non-selectable"},e._l(e.days,function(t){return n("div",{staticClass:"col day"},[n("div",{staticClass:"column"},[n("div",{staticClass:"col-auto header q-py-md text-center"},[n("span",{staticClass:"gt-xs"},[e._v(e._s(t.name))]),n("span",{staticClass:"xs"},[e._v(e._s(e.printSmall(t.name)))])]),e._l(t.hours,function(t){return n("div",{staticClass:"col-auto hour q-pa-xs",class:{selected:t.selected},on:{mousedown:function(n){return e.select(t)},mouseover:function(n){return e.mouseOver(n,t)},mouseup:e.updateValue}},[e._v("\n              "+e._s(t.index)+"\n            ")])})],2)])}),0)])])],1)},Hr=[],zr=(n("6c7b"),["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"]),Qr={name:"FormSchemaWeekCalendar",mixins:[Tt["FormComponent"]],data:function(){return{days:this.fromValue(this.c_value),selectMode:!0,modal:!1}},methods:{select:function(e){e.selected=!e.selected,this.selectMode=e.selected},mouseOver:function(e,t){1===e.buttons&&(t.selected=this.selectMode)},updateValue:function(){var e=[];this.days.forEach(function(t,n){var i=n,r=!1,a=null;t.hours.forEach(function(t){t.selected!=r&&(t.selected?a={start:{weekDay:i,hour:t.index}}:(a.end={weekDay:i,hour:t.index},e.push(a),a=null)),r=t.selected}),a&&(a.end={weekDay:i,hour:24},e.push(a),a=null)}),this.c_value=e},inSelection:function(e,t,n){var i=function(e,t){return 100*e+t};for(var r in e){var a=i(e[r].start.weekDay,e[r].start.hour),o=i(e[r].end.weekDay,e[r].end.hour),s=i(t,n);if(s>=a&&s<o)return!0}return!1},fromValue:function(e){var t=this,n=zr.map(function(n,i){return{name:n,hours:Array(24).fill(0).map(function(n,r){return{index:r,selected:!!e&&t.inSelection(e,i,r)}})}});return n},toString:function(e){return e.start.weekDay===e.end.weekDay?zr[e.start.weekDay]+" "+e.start.hour+"h - "+e.end.hour+"h":zr[e.start.weekDay]+" "+e.start.hour+"h - "+zr[e.end.weekDay]+" "+e.end.hour+"h"},printSmall:function(e){return e.substring(0,3)}},mounted:function(){this.updateValue()}},Yr=Qr,Gr=(n("4915"),Object(Le["a"])(Yr,Vr,Hr,!1,null,"d51621fa",null)),Jr=Gr.exports,Kr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-array-modal"},[n("div",[n("q-btn",{attrs:{flat:"",size:"md",label:"Add item",icon:"add"},on:{click:e.addItem}})],1),e._l(e.items,function(t,i){return n("div",{key:i,staticClass:"formField"},[n("div",{staticClass:"row items-center"},[n("div",{staticClass:"label col text-faded"},[n("q-icon",{attrs:{name:"keyboard_arrow_right",color:"primary"}}),e._v("\n        "+e._s(e.getLabel(i))+"\n      ")],1),i>0?n("q-btn",{staticClass:"col-auto",attrs:{flat:"",size:"sm",color:"secondary",icon:"arrow_drop_up"},on:{click:function(t){return e.moveItem(i,"up")}}}):e._e(),i<e.items.length-1?n("q-btn",{staticClass:"col-auto",attrs:{flat:"",size:"sm",color:"secondary",icon:"arrow_drop_down"},on:{click:function(t){return e.moveItem(i,"down")}}}):e._e(),n("q-btn",{staticClass:"col-auto",attrs:{flat:"",size:"sm",color:"secondary",label:"edit",icon:"edit"},on:{click:function(t){return e.editItem(i)}}}),n("q-btn",{staticClass:"col-auto",attrs:{flat:"",size:"sm",color:"negative",label:"remove",icon:"delete"},on:{click:function(t){return e.removeItem(i)}}})],1)])}),n("modal",{attrs:{title:"Add item",icon:"add","valid-btn-disable":e.edit.error,"valid-btn-label":"Add"},on:{valid:e.onEditDone},model:{value:e.edit.show,callback:function(t){e.$set(e.edit,"show",t)},expression:"edit.show"}},[n("form-schema",{attrs:{schema:e.schema.items||{},value:e.edit.model},on:{input:function(t){e.edit.model=t},error:function(t){e.edit.error=t}}})],1)],2)},Zr=[],Xr={name:"FormSchemaArrayModal",mixins:[Tt["FormComponent"]],data:function(){return{items:[],edit:{show:!1,model:void 0,error:!1}}},watch:{model:function(){this.refreshFromModel()}},validations:function(){var e={};return"number"===typeof this.c_schema.minItems&&(e.minLength=Object(nn["minLength"])(this.c_schema.minItems)),"number"===typeof this.c_schema.maxItems&&(e.maxLength=Object(nn["maxLength"])(this.c_schema.maxItems)),{c_value:e}},methods:{refreshFromModel:function(){var e=this;this.items=(this.c_value||[]).map(function(t){return{schema:e.c_schema.items||{}}})},getLabel:function(e){var t=this.c_value._label;return"string"===typeof t?t:"function"===typeof t?t.call(this,e,this.c_value[e]):-1!==["string","boolean","integer","int","long","number","float","double"].indexOf(this.c_schema.items.type)?String(this.c_value[e]):"item #"+e},getModel:function(e){return Array.isArray(this.c_value)&&e<this.c_value.length?this.c_value[e]:void 0},addItem:function(){this.edit.key=-1,this.edit.model=void 0,this.edit.show=!0},onEditDone:function(){-1===this.edit.key?this.c_value.push(this.edit.model):this.$set(this.c_value,this.edit.key,this.edit.model),this.edit.show=!1},removeItem:function(e){this.items.splice(e,1),this.c_value.splice(e,1)},moveItem:function(e,t){var n=this.c_value.splice(e,1);this.c_value.splice(e+("up"===t?-1:1),0,n[0])},editItem:function(e){this.edit.key=e,this.edit.model=this.c_value[e],this.edit.show=!0},onChildValueChange:function(e,t){this.$set(this.c_value,e,t)},onChildErrorChange:function(e,t){this.items[e].error=t,this.$emit("error",Object.values(this.items).some(function(e){return e.error}))}},mounted:function(){this.refreshFromModel()}},ea=Xr,ta=(n("32a5"),Object(Le["a"])(ea,Kr,Zr,!1,null,"c1009e8c",null)),na=ta.exports,ia={BluetoothInterface:xi,Editor:ji,EthingFlowNode:Ni,EthingResource:Pi["a"],Cron:Ki,Host:cr,Oneof:mr,Optional:wr,Scheduler:Tr,Scope:Lr,SerialPort:Wr,WeekCalendar:Jr,ArrayModal:na};for(var ra in vi)Tt["coreComponents"].push(vi[ra]);for(var aa in ia)Tt["registerForm"](ia[aa]);var oa=function(e){var t=e.Vue;t.component("FormSchema",Bt),t.config.optionMergeStrategies.validations=t.config.optionMergeStrategies.data},sa=n("bc3a"),ca=n.n(sa),la=function(e){var t=e.Vue;t.prototype.$axios=ca.a,window&&(window.axios=ca.a)},ua=n("2330"),da=Ve(),ha=da.app,fa=da.router;function ma(){return pa.apply(this,arguments)}function pa(){return pa=o()(r.a.mark(function e(){var t,n;return r.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t=[Ge,Xe,nt,bt,Ot,Et,oa,la,ua["a"]],n=0;case 2:if(!(n<t.length)){e.next=20;break}if("function"===typeof t[n]){e.next=5;break}return e.abrupt("continue",17);case 5:return e.prev=5,e.next=8,t[n]({app:ha,router:fa,Vue:s["default"],ssrContext:null});case 8:e.next=17;break;case 10:if(e.prev=10,e.t0=e["catch"](5),!e.t0||!e.t0.url){e.next=15;break}return window.location.href=e.t0.url,e.abrupt("return");case 15:return console.error("[Quasar] boot error:",e.t0),e.abrupt("return");case 17:n++,e.next=2;break;case 20:new s["default"](ha);case 21:case"end":return e.stop()}},e,null,[[5,10]])})),pa.apply(this,arguments)}ma()},"2f7b":function(e,t,n){},"32a5":function(e,t,n){"use strict";var i=n("113e"),r=n.n(i);r.a},"36c33":function(e,t,n){"use strict";var i=n("9ea3"),r=n.n(i);r.a},"3a11":function(e,t,n){},"424a":function(e,t,n){},4880:function(e,t,n){},4915:function(e,t,n){"use strict";var i=n("2f7b"),r=n.n(i);r.a},"4e1e":function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="4e1e"},"51e5":function(e,t,n){"use strict";var i=n("0b6e"),r=n.n(i);r.a},"56ed":function(e,t,n){"use strict";var i=n("4880"),r=n.n(i);r.a},"597a":function(e,t,n){},"5a31":function(e,t,n){"use strict";var i=n("89fa"),r=n.n(i);r.a},6451:function(e,t,n){"use strict";var i=n("3a11"),r=n.n(i);r.a},6659:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-item",{staticClass:"item",attrs:{clickable:"",link:!e.readonly},on:{click:function(t){return e.open(e.resource)}}},[e._l(e.level,function(t){return n("div",{class:e.gen(t)})}),n("q-item-section",{attrs:{avatar:""}},[n("q-avatar",{attrs:{icon:e.meta.icon,"text-color":"white",color:e.meta.color}})],1),n("q-item-section",[n("q-item-label",[n("span",{staticClass:"vertical-middle text-black"},[e._v(e._s(e.resource.basename()))]),e.showParent?n("small",{staticClass:"parent text-faded vertical-bottom on-right",class:e.readonly?"":"cursor-pointer",on:{click:function(t){return t.stopPropagation(),e.open(e.createdBy)}}},[e._v(e._s(e.createdBy.basename()))]):e._e(),e.showConnected&&!e.resource.connected()?n("q-icon",{staticClass:"vertical-middle on-right",attrs:{name:"mdi-lan-disconnect",color:"warning"}}):e._e(),e.resource.public()?n("q-icon",{staticClass:"vertical-middle on-right",attrs:{name:"share",color:"warning"}}):e._e()],1),n("q-item-label",{attrs:{caption:""}},[e._v(e._s(e.$ethingUI.utils.dateToString(e.date)))]),e.showType?n("q-item-label",{attrs:{caption:""}},[e._v(e._s(e.meta.title))]):e._e(),e.showBattery?n("q-item-label",{staticClass:"lt-sm",attrs:{caption:""}},[e._v("battery: "+e._s(e.resource.battery())+"%")]):e._e(),e.showLocation?n("q-item-label",{staticClass:"lt-sm",attrs:{caption:""}},[e._v("location: "+e._s(e.resource.location()))]):e._e(),e.showSize?n("q-item-label",{attrs:{caption:""}},[e._v(e._s(e.$ethingUI.utils.sizeToString(e.resource.size())))]):e._e(),e.showLength?n("q-item-label",{attrs:{caption:""}},[e._v(e._s(e.resource.length())+" rows")]):e._e(),e.showError?n("q-item-label",{staticClass:"text-negative",attrs:{caption:""}},[n("q-icon",{attrs:{name:"mdi-alert"}}),e._v(" "+e._s(e.resource.attr("error")))],1):e._e()],1),n("q-item-section",{attrs:{side:""}},[n("div",[e._l(e.data,function(t,i){return n("q-chip",{key:i,staticClass:"gt-sm",attrs:{dense:"",outline:"",square:"",color:"secondary"}},[e._v(e._s(i)+": "+e._s(t))])}),e.showLocation?n("q-chip",{staticClass:"gt-xs",attrs:{dense:"",outline:"",square:"",color:"secondary",icon:"location_on"}},[e._v("\n        "+e._s(e.resource.location())+"\n      ")]):e._e(),e.showBattery?n("resource-battery-chip",{staticClass:"gt-xs",attrs:{outline:"",square:"",color:"secondary",resource:e.resource}}):e._e()],2)]),e.readonly?e._e():n("q-item-section",{attrs:{side:""}},[n("div",[e._t("buttons-prepend"),e.showFlowEnable?n("q-btn",{staticClass:"gt-xs",attrs:{icon:e.flowEnableIcon,flat:"",dense:"",label:e.flowEnableLabel,color:e.flowEnableColor},on:{click:function(t){return t.stopPropagation(),e.toggleFlowEnable()}}}):e._e(),e.showChart?n("q-btn",{staticClass:"gt-xs",attrs:{icon:"mdi-chart-line",round:"",flat:"",dense:"",color:"secondary"},on:{click:function(t){return t.stopPropagation(),e.chart(t)}}}):e._e(),e.showDownload?n("q-btn",{staticClass:"gt-xs",attrs:{icon:"cloud_download",round:"",flat:"",dense:"",color:"secondary"},on:{click:function(t){return t.stopPropagation(),e.download(t)}}}):e._e(),n("q-btn",{staticClass:"gt-xs",attrs:{icon:"delete",round:"",flat:"",dense:""},on:{click:function(t){return t.stopPropagation(),e.remove(t)}}}),n("q-btn",{staticClass:"gt-xs",attrs:{icon:"settings",round:"",flat:"",dense:""},on:{click:function(t){return t.stopPropagation(),e.settings(t)}}}),n("q-btn",{staticClass:"lt-sm",attrs:{icon:"more_vert",round:"",flat:"",dense:""},on:{click:function(t){return t.stopPropagation(),e.more(t)}}})],2)])],2)},r=[],a=(n("7f7f"),n("c5f6"),n("691a")),o={name:"ResourceQItem",components:{ResourceBatteryChip:a["a"]},props:{resource:{},level:{type:Number,default:0},noParent:Boolean,readonly:Boolean},data:function(){return{}},computed:{date:function(){var e=this.resource.modifiedDate();if(this.resource instanceof this.$ething.Device){var t=this.resource.lastSeenDate();if(t&&t>e)return t}return e},createdBy:function(){return this.resource.createdBy()?this.$ething.arbo.get(this.resource.createdBy()):null},showParent:function(){return!this.noParent&&!!this.createdBy},showType:function(){return this.resource instanceof this.$ething.Device},showConnected:function(){return this.resource instanceof this.$ething.Device},showError:function(){return this.resource instanceof this.$ething.Device&&this.resource.attr("error")},showBattery:function(){return this.resource instanceof this.$ething.Device&&this.resource.hasBattery()},showLocation:function(){return this.resource instanceof this.$ething.Device&&this.resource.location()},showSize:function(){return this.resource instanceof this.$ething.File},showLength:function(){return this.resource instanceof this.$ething.Table},showChart:function(){return this.resource instanceof this.$ething.Table&&this.resource.length()},showDownload:function(){return this.resource instanceof this.$ething.File||this.resource instanceof this.$ething.Table},showFlowEnable:function(){return this.$ethingUI.isSubclass(this.resource,"resources/Flow")},meta:function(){return this.$ethingUI.get(this.resource)},data:function(){return this.meta.data()||{}},flowEnableIcon:function(){return this.resource.attr("enabled")?"stop":"mdi-play"},flowEnableLabel:function(){return this.resource.attr("enabled")?"stop":"run"},flowEnableColor:function(){return this.resource.attr("enabled")?"negative":"secondary"}},methods:{gen:function(e){return["pad","pad-"+e]},batteryIcon:function(e){return e>95?"mdi-battery":e>85?"mdi-battery-90":e>75?"mdi-battery-80":e>65?"mdi-battery-70":e>55?"mdi-battery-60":e>45?"mdi-battery-50":e>35?"mdi-battery-40":e>25?"mdi-battery-30":e>15?"mdi-battery-20":e>=0?"mdi-battery-alert":"battery unknown"},batteryColor:function(e){return e<=15?"negative":e<=40?"warning":void 0},settings:function(){this.$router.push("/resource/"+this.resource.id())},more:function(){var e=this,t=[],n={};this.showFlowEnable&&(t.push({label:this.flowEnableLabel,color:this.flowEnableColor,icon:this.flowEnableIcon,id:"flowEnable"}),n["flowEnable"]=function(){return e.toggleFlowEnable()}),this.showChart&&(t.push({label:"Plot chart",color:"secondary",icon:"mdi-chart-line",id:"plotChart"}),n["plotChart"]=function(){return e.chart()}),t.push({label:"Delete",color:"negative",icon:"delete",id:"remove"}),n["remove"]=function(){return e.remove()},t.push({label:"Settings",icon:"settings",id:"settings"}),n["settings"]=function(){return e.settings()},this.$q.bottomSheet({title:this.resource.basename(),actions:t}).onOk(function(e){n[t]()})},remove:function(){var e=this,t=this.resource.name(),n=this.$ething.arbo.list().filter(function(t){return t.createdBy()===e.resource.id()}),i=[];return n.length&&i.push({label:"Remove also the children resources",value:"removeChildren",color:"secondary"}),this.$q.dialog({title:"Remove",message:"Do you really want to remove definitely the "+this.resource.type()+' "'+this.resource.name()+'" ?',options:{type:"checkbox",model:[],items:i},ok:"Remove",cancel:"Cancel"}).onOk(function(n){e.resource.remove(-1!==n.indexOf("removeChildren")).then(function(){e.$q.notify('"'+t+'" removed !')})})},chart:function(){this.$router.push("/chart/"+this.resource.id())},download:function(){var e=this;this.resource instanceof this.$ething.File?this.$ething.request({url:this.resource.getContentUrl(),dataType:"blob"}).then(function(t){e.$ethingUI.utils.saveAs(t,e.resource.basename())}):this.resource instanceof this.$ething.Table&&this.$q.dialog({title:'Download "'+this.resource.name()+'"',message:"Format: ",options:{type:"radio",model:"csv",items:[{label:"CSV",value:"csv"},{label:"JSON",value:"json_pretty"}]},cancel:!0,persistent:!0,color:"secondary"}).onOk(function(t){e.$ething.request({url:e.resource.getContentUrl()+"?fmt="+t,dataType:"blob"}).then(function(n){e.$ethingUI.utils.saveAs(n,e.resource.basename()+"."+("json_pretty"==t?"json":t))})})},open:function(e){this.readonly||this.$ethingUI.open(e)},toggleFlowEnable:function(){this.resource.set({enabled:!this.resource.attr("enabled")}).catch(function(e){console.error(e)})}}},s=o,c=(n("13f6"),n("2877")),l=Object(c["a"])(s,i,r,!1,null,"43f4717f",null);t["a"]=l.exports},"691a":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return"number"===typeof e.battery?n("q-chip",e._b({attrs:{dense:"",icon:e.batteryIcon}},"q-chip",e.attrs,!1),[e._v("\n  "+e._s(e.battery)+"%\n")]):e._e()},r=[],a=(n("f751"),{name:"ResourceBatteryChip",props:{resource:{}},data:function(){return{}},computed:{battery:function(){return this.resource.battery()},batteryIcon:function(){var e=this.battery;return e>95?"mdi-battery":e>85?"mdi-battery-90":e>75?"mdi-battery-80":e>65?"mdi-battery-70":e>55?"mdi-battery-60":e>45?"mdi-battery-50":e>35?"mdi-battery-40":e>25?"mdi-battery-30":e>15?"mdi-battery-20":e>=0?"mdi-battery-alert":"battery_unknown"},attrs:function(){var e=Object.assign({},this.$attrs),t=this.battery;return t<=15&&(e.color="negative"),t<=40&&(e.color="warning"),e}}}),o=a,s=n("2877"),c=Object(s["a"])(o,i,r,!1,null,null,null);t["a"]=c.exports},"6b5b":function(e,t,n){},"714b":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-dialog",e._b({ref:"modal",staticClass:"column",attrs:{value:e.value},on:{input:function(t){return e.$emit("input",t)},show:function(t){return e.$emit("show",t)},"escape-key":function(t){return e.$emit("cancel")},dismiss:function(t){return e.$emit("cancel")}}},"q-dialog",e.$attrs,!1),[n("div",{staticClass:"column bg-white",style:Object.assign({},e.widthCss,e.heightCss)},[n("div",{staticClass:"col-auto bg-primary text-white q-py-sm q-px-md title"},[n("div",{staticClass:"row items-center"},[e.icon?n("q-icon",{attrs:{name:e.icon,left:""}}):e._e(),e.title?n("div",{staticClass:"text-h6"},[e._v(e._s(e.title))]):e._e(),n("q-space"),n("q-btn",{attrs:{dense:"",flat:"",icon:"close"},on:{click:e.onCloseBtnClick}},[e._v("Close")])],1)]),n("div",{staticClass:"col scroll"},[n("div",{class:e.noContentPadding?"":"q-pa-md"},[e._t("default")],2),!e.noButtons&&e.scroll?n("div",{staticClass:"q-py-sm q-px-md buttons row items-center"},[e.validBtnHide?e._e():n("q-btn",{attrs:{color:e.validBtnColor,label:e.validBtnLabel,disable:e.validBtnDisable,loading:e.validBtnLoading,flat:""},on:{click:function(t){return e.onValidBtnClick()}}}),e.cancelBtnHide?e._e():n("q-btn",{attrs:{color:e.cancelBtnColor,label:e.cancelBtnLabel,disable:e.cancelBtnDisable,flat:""},on:{click:function(t){return e.onCancelBtnClick()}}}),e._l(e.buttons,function(t,i){return n("q-btn",{key:i,attrs:{color:t.color,label:t.label,flat:t.flat,disable:t.disable},on:{click:function(n){return e.onBtnClick(t)}}})}),e._t("buttons"),n("q-space"),e._t("buttons-right")],2):e._e()]),e.noButtons||e.scroll?e._e():n("div",{staticClass:"col-auto q-py-sm q-px-md buttons row items-center"},[e.validBtnHide?e._e():n("q-btn",{attrs:{color:e.validBtnColor,label:e.validBtnLabel,disable:e.validBtnDisable,loading:e.validBtnLoading,flat:""},on:{click:function(t){return e.onValidBtnClick()}}}),e.cancelBtnHide?e._e():n("q-btn",{attrs:{color:e.cancelBtnColor,label:e.cancelBtnLabel,disable:e.cancelBtnDisable,flat:""},on:{click:function(t){return e.onCancelBtnClick()}}}),e._l(e.buttons,function(t,i){return n("q-btn",{key:i,attrs:{color:t.color,label:t.label,flat:t.flat,disable:t.disable},on:{click:function(n){return e.onBtnClick(t)}}})}),e._t("buttons"),n("q-space"),e._t("buttons-right")],2)])])},r=[],a={name:"Modal",props:{title:String,icon:String,value:{},size:{type:String,default:"md"},scroll:Boolean,noContentPadding:Boolean,noButtons:Boolean,validBtnHide:Boolean,validBtnDisable:Boolean,validBtnLoading:Boolean,validBtnLabel:{type:String,default:"Valid"},validBtnColor:{type:String,default:"primary"},cancelBtnHide:Boolean,cancelBtnDisable:Boolean,cancelBtnLabel:{type:String,default:"Cancel"},cancelBtnColor:{type:String,default:"negative"},buttons:Array},data:function(){return{}},computed:{heightCss:function(){var e;return"xs"==this.size?e="40vh":"sm"==this.size?e="50vh":"md"==this.size?e="70vh":"lg"==this.size?e="80vh":"xl"==this.size&&(e="90vh"),{height:e}},widthCss:function(){var e;return"xs"==this.size?e="30vw":"sm"==this.size?e="40vw":"md"==this.size?e="50vw":"lg"==this.size?e="70vw":"xl"==this.size&&(e="90vw"),{width:e,maxWidth:e}}},methods:{onValidBtnClick:function(){this.$emit("valid")},onCancelBtnClick:function(){this.$emit("cancel"),this.hide()},onBtnClick:function(e){e.onclick.call(this)},onCloseBtnClick:function(){this.$emit("cancel"),this.hide()},hide:function(){this.$refs.modal&&this.$refs.modal.hide()},show:function(){this.$refs.modal&&this.$refs.modal.show()},toggle:function(){this.$refs.modal&&this.$refs.modal.toggle()}}},o=a,s=(n("51e5"),n("2877")),c=Object(s["a"])(o,i,r,!1,null,"471b82b6",null);t["a"]=c.exports},"79c7":function(e,t,n){"use strict";var i=n("eacb"),r=n.n(i);r.a},"7b2c":function(e,t,n){},"7cd69":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("modal",{ref:"modal",attrs:{value:e.value,title:e.title,icon:"add","valid-btn-disable":e.formError,"valid-btn-label":"create","valid-btn-loading":e.loading},on:{input:function(t){return e.$emit("input",t)},valid:e.handler,cancel:e.onCancel}},[e.items.length>1?n("q-select",{staticClass:"q-mb-xl",attrs:{options:e.items,"emit-value":""},scopedSlots:e._u([{key:"selected",fn:function(){return[e.selectedType?n("div",[n("q-avatar",{staticClass:"q-mr-sm",attrs:{icon:e.selectedClass.icon,color:e.selectedClass.color,"text-color":"white",size:"24px"}}),n("span",[e._v(e._s(e.selectedClass.title))])],1):n("div",[e._v("select a resource")])]},proxy:!0},{key:"option",fn:function(t){return[n("q-item",e._g(e._b({},"q-item",t.itemProps,!1),t.itemEvents),[n("q-item-section",{attrs:{avatar:""}},[n("q-avatar",{attrs:{color:t.opt.color,"text-color":"white",icon:t.opt.icon}})],1),n("q-item-section",[n("q-item-label",[e._v(e._s(t.opt.label))]),n("q-item-label",{attrs:{caption:""}},[e._v(e._s(t.opt.sublabel))])],1)],1)]}}],null,!1,1413784834),model:{value:e.selectedType,callback:function(t){e.selectedType=t},expression:"selectedType"}}):e._e(),e.selectedType?n("resource-editor",{key:e.selectedType,ref:"form",attrs:{resource:e.selectedType},on:{error:function(t){e.formError=t}}}):e._e(),e.error?n("q-banner",{staticClass:"bg-negative text-white q-mb-xl"},[n("q-icon",{attrs:{left:"",name:"mdi-alert"}}),e._v(" "+e._s(String(e.error))+"\n  ")],1):e._e()],1)},r=[],a=(n("097d"),n("551c"),n("06db"),n("28a5"),n("d6ac")),o=n("714b"),s={name:"ResourceCreateModal",components:{Modal:o["a"],ResourceEditor:a["a"]},props:{value:Boolean,types:{type:Array,default:function(){return["resources/Resource"]}}},data:function(){return{selectedType:void 0,loading:!1,error:!1,formError:!1}},computed:{items:function(){var e=this,t=[];return this.$ethingUI.iterate("resources",function(n){var i=e.$ethingUI.get(n);if(!i.virtual&&!i.disableCreation){var r=!1;if(-1!==e.types.indexOf(n))r=!0;else for(var a in e.types)if(e.$ethingUI.isSubclass(i,e.types[a])){r=!0;break}r&&t.push(i)}}),t.map(function(e){var t=e._type,n=t.split("/");return n.pop(),n=n.join(" "),{label:e.title,icon:e.icon,color:e.color,sublabel:n,value:t}})},title:function(){return 1==this.items.length?"create "+this.items[0].label:"create"},selectedClass:function(){return this.selectedType?this.$ethingUI.get(this.selectedType):void 0}},methods:{show:function(){return this.$refs.modal.show()},hide:function(){return this.$refs.modal?this.$refs.modal.hide():Promise.resolve()},onDone:function(e){this.hide(),this.$emit("ok")},onCancel:function(){this.hide(),this.$emit("cancel")},handler:function(){var e=this;this.loading=!0,this.$refs.form.submit().then(this.onDone).catch(function(t){e.error=t||"error"}).finally(function(){e.loading=!1})}}},c=s,l=n("2877"),u=Object(l["a"])(c,i,r,!1,null,null,null);t["a"]=u.exports},"7e6d":function(e,t,n){},"80c5":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"row cell"},[n("div",{staticClass:"col-xs-12 col-sm-3 title text-bold"},[e._v("\n      Schedule\n    ")]),n("div",{staticClass:"col-xs-12 col-sm-9 cell-content"},[n("div",{staticClass:"text-faded"},[e._v("\n        Select the schedule that the trigger should run on.\n      ")]),n("q-list",[n("q-item",{attrs:{tag:"label"}},[n("q-item-section",{attrs:{side:"",top:""}},[n("q-radio",{attrs:{val:"daily"},model:{value:e.model.schedule,callback:function(t){e.$set(e.model,"schedule",t)},expression:"model.schedule"}})],1),n("q-item-section",[n("q-item-label",[e._v("Daily")]),n("q-item-label",{attrs:{caption:""}},[e._v("Allows you to configure a trigger that will run once, hourly or minutely daily")])],1)],1),n("q-item",{attrs:{tag:"label"}},[n("q-item-section",{attrs:{side:"",top:""}},[n("q-radio",{attrs:{val:"weekly"},model:{value:e.model.schedule,callback:function(t){e.$set(e.model,"schedule",t)},expression:"model.schedule"}})],1),n("q-item-section",[n("q-item-label",[e._v("Days per week")]),n("q-item-label",{attrs:{caption:""}},[e._v("Allows you to configure a trigger that will run once, hourly or minutely on certain days of the week")])],1)],1),n("q-item",{attrs:{tag:"label"}},[n("q-item-section",{attrs:{side:"",top:""}},[n("q-radio",{attrs:{val:"monthly"},model:{value:e.model.schedule,callback:function(t){e.$set(e.model,"schedule",t)},expression:"model.schedule"}})],1),n("q-item-section",[n("q-item-label",[e._v("Days per month")]),n("q-item-label",{attrs:{caption:""}},[e._v("Allows you to configure a trigger that will run on a specific date of the month or specific day of the week")])],1)],1),n("q-item",{attrs:{tag:"label"}},[n("q-item-section",{attrs:{side:"",top:""}},[n("q-radio",{attrs:{val:"cron"},model:{value:e.model.schedule,callback:function(t){e.$set(e.model,"schedule",t)},expression:"model.schedule"}})],1),n("q-item-section",[n("q-item-label",[e._v("Cron expression")]),n("q-item-label",{attrs:{caption:""}},[e._v("Allows you to configure a trigger that will run according to the specific CRON expression")])],1)],1)],1)],1)]),"weekly"==e.model.schedule?n("div",{staticClass:"row cell"},[n("div",{staticClass:"col-xs-12 col-sm-3 title text-bold"},[e._v("\n      Run Days\n    ")]),n("div",{staticClass:"col-xs-12 col-sm-9 cell-content"},[n("div",{staticClass:"text-faded"},[e._v("\n        Select what days of the week the scheduler should execute.\n      ")]),n("div",{staticClass:"q-my-md"},e._l(e.weekdays,function(t){return n("q-checkbox",{key:t,staticClass:"q-mr-md q-my-sm",attrs:{val:t,label:t},model:{value:e.model.days,callback:function(t){e.$set(e.model,"days",t)},expression:"model.days"}})}),1)])]):e._e(),"monthly"==e.model.schedule?n("div",{staticClass:"row cell"},[n("div",{staticClass:"col-xs-12 col-sm-3 title text-bold"},[e._v("\n      On\n    ")]),n("div",{staticClass:"col-xs-12 col-sm-9 cell-content"},[n("div",{staticClass:"text-faded"},[e._v("\n        Select when in the month the trigger should execute\n      ")]),n("q-list",[n("q-item",{attrs:{tag:"label"}},[n("q-item-section",{attrs:{side:"",top:""}},[n("q-radio",{attrs:{val:"day"},model:{value:e.model.on,callback:function(t){e.$set(e.model,"on",t)},expression:"model.on"}})],1),n("q-item-section",[e._v("\n            Specific date of every month\n          ")])],1),n("q-item",{attrs:{tag:"label"}},[n("q-item-section",{attrs:{side:"",top:""}},[n("q-radio",{attrs:{val:"weekday"},model:{value:e.model.on,callback:function(t){e.$set(e.model,"on",t)},expression:"model.on"}})],1),n("q-item-section",[e._v("\n            Specific day of week of every month\n          ")])],1)],1),"day"==e.model.on?n("div",[e._v("\n        The\n        "),n("q-select",{staticClass:"inline",attrs:{options:e.onMonthlyDaysOptions},model:{value:e.model.onDay,callback:function(t){e.$set(e.model,"onDay",t)},expression:"model.onDay"}}),e._v("\n        of every month\n      ")],1):e._e(),"weekday"==e.model.on?n("div",[e._v("\n        The\n        "),n("q-select",{staticClass:"inline",attrs:{options:[{label:"First",value:1},{label:"Second",value:2},{label:"Third",value:3},{label:"Fourth",value:4}]},model:{value:e.model.onWeekdayOrdinal,callback:function(t){e.$set(e.model,"onWeekdayOrdinal",t)},expression:"model.onWeekdayOrdinal"}}),n("q-select",{staticClass:"inline",attrs:{options:e.onMonthlyWeekdaysOptions},model:{value:e.model.onWeekday,callback:function(t){e.$set(e.model,"onWeekday",t)},expression:"model.onWeekday"}}),e._v("\n        of every month\n      ")],1):e._e()],1)]):e._e(),"daily"==e.model.schedule||"weekly"==e.model.schedule?n("div",{staticClass:"row cell"},[n("div",{staticClass:"col-xs-12 col-sm-3 title text-bold"},[e._v("\n      Interval\n    ")]),n("div",{staticClass:"col-xs-12 col-sm-9 cell-content"},[n("q-select",{staticClass:"inline",attrs:{options:[{label:"Runs once",value:"once"},{label:"Every x hours",value:"repeatHours"},{label:"Every x minutes",value:"repeatMinutes"}]},model:{value:e.model.interval,callback:function(t){e.$set(e.model,"interval",t)},expression:"model.interval"}})],1)]):e._e(),"monthly"==e.model.schedule||("daily"==e.model.schedule||"weekly"==e.model.schedule)&&"once"==e.model.interval?n("div",{staticClass:"row cell"},[n("div",{staticClass:"col-xs-12 col-sm-3 title text-bold"},[e._v("\n      Start Time\n    ")]),n("div",{staticClass:"col-xs-12 col-sm-9 cell-content"},[e._v("\n\n      Starting at\n      "),n("q-input",{staticClass:"inline",attrs:{filled:""},scopedSlots:e._u([{key:"append",fn:function(){return[n("q-icon",{staticClass:"cursor-pointer",attrs:{name:"access_time"}},[n("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[n("q-time",{attrs:{format24h:""},model:{value:e.model.startTime,callback:function(t){e.$set(e.model,"startTime",t)},expression:"model.startTime"}})],1)],1)]},proxy:!0}],null,!1,1903552290),model:{value:e.model.startTime,callback:function(t){e.$set(e.model,"startTime",t)},expression:"model.startTime"}})],1)]):e._e(),"daily"!=e.model.schedule&&"weekly"!=e.model.schedule||"repeatHours"!=e.model.interval&&"repeatMinutes"!=e.model.interval?e._e():n("div",{staticClass:"row cell"},[n("div",{staticClass:"col-xs-12 col-sm-3 title text-bold"},[e._v("\n      Repeat\n    ")]),n("div",{staticClass:"col-xs-12 col-sm-9 cell-content"},[e._v("\n      Every\n      "),n("q-select",{staticClass:"inline",attrs:{options:"repeatHours"==e.model.interval?e.everyHoursOptions:e.everyMinutesOptions},model:{value:e.model.every,callback:function(t){e.$set(e.model,"every",t)},expression:"model.every"}}),"repeatHours"==e.model.interval?n("span",[e._v("\n        hours\n      ")]):n("span",[e._v("\n        minutes\n      ")])],1)]),"cron"==e.model.schedule?n("div",{staticClass:"row cell"},[n("div",{staticClass:"col-xs-12 col-sm-3 title text-bold"},[e._v("\n      Cron Expression\n    ")]),n("div",{staticClass:"col-xs-12 col-sm-9 cell-content"},[n("div",{staticClass:"text-faded"},[e._v("\n        Enter the cron expression to configure when the trigger shoud execute\n      ")]),n("q-input",{staticClass:"q-my-md",attrs:{placeholder:"min hour day month weekday",label:"Cron expression"},model:{value:e.model.cron,callback:function(t){e.$set(e.model,"cron",t)},expression:"model.cron"}})],1)]):e._e()])},r=[],a=(n("28a5"),n("f751"),n("bd4c")),o={name:"Cron",props:["value"],data:function(){for(var e=[],t=1;t<=12;t++)e.push({label:String(t),value:t});var n=[];for(t=1;t<=59;t++)n.push({label:String(t),value:t});var i=[];for(t=1;t<=31;t++)i.push({label:String(t),value:t});var r=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"];return{model:Object.assign({schedule:"daily",interval:"once",startTime:a["b"].buildDate({hours:15,minutes:0}),every:1,days:[],on:"day",onDay:1,onWeekdayOrdinal:1,onWeekday:"monday",cron:this.value||"* 1 * * *"},this.value?this.unserialize(this.value):null),weekdays:r,everyHoursOptions:e,everyMinutesOptions:n,onMonthlyWeekdaysOptions:r.map(function(e){return{label:e,value:e}}),onMonthlyDaysOptions:i,cron:""}},watch:{model:{handler:function(){this.cron=this.serialize()},deep:!0,immediate:!0},cron:{handler:function(e){this.$emit("input",e)},immediate:!0}},methods:{weekdayToIndex:function(e){var t=this.weekdays.indexOf(e)+1;return 7==t&&(t=0),t},indexToWeekday:function(e){return e=parseInt(e),0==e&&(e=7),this.weekdays[e-1]},serialize:function(){var e=this,t=this.model;if("cron"==t.schedule)return t.cron;if("daily"==t.schedule||"weekly"==t.schedule){var n="*";if("weekly"==t.schedule&&(n=t.days.map(function(t){return e.weekdayToIndex(t)}).join(","),n||(n="*")),"once"==t.interval){var i=t.startTime.getHours(),r=t.startTime.getMinutes();return r+" "+i+" * * "+n}if("repeatHours"==t.interval){var a=t.every||1;return 1==a?"0 * * * "+n:"0 */"+a+" * * "+n}if("repeatMinutes"==t.interval){a=t.every||1;return 1==a?"* * * * "+n:"*/"+a+" * * * "+n}}if("monthly"==t.schedule){i=t.startTime.getHours(),r=t.startTime.getMinutes();if("day"==t.on){var o=t.onDay||1;return r+" "+i+" "+o+" * *"}if("weekday"==t.on){n=["1-7","8-14","15-21","22-28"];return r+" "+i+" "+n[t.onWeekdayOrdinal-1]+" * "+this.weekdayToIndex(t.onWeekday)}}},unserialize:function(e){var t=this,n={},i=e.split(" "),r=/^[0-9]+$/,o=/^\*\/[0-9]+$/;if(5===i.length)if(r.test(i[0])&&r.test(i[1])&&(n.startTime=a["b"].buildDate({hours:parseInt(i[1]),minutes:parseInt(i[0])})),"*"==i[2]&&"*"==i[3]){var s="daily";if("*"!=i[4]&&(s=null,/^[0-6](,[0-6])*$/.test(i[4])&&(s="weekly",n.days=i[4].split(",").map(function(e){return t.indexToWeekday(e)}))),s){if(r.test(i[0])&&r.test(i[1]))return n.schedule=s,n.interval="once",n;if("0"==i[0]&&o.test(i[1]))return n.schedule=s,n.interval="repeatHours",n.every=parseInt(i[1].substr(2)),n;if("0"==i[0]&&"*"==i[1])return n.schedule=s,n.interval="repeatHours",n.every=1,n;if("*"==i[1]&&o.test(i[0]))return n.schedule=s,n.interval="repeatMinutes",n.every=parseInt(i[0].substr(2)),n;if("*"==i[1]&&"*"==i[0])return n.schedule=s,n.interval="repeatMinutes",n.every=1,n}}else if("*"!=i[2]&&"*"==i[3]){if(r.test(i[2])&&"*"==i[4])return n.schedule="monthly",n.on="day",n.onDay=parseInt(i[2]),n;var c=["1-7","8-14","15-21","22-28"];if(/^[0-6]$/.test(i[4])&&-1!==c.indexOf(i[2]))return n.schedule="monthly",n.on="weekday",n.onWeekdayOrdinal=c.indexOf(i[2])+1,n.onWeekday=this.indexToWeekday(i[4]),n}return n.schedule="cron",n.cron=e,n}}},s=o,c=(n("97cf"),n("2877")),l=Object(c["a"])(s,i,r,!1,null,"6cd76d28",null);t["a"]=l.exports},8947:function(e,t,n){},"89fa":function(e,t,n){},"8aff":function(e,t,n){},9023:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"widget",class:{"widget-err":e.hasError},style:e.style},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.hasError,expression:"hasError"}],staticClass:"widget-err-layer fit column items-center"},[n("div",{staticClass:"col"}),n("div",{staticClass:"col-auto text-center text-caption"},[e._t("error-before"),n("div",[e._v(e._s(String(e.error||"error")))]),e._t("error-after")],2),n("div",{staticClass:"col"})]),n("div",{staticClass:"widget-content-layer",class:e.inline?"":"fit"},[n("div",{staticClass:"column"},[e.dense||!e.c_title&&!e.$slots.title?e._e():n("div",{staticClass:"col-auto text-center text-faded ellipsis"},[e._t("title",[n("small",[e._v(e._s(e.c_title))])])],2),n("div",{staticClass:"col relative-position"},[n(e.component,e._b({ref:"inner",tag:"component",on:{error:function(t){e.error=t}}},"component",e.$attrs,!1))],1),e.dense||!e.c_footer&&!e.$slots.footer?e._e():n("div",{staticClass:"col-auto text-center text-light ellipsis"},[e._t("footer",[n("small",[e._v(e._s(e.c_footer))])])],2)])])])},r=[],a=(n("7f7f"),n("c5f6"),n("25d4")),o={name:"Widget",components:a["e"],inheritAttrs:!1,props:{component:{},minWidth:Number,minHeight:Number,inline:Boolean,title:String,footer:String,dense:Boolean},data:function(){return{error:!1,widgetInstance:null}},computed:{style:function(){var e={},t=this.widgetInstance;return t&&(t.bgColor&&(e["background-color"]=t.bgColor),t.color&&(e["color"]=t.color),this.minWidth&&(e.minWidth=this.minWidth+"px",this.inline&&(e.width=e.minWidth)),this.minHeight&&(e.minHeight=this.minHeight+"px",e.height=this.inline?e.minHeight:"1px")),e},hasError:function(){return!!this.error},c_resource:function(){return this.$attrs["resource"]},c_title:function(){var e=this,t=this.title;return"undefined"===typeof t&&this.c_resource&&(t="%name%"),this.$ethingUI.utils.parse(t,function(t){if("createdBy"===t)return e.$ething.arbo.get(e.c_resource.createdBy()).name();var n=e.c_resource[t];return"function"===typeof n?n.call(e.c_resource):"undefined"!==typeof n?n:e.c_resource.attr(t)})},c_footer:function(){var e=this.footer;return"undefined"===typeof e&&this.c_resource&&(e=this.c_resource.lastSeenDate?this.c_resource.lastSeenDate():this.c_resource.contentModifiedDate?this.c_resource.contentModifiedDate():this.c_resource.modifiedDate(),e=e?this.$ethingUI.utils.dateToString(e):"never"),e}},mounted:function(){this.widgetInstance=this.$refs.inner},methods:{hasContentOverflow:function(){var e=null;return this.widgetInstance&&(e=this.widgetInstance.$el),!!e&&e.scrollWidth>e.clientWidth},setError:function(e){this.error=e},setTitle:function(e){this.title=e},setFooter:function(e){this.footer=e}}},s=o,c=(n("5a31"),n("2877")),l=Object(c["a"])(s,i,r,!1,null,null,null);t["a"]=l.exports},"90ee":function(e,t,n){"use strict";var i,r,a,o,s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("strong",[e._v(e._s(e.node.name))])},c=[],l={name:"NodeBase",props:["flow","node"]},u=l,d=n("2877"),h=Object(d["a"])(u,s,c,!1,null,null,null),f=h.exports,m={name:"NodeInput",mixins:[f],methods:{inject:function(e){this.$ething.request({url:"flows/"+this.flow.id()+"/inject/"+this.node.id,method:"POST",contentType:"application/json; charset=utf-8",data:e})}}},p=m,v=Object(d["a"])(p,i,r,!1,null,null,null),b=v.exports,y={name:"NodeOutput",mixins:[f],computed:{data:function(){var e=this.flow.data()[this.node.id];if("string"===typeof e)try{e=JSON.parse(e)}catch(t){console.error(t)}return e}}},g=y,_=Object(d["a"])(g,a,o,!1,null,null,null),w=_.exports,x=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-btn",{attrs:{label:e.node.name},on:{click:function(t){return t.stopPropagation(),e._inject(t)}}})},$=[],C={name:"NodeButton",mixins:[b],methods:{_inject:function(e){this.inject((new Date).getTime()/1e3)}}},k=C,q=Object(d["a"])(k,x,$,!1,null,null,null),O=q.exports,S=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",{staticClass:"ellipsis"},[e._v(e._s(e.node.name)+": "+e._s(e.displayValue))])},j=[],E={name:"NodeLabel",mixins:[w],computed:{displayValue:function(){if("undefined"===typeof this.data)return"";try{return JSON.stringify(this.data)}catch(e){return String(this.data)}}}},T=E,D=Object(d["a"])(T,S,j,!1,null,null,null),I=D.exports;t["a"]={Base:f,Input:b,Output:w,Button:O,Label:I}},"95fd":function(e,t,n){"use strict";var i=n("8947"),r=n.n(i);r.a},9769:function(e,t,n){"use strict";var i=n("424a"),r=n.n(i);r.a},"97cf":function(e,t,n){"use strict";var i=n("7b2c"),r=n.n(i);r.a},"9ea3":function(e,t,n){},a8cc:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"flow-node"},[n("div",{ref:"dynW"})])},r=[],a=(n("f751"),n("90ee")),o={name:"FlowNode",components:a["a"],props:["flow","node"],data:function(){return{instance:null}},computed:{computedFlow:function(){if("string"===typeof this.flow){var e=this.$ething.arbo.get(this.flow);if(!e)throw"The flow id="+this.flow+" does not exist anymore";return e}return this.flow},computedNode:function(){if("string"===typeof this.node){var e=this.computedFlow.attr("nodes");for(var t in e)if(e[t].id===this.node)return e[t];throw"The node id="+this.node+" from the flow id="+this.computedFlow.id()+" does not exist anymore"}return this.node},nodeType:function(){return this.$ethingUI.get(this.computedNode.type)},nodeComponent:function(){var e=this.nodeType.node||"Base";return"string"===typeof e&&(e=a["a"][e]),Vue.extend(e)}},mounted:function(){var e=this,t=new this.nodeComponent({propsData:Object.assign({flow:this.computedFlow,node:this.computedNode},this.$attrs),parent:this});t.$on("inject",function(t){e.$emit("inject",t)}),t.$mount(this.$refs.dynW),this.instance=t},beforeDestroy:function(){this.instance&&this.instance.$destroy()},methods:{}},s=o,c=n("2877"),l=Object(c["a"])(s,i,r,!1,null,null,null);t["a"]=l.exports},b4a1:function(e,t,n){"use strict";var i=n("c926"),r=n.n(i);r.a},c09d:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("q-list",e._l(e.operations,function(t){return n("q-expansion-item",{key:t.name,attrs:{"expand-separator":"",icon:"keyboard_arrow_right",label:t.name,caption:e.operationReturnToString(t)}},[n("q-card",{staticClass:"content"},[t.description?n("q-card-section",[n("q-markdown",{staticClass:"text-faded"},[e._v(e._s(t.description))])],1):e._e(),e.hasParameters(t)?n("q-card-section",[n("form-schema",{attrs:{schema:t.schema},on:{error:function(e){t.inputError=e}},model:{value:t.model,callback:function(n){e.$set(t,"model",n)},expression:"operation.model"}})],1):e._e(),n("q-card-section",[n("q-btn",{attrs:{loading:t.loading,disable:t.inputError,color:"primary",icon:"done",label:"execute"},on:{click:function(n){return e.execute(t)}}})],1),t.error?n("q-card-section",[n("q-banner",{staticClass:"bg-negative text-white"},[n("q-icon",{attrs:{left:"",name:"mdi-alert"}}),e._v(" "+e._s(String(t.error))+"\n          ")],1)],1):e._e(),t.result?n("q-card-section",{staticClass:"result"},["image"===t.resultType?n("img",{attrs:{src:t.result},on:{load:function(e){t.loading=!1},error:function(e){t.loading=!1,t.error="an error occured",t.result=null}}}):"audio"===t.resultType?n("audio",{attrs:{controls:"",src:t.result,type:t.resultContentType}}):"video"===t.resultType?n("video",{attrs:{controls:"",autoplay:"",src:t.result,type:t.resultContentType}}):"videoflash"===t.resultType?n("object",{staticClass:"videoplayer",attrs:{width:"425",height:"300",data:"http://releases.flowplayer.org/swf/flowplayer-3.2.18.swf",type:"application/x-shockwave-flash"}},[n("param",{attrs:{name:"movie",value:"http://releases.flowplayer.org/swf/flowplayer-3.2.18.swf"}}),n("param",{attrs:{name:"allowfullscreen",value:"true"}}),n("param",{attrs:{name:"allowscriptaccess",value:"always"}}),e._v('":{\\"url\\":\\"\' + operation.result + \'\\"},\\"playlist\\":[{\\"url\\":\\"\' + operation.result + \'\\"}]}\'" />\n          ')]):"json"===t.resultType?n("pre",{directives:[{name:"highlightjs",rawName:"v-highlightjs"}]},[n("code",{staticClass:"json"},[e._v(e._s(t.result))])]):"html"===t.resultType?n("pre",{directives:[{name:"highlightjs",rawName:"v-highlightjs"}]},[n("code",{staticClass:"html"},[e._v(e._s(t.result))])]):"xml"===t.resultType?n("pre",{directives:[{name:"highlightjs",rawName:"v-highlightjs"}]},[n("code",{staticClass:"xml"},[e._v(e._s(t.result))])]):"text"===t.resultType?n("pre",[n("code",{staticClass:"plain"},[e._v(e._s(t.result))])]):e._e()]):e._e()],1)],1)}),1)],1)},r=[],a=(n("551c"),n("097d"),n("8993")),o=n.n(a),s=(n("ac6a"),n("cadf"),n("06db"),n("456d"),n("7f7f"),n("a481"),n("426a"),function(e){var t=document.createElement("audio");return!(!t.canPlayType||!t.canPlayType(e).replace(/no/,""))}),c=function(e){var t=document.createElement("video");return!(!t.canPlayType||!t.canPlayType(e).replace(/no/,""))},l=function(e,t){if(e instanceof Blob){var n=new window.FileReader;n.readAsText(e),n.onloadend=function(){t(n.result)}}else t(e)},u={name:"DeviceApi",props:["device"],data:function(){return{operations:[],_resourceId:null}},watch:{device:{handler:function(e){e&&this._resourceId!=e.id()&&this.buildApi()},immediate:!0}},methods:{buildApi:function(){var e=this.$ethingUI.get(this.device).methods,t=[];for(var n in e){var i=e[n];t.push({name:n,description:i.description,return:i.return,inputError:!1,error:!1,loading:!1,ts:0,result:null,resultType:null,resultContentType:null,schema:{additionalProperties:!1,properties:i.arguments,required:i.required,type:"object"},model:{}})}this.operations=t},hasParameters:function(e){return Object.keys(e.schema.properties||{}).length},operationReturnToString:function(e){var t=e.return;return"string"===typeof t?t:"object"===o()(t)&&null!==t?t.type:""},execute:function(e){var t=e.return;e.ts=Date.now(),e.error=!1,e.loading=!0,e.result=null,e.resultType=null,e.resultContentType=null,/^image\//.test(t)||/^multipart\/x-mixed-replace/.test(t)||"video/x-motion-jpeg"==t||"video/x-jpeg"==t?(e.result=this.toUrl(e)+"&_ts="+e.ts,e.resultType="image"):/^audio\//.test(t)&&s(t)?(e.resultContentType=t,e.result=this.toUrl(e)+"&_ts="+e.ts,e.resultType="audio",e.loading=!1):/^video\//.test(t)?(c(t)?(e.resultContentType=t,e.result=this.toUrl(e)+"&_ts="+e.ts,e.resultType="video"):(e.result=this.toUrl(e)+"&_ts="+e.ts,e.resultType="videoflash"),e.loading=!1):this.device.execute(e.name,e.model,"blob").then(function(t){e.loading=!1;var n=t.type;t&&0!=t.size?/json/.test(n)?l(t,function(t){try{e.result=JSON.stringify(JSON.parse(t),null,"  "),e.resultType="json"}catch(n){e.error="can't parse JSON.  Raw result:\n\n"+t}}):"text/html"===n?l(t,function(t){e.result=t,e.resultType="html"}):/xml/.test(n)?l(t,function(t){e.result=t,e.resultType="xml"}):/text/.test(n)?l(t,function(t){e.result=t,e.resultType="text"}):e.error="Unable to render the response":(e.result=null,e.resultType="empty")}).catch(function(t){e.error=t}).finally(function(){e.loading=!1})},toUrl:function(e){var t="devices/"+this.device.id()+"/call/"+e.name;return e.model&&(t+="?"+this.$ething.utils.param(e.model)),this.$ething.toApiUrl(t,!0)}}},d=u,h=(n("2a8f"),n("2877")),f=Object(h["a"])(d,i,r,!1,null,"47b7e956",null);t["a"]=f.exports},c658:function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"b",function(){return o}),n.d(t,"c",function(){return s}),n.d(t,"f",function(){return c}),n.d(t,"d",function(){return l}),n.d(t,"a",function(){return d}),n.d(t,"g",function(){return h});n("ac6a"),n("cadf"),n("06db"),n("456d");var i=n("11ec"),r=n("ed08");function a(e,t,n,i,r){n=n||{};var a=Object.keys(e).concat(Object.keys(t)).filter(function(e,t,n){return n.indexOf(e)===t});return a.forEach(function(a){var o="undefined"!==typeof n[a]?n[a]:i;o&&(e[a]=o(e[a],t[a],r))}),e}function o(e,t){return"undefined"==typeof e?t:"undefined"==typeof t?e:Object(r["isPlainObject"])(e)&&Object(r["isPlainObject"])(t)?Object(i["a"])(!0,{},e,t):t}function s(e,t,n,i){return e?t?(i=i||o,function(){var r=Array.prototype.slice.call(arguments),a=e.apply(this,r),o=t.apply(this,r);return i(a,o,n)}):e:t}function c(e,t,n,i){return"undefined"===typeof t?i:t}function l(e,t,n,i){e||(e={}),t||(t={}),i=i||o;var r=Object.keys(e).concat(Object.keys(t)).filter(function(e,t,n){return n.indexOf(e)===t}),a={};return r.forEach(function(r){a[r]=i(e[r],t[r],n)}),a}function u(e,t,n,i){if(!e)return t;if(!t)return e;var r=e.concat(t);return i&&(r=r.filter(function(e,t,n){return n.indexOf(e)===t})),r}var d=function(e,t,n){return u(e,t,n,!0)};function h(e,t,n){if(!e)return t;if(!t||Object(r["isEmptyObject"])(t))return e;if(Object(r["isVueComponent"])(t))return t;var a=Object(i["a"])(!0,{},t);return a.mixins=[e],a}},c7b2:function(e,t,n){"use strict";var i={};n.r(i),n.d(i,"widgets",function(){return Et}),n.d(i,"FlowNodes",function(){return Tt["a"]}),n.d(i,"Chart",function(){return p["a"]}),n.d(i,"DeviceApi",function(){return v["a"]}),n.d(i,"FlowNode",function(){return b["a"]}),n.d(i,"ImageViewer",function(){return y["a"]}),n.d(i,"Modal",function(){return g["a"]}),n.d(i,"ResourceBatteryChip",function(){return _["a"]}),n.d(i,"ResourceEditor",function(){return w["a"]}),n.d(i,"ResourceQItem",function(){return x["a"]}),n.d(i,"ResourceSelect",function(){return $["a"]}),n.d(i,"Widget",function(){return C["a"]}),n.d(i,"ResourceObservable",function(){return k}),n.d(i,"ResourceActivity",function(){return Dt["a"]});n("5df3"),n("551c"),n("a481"),n("28a5"),n("f751"),n("7f7f"),n("ac6a"),n("cadf"),n("06db"),n("456d");var r,a,o,s,c=n("426a"),l=n.n(c),u=n("18d6"),d=n("2a19"),h=n("4328"),f=n.n(h),m=n("ed08"),p=n("0292"),v=(n("80c5"),n("c09d")),b=n("a8cc"),y=n("e700"),g=n("714b"),_=n("691a"),w=n("d6ac"),x=n("6659"),$=n("ffbd"),C=n("9023"),k={name:"ResourceObservable",props:["resource","attribute"],data:function(){return{lastValue:void 0,lastUpdate:null}},watch:{resource:{handler:function(e,t){var n=this;if(e!==t&&(this.lastUpdate=null),!this.lastUpdate||e.modifiedDate()>this.lastUpdate){if(this.lastUpdate=e.modifiedDate(),this.attribute){var i=Array.isArray(this.attribute)?this.attribute:[this.attribute];return this.lastValue||(this.lastValue=[]),void i.forEach(function(t,i){var r=e.attr(t),a=n.lastValue&&i<n.lastValue.length?n.lastValue[i]:void 0;a!==r&&n.$emit("change",e,t,r),n.lastValue[i]=r})}this.$emit("change",e)}},deep:!0},attribute:function(){this.lastValue=void 0}},render:function(e){}},q={name:"WWidget",inheritAttrs:!1,props:{color:{type:String},bgColor:{type:String}},methods:{setError:function(e){this.$emit("error",e)}},errorHandler:function(e,t,n){console.error("widget error:",e,t,n),this.setError(e)}},O=q,S=n("2877"),j=Object(S["a"])(O,r,a,!1,null,null,null),E=j.exports,T=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"column"},[e.noHeader?e._e():n("div",{staticClass:"col-auto text-center text-faded ellipsis"},[e._v("\n    "+e._s(e.title)+"\n    "),e.title?e._e():e._t("header")],2),n("div",{staticClass:"col relative-position"},[e._t("default")],2),e.noFooter?e._e():n("div",{staticClass:"col-auto text-center text-faded ellipsis"},[e._t("footer")],2)])},D=[],I={name:"WLayout",props:{title:String,noHeader:Boolean,noFooter:Boolean}},F=I,B=Object(S["a"])(F,T,D,!1,null,"4bb04200",null),A=B.exports,L={name:"WResource",mixins:[E],props:["resource"],data:function(){return{}},computed:{r:function(){if(console.warn("r is deprecated",this),this.resource instanceof l.a.Resource)return this.resource;var e=l.a.arbo.get(this.resource);return e||this.setError("the resource does not exist anymore ! ("+this.resource+")"),e}}},M=L,R=Object(S["a"])(M,o,s,!1,null,null,null),U=R.exports,N=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("chart",{attrs:{preferences:e.resource||{},history:e.history,expended:"",minimal:"",readonly:"","no-zoom":"",chartOptions:e.chartOptions}})},P=[],W={name:"WChart",components:{Chart:p["a"]},mixins:[U],props:{history:{default:86400}},data:function(){return{chartOptions:{chart:{backgroundColor:"rgba(255, 255, 255, 0.0)"},plotOptions:{series:{color:this.color}},title:{style:{color:this.color},text:null},subtitle:{text:null}}}}},V=W,H=Object(S["a"])(V,N,P,!1,null,null,null),z=H.exports,Q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("image-viewer",{attrs:{source:e.resource,"no-title":"",zoom:"fullscreen","content-style":{color:e.color,"background-color":"transparent"},"toolbar-style":{background:"transparent"}}})},Y=[],G={name:"WImage",components:{ImageViewer:y["a"]},mixins:[U]},J=G,K=Object(S["a"])(J,Q,Y,!1,null,"686b5a25",null),Z=K.exports,X=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"absolute-center"},[n("q-toggle",{attrs:{value:!!e.resource.attr(e.attr),color:e.color,"keep-color":"",disable:e.writing},on:{input:e.toggle}})],1)},ee=[],te=(n("097d"),{name:"WSwitch",mixins:[U],props:{attr:String,set:Function},data:function(){return{writing:!1}},methods:{toggle:function(e){var t=this;this.writing=!0,Promise.resolve(this.set(this.resource,e)).catch(function(e){t.setError(e)}).finally(function(){t.writing=!1})}}}),ne=te,ie=Object(S["a"])(ne,X,ee,!1,null,"2cb927e4",null),re=ie.exports,ae=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("w-layout",e._b({},"w-layout",e.$attrs,!1),[n("small",{staticClass:"cursor-pointer",attrs:{slot:"header"},on:{click:function(t){return e.$ethingUI.open(e.resource)}},slot:"header"},[e._v("\n    "+e._s(e.resource.basename())+"\n  ")]),e._t("default"),n("small",{attrs:{slot:"footer"},slot:"footer"},[e._v("\n    "+e._s(e.date)+"\n  ")])],2)},oe=[],se={name:"WDeviceLayout",components:{WLayout:A},props:["resource"],computed:{date:function(){var e=this.resource.lastSeenDate();return e||(e=this.resource.modifiedDate()),this.$ethingUI.utils.dateToString(e)}}},ce=se,le=Object(S["a"])(ce,ae,oe,!1,null,null,null),ue=le.exports,de=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"absolute-center text-h6 text-no-wrap q-gutter-x-xs ellipsis"},[e.icon?n("q-icon",{attrs:{name:e.icon}}):e._e(),n("span",{staticClass:"value",style:{color:e.color}},[e._v(e._s(e.__map(e.resource.attr(e.attr))))]),e.unit?n("small",{staticClass:"unit",staticStyle:{filter:"brightness(90%)"}},[e._v(e._s(e.unit))]):e._e()],1)},he=[],fe={name:"WDeviceLabel",mixins:[U],props:{unit:String,attr:String,icon:String,map:Array},methods:{__map:function(e){var t=this.map;if(t&&t.length)for(var n in t)if(t[n].key===e)return t[n].value;return null===e||void 0===e?"?":e}}},me=fe,pe=Object(S["a"])(me,de,he,!1,null,null,null),ve=pe.exports,be=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"fit column items-center justify-center"},[n("resource-observable",{attrs:{resource:e.resource},on:{change:e.update}}),e._l(e.computedItems,function(t,i){return n("div",{key:i,staticClass:"col-auto"},[t.label?n("span",{staticClass:"label text-faded"},[e._v("\n        "+e._s(t.label)+" :\n    ")]):e._e(),n("span",{staticClass:"value",style:{color:t.color}},[t.icon?[e.isUrlIcon(t.value)?n("img",{staticClass:"vertical-middle",attrs:{src:t.value}}):n("q-icon",{attrs:{name:t.value}})]:[e._v("\n        "+e._s(t.value)+"\n      ")]],2),t.unit?n("small",{staticClass:"unit",staticStyle:{filter:"brightness(90%)"}},[e._v("\n        "+e._s(t.unit)+"\n    ")]):e._e()])})],2)},ye=[],ge=(n("55dd"),n("7514"),{name:"WDeviceMultiLabel",mixins:[U],props:{items:Array},data:function(){return{computedItems:[]}},methods:{update:function(){var e=this,t=this.items.map(function(t,n){var i=Object.assign({attr:void 0,label:"",value:void 0,unit:null,color:e.color,offset:0,coefficient:0,map:{},icon:!1,update:null,nullValue:void 0,skipIfNull:!1,_skipped:!1},t);return i.attr?i.value=e.resource.attr(i.attr):"function"===typeof i.value&&(i.value=i.value.call(e,i)),"function"===typeof i.update&&i.update.call(e,i,i.value),e.computedValue(i),!i.skipIfNull||null!==i.value&&"undefined"!==typeof i.value||(i._skipped=!0),i});this.computedItems=t.filter(function(e){return!e._skipped})},computedValue:function(e){if(null===e.nullValue||"undefined"===typeof e.nullValue||null!==e.value&&"undefined"!==typeof e.value||(e.value=e.nullValue),e.coefficient&&(e.value*=e.coefficient),e.offset&&(e.value+=e.offset),e.map){var t;if(Array.isArray(e.map))t=e.map;else for(var n in t=[],e.map)t.push({key:n,value:e.map[n]});var i=t.find(function(t){return t.key===e.value});if(i||(i=t.find(function(e){return"*"===e.key})),i)e.value=i.value;else if("number"===typeof e.value){var r=t.map(function(e){return e.key}).filter(function(e){return"number"===typeof e}).sort(),a=e.value,o=null,s=null;r.forEach(function(e){var t=Math.abs(e-a);(null===o||t<=o)&&(o=t,s=e)}),null!==s&&(i=t.find(function(e){return e.key===s}),e.value=i.value)}}return e.value},isUrlIcon:function(e){return/^https?:\/\//.test(e)}},mounted:function(){this.update()}}),_e=ge,we=Object(S["a"])(_e,be,ye,!1,null,null,null),xe=we.exports,$e=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"fit"},[n("q-resize-observer",{on:{resize:e.updateLayout}}),n("div",{staticClass:"absolute-center"},[n("q-knob",{attrs:{value:e.resource.attr(e.attr)||0,min:e.min,max:e.max,readonly:"",color:e.color,"show-value":"",size:this.knobSize+"px",thickness:.1,"track-color":"grey-3"}},[n("div",{staticClass:"text-h6 text-no-wrap"},[e.icon?n("q-icon",{attrs:{name:e.icon}}):e._e(),e._v("\n        "+e._s(e.resource.attr(e.attr))+" "),n("small",{staticClass:"unit"},[e._v(e._s(e.unit))])],1)])],1)],1)},Ce=[],ke=(n("c5f6"),{name:"WDeviceKnob",mixins:[U],props:{unit:String,icon:String,min:{type:Number,default:0},max:{type:Number,default:100},attr:String},data:function(){return{knobSize:32}},methods:{updateLayout:function(e){var t=Math.max(Math.min(e.width,e.height),64);this.knobSize=parseInt(.8*t)}}}),qe=ke,Oe=Object(S["a"])(qe,$e,Ce,!1,null,null,null),Se=Oe.exports,je=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("image-viewer",{ref:"view",attrs:{source:e.source,"no-title":"",zoom:"fullscreen",toolbarStyle:{background:"transparent"},"content-style":{color:e.color,"background-color":"transparent"},"toolbar-style":{background:"transparent"}}})},Ee=[],Te={name:"WCamera",components:{ImageViewer:y["a"]},props:{refreshInterval:{default:30}},data:function(){return{timerId:null}},computed:{source:function(){return this.resource.executeUrl("snapshot")}},mounted:function(){var e=this;this.timerId=setInterval(function(){e.$refs.view.refresh()},1e3*this.refreshInterval)},beforeDestroy:function(){null!==this.timerId&&clearInterval(this.timerId)},mixins:[U]},De=Te,Ie=Object(S["a"])(De,je,Ee,!1,null,"2f04df0e",null),Fe=Ie.exports,Be=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"absolute-center"},[n("q-knob",{attrs:{value:e.value,min:e.min,max:e.max,disable:e.writing,color:e.color},on:{change:e.setLevel}},[e._v("\n    "+e._s(e.value)+" "),n("small",{staticClass:"unit",staticStyle:{filter:"brightness(90%)"}},[e._v(e._s(e.unit))])])],1)},Ae=[],Le={name:"WDimmable",mixins:[U],props:{unit:{type:String,default:"%"},min:{type:Number,default:0},max:{type:Number,default:100},attr:String,set:Function},data:function(){return{writing:!1}},computed:{value:function(){return this.resource.attr(this.attr)}},methods:{setLevel:function(e){var t=this;this.writing=!0,Promise.resolve(this.set(this.resource,e)).catch(function(e){t.setError(e)}).finally(function(){t.writing=!1})}}},Me=Le,Re=Object(S["a"])(Me,Be,Ae,!1,null,"7a36bd14",null),Ue=Re.exports,Ne=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("w-device-multi-label",e._b({attrs:{resource:e.resource,items:e.items}},"w-device-multi-label",e.$attrs,!1))},Pe=[],We={name:"WGenericSensor",mixins:[U],computed:{items:function(){var e=this.resource.data(),t=[];for(var n in e)t.push({label:n,unit:null,value:e[n]});return t}}},Ve=We,He=Object(S["a"])(Ve,Ne,Pe,!1,null,null,null),ze=He.exports,Qe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"absolute-center text-center"},[n("div",{staticClass:"time"},[n("span",{staticClass:"text-weight-bold"},[e._v(e._s(e.hours)+":"+e._s(e.minutes)+" ")]),n("small",{staticStyle:{filter:"brightness(90%)"}},[e._v(e._s(e.seconds))])]),n("span",{staticClass:"weekday",staticStyle:{filter:"brightness(90%)"}},[e._v("\n        "+e._s(e.weekday)+"\n    ")])])])},Ye=[],Ge=n("25d4"),Je=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function Ke(e,t,n){return n=n||"0",e+="",e.length>=t?e:new Array(t-e.length+1).join(n)+e}var Ze={name:"WClock",mixins:[E],props:{},data:function(){return{hours:0,minutes:0,seconds:0,weekday:"",timerId:null}},mounted:function(){var e=this;this.timerId=setInterval(function(){e.refreshTime()},1e3)},beforeDestroy:function(){null!==this.timerId&&clearInterval(this.timerId)},methods:{refreshTime:function(){var e=new Date;this.hours=Ke(e.getHours(),2),this.minutes=Ke(e.getMinutes(),2),this.seconds=Ke(e.getSeconds(),2),this.weekday=Je[e.getDay()]}}};Object(Ge["c"])("clock",{component:Ze,title:"clock",description:"Display the time"});var Xe=Ze,et=Xe,tt=Object(S["a"])(et,Qe,Ye,!1,null,null,null),nt=tt.exports,it=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"fit",class:e.outputs.length&&e.inputs.length?"row items-center":""},[e.inputs.length?n("div",{staticClass:"inputs column justify-around items-center",class:e.outputs.length?"col-6":"fit"},e._l(e.inputs,function(t,i){return n("flow-node",{key:i,staticClass:"col-auto",attrs:{flow:e.resource,node:t}})}),1):e._e(),e.outputs.length?n("div",{staticClass:"outputs column justify-around items-center",class:e.inputs.length?"col-6":"fit"},e._l(e.outputs,function(t,i){return n("flow-node",{key:i,staticClass:"col-auto",attrs:{flow:e.resource,node:t}})}),1):e._e()])},rt=[],at={name:"WFlow",extends:U,components:{FlowNode:b["a"]},computed:{parsedFlow:function(){var e=this,t=this.resource.attr("nodes"),n=[],i=[];return t.forEach(function(t){e.$ethingUI.isSubclass(t.type,"nodes/Input")?n.push(t):e.$ethingUI.isSubclass(t.type,"nodes/Output")&&i.push(t)}),{inputs:n,outputs:i}},inputs:function(){return this.parsedFlow.inputs},outputs:function(){return this.parsedFlow.outputs}}},ot=at,st=Object(S["a"])(ot,it,rt,!1,null,null,null),ct=st.exports,lt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("flow-node",{staticClass:"absolute-center",attrs:{flow:e.resource,node:e.node}})},ut=[],dt={name:"WFlowNode",extends:U,components:{FlowNode:b["a"]},props:["node"]},ht=dt,ft=Object(S["a"])(ht,lt,ut,!1,null,null,null),mt=ft.exports,pt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"absolute-center",staticStyle:{"min-width":"100%"}},[n("q-btn",{staticClass:"full-width",style:{color:e.displayHex},attrs:{icon:"mdi-lightbulb",flat:"",size:"xl"},on:{click:e.p_toggle}}),n("div",{staticClass:"row items-center"},[n("q-icon",{staticClass:"col-auto q-mx-sm",attrs:{name:"mdi-brightness-5"}}),n("q-slider",{staticClass:"col",attrs:{min:0,max:100,disable:e.writing,value:e.brightness||0},on:{change:e.p_setBrightness}}),n("q-icon",{staticClass:"col-auto q-mx-sm",attrs:{name:"mdi-brightness-7"}})],1),n("div",{staticClass:"row items-center"},[n("q-icon",{staticClass:"col-auto q-mx-sm",staticStyle:{visibility:"hidden"},attrs:{name:"mdi-brightness-5"}}),n("q-slider",{staticClass:"col hue-slider",attrs:{min:0,max:360,disable:e.writing,value:e.hue},on:{change:e.p_setColorHue}}),n("q-icon",{staticClass:"col-auto q-mx-sm",staticStyle:{visibility:"hidden"},attrs:{name:"mdi-brightness-7"}})],1)],1)},vt=[],bt=n("bc78"),yt=(bt["a"].hexToRgb,bt["a"].rgbToHsv,bt["a"].hsvToRgb),gt=bt["a"].rgbToHex,_t={name:"WRGBLight",mixins:[U],props:{setBrightness:Function,setColor:Function,setState:{}},data:function(){return{writing:!1}},computed:{brightness:function(){return this.resource.attr("level")||0},hue:function(){return this.resource.attr("hue")},saturation:function(){return this.resource.attr("saturation")},displayHex:function(){return this.state?gt(yt({h:this.hue,s:this.saturation,v:100})):"#777"},state:function(){return this.resource.attr("state")}},methods:{p_setBrightness:function(e){var t=this;this.writing=!0,Promise.resolve(this.setBrightness(this.resource,e)).catch(function(e){t.setError(e)}).finally(function(){t.writing=!1})},p_setColorHue:function(e){var t=this,n=100;this.writing=!0,Promise.resolve(this.setColor(this.resource,e,n)).catch(function(e){t.setError(e)}).finally(function(){t.writing=!1})},p_toggle:function(){var e=this;this.setState?Promise.resolve(this.setState(this.resource,!this.state)).catch(function(t){e.setError(t)}).finally(function(){e.writing=!1}):this.p_setBrightness(this.state?0:this.brightness||100)}}},wt=_t,xt=(n("56ed"),Object(S["a"])(wt,pt,vt,!1,null,null,null)),$t=xt.exports,Ct=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n(e.sensorAttributeInfo.component,e._b({tag:"component"},"component",e.sensorAttributeInfo.attrs,!1))},kt=[],qt={name:"WDeviceSensor",mixins:[U],props:{sensorName:String,widgetType:String},computed:{sensorAttributeInfo:function(){var e=this,t=EThingUI.get(this.resource).properties;for(var n in t){var i=t[n];if(i.sensor&&(this.sensorName===n||!this.sensorName)){var r="WDeviceLabel",a={attr:n,unit:i.unit,icon:i.icon,resource:this.resource,color:this.color,bgColor:this.bgColor};if("number"===i.type&&"number"==typeof i.minimum&&"number"==typeof i.maximum&&(r="WDeviceKnob",a.min=i.minimum,a.max=i.maximum),r=this.widgetType||r,"WChart"===r&&(a.resource=null,i.history)){var o=this.$ething.arbo.find(function(t){return t.createdBy()==e.resource.id()&&t.name()==n});o.length>0&&(a.resource=o[0])}return{component:r,attrs:Object.assign(a,this.$attrs)}}}}}},Ot=qt,St=Object(S["a"])(Ot,Ct,kt,!1,null,null,null),jt=St.exports,Et={WWidget:E,WLayout:A,WResource:U,WChart:z,WImage:Z,WSwitch:re,WDeviceLayout:ue,WDeviceLabel:ve,WDeviceMultiLabel:xe,WDeviceKnob:Se,WCamera:Fe,WDimmable:Ue,WGenericSensor:ze,WRGBLight:$t,WDeviceSensor:jt,WClock:nt,WFlow:ct,WFlowNode:mt},Tt=n("90ee"),Dt=n("0de1"),It=n("e35a"),Ft=n("09bd"),Bt=n.n(Ft),At=n("8993"),Lt=n.n(At),Mt=n("2b0e"),Rt=n("11ec"),Ut=n("3e67"),Nt=n("c658"),Pt=n("bd4c"),Wt={icon:"attachment",color:"grey",properties:{data:{$readOnly:!0},modifiedDate:{getFormatted:function(e){return Pt["b"].formatDate(this.get(e).getTime(),"YYYY-MM-DD HH:mm")}},createdDate:{getFormatted:function(e){return Pt["b"].formatDate(this.get(e).getTime(),"YYYY-MM-DD HH:mm")}},extends:{getFormatted:function(e){return(this.get(e)||[]).join(", ")}}}},Vt=n("7937"),Ht={icon:"mdi-file",color:"green",properties:{size:{getFormatted:function(e){return Vt["c"].humanStorageSize(this.get(e))}},contentModifiedDate:{getFormatted:function(e){return Pt["b"].formatDate(this.get(e).getTime(),"YYYY-MM-DD HH:mm")}}},dynamic:function(e){var t,n={};"plot"===e.extension()?(t="mdi-file-chart",n.chart={component:z,schema:{title:"chart",properties:{history:{description:"the past data to plot",type:"number",enum:[3600,21600,43200,86400,172800,604800,"all"],$labels:["1 hour","6 hours","12 hours","1 day","2 days","1 week","all"],default:86400}}},minWidth:250,minHeight:150}):/^text/.test(e.mime())?t="mdi-file-document":/^image/.test(e.mime())?(t="mdi-file-image",n.image={component:Z,schema:{title:"image"},minWidth:320,minHeight:280}):/^video/.test(e.mime())?t="mdi-file-video":/^application/.test(e.mime())&&(t="mdi-file-xml");var i={};return t&&(i.icon=t),n&&(i.widgets=n),i},open:function(e,t){return/\.plot$/.test(e.basename())?"/chart/"+e.id():/image/.test(e.mime())?"/image/"+e.id():"/text/"+e.id()}},zt={icon:"mdi-table-large",color:"blue",properties:{length:{getFormatted:function(e){return this.get(e)+" rows"}},contentModifiedDate:{getFormatted:function(e){return Pt["b"].formatDate(this.get(e).getTime(),"YYYY-MM-DD HH:mm")}}},widgets:{chart:{component:z,schema:{title:"chart",properties:{history:{description:"the past data to plot",type:"number",enum:[3600,21600,43200,86400,172800,604800,"all"],$labels:["1 hour","6 hours","12 hours","1 day","2 days","1 week","all"],default:86400}}},minWidth:250,minHeight:150}},open:function(e,t){return"chart"===t?"/chart/"+e.id():"/table/"+e.id()}},Qt={icon:"mdi-sitemap",color:"purple",virtual:!0,disableCreation:!1,properties:{lastSeenDate:{getFormatted:function(e){var t=this.get(e);return t?Pt["b"].formatDate(t.getTime(),"YYYY-MM-DD HH:mm"):"never"}},location:{get:function(e){return e.attr("location")}}},open:function(e,t){return"/device/"+e.id()}},Yt={icon:"mdi-ray-start-arrow",color:"orange",properties:{nodes:{$readOnly:!0},connections:{$readOnly:!0}},open:function(e,t){return"/flow/"+e.id()},widgets:function(e){return{"flow.full":{component:ct,title:"Flow widget",description:"interact with flow"},"flow.node":{component:mt,title:"Flow node widget",description:"interact with flow",schema:{properties:{node:{description:"the input/output node to display",type:"string",$component:"ething.flow.node",$flow:e,$filter:function(e,t){return EThingUI.isSubclass(t.type,"nodes/Input")||EThingUI.isSubclass(t.type,"nodes/Output")}}}}}}}},Gt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-list",e._l(e.items,function(e){return n("resource-q-item",{key:e.id(),attrs:{resource:e}})}),1)},Jt=[],Kt={name:"ListGroupItems",components:{ResourceQItem:x["a"]},props:{resource:{}},computed:{items:function(){var e=this,t=[];return this.resource.attr("items").forEach(function(n){var i=e.$ething.arbo.get(n);i&&t.push(i)}),t}},methods:{}},Zt=Kt,Xt=Object(S["a"])(Zt,Gt,Jt,!1,null,null,null),en=Xt.exports,tn={color:"cyan-6",widgets:function(e){return{"group.list":{in:"devicePage",component:en,title:"Items",devicePage:{padding:!1}}}}},nn={Resource:Wt,File:Ht,Table:zt,Device:Qt,Flow:Yt,Group:tn},rn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},e._l(e.sensorAttributes,function(t,i,r){return n("div",{key:i,staticClass:"row items-stretch",class:r>0?"q-mt-sm":""},[n("widget",e._b({staticClass:"col-sm-auto col-xs-12",attrs:{component:"WDeviceSensor",resource:e.resource}},"widget",t.widget,!1)),n("div",{staticClass:"gt-xs col q-ml-sm relative-position bg-white",staticStyle:{height:"220px"}},[t.chart?n("widget",e._b({staticClass:"absolute fit",attrs:{component:"WDeviceSensor",resource:e.resource,widgetType:"WChart"}},"widget",t.widget,!1)):n("small",{staticClass:"absolute-center text-light"},[e._v("No data")])],1)],1)}),0)},an=[],on={name:"SensorsListView",components:{Widget:C["a"]},props:{resource:{}},computed:{sensorAttributes:function(){var e={},t=this.$ethingUI.get(this.resource).properties;for(var n in t){var i=t[n];if(i.sensor){var r={title:i.title||n,minHeight:220,minWidth:220,sensorName:n,color:"#027be3",bgColor:"#ffffff"};e[n]={widget:r,chart:i.history}}}return e}},methods:{}},sn=on,cn=(n("6451"),Object(S["a"])(sn,rn,an,!1,null,"75049f18",null)),ln=cn.exports,un={widgets:{"sensor.main":{in:"devicePage",component:ln,title:"Sensors",devicePage:{padding:!1}}},data:function(e){var t={},n=hi.get(e).properties;for(var i in n){var r=n[i];if(r.sensor){var a=e.attr(i);"undefined"!=typeof a&&null!==a&&(t[r.title||i]=a+(r.unit||""))}}return t},dynamic:function(e){var t=[],n=hi.get(e.types()).properties;for(var i in n){var r=n[i];r.sensor&&t.push(i)}if(t.length>0){var a={in:"dashboard",component:jt,title:"label",description:"show the current value of the sensor in a label",attributes:{widgetType:"WDeviceLabel"},schema:{properties:{},required:[]}};t.length>1?(a.schema.properties.sensorName={title:"sensor",enum:t,default:t[0]},a.schema.required.push("sensorName")):a.attributes.sensorName=t[0];var o={in:"dashboard",component:jt,title:"qnob",description:"show the current value of the sensor",attributes:{widgetType:"WDeviceKnob"},schema:{properties:{min:{title:"minimum",type:"number",default:0},max:{title:"maximum",type:"number",default:100}},required:[]}};if(t.length>1)o.schema.properties.sensorName={title:"sensor",enum:t,default:t[0],id:"sensor.widget.sensorName"},o.schema.required.push("sensorName"),o.schema.properties.min.$dependencies={"sensor.widget.sensorName":function(t,n,i){var r=hi.get(e).properties[t].minimum||0;n.$set(n.parent().c_schema.properties.min,"default",r)}},o.schema.properties.max.$dependencies={"sensor.widget.sensorName":function(t,n,i){var r=hi.get(e).properties[t].maximum;"number"!=typeof r&&(r=100),n.$set(n.parent().c_schema.properties.max,"default",r)}};else{o.attributes.sensorName=t[0],o.schema.properties.min.default=n[t[0]].minimum||0;var s=n[t[0]].maximum;"number"==typeof s&&(o.schema.properties.max.default=s)}var c={in:"dashboard",component:jt,title:"chart",description:"plot the value of the sensor",attributes:{widgetType:"WChart"},schema:{properties:{history:{description:"the past data to plot",type:"number",enum:[3600,21600,43200,86400,172800,604800,"all"],$labels:["1 hour","6 hours","12 hours","1 day","2 days","1 week","all"],default:86400}},required:[]}};return t.length>1?(c.schema.properties.sensorName={title:"sensor",enum:t,default:t[0]},c.schema.required.push("sensorName")):c.attributes.sensorName=t[0],{widgets:{"sensor.label":a,"sensor.qnob":o,"sensor.graph":c}}}}},dn={data:function(e){return{state:e.attr("state")?"on":"off"}},widgets:{"switch.state":{in:["dashboard","devicePage"],component:ve,attributes:{attr:"state",map:[{key:!0,value:"On"},{key:!1,value:"Off"}]},title:"state",description:"show the state of the switch",minWidth:100,minHeight:100}}},hn={data:function(e){return{state:e.attr("state")?"on":"off"}},widgets:{"switch.state":{in:["dashboard"]},"relay.switch":{in:["dashboard","devicePage"],component:re,attributes:{attr:"state",set:function(e,t){return e.execute("setState",t)}},title:"switch",description:"toggle the device",minWidth:60,minHeight:60}}},fn={widgets:{"relay.switch":{description:"toggle the light"}}},mn={data:function(e){return{level:e.attr("level")+"%"}},widgets:{"dimmer.label":{in:["dashboard"],component:ve,attributes:{attr:"level",unit:"%"},title:"level",description:"show the level as a label",minWidth:100,minHeight:100},"dimmer.knob":{in:["dashboard","devicePage"],component:Se,attributes:{attr:"level",unit:"%",min:0,max:100},title:"level",description:"show the level in a knob component",minWidth:160,minHeight:180}}},pn={data:function(e){return{level:e.attr("level")+"%"}},widgets:{"dimmable.dimmer":{in:["dashboard","devicePage"],component:Ue,attributes:{attr:"level",set:function(e,t){return e.execute("setLevel",t)}},label:"Dimmer",description:"adjust the level",minWidth:160,minHeight:160}}},vn={widgets:{camera:{in:["dashboard","devicePage"],component:Fe,attributes:{refreshInterval:30},minWidth:160,minHeight:160,title:"Camera",description:"show the last image"}}},bn={widgets:{"anemometer.wind":{in:["dashboard","devicePage"],component:xe,attributes:{items:[{label:"wind speed",attr:"wind_speed",unit:"m/s"},{label:"wind direction",attr:"wind_direction",skipIfNull:!0,map:[{key:0,value:"N"},{key:45,value:"N-E"},{key:90,value:"E"},{key:135,value:"S-E"},{key:180,value:"S"},{key:225,value:"S-O"},{key:270,value:"O"},{key:315,value:"N-O"}]}]},title:"wind information",description:"show the wind speed and wind direction",minWidth:100,minHeight:100}}},yn={data:function(e){return{state:e.attr("state")?"opened":"closed"}}},gn={widgets:{"relay.switch":{in:["dashboard"]},"switch.state":{in:["dashboard"]}}},_n={widgets:{"relay.switch":{in:["dashboard"]},"switch.state":{in:["dashboard"]}}},wn={widgets:{default:{in:["dashboard","devicePage"],icon:"mdi-lightbulb",component:$t,attributes:{setBrightness:function(e,t){return e.execute("setLevel",t)},setColor:function(e,t,n){return e.execute("setColor",{hue:t,saturation:n})},setState:function(e,t){return e.execute("setState",t)}},title:"RGBW light",description:"control the light",minWidth:160,minHeight:200},"relay.switch":{in:["dashboard"]},"switch.state":{in:["dashboard"]},"dimmable.dimmer":{in:["dashboard"]}}},xn={Sensor:un,Switch:dn,Relay:hn,Light:fn,Dimmer:mn,Dimmable:pn,Camera:vn,Anemometer:bn,DoorSensor:yn,DimmableRelay:gn,DimmableLight:_n,RGBWLight:wn},$n={icon:"mdi-signal-variant"},Cn={Signal:$n},kn={color:"#eeeeee"},qn={properties:{method:{id:"HttpRequest.method"},body:{format:"text",$dependencies:{"HttpRequest.method":function(e,t,n){t.$set(t.parent().c_schema.properties.body,"$disabled",-1===["POST","PUT","PATCH"].indexOf(e))}}}}},On={properties:{resource:{id:"ExecuteDevice.device"},method:{id:"ExecuteDevice.method",enum:[],$dependencies:{"ExecuteDevice.device":function(e,t,n){var i=this.$ething.arbo.get(e),r={};i&&(r=this.$ethingUI.get(i).methods),t.$set(t.c_schema,"enum",Object.keys(r))}}},args:{$dependencies:{"ExecuteDevice.method":function(e,t,n){var i=this.$ething.arbo.get(this.find("ExecuteDevice.device").c_value);if(i&&e){var r=this.$ethingUI.get(i).methods,a=r[e];if(a&&Object.keys(a.arguments).length>0){var o={additionalProperties:!1,properties:a.arguments,required:a.required,type:"object"};return void this.$set(this.parent().c_schema.properties,"args",o)}}this.$delete(this.parent().c_schema.properties,"args")}}}}},Sn={node:"Button"},jn={node:"Label"},En={Node:kn,HttpRequest:qn,ExecuteDevice:On,Button:Sn,Label:jn},Tn={resources:nn,interfaces:xn,signals:Cn,nodes:En},Dn={color:"grey",icon:"mdi-help",title:"",description:"",required:[],properties:{},virtual:!1,dynamic:null,category:"",signals:[],widgets:{},disableCreation:!1,open:null,methods:{},data:function(e){},node:null},In={required:Nt["a"],properties:Nt["d"],virtual:Nt["f"],dynamic:!1,signals:Nt["a"],widgets:function(e,t,n){return Object(Nt["d"])(e,t,n,function(e,t,i){if(!e)return t.title||(t.title=n.title),t.icon||(t.icon=n.icon),t;if(!t)return e;var r=Object.keys(e).concat(Object.keys(t)).filter(function(e,t,n){return n.indexOf(e)===t}),a={};return r.forEach(function(n){a[n]="component"===n?Object(Nt["g"])(e[n],t[n]):Object(Nt["b"])(e[n],t[n])}),a})},methods:Nt["d"],data:Nt["c"]},Fn=["widgets"];function Bn(e,t,n){var i=t?t.split("/"):[],r=e;for(var a in i){var o=i[a];if("object"!==Lt()(r)||null===r)throw"definition of "+t+" not found";if("undefined"===typeof r[o]){if(!n)throw"definition of "+t+" not found";r[o]={}}r=r[o]}return r}function An(e,t,n,i){"undefined"===typeof n&&"function"===typeof t&&(i=n,n=t,t=null),i=i||[],t=t||{};var r=!1,a=function(){r=!0};if(e=n(e,t,a,i.join("/")),!r&&"object"===Lt()(e)&&null!==e)for(var o in e){var s=e[o];if("object"===Lt()(s)&&null!==s){var c=i.slice(0);c.push(o),e[o]=An(s,t[o],n,c)}}return e}function Ln(e){if("undefined"!==typeof e["allOf"]){var t=e["allOf"],n=e._bases||[],i={};for(var r in t){var a=t[r],o=null;"string"===typeof a["$ref"]?(o=a["$ref"].substr(2),-1===n.indexOf(o)&&n.push(o)):Un(i,a)}var s=Object(Rt["a"])(!0,{},e);delete s.allOf,Un(i,s),i._bases=n,"undefined"===typeof i["type"]&&(i["type"]="class"),e=i}return e}function Mn(e){if("undefined"!==typeof e["widgets"])for(var t in e.widgets){var n=e.widgets[t];if("string"===typeof n.component){var i=Mt["default"].component(n.component);i?e.widgets[t]=i:(console.error("unknown component "+n.component),e.widgets[t]={})}"string"===typeof n.in&&(n.in=[n.in])}return e}function Rn(e,t,n){var i={};if(!e)return i;var r=e.slice().reverse(),a=!1;return r.forEach(function(e){var r=Bn(t,e);if(r=Object(Rt["a"])(!0,{},r),n){if(r.dynamic){a=!0;var o=r.dynamic.call(r,n);o&&Object(Rt["a"])(!0,r,o)}Fn.forEach(function(e){"function"===typeof r[e]&&(r[e]=r[e].call(r,n))})}r=Mn(r),Un(i,r)}),delete i._mro,delete i._bases,i._dep=e,n&&a&&(i._cacheEtag=n.attr("modifiedDate")),i}function Un(e,t){return Object(Nt["e"])(e,t,In,Nt["b"],t)}function Nn(e,t){e=Object(Rt["a"])(!0,{},Dn,e);var n=function(t){var n=e.properties[t];n.get||(n.get=function(e){return e[t]?e[t]():e.attr(t)}),n.getFormatted||(n.getFormatted=n.get)};for(var i in e.properties)n(i);if("function"!==typeof e.open){var r=e.open;e.open=function(){return r}}for(var a in e.widgets)e.widgets[a]=Object.assign({},Ge["d"],e.widgets[a]);if(delete e.dynamic,t){var o=e.open;e.open=function(e){return o.call(this,t,e)};var s=e.data;e.data=function(){return s?s.call(this,t):{}},e._resource=t}return e}var Pn={};function Wn(e,t){var n=null,i=null,r={},a=!1;if(t instanceof l.a.Resource)n=t,t=t.type(),i=n.id();else if("object"===Lt()(t)&&null!==t&&t._type)t=t._type;else if(Array.isArray(t))a=!0;else if("string"!==typeof t)throw"type must be a string";if(n){if(i in Pn){var o=Pn[i];if(!o._cacheEtag||n.attr("modifiedDate")==o._cacheEtag)return o}}else if(!a&&t in Pn)return Pn[t];return n?r=Rn(n.attr("extends"),e,n):a?r=Rn(t,e):(r=Bn(e,t),r=Rn(r._mro||[],e)),r=Nn(r,n),n?Pn[i]=r:a||(Pn[t]=r),r}function Vn(e,t){var n=!1;if(An(t,function(e,t,i,r){return"undefined"!==typeof e["allOf"]&&(n=!0,e=Ln(e)),"class"===e["type"]&&(e._type=r,i()),e}),n){var i={};An(t,function(e,t,n,r){return"class"===e["type"]&&(i[r]=e._bases||[],n()),e});var r=Object(Ut["linearize"])(i,{reverse:!0,python:!0});for(var a in r){var o=Bn(t,a);o._mro=r[a]}}An(t,Tn,function(t,n,i,r){if("class"===t["type"]){var a=r.split("/"),o=a.pop();a=a.join("/");var s=Bn(e.definitions,a,!0);s[o]=t,n&&(t=e.extend(r,n)),i()}return t})}function Hn(e){if("string"===typeof e)return e;if(e instanceof l.a.Resource)return e.type();if("object"===Lt()(e)&&null!==e&&e._type)return e._type;if("object"===Lt()(e)&&null!==e&&e._resource)return e._resource.type();throw Error('invalid type: "'+e+'"')}var zn={install:function(e){var t=e.EThingUI;Object.assign(t,{mergeClass:Un,definitions:{},iterate:function(e,t){t||"function"!==typeof e||(t=e,e=null),"string"===typeof e&&(e=Bn(this.definitions,e)),e=e||this.definitions,An(e,function(e,n,i,r){return"class"===e["type"]&&(t(e._type),i()),e})},isDefined:function(e){try{return Bn(this.definitions,Hn(e)),!0}catch(t){return!1}},getRaw:function(e){try{return Bn(this.definitions,Hn(e))}catch(t){}},get:function(e){return Wn(this.definitions,e)},isSubclass:function(e,t){if(t=Hn(t),e instanceof l.a.Resource&&e.isTypeof(t))return!0;if(e=Hn(e),e===t)return!0;var n=this.get(e);return n&&n._dep&&-1!==n._dep.indexOf(t)},extend:function(e,t){e=Hn(e);var n=Bn(this.definitions,e);return Object(Rt["a"])(!0,n,t),Object.keys(Pn).forEach(function(t){var n=Pn[t];-1!==n._dep.indexOf(e)&&delete Pn[t]}),n},loadMeta:function(){var e=this;return l.a.request({url:"utils/definitions",dataType:"json"}).then(function(t){Vn(e,t),console.log("[meta] ething meta loaded !")})}}),l.a.Resource.prototype.meta=function(){return t.get(this)}}},Qn=n("8055"),Yn=n.n(Qn),Gn=n("25b3"),Jn=n.n(Gn),Kn=Jn()(Yn.a.Manager),Zn={install:function(e){var t=e.EThingUI;function n(){var e=Yn()(l.a.config.serverUrl+"/events",{autoConnect:!1}),n=Yn()(l.a.config.serverUrl+"/notifications",{autoConnect:!1});Kn(e),e.on("connect",function(){console.log("[socketio] connected"),t.emit("ui.server.connected"),n.open()}),e.on("disconnect",function(){console.log("[socketio] disconnected"),t.emit("ui.server.disconnected"),n.close()}),e.on("*",function(e,t){var n=e.data[1];l.a.arbo.dispatch(JSON.parse(n))}),n.on("connect",function(){var e="ething.cid",t=u["a"].getItem(e);t||(t=String(parseInt(1e9*Math.random())),u["a"].set(e,t)),n.emit("init",{cid:t})}),Object.assign(t,{eventsSocket:e,notifSocket:n})}Object.assign(t,{io:Yn.a,ioPatch:Kn,initSockets:n})}},Xn=function(e){var t=e.EThingUI,n=e.Vue,i=new n;Object.assign(t,{on:function(){return i.$on.apply(i,arguments)},once:function(){return i.$once.apply(i,arguments)},off:function(){return i.$off.apply(i,arguments)},emit:function(){return i.$emit.apply(i,arguments)}})},ei=function(e){var t=e.EThingUI;e.Vue;l.a.on("ConfigUpdated",function(e){console.log("[app] settings updated",e),t.settings=e.data.config}),Object.assign(t,{settings:{},loadSettings:function(){var e=this;return l.a.settings.get().then(function(t){return e.settings=t,t})}})},ti=(n("3b2b"),n("a639")),ni=function(e){var t=e.EThingUI;e.Vue;Object.assign(t,{dbSet:function(e,t,n){var i="session"===n?ti["a"]:u["a"];i.set(e,t)},dbGet:function(e,t){var n="session"===t?ti["a"]:u["a"];if(e instanceof RegExp){var i=n.get.all(),r={};for(var a in i)e.test(a)&&(r[a]=i[a]);return r}return"string"===typeof e?n.get.item(e):n.get.all()},dbDelete:function(e,t){var n="session"===t?ti["a"]:u["a"];n.remove(e)}})},ii={install:function(e){var t=e.EThingUI;Object.assign(t,{info:{},plugins:{},scopes:{},loadInfo:function(){var e=this,t=l.a.request({url:"utils/info",dataType:"json"});return t.then(function(t){console.log("[meta] ething info loaded !"),Object.assign(e,t)}).catch(function(e){console.error("[meta] ething info error !")})}})}},ri={install:function(e){var t=e.EThingUI;Object.assign(t,{loadPlugins:function(){var e=this.plugins||{},t=[],n=function(n){var i=e[n];i.js_index&&t.push(new Promise(function(e,t){Object(m["injectScript"])(l.a.config.serverUrl+"/api/plugin/"+n+"/index.js",function(i){i?(console.error("[meta] plugin "+n+" fail loading"),t()):(console.log("[meta] plugin "+n+" loaded"),e())})}))};for(var i in e)n(i);return Promise.all(t)}})}},ai=["ResourceUpdated"],oi=50,si=function(e){var t,n=e.EThingUI;e.Vue;function i(){return t=n.activity={global:[]},t}function r(e,n){var i=e.type;if(e.originalEvent&&-1===ai.indexOf(i)&&e.originalEvent.resource){var r=e.originalEvent.resource.id,a=l.a.arbo.get(r);if(a){t[r]||(t[r]=[]);t[r];t[r].push(e),oi>0&&(t[r]=t[r].slice(Math.max(t[r].length-oi,0)))}}}i(),l.a.on("*",r),n.on("ui.loaded",function(){i()})};Bt.a.shim();var ci=36e5,li={VERSION:"0.0.1",utils:m,components:i,EThing:l.a,form:It},ui=m["getParameterByName"];function di(e,t){Object.keys(t).forEach(function(n){var i=t[n];m["isVueComponent"](i)?void 0!==i.name&&e.component(i.name,i):m["isPlainObject"](i)&&di(e,i)})}li.kioskMode=Object({NODE_ENV:"production",CLIENT:!0,SERVER:!1,DEV:!1,PROD:!0,MODE:"spa",API:!0,VERSION:"0.0.1",VUE_ROUTER_MODE:"hash",VUE_ROUTER_BASE:"/client/",APP_URL:"undefined"}).KIOSK||"1"===ui("kiosk"),li.virtualKeyboardEnabled=Object({NODE_ENV:"production",CLIENT:!0,SERVER:!1,DEV:!1,PROD:!0,MODE:"spa",API:!0,VERSION:"0.0.1",VUE_ROUTER_MODE:"hash",VUE_ROUTER_BASE:"/client/",APP_URL:"undefined"}).VIRTUALKEYBOARD||"1"===ui("virtualkeyboard"),li.install=function(e){var t=e.app,n=e.router,r=e.Vue,a=e.store;if(!li.__installed){li.__installed=!0,r.config.errorHandler=function(e,t,n){var i=null,r=t;if(t)if(t.$options.errorHandler)i=t.$options.errorHandler;else while(r.$parent)if(r=r.$parent,i=r.$options.errorHandler)break;i?i.call(r,e,t,n):console.error(e)},Object.assign(li,{router:n,store:a,getVueInstance:function(){return this.router.app},route:function(e,t){return this.get(e).open(t)},open:function(e,t){var i=li.route(e,t);i&&n.push(i)}});var o=[zn,Zn,Ge["b"],Xn,ei,ni,ii,ri,si];o.forEach(function(e){var t="function"===typeof e?e:e.install;t({EThingUI:li,Vue:r,router:n,store:a})});var s=null,c=!1,h=window.location.href,m=h.split("/");s=m[0]+"//"+m[2],s&&(l.a.config.serverUrl=s),c||(li.autoLogin=/\/\/localhost/.test(l.a.config.serverUrl)),r.prototype.$ethingUI=li,window&&(window.EThingUI=li),i&&di(r,i),Object.assign(li,{dynamicServerUrl:c,getServerUrl:function(){return l.a.config.serverUrl},setServerUrl:function(e){u["a"].set("ething.server.url",e),l.a.config.serverUrl=e},needAuth:function(){return c&&!u["a"].getItem("ething.server.url")}}),t.data=t.data||{},t.data.state="begin",t.data.error=!1,Object.assign(li,{reset:function(){t.data.state="begin",li.eventsSocket.close(),u["a"].remove("ething.auth.iat"),this.authRefreshTimer&&clearInterval(this.authRefreshTimer)},disconnect:function(){this.reset(),n.app.$router.push({name:"login",query:{redirect_uri:n.app.$router.currentRoute.path}})},logout:function(){var e=l.a.axios.request({method:"get",url:l.a.config.serverUrl+"/auth/logout"});return this.disconnect(),e},login:function(e,t,i){var r=this;return l.a.axios.request({method:"post",url:e+"/auth/password",headers:{"content-type":"application/x-www-form-urlencoded"},data:f.a.stringify({login:t,password:i})}).then(function(t){r.reset(),r.setServerUrl(e),u["a"].set("ething.auth.iat",Date.now());var i=n.app.$route.query.redirect_uri||"/";"/login"===i&&(i="/"),n.app.$router.replace(i)})},authRefreshTimer:null,authRefresh:function(){return l.a.axios.request({method:"post",url:l.a.config.serverUrl+"/auth/refresh"}).then(function(){u["a"].set("ething.auth.iat",Date.now())})}}),console.log("[app] ething configuring ..."),l.a.axios.defaults.withCredentials=!0,l.a.axios.interceptors.response.use(function(e){return e},function(e){if(e.response){var t=e.response.status;401!=t&&403!=t||li.disconnect()}return Promise.reject(e)}),n.beforeEach(function(e,i,a){if("begin"===t.data.state&&"login"!==e.name){if(console.log("[app] begin..."),li.needAuth())return console.warn("[app] no serverUrl found ! need to create a new session"),void a({name:"login",replace:!0,query:{redirect_uri:e.path}});t.data.state="initializing",console.log("[app] initializing..."),li.initSockets(),li.notifSocket.on("notification",function(e){console.log("[app] notification received",e),d["a"].create({type:"info",message:e.msg,detail:e.subject,position:"bottom-right",timeout:15e3,actions:[{label:"Close",handler:function(){}}]})});var o=t.router.app;window.app=o,window.quasar=o.$q,window.Vue=r;var s=li.loadInfo(),c=li.loadMeta(),h=li.loadSettings(),f=l.a.arbo.load(null,!0).then(function(){console.log("[app] ething arbo loaded !")});Promise.all([s,f,c,h]).then(function(){return li.loadPlugins()}).then(function(){t.data.state="ok",console.log("[app] ething loaded !");var e=!1,i=null,r=null;function a(){i&&i(),e&&(setTimeout(function(){n.go()},1e3),i=d["a"].create({type:"positive",color:"positive",message:"Reconnected to server !",icon:"thumb_up",position:"bottom-right",onDismiss:function(){i=null}}),r="connected")}function o(){e=!0,"disconnected"!==r&&(i&&i(),i=d["a"].create({type:"negative",color:"negative",message:"Lost connection to server !",icon:"report_problem",position:"bottom-right",timeout:0,onDismiss:function(){i=null}}),r="disconnected")}li.on("ui.server.connected",a),li.on("ui.server.disconnected",o),li.eventsSocket.open();var s=u["a"].getItem("ething.auth.iat");s&&Date.now()-s>ci&&li.authRefresh(),li.authRefreshTimer=setInterval(function(){li.authRefresh()},ci),li.emit("ui.loaded")}).catch(function(e){console.error(e),t.data.state="error",t.data.error=e})}a()})}};var hi=t["a"]=li},c926:function(e,t,n){},cd50:function(e,t,n){var i={"./bmp":"0dcc","./bmp.js":"0dcc","./gif":"c416","./gif.js":"c416","./jpg":"135b","./jpg.js":"135b","./png":"e9ef","./png.js":"e9ef","./psd":"520c","./psd.js":"520c","./svg":"b0bf","./svg.js":"b0bf","./tiff":"f270","./tiff.js":"f270","./webp":"cf1e","./webp.js":"cf1e"};function r(e){var t=a(e);return n(t)}function a(e){if(!n.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}r.keys=function(){return Object.keys(i)},r.resolve=a,e.exports=r,r.id="cd50"},d6ac:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._t("default"),e.meta.description?n("q-markdown",[e._v(e._s(e.meta.description.trim()))]):e._e(),n("form-schema",{attrs:{schema:e.schema},on:{error:function(t){e.inputError=t}},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}}),n("q-inner-loading",{staticClass:"text-center",attrs:{showing:!e.ready}},[n("div",{staticClass:"q-pa-lg text-primary"},[e._v("loading...")]),n("q-spinner-oval",{attrs:{color:"primary",size:"50px"}})],1)],2)},r=[],a=n("8993"),o=n.n(a),s=(n("7f7f"),n("097d"),n("ac6a"),n("cadf"),n("456d"),n("f751"),n("28a5"),n("551c"),n("06db"),n("426a")),c=n.n(s),l=n("11ec"),u=n("4d7c"),d={name:"ResourceEditor",props:["resource"],data:function(){var e=this,t=this.getSchemaModel(function(){e.$nextTick(function(){e.ready=!0})});return{inputError:!1,create:!(this.resource instanceof c.a.Resource),type:this.resource instanceof c.a.Resource?this.resource.type():this.resource,schema:t.schema,model:t.model,meta:t.meta,ready:!1}},watch:{inputError:function(e){this.$emit("error",e)}},methods:{submit:function(){if(this.inputError)return Promise.reject("form error");var e={},t=null;if(this.create){var n=this.type.split("/").pop();t="undefined"!==typeof c.a[n]?c.a[n].create(Object.assign(e,this.model)):c.a.Device.create(this.type,Object.assign(e,this.model))}else t=this.resource.set(Object.assign(e,this.model));return t},getSchemaModel:function(e){var t=this,n=this.resource instanceof c.a.Resource?this.resource.type():this.resource,i=this.resource instanceof c.a.Resource?this.resource:null,r=i?this.$ethingUI.get(i):this.$ethingUI.get(n);r=this.customize(Object(l["a"])(!0,{},r),i,n);var a=r.required||[],o={},s={},u=0,d=function(){u--,u<=0&&"function"===typeof e&&e()},h=function(e){var n=r.properties[e]["$required"]||-1!==a.indexOf(e);if((!r.properties[e]["$readOnly"]||n)&&(o[e]=r.properties[e],r.properties[e]["$required"]&&-1===a.indexOf(e)&&a.push(e),i)){var c=r.properties[e].get(i);c instanceof Promise?(u++,c.then(function(n){t.$set(t.model,e,n)}).finally(d)):s[e]=c}};for(var f in r.properties)h(f);var m=Object.keys(o);return a=a.filter(function(e){return-1!==m.indexOf(e)}),u||d(),{model:s,schema:{type:"object",required:a,properties:o,$order:["name"]},meta:r}},customize:function(e,t,n){return t||("resources/File"===n?(e.properties.content={id:"resource.content",type:"string",$component:"file"},e.properties.name["$dependencies"]={"resource.content":function(e,t,n){n.files.length>0&&(t.c_value=n.files[0].name)}}):"resources/Table"===n&&(e.properties.content={id:"resource.content",type:"string",$component:"file",accept:".json,.csv",$converter:function(e,t,n,i){var r=function(e){if(!Array.isArray(e))return i("invalid file content");for(var t in e){if("object"!==o()(e[t])||null===e[t])return i("invalid file content");if(!e[t].date)return i("no date field for the item "+t);var r=!1;for(var a in e[t])if("date"!=a&&"id"!=a){r=!0;break}if(!r)return i("no data for the item "+t)}n(e)};/\.json$/i.test(e.name)?r(JSON.parse(t)):/\.csv$/i.test(e.name)?u().fromString(t).then(function(e){r(e)}):i("invalid file type")}},e.properties.name["$dependencies"]={"resource.content":function(e,t,n){n.files.length>0&&(t.c_value=n.files[0].name)}})),e}}},h=d,f=n("2877"),m=Object(f["a"])(h,i,r,!1,null,null,null);t["a"]=m.exports},dd5d:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("form-schema-layout",{staticClass:"form-schema-ething-resource"},[n("resource-select",{attrs:{value:e.c_value,filter:e.computed_filter,multiple:e.multiple,"use-id":"","create-types":e.createTypes,dense:"",error:!!e.error,"hide-bottom-space":""},on:{input:function(t){e.c_value=t}}})],1)},r=[],a=n("ffbd"),o=n("e35a"),s=n("b5ae"),c={name:"FormSchemaEthingResource",mixins:[o["FormComponent"]],components:{ResourceSelect:a["a"]},computed:{multiple:function(){return"array"===this.c_schema.type},__r_schema:function(){return this.multiple?this.c_schema.items:this.c_schema},computed_filter:function(){var e=this,t=this.__r_schema;return function(n){return e.filter(n,t)}},createTypes:function(){var e=this,t=[];return this.__r_schema["$onlyTypes"]&&(t=t.concat(this.__r_schema["$onlyTypes"])),this.__r_schema["$must_throw"]&&this.$ethingUI.iterate("resources",function(n){var i=e.$ethingUI.get(n);-1!==i.signals.indexOf(e.__r_schema["$must_throw"])&&t.push(n)}),t}},validations:function(){var e={};return"number"===typeof this.c_schema.minItems&&(e.minLength=Object(s["minLength"])(this.c_schema.minItems)),"number"===typeof this.c_schema.maxItems&&(e.maxLength=Object(s["maxLength"])(this.c_schema.maxItems)),{c_value:e}},methods:{filter:function(e,t){var n;if(t["$must_throw"]){n=!1;var i=this.$ethingUI.get(e).signals;for(var r in i)if(this.$ethingUI.isSubclass(i[r],t["$must_throw"])){n=!0;break}if(!n)return!1}if(t["$onlyTypes"]){n=!1;var a=t["$onlyTypes"];for(var r in a)if(e.isTypeof(a[r])){n=!0;break}if(!n)return!1}return!(t["$filter"]&&!t["$filter"].call(t,e))}}},l=c,u=n("2877"),d=Object(u["a"])(l,i,r,!1,null,"0ac270af",null);t["a"]=d.exports},e054:function(e,t,n){"use strict";var i=n("597a"),r=n.n(i);r.a},e35a:function(e,t,n){"use strict";n.r(t);n("7514"),n("c5f6"),n("ac6a"),n("cadf"),n("06db"),n("456d"),n("f751"),n("a481");var i=n("8993"),r=n.n(i),a=(n("20d6"),n("7f7f"),n("b5ae")),o=n("11ec"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"form-schema-layout",style:{display:e.inlined?"inline":"block"}},[!e.forceDescription&&e.inlined||!e.schema.description?e._e():n("small",{staticClass:"form-schema-description",staticStyle:{display:"block"}},[n("q-markdown",[e._v(e._s(e.schema.description.trim()))])],1),e._t("default"),!e.inlined&&e.error?n("small",{staticClass:"form-schema-error",staticStyle:{display:"block"}},[e._v("\n    "+e._s(e.error)+"\n  ")]):e._e()],2)},c=[],l={name:"formSchemaLayout",props:{forceDescription:Boolean},computed:{inlined:function(){return this.$parent.inlined},schema:function(){return this.$parent.c_schema},error:function(){return this.$parent.error},level:function(){return this.$parent.level}}},u=l,d=(n("e054"),n("2877")),h=Object(d["a"])(u,s,c,!1,null,"5cbd3fdb",null),f=h.exports;n.d(t,"makeForm",function(){return O}),n.d(t,"FormComponent",function(){return S}),n.d(t,"registerForm",function(){return y}),n.d(t,"unregisterForm",function(){return g}),n.d(t,"addDefinitionsHandler",function(){return j}),n.d(t,"resolve",function(){return q}),n.d(t,"coreComponents",function(){return v});var m=!1,p=[],v=[],b=[],y=function(e,t){b.push({component:e,test:t,name:e.name?w(e.name):""})},g=function(e){var t=b.findIndex(function(t){return t.component===e});-1!==t&&b.splice(t,1)};function _(e){if(null===e||"object"!==r()(e)||"isActiveClone"in e)return e;if(e instanceof Date)var t=new e.constructor;else t=e.constructor();for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e["isActiveClone"]=null,t[n]=_(e[n]),delete e["isActiveClone"]);return t}function w(e){return e.replace(/[_\.\-]/g,"").toLowerCase().replace(/^formschema/,"")}function x(e,t,n){var i=null;if(i="function"===typeof n?n:$(e),"function"===typeof i)try{return i(t)}catch(r){}}function $(e){if("undefined"!==typeof e.rule)return e.rule;if(Array.isArray(e.mixins))for(var t in e.mixins){var n=e.mixins[t],i=$(n);if(i)return i}}var C=function(e){if("string"===typeof e["$ref"]){var t=Object.assign({},e);delete t["$ref"];var n=e["$ref"],i=null;for(var a in p)if(i=p[a](n),"object"===r()(i)&&null!==i)break;e=q(Object(o["a"])(!0,t,i))}return e},k=function(e){if(Array.isArray(e.allOf)){var t=Object.assign({},e);delete t.allOf,e.allOf.forEach(function(e){t=Object(o["a"])(!0,t,q(e))}),e=t}return e},q=function(e){return k(C(e))},O=function(e,t,n){var i=t.schema=q(t.schema);if(i&&0!==Object.keys(i).length){var r={props:t,on:n},a=i["$component"],o=a?w(a):void 0,s=!1;for(var c in b){var l=b[c];if(a&&l.name&&l.name===o)return e(l.component,r);if(!1===s&&x(l.component,i,l.test)&&(s=l.component,!a))break}for(var u in v){var d=v[u],h=d.name;if(a&&o===w(h))return e(d,r);if(!1===s&&x(d,i)&&(s=d,!a))break}if(a&&console.warn("[form] component not found: "+a),!1!==s)return e(s,r);console.error("unable to render the schema",Object.assign({},i))}},S={components:{FormSchemaLayout:f},props:{inline:{default:"inherit"},value:{},schema:{},context:Object,required:{type:Boolean,default:!1},level:{type:Number,default:0}},data:function(){var e=this.schema.id;return e||(e=this.schema.type+"-"+parseInt(1e4*Math.random()),this.schema["$idPrefix"]&&(e=String(this.schema["$idPrefix"])+"-"+e)),{id:e,c_schema:null,formSchemaNode:!0,formSchemaCache:void 0}},watch:{schema:{handler:function(e,t){m&&this.log("watch schema",_(e)),this.c_schema=Object(o["a"])(!0,{},e)},immediate:!0,deep:!0},value:{handler:function(e,t){m&&this.log("watch value"),"undefined"!==typeof this.formSchemaCache&&(this.formSchemaCache=void 0,m&&this.log("clear cache"))},immediate:!0},c_value:{handler:function(e,t){m&&this.log("watch c_value",_(e),"prev",_(t)),this.$v.c_value.$touch()},immediate:!0},error:{handler:function(e,t){m&&this.log("watch error",_(e),"prev",_(t)),this.$emit("error",e)},immediate:!0}},computed:{inlined:function(){var e=this.inline;if(""===e&&(e=!0),"undefined"!==typeof this.schema["$inline"]&&(e=this.schema["$inline"]),"inherit"===e){var t=this.parent();return!!t&&t.inlined}return!!e},c_value:{get:function(){return"undefined"!==typeof this.formSchemaCache?(m&&this.log("c_value.get (cache)",_(this.formSchemaCache)),this.formSchemaCache):(m&&this.log("c_value.get",_(this.value)),"undefined"!==typeof this.value?this.cast(this.value):this.value)},set:function(e){m&&this.log("c_value.set",_(e)),this.formSchemaCache=e,this.$emit("input",e)},cache:!0},error:function(){if(m&&this.log("compute error",this.$v.c_value.$error),!this.$v.c_value.$error)return!1;if("undefined"!=typeof this.$v.c_value.required&&!this.$v.c_value.required)return"Field is required";if("undefined"!=typeof this.$v.c_value.minLength&&!this.$v.c_value.minLength){if(1==this.$v.c_value.$params.minLength.min)return"must not be empty";var e="array"===this.c_schema.type?"items":"characters";return"must have minimum "+this.$v.c_value.$params.minLength.min+" "+e}if("undefined"!=typeof this.$v.c_value.maxLength&&!this.$v.c_value.maxLength){e="array"===this.c_schema.type?"items":"characters";return"must have maximum "+this.$v.c_value.$params.maxLength.max+" "+e}return"undefined"==typeof this.$v.c_value.minValue||this.$v.c_value.minValue?"undefined"==typeof this.$v.c_value.maxValue||this.$v.c_value.maxValue?"undefined"==typeof this.$v.c_value.between||this.$v.c_value.between?"undefined"==typeof this.$v.c_value.alpha||this.$v.c_value.alpha?"undefined"==typeof this.$v.c_value.alphaNum||this.$v.c_value.alphaNum?"undefined"==typeof this.$v.c_value.numeric||this.$v.c_value.numeric?"undefined"==typeof this.$v.c_value.email||this.$v.c_value.email?"undefined"==typeof this.$v.c_value.ipAddress||this.$v.c_value.ipAddress?"undefined"==typeof this.$v.c_value.macAddress||this.$v.c_value.macAddress?"undefined"==typeof this.$v.c_value.url||this.$v.c_value.url?"undefined"==typeof this.$v.c_value.regex||this.$v.c_value.regex?"Invalid value":"Does not match the pattern `"+this.$v.c_value.$params.regex.pattern+"`":"Accepts only URLs":"Accepts only valid MAC addresses like 00:ff:11:22:33:44:55":"Accepts only valid IPv4 addresses in dotted decimal notation like 127.0.0.1":"Accepts only valid email addresses":"Accepts only numerics":"Accepts only alphanumerics":"Accepts only alphabet characters":"must be between "+this.$v.c_value.$params.between.min+" and "+this.$v.c_value.$params.between.max:"must be lower than or equal to "+this.$v.c_value.$params.maxValue.max:"must be greater than or equal to "+this.$v.c_value.$params.minValue.min}},methods:{cast:function(e){return e},getDefault:function(){},log:function(){var e=Array.prototype.slice.call(arguments);e.unshift("["+this.id+"]"),console.log.apply(console,e)},getContext:function(e){if(!e){var t=this.parseContext(window["FormSchemaContext"]),n=this.parent();return n&&Object(o["a"])(!0,t,this.parseContext(n.getContext())),Object(o["a"])(!0,t,this.parseContext(this.context)),t}return this.getContext()[e]},parseContext:function(e){e=e||{};var t=e["global"]||{},n=this.$options.name,i=w(n);for(var r in e)if(w(r)===i){Object.assign(t,e[r]||{});break}return Object.assign(t,e[this.id]||{}),t},parent:function(){var e=this.$parent;while(e&&!e.formSchemaNode)e=e.$parent;return e},root:function(){var e,t=this;while(t)e=t,t=t.parent();return e},children:function(){return this._children(this)},_children:function(e){var t=[];for(var n in e.$children){var i=e.$children[n];i.formSchemaNode?t.push(i):t=t.concat(this._children(i))}return t},find:function(e){var t=this._find_down(this,e);return t||this._find_up(this,e)},_find_up:function(e,t){var n=e.parent();if(n){if(n._is(t))return n;var i=n.children();for(var r in i){var a=i[r];if(a!==e){var o=this._find_down(a,t);if(o)return o}}return this._find_up(n,t)}},_find_down:function(e,t){if(e._is(t))return e;var n=e.children();for(var i in n){var r=this._find_down(n[i],t);if(r)return r}},_is:function(e){return this.schema.id===e},_install_dep:function(e,t){var n=this;e.$on("input",function(i){n.$nextTick(function(){t.call(n,i,n,e)})}),t.call(this,e.c_value,this,e)}},validations:function(){return m&&this.log("validations",this.required),{c_value:this.required?{required:a["required"]}:{}}},mounted:function(){m&&this.log("mounting component");var e=!1;if("undefined"===typeof this.c_value){var t=void 0;t="undefined"!==typeof this.c_schema.default?this.c_schema.default:this.getDefault(),"undefined"!==typeof t&&(e=!0,m&&this.log("set default on mounted",t),this.c_value=t)}if(e||this.$v.c_value.$touch(),this.c_schema["$dependencies"])for(var n in this.c_schema["$dependencies"]){var i=this.c_schema["$dependencies"][n],r=this.find(n);m&&this.log("find node",n),r&&i?this._install_dep(r,i):r||console.warn('[form-schema] node with id ""'+n+'" not found for '+this.$options.name)}}};function j(e){p.push(e)}},e700:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"fit"},[n("div",{ref:"container",class:e.fullscreen?"fullscreen":"relative-position fit",style:e.__style},[n(e.__zoom?"v-zoomer":"div",{directives:[{name:"show",rawName:"v-show",value:!e.error,expression:"!error"}],tag:"component",staticStyle:{width:"100%",height:"100%"}},[n("img",{key:e.key,staticStyle:{"object-fit":"contain",width:"100%",height:"100%"},attrs:{src:e.__url,alt:""},on:{load:e.onload,error:e.onerror}})]),n("div",{staticClass:"absolute-top row items-center q-pa-sm",style:e.__toolbarStyle},[n("div",{staticClass:"col text-subtitle1"},[e.noTitle?e._e():n("span",[e._v(e._s(e.__data.title))])]),n("div",{staticClass:"col-auto"},[n("q-btn",{attrs:{round:"",flat:"",icon:"mdi-refresh"},on:{click:function(t){return e.refresh()}}}),n("q-btn",{attrs:{round:"",flat:"",icon:e.fullscreen?"fullscreen_exit":"fullscreen"},on:{click:function(t){return e.toggleFullscreen()}}})],1)]),n("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"absolute-center"},[n("q-circular-progress",{attrs:{indeterminate:"",size:"48px",color:"white"}})],1),n("div",{directives:[{name:"show",rawName:"v-show",value:e.error,expression:"error"}],staticClass:"absolute-center text-negative"},[e._v("\n    Unable to load the picture\n  ")])],1)])},r=[],a=(n("f751"),n("7f7f"),{name:"ImageViewer",props:{source:{},noTitle:Boolean,zoom:{type:String,default:"both"},contentStyle:Object,toolbarStyle:Object},data:function(){return{fullscreen:!1,key:1,urlSuffix:"",loading:!0,error:!1}},computed:{__data:function(){return/^https?:\/\//.test(this.source)?{url:this.source,title:this.source}:this.source instanceof this.$ething.File?{url:this.source.getContentUrl(!1),title:this.source.name()}:void 0},__url:function(){var e=this.__data.url;return e+(-1===e.indexOf("?")?"?":"&")+this.urlSuffix},__zoom:function(){return"none"!==this.zoom&&("fullscreen"===this.zoom?this.fullscreen:"inline"!==this.zoom||!this.fullscreen)},__style:function(){var e={color:"white","background-color":"#2b2b2b"};return!this.fullscreen&&this.contentStyle&&Object.assign(e,this.contentStyle),e},__toolbarStyle:function(){var e={background:"rgba(0,0,0,0.47)"};return this.toolbarStyle&&Object.assign(e,this.toolbarStyle),e}},methods:{toggleFullscreen:function(){this.fullscreen=!this.fullscreen,this.fullscreen?document.body.appendChild(this.$refs.container):this.$el.appendChild(this.$refs.container)},refresh:function(){this.loading=!0,this.error=!1,this.source instanceof this.$ething.File?this.urlSuffix="_ts="+Date.now():this.key+=1},onload:function(){this.loading=!1},onerror:function(){this.error=!0,this.loading=!1}}}),o=a,s=n("2877"),c=Object(s["a"])(o,i,r,!1,null,null,null);t["a"]=c.exports},eacb:function(e,t,n){},ed08:function(e,t,n){"use strict";n.r(t);n("ac6a"),n("cadf"),n("456d");var i=n("8993"),r=n.n(i),a=(n("7f7f"),n("4917"),n("3b2b"),n("a481"),n("6b54"),n("06db"),n("bd4c")),o=n("7937"),s=n("426a"),c=n.n(s),l=n("21a6"),u=n.n(l);function d(){var e=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var t=0;t<e.length;t++)if(e[t]+"Hidden"in document)return e[t]+"Hidden";return null}function h(){var e=d();return!!e&&document[e]}function f(e,t,n){var i=n&&n.waitHidden||0,r=n&&n.waitShown||0,a=null,o=null;function s(t,n){t!==a&&(a=t,e(a,n))}function c(e,t){var n=e?r:i;null!==o&&(clearTimeout(o),o=null),n?o=setTimeout(function(){o=null,s(e,t)},n):s(e,t)}var l=function(e,t){e.length>0&&c(e[0].isIntersecting,"element")},u=new IntersectionObserver(l);u.observe(t);var f=function(){c(!h(),"page")},m=d(),p=null;m&&(p=m.replace(/[H|h]idden/,"")+"visibilitychange",document.addEventListener(p,f,!1)),this.isVisible=function(){return a},this.destroy=function(){u.disconnect(),p&&document.removeEventListener(p,f,!1),null!==o&&(clearTimeout(o),o=null)}}n("5abe");var m=f,p=(n("551c"),n("7cd69")),v=function(e){return new Promise(function(t,n){var i=document.createElement("div");document.body.appendChild(i);var r=function(e){console.log("ok"),t(e),o.$destroy()},a=function(e){console.log("cancel",e),n(e||new Error),o.$destroy()},o=new Vue({el:i,data:function(){return{props:e}},render:function(t){return t(p["a"],{ref:"modal",props:e,on:{ok:r,cancel:a}})},mounted:function(){this.$refs.modal.show()}})})};function b(e,t){var n=document.createElement("script"),i=document.getElementsByTagName("script")[0];n.async=1,n.onload=n.onreadystatechange=function(e,i){(i||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=n.onerror=null,n=void 0,i||t&&t())},n.onerror=function(e){n.onload=n.onreadystatechange=n.onerror=null,n=void 0,t&&t(!0)},n.src=e,i.parentNode.insertBefore(n,i)}var y=/%[^\s]+%/g;function g(e,t){var n,i=[],r=e;while(n=y.exec(e))i.push(n);return i.reverse().forEach(function(e){var n=e.index,i=e[0].length,o=e[0].substring(1,i-1),s=void 0;try{if("function"===typeof t)s=t(o);else{var c=t[o];s="function"===typeof c?c.call(t):c}}catch(l){}s instanceof Date&&(s=a["b"].formatDate(s.getTime(),"YYYY-MM-DD HH:mm:ss")),r=r.substring(0,n)+String(s)+r.substring(n+i,r.length)}),r}n.d(t,"isPlainObject",function(){return w}),n.d(t,"isRegExp",function(){return x}),n.d(t,"extend",function(){return $}),n.d(t,"getParameterByName",function(){return C}),n.d(t,"dateToString",function(){return k}),n.d(t,"sizeToString",function(){return q}),n.d(t,"colorNameToHex",function(){return O}),n.d(t,"describe",function(){return S}),n.d(t,"saveAs",function(){return j}),n.d(t,"isDefined",function(){return E}),n.d(t,"isEmptyObject",function(){return T}),n.d(t,"isVueComponent",function(){return D}),n.d(t,"VisibilityObserver",function(){return m}),n.d(t,"createModal",function(){return v}),n.d(t,"injectScript",function(){return b}),n.d(t,"parse",function(){return g});var _=Object.prototype.toString;function w(e){return"[object Object]"===_.call(e)}function x(e){return"[object RegExp]"===_.call(e)}function $(e){e=e||{};for(var t=1,n=arguments.length;t<n;++t){var i=arguments[t];if(i)for(var r in i)i.hasOwnProperty(r)&&(w(i[r])?e[r]=$(e[r],i[r]):e[r]=i[r])}return e}function C(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),i=n.exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}function k(e,t){if("string"!==typeof e&&"number"!==typeof e||(e=new Date(e)),!e)return"undefined"===typeof t?"-":t;var n=e.getTime();return a["b"].formatDate(n,"YYYY-MM-DD HH:mm:ss")}function q(e){return o["c"].humanStorageSize(e)}function O(e){var t=document.createElement("div");t.style.color=e;var n=window.getComputedStyle(document.body.appendChild(t)).color.match(/\d+/g).map(function(e){return parseInt(e,10)});return document.body.removeChild(t),n.length>=3?"#"+((1<<24)+(n[0]<<16)+(n[1]<<8)+n[2]).toString(16).substr(1):e}function S(e){var t=[],n=function e(t){if(c.a.utils.isId(t)){var n=c.a.arbo.get(t);if(n)return n.name()}return Array.isArray(t)?t.map(function(t){return e(t)}).join(" "):"object"===r()(t)&&null!==t?0===Object.keys(t).length?"":"{...}":null===t?"":String(t)};for(var i in e){var a=e[i],o=n(a);o&&"undefined"!==typeof a&&t.push(i+": "+o)}return t.join(", ")}function j(e,t){return w(e)&&(e=JSON.stringify(e,null,2)),"string"===typeof e&&(e=new Blob([e],{type:"text/plain"})),u.a.saveAs(e,t||"data")}function E(e){return"undefined"!==typeof e}function T(e){return w(e)&&0==Object.keys(e).length}function D(e){return E(e.mixins)||E(e.extends)||E(e.el)||E(e.render)||E(e.template)||E(e.beforeCreate)||E(e.beforeDestroy)}},fc1d:function(e,t,n){},ffbd:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-select",e._b({attrs:{options:e.options,multiple:e.multiple,"emit-value":"","display-value":e.displayValue,"items-aligned":"","options-selected-class":"text-deep-orange"},on:{filter:e.filterFn},scopedSlots:e._u([{key:"option",fn:function(t){return[n("q-item",e._g(e._b({},"q-item",t.itemProps,!1),t.itemEvents),[n("q-item-section",{attrs:{avatar:""}},[n("q-avatar",{attrs:{color:t.opt.color,"text-color":"white",icon:t.opt.icon}})],1),n("q-item-section",[n("q-item-label",[e._v(e._s(t.opt.label))]),n("q-item-label",{attrs:{caption:""}},[e._v(e._s(t.opt.title))]),t.opt.createBys?n("q-item-label",{attrs:{caption:""}},[e._l(t.opt.createBys,function(t){return[n("q-icon",{attrs:{name:"keyboard_arrow_right"}}),n("span",[e._v(e._s(t.basename()))])]})],2):e._e()],1)],1)]}},e.disableCreate||0!=e.computedCreateTypes.length?null:{key:"append",fn:function(){return[n("q-icon",{staticClass:"cursor-pointer",attrs:{name:"add"},on:{click:e.openCreateModal}})]},proxy:!0}],null,!0),model:{value:e.model,callback:function(t){e.model=t},expression:"model"}},"q-select",e.$attrs,!1))},r=[],a=(n("7f7f"),n("7514"),n("28a5"),n("426a"),n("ed08")),o={name:"ResourceSelect",props:{type:String,notType:String,filter:{},value:{},useId:Boolean,multiple:Boolean,disableCreate:Boolean,createTypes:Array},data:function(){return{options:this.compute_options(),p_model:null}},computed:{model:{get:function(){var e=this.selectedResources.map(function(e){return e.id()});return this.multiple?e:e[0]},set:function(e){var t,n=this;t=this.multiple?this.useId?e:e.map(function(e){return n.$ething.arbo.get(e)}):this.useId?e:this.$ething.arbo.get(e),this.$emit("input",t)}},computedCreateTypes:function(){return this.createTypes?this.createTypes:this.type?this.type.split(/[ ;,]+/):["resources/Resource"]},selectedResources:function(){var e=this;if(this.multiple){var t=[];return Array.isArray(this.value)?t=this.value:this.value&&(t=[this.value]),this.useId?t.map(function(t){return e.$ething.arbo.get(t)}):t}return this.value?[this.useId?this.$ething.arbo.get(this.value):this.value]:[]},displayValue:function(){return 0==this.selectedResources.length?"none":this.selectedResources.map(function(e){return e.basename()}).join(", ")}},methods:{openCreateModal:function(){Object(a["createModal"])({types:this.computedCreateTypes})},resources:function(){var e=this,t=null,n=null;return this.notType&&(t=this.notType.split(/[ ;,]+/)),this.type&&(n=this.type.split(/[ ;,]+/)),this.$ething.arbo.find(function(i){if(t)for(var r in t)if(i.isTypeof(t[r]))return!1;if(n){var a=!1;for(var r in n)if(i.isTypeof(n[r])){a=!0;break}if(!a)return!1}return!e.filter||!!e.filter(i)})},compute_options:function(){var e=this;return this.resources().map(function(t){for(var n=[],i=t,r=0;r<2;r++){var a=i.createdBy()?e.$ething.arbo.get(i.createdBy()):null;if(!a)break;n.push(a),i=a}var o=e.$ethingUI.get(t);return{label:t.name(),value:t.id(),icon:o.icon,color:o.color,title:o.title,createBys:n}})},filterFn:function(e,t,n){var i=this;t(function(){i.options=i.compute_options()})}}},s=o,c=n("2877"),l=Object(c["a"])(s,i,r,!1,null,null,null);t["a"]=l.exports}},[[0,"runtime","vendor"]]]);