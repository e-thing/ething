webpackJsonp([14],{"4FPp":function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"\n.add-row-item[data-v-c61c2100]:not(:first-child) {\n  border-top: 1px solid #bbdefb;\n}\n",""])},h6EO:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("fZjL"),s=a.n(i),n=a("//Fk"),o=a.n(n),l=a("pFYg"),r=a.n(l),d=a("woOf"),c=a.n(d),u=a("7109"),f=a("+cKO"),m={name:"PageTable",data:function(){return{loading:!0,serverPagination:{rowsPerPage:10,page:1,sortBy:"date",descending:!0,rowsNumber:0},serverData:[],filter:"",visibleColumns:["date"],edit:!1,selected:[],loadingStatistics:!1,statistics:null,modalStatistics:!1,add:{modal:!1,error:!1,data:[],typeOptions:["string","number","boolean"].map(function(t){return{label:t,value:t}})}}},validations:function(){return{add:{data:{$each:{key:{required:f.required},value:{required:f.required}}}}}},computed:{resource:function(){var t=this.$route.params.id,e=this.$store.getters["ething/get"](t);return t&&t.length&&(e||this.$router.replace("/404")),this.serverPagination.rowsNumber=e.length(),this.visibleColumns=["date"].concat(e.keys()),e},columns:function(){var t=this.resource,e=[],a={align:"left"};return t&&(e=t.keys().map(function(t){return c()({},a,{name:t,label:t,field:t})})),e.unshift(c()({},a,{name:"date",label:"date",field:"date",sortable:!0,format:function(t){return u._11.formatDate(t,"YYYY-MM-DD HH:mm:ss")}})),e.unshift(c()({},a,{name:"id",label:"id",field:"id"})),e},createdBy:function(){return this.$ething.arbo.get(this.resource.createdBy())},isEmpty:function(){return 0===this.serverData.length}},watch:{resource:function(t,e){t&&t.contentModifiedDate()>this.contentModifiedDate&&this.reloadData()},"add.data":{handler:function(t,e){t.forEach(function(t){if(r()(t.value)!=t.type)switch(t.type){case"boolean":t.value=!!t.value;break;case"string":t.value=String(t.value);break;case"number":t.value=0}})},deep:!0}},methods:{request:function(t){var e=this,a=t.pagination;t.filter;this.resource&&(this.loading=!0,this.contentModifiedDate=this.resource.contentModifiedDate(),this.resource.select({sort:(a.descending?"-":"+")+a.sortBy,start:(a.page-1)*a.rowsPerPage,length:a.rowsPerPage}).then(function(t){e.serverPagination=a,e.serverData=t,e.loading=!1}).catch(function(t){}).finally(function(){e.loading=!1}))},reloadData:function(){this.request({pagination:this.serverPagination,filter:this.filter})},removeSelection:function(){var t=this;this.selected.length&&(this.loading=!0,this.resource.removeRow(this.selected.map(function(t){return t.id})).finally(function(){t.loading=!1,t.selected=[]}))},showStats:function(){null===this.statistics&&this.computeStats(),this.modalStatistics=!0},computeStats:function(){var t=this;this.loadingStatistics=!0,this.statistics={};var e=this.resource.keys().map(function(e){return t.resource.computeStatistics(e).then(function(a){t.statistics[e]=a})});o.a.all(e).finally(function(){t.loadingStatistics=!1})},showAddRow:function(){0===this.add.data.length&&this.addRowTmpl(),this.add.modal=!0},addRowTmpl:function(){var t=this.resource.keys();this.add.data.push({key:t.length?t[0]:"",type:"number",value:0})},addRowListKeys:function(){return this.resource.keys().map(function(t){return{label:t,value:t}})},addRowKeyFilter:function(t,e){e.field;return e.list},addRowShowKeySuggestion:function(t){this.$refs.addRowKeyAutocomplete[t].trigger()},addRow:function(){var t=this,e={};this.add.data.forEach(function(t){if(t.key){var a=t.value;"number"===t.type&&(a=parseFloat(a)),e[t.key]=a}}),s()(e).length>0&&(this.add.loading=!0,this.resource.insert(e).then(function(){t.add.error=!1,t.add.modal=!1}).catch(function(e){t.add.error=e}).finally(function(){t.add.loading=!1}))},format:function(t,e){if(/date/i.test(t)){var a=new Date(e);e=u._11.formatDate(a,"YYYY-MM-DD HH:mm:ss")}return e}},mounted:function(){this.reloadData()}},v=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",[a("q-table",{staticClass:"absolute fit scroll",attrs:{data:t.serverData,columns:t.columns,"row-key":"id","visible-columns":t.visibleColumns,loading:t.loading,pagination:t.serverPagination,selection:t.edit?"multiple":"none",selected:t.selected,color:"secondary"},on:{"update:pagination":function(e){t.serverPagination=e},request:t.request,"update:selected":function(e){t.selected=e}},scopedSlots:t._u([{key:"top-left",fn:function(e){return[a("div",{staticClass:"q-title q-title-opacity"},[t._v(t._s(t.resource.basename())+" "),t.createdBy?a("small",{staticClass:"cursor-pointer text-faded",on:{click:function(e){t.$ui.open(t.createdBy)}}},[t._v(" - "+t._s(t.createdBy.basename()))]):t._e()])]}},{key:"top-right",fn:function(e){return[a("q-table-columns",{staticClass:"q-mr-sm",attrs:{color:"secondary",columns:t.columns},model:{value:t.visibleColumns,callback:function(e){t.visibleColumns=e},expression:"visibleColumns"}}),t._v(" "),a("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"mdi-chart-line",color:"faded",disable:t.isEmpty},on:{click:function(e){t.$ui.open(t.resource,"chart")}}}),t._v(" "),a("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"mdi-information-outline",color:"faded",disable:t.isEmpty},on:{click:t.showStats}}),t._v(" "),a("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"add",color:"faded"},on:{click:t.showAddRow}}),t._v(" "),a("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"check_box",color:t.edit?"secondary":"faded",disable:t.isEmpty},on:{click:function(e){t.edit=!t.edit}}}),t._v(" "),t.selected.length?a("q-btn",{attrs:{flat:"",round:"",dense:"",color:"negative",icon:"delete"},on:{click:t.removeSelection}}):t._e(),t._v(" "),a("q-btn",{attrs:{flat:"",round:"",dense:"",color:e.inFullscreen?"secondary":"faded",icon:e.inFullscreen?"fullscreen_exit":"fullscreen"},on:{click:e.toggleFullscreen}})]}}])}),t._v(" "),a("q-modal",{attrs:{"content-css":{maxWidth:"400px"}},model:{value:t.modalStatistics,callback:function(e){t.modalStatistics=e},expression:"modalStatistics"}},[a("div",{staticClass:"q-ma-md"},[a("div",{staticClass:"q-mb-md q-title q-title-opacity"},[t._v("Statistics")]),t._v(" "),t.loadingStatistics?a("div",{staticClass:"text-center q-mb-md"},[a("div",{staticClass:"q-pa-lg text-primary"},[t._v("loading...")]),t._v(" "),a("q-spinner-oval",{attrs:{color:"primary",size:"50px"}})],1):null!==t.statistics?a("div",t._l(t.resource.keys(),function(e){return a("div",[a("div",{staticClass:"q-mb-md q-subheading q-subheading-opacity"},[t._v(t._s(e))]),t._v(" "),a("div",{staticClass:"row q-mb-md"},[t._l(t.statistics[e],function(e,i){return[a("div",{staticClass:"col-xs-12 col-sm-4 key text-secondary"},[t._v(t._s(i))]),t._v(" "),a("div",{staticClass:"col-xs-12 col-sm-8 value"},[t._v(t._s(t.format(i,e)))])]})],2)])})):t._e(),t._v(" "),a("q-btn",{attrs:{color:"faded",label:"Close",flat:""},on:{click:function(e){t.modalStatistics=!1}}}),t._v(" "),a("q-btn",{attrs:{color:"faded",disable:t.loadingStatistics,label:"Reload",flat:""},on:{click:t.computeStats}})],1)]),t._v(" "),a("q-modal",{attrs:{"content-css":{minWidth:"50%"}},model:{value:t.add.modal,callback:function(e){t.$set(t.add,"modal",e)},expression:"add.modal"}},[a("div",{staticClass:"q-ma-md"},[a("div",{staticClass:"q-mb-md q-title q-title-opacity"},[t._v("Insert data")]),t._v(" "),a("div",t._l(t.add.data,function(e,i){return a("div",{key:i,staticClass:"q-my-lg add-row-item"},[a("q-field",{staticClass:"q-my-md",attrs:{error:t.$v.add.data.$each[i].key.$error,"error-label":"required"}},[a("q-input",{attrs:{"stack-label":"Column name"},on:{focus:function(e){t.addRowShowKeySuggestion(i)},blur:t.$v.add.data.$each[i].key.$touch},model:{value:e.key,callback:function(a){t.$set(e,"key","string"==typeof a?a.trim():a)},expression:"item.key"}},[a("q-autocomplete",{ref:"addRowKeyAutocomplete",refInFor:!0,attrs:{"min-characters":0,filter:t.addRowKeyFilter,"static-data":{field:"value",list:t.addRowListKeys()}},on:{selected:t.selected}})],1)],1),t._v(" "),a("q-field",{staticClass:"q-my-md",attrs:{icon:"keyboard_arrow_right",label:"Type"}},[a("q-select",{attrs:{options:t.add.typeOptions},model:{value:e.type,callback:function(a){t.$set(e,"type",a)},expression:"item.type"}})],1),t._v(" "),a("q-field",{staticClass:"q-my-md",attrs:{icon:"keyboard_arrow_right",label:"Value",error:t.$v.add.data.$each[i].value.$error,"error-label":"required"}},["string"===e.type?a("q-input",{on:{blur:t.$v.add.data.$each[i].value.$touch},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}}):"number"===e.type?a("q-input",{attrs:{type:"number"},on:{blur:t.$v.add.data.$each[i].value.$touch},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}}):"boolean"===e.type?a("q-select",{attrs:{options:[{label:"True",value:!0},{label:"False",value:!1}]},on:{blur:t.$v.add.data.$each[i].value.$touch},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}}):t._e()],1)],1)})),t._v(" "),t.add.error?a("q-alert",{staticClass:"q-my-md",attrs:{type:"negative"}},[t._v("\n        "+t._s(String(t.add.error))+"\n      ")]):t._e(),t._v(" "),a("q-btn",{staticClass:"float-right",attrs:{color:"primary",icon:"add",label:"add another column",flat:"",size:"md"},on:{click:t.addRowTmpl}}),t._v(" "),a("div",[a("q-btn",{attrs:{color:"primary",disable:t.add.error,label:"Add",loading:t.add.loading},on:{click:t.addRow}}),t._v(" "),a("q-btn",{attrs:{color:"negative",label:"Close",flat:""},on:{click:function(e){t.add.modal=!1}}})],1)],1)])],1)},h=[];v._withStripped=!0;var p=a("XyMi"),b=!1;var y=function(t){b||a("ulA3")},g=Object(p.a)(m,v,h,!1,y,"data-v-c61c2100",null);g.options.__file="src\\pages\\Table.vue";e.default=g.exports},ulA3:function(t,e,a){var i=a("4FPp");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("rjj0").default)("25bc98e6",i,!1,{})}});